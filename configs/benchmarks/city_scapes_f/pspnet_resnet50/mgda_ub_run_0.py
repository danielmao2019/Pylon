# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 2994450
config['train_seeds'] = [54976981, 61187603, 61284014, 74049621, 82067563, 16301058, 94397639, 16018678, 25396178, 65128914, 5332660, 66216688, 34484453, 65300830, 42998582, 5976850, 29351069, 34598982, 38738629, 56193796, 74020309, 11391705, 7432474, 58480226, 21388950, 36816540, 18245086, 8907947, 42397195, 60835402, 31520875, 27184859, 10677855, 46953411, 52017511, 92962768, 61275145, 13759774, 62601249, 6906689, 27992081, 84272599, 43479039, 49247223, 96334540, 48732151, 16654267, 46020706, 62288548, 44589653, 30755125, 25019753, 56824353, 12415758, 23603145, 90026024, 67324808, 63346680, 15452145, 86061990, 82108720, 92604510, 52416118, 54162304, 831383, 48814522, 74563180, 25390590, 98547609, 93235998, 48299141, 55773482, 14077664, 15378291, 59099974, 72592447, 39908046, 81998259, 74997818, 70506721, 32092040, 9984042, 78750639, 29235348, 38240784, 970822, 47027974, 82699046, 72135696, 2723331, 38246136, 69679544, 99507561, 6919668, 91951632, 64953724, 91880481, 6741566, 81222035, 90731272]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/mgda_ub_run_0"
