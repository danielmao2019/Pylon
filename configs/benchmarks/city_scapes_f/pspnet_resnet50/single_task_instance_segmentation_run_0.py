# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.city_scapes_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['instance_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['instance_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['instance_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_instance_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 46366464
config['train_seeds'] = [55970959, 73453578, 70147077, 11582006, 71386235, 42334119, 3429504, 25057406, 79117554, 85258607, 36112107, 77321470, 73048664, 54043548, 16971483, 43394946, 5771545, 7443197, 28599754, 68038152, 89432020, 39775504, 45045090, 1393227, 58567357, 80201371, 10918537, 37601065, 18578104, 21238937, 40370318, 92720197, 86783431, 78323179, 67539435, 38680130, 92490684, 8168700, 71321100, 4888391, 7952689, 66380885, 34524114, 36737140, 24856572, 76310364, 60176911, 75310206, 99303406, 10951713, 78359281, 68894983, 7620696, 31340971, 65398997, 13834342, 45417309, 38900264, 64484786, 47380653, 97707278, 25008205, 26865420, 94683676, 17305932, 79988332, 9354409, 59914862, 30909684, 79751336, 98885145, 59020583, 38998779, 45129866, 8648076, 98557777, 71328290, 295372, 47808316, 62576632, 7919714, 23390627, 15807673, 74253669, 19827850, 26809344, 78886167, 65945835, 67186146, 37541888, 97606363, 34225168, 53840349, 44896389, 60832072, 98942118, 36551102, 12149563, 92453346, 54256531]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/single_task_instance_segmentation_run_0"
