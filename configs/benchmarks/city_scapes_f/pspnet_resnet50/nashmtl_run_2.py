# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.nashmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 7499797
config['train_seeds'] = [22892850, 71034908, 66501132, 25286884, 99318290, 29504699, 67075242, 36201377, 67446138, 37386910, 57981356, 45216079, 32976878, 1119953, 29685450, 83173970, 15511211, 86704469, 21113779, 57614448, 69637950, 24295280, 60723607, 95266849, 90829126, 67547144, 61755676, 15874922, 64815840, 95660990, 73416492, 23660814, 13963514, 41461467, 68298787, 97806917, 45693725, 41711691, 61721137, 37692111, 11987570, 69120966, 6113055, 44857718, 34272135, 52990712, 84836493, 23700933, 97082978, 48548031, 77963620, 14580961, 14517481, 11747723, 11842116, 37839335, 49094671, 51778345, 35830408, 28181913, 11283299, 35048260, 24389748, 45754838, 95830675, 35135964, 78985892, 14903287, 10048644, 8428753, 40983441, 10534069, 85060874, 57148790, 89017462, 38847859, 36054007, 96731043, 82021508, 28467939, 47697185, 88426879, 51372305, 81303018, 44597381, 84367936, 47463532, 54919159, 27940549, 47740054, 89818016, 50233091, 10411952, 82271237, 8996236, 32704311, 75019570, 495257, 75364883, 8461813]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/nashmtl_run_2"
