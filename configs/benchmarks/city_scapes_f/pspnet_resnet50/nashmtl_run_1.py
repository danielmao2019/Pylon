# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.nashmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 32494826
config['train_seeds'] = [81157825, 25514492, 62064371, 11820358, 99893490, 41205125, 15740551, 91648, 73719754, 486058, 26632426, 34446609, 89769818, 20967975, 42282428, 39239652, 73513434, 178954, 32749000, 52315821, 78065264, 16772186, 36268781, 73436999, 38773398, 19472032, 60489693, 82735066, 94036680, 73363648, 25575588, 14934636, 38685143, 85799209, 3195396, 22050085, 38246341, 79638488, 89636419, 64212569, 37442199, 57854120, 10022275, 44543183, 96003359, 85175878, 64449520, 57123084, 19496212, 52272361, 54881344, 92264614, 94497131, 13665538, 38184502, 96080771, 6362295, 15623569, 51004476, 78500067, 23605420, 17934866, 26358604, 65730174, 42698663, 27608056, 36277561, 94848465, 11443149, 98919603, 67986384, 59278845, 54588275, 67068008, 6634050, 6155186, 36056617, 81247741, 23753773, 39324814, 17731921, 22363851, 31101646, 51756231, 60105157, 83540322, 48813596, 82017904, 99715795, 55882733, 66000387, 50385566, 81347801, 10447754, 6298099, 84154968, 31877122, 23491222, 55906231, 36246969]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/nashmtl_run_1"
