# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 41711708
config['train_seeds'] = [89833221, 19591639, 3164200, 20255676, 86110249, 77276920, 57602736, 64083001, 67321744, 50873100, 54543521, 76306166, 73972992, 88809994, 92483238, 98512725, 98777134, 2638245, 37465019, 94562364, 65943213, 11203707, 53075003, 86573876, 18807798, 95760200, 16134992, 94086763, 38821532, 64192983, 76906273, 17013845, 77004226, 53186668, 11430753, 76668719, 78829233, 16773391, 14088666, 72698978, 26079811, 87852498, 200270, 73668704, 35318339, 9548287, 34360270, 22109715, 50146482, 20573196, 26809238, 18739569, 84556497, 71637769, 91789440, 41650844, 66270906, 26855893, 76487329, 66246377, 46145219, 81091668, 78292285, 98686001, 9889589, 52465508, 57686024, 8929011, 54359028, 67045672, 11381980, 4005530, 65652694, 44662028, 3927337, 89334381, 46992642, 33227743, 24267619, 98783618, 79795884, 34177882, 82660149, 4376051, 44023753, 89348763, 42872985, 21762144, 53270898, 42080897, 79177378, 82542525, 60462859, 89558289, 95721066, 78894419, 46100552, 27259974, 10821713, 10009510]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/pcgrad_run_2"
