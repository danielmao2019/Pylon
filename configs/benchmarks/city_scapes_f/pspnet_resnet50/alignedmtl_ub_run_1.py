# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 63383438
config['train_seeds'] = [38778311, 7271720, 65448875, 73744299, 71542113, 3219576, 55290853, 98505807, 7083334, 98780850, 23206905, 52474272, 44873295, 85049508, 19348070, 51434753, 23163467, 42135068, 8633948, 82348396, 29919915, 33632842, 88633025, 63020031, 9030384, 16746937, 43033078, 60822051, 36818163, 84318182, 5118247, 42006520, 54924161, 61897113, 22344398, 70510702, 47372855, 54997128, 20247477, 57868602, 81915037, 25004477, 11849010, 38443812, 6379969, 24465178, 54418687, 22820650, 24205564, 7947818, 71375487, 68362175, 18234435, 14002935, 37790511, 46040343, 49144036, 60246245, 46400310, 38042308, 47316587, 95005947, 42142395, 65798995, 83491111, 91836328, 78927974, 22964399, 58320424, 11725625, 18026203, 46645059, 56651427, 11480065, 32913437, 88500330, 30836462, 70489479, 33639368, 47347355, 27079424, 66506301, 72095191, 22708029, 93259767, 26140376, 82063016, 58365757, 48839364, 52578242, 23659873, 52062767, 37728917, 43867839, 23037374, 39536609, 1571417, 86125227, 30597527, 85948429]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/alignedmtl_ub_run_1"
