# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 73908417
config['train_seeds'] = [81566168, 98220192, 33994419, 4828102, 51019644, 79080435, 79716203, 69559824, 13203599, 66806119, 63728766, 12853931, 53559149, 74761803, 52358578, 70385463, 28157361, 70253902, 33200703, 6928618, 98962964, 72458201, 61284659, 12924489, 27324549, 53329687, 79337569, 31026641, 46757486, 23530850, 73911524, 14806761, 282140, 4948195, 54081308, 42591431, 44820355, 59115606, 23273281, 87306606, 48979343, 48960887, 86024693, 33106186, 13473557, 80320434, 92114173, 42813196, 98000419, 28225466, 67178869, 99451629, 64343028, 88307522, 95555620, 29516613, 37625469, 61372178, 63238101, 63142107, 34719423, 57989917, 79613105, 8242513, 15738359, 87578225, 96307284, 35546158, 43846311, 10181192, 53427124, 85429092, 21677637, 97719280, 73923902, 72125037, 53235255, 75542304, 3745002, 42458747, 21174595, 62567817, 21752903, 99806673, 97725619, 72196394, 87431678, 13110588, 89535791, 31493997, 4839459, 50034988, 49435741, 53124375, 19433027, 98262202, 17196836, 19755659, 18062876, 6514860]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/cosreg_run_1"
