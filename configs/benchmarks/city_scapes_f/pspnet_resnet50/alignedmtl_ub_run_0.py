# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 49368491
config['train_seeds'] = [32088686, 8546385, 26298821, 54299284, 45309100, 40656786, 61761220, 67956576, 48169121, 91196657, 91346913, 79254736, 73366797, 48536084, 36733392, 10902827, 91251978, 343401, 48483670, 54432231, 27907436, 53490928, 79124269, 69542785, 35586508, 14325160, 60060765, 85668692, 47788052, 32268215, 26548398, 61543238, 8634584, 76965281, 4468410, 99062264, 53217849, 43774247, 51327966, 78700456, 37021661, 91727322, 46537360, 96739827, 72270317, 76233014, 54061617, 64865381, 99279072, 44353521, 13767403, 91012538, 26941581, 9303106, 64994479, 64624840, 94020048, 7289817, 41653240, 76357513, 73120611, 75897456, 90438, 22718380, 28426573, 11807279, 46958092, 77650926, 35555023, 37991963, 26318888, 51814985, 2853724, 39622870, 20456065, 28976726, 69823363, 26539942, 39810031, 69329248, 6401639, 76300475, 92971921, 84210747, 36319806, 12805234, 64951000, 92480291, 68230074, 44040238, 32060288, 24312221, 35331213, 95602263, 35818069, 2905349, 64836725, 17647106, 7521832, 32019254]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/alignedmtl_ub_run_0"
