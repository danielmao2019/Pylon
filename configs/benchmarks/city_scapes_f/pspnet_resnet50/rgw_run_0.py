# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 69542994
config['train_seeds'] = [74543643, 39439927, 85700856, 31310666, 67891348, 4657020, 25466053, 66914148, 11160192, 49019167, 69300714, 37616552, 29744489, 84481586, 71537313, 58231834, 54558150, 90726936, 66457522, 35913346, 18620056, 60895218, 93884515, 95939242, 20605669, 31184816, 30756716, 37441299, 73483564, 15237181, 47573651, 86754774, 31472833, 74920294, 34893356, 66074244, 80434605, 51705978, 14364056, 27495831, 84836727, 63716222, 95361392, 76661213, 12300917, 85539572, 33804094, 61092143, 58263130, 80395339, 33410888, 78631300, 72300322, 41504202, 9662323, 37794022, 80957475, 39084447, 86644510, 61157471, 66163801, 452341, 41788456, 43207220, 55742058, 78657830, 73008179, 23050505, 17991569, 66866252, 580335, 38741838, 45021462, 41491812, 41587298, 55784747, 54757135, 24255278, 15719476, 81150866, 15875675, 26773284, 51392551, 60893639, 67972183, 51928205, 74730254, 64264037, 45016583, 74263616, 17978127, 77893891, 48264611, 79085025, 67411868, 21178699, 74697003, 66543454, 6802637, 74938068]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/rgw_run_0"
