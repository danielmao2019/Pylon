# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.baseline import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 21105247
config['train_seeds'] = [61765017, 7872836, 30165886, 67912317, 52230444, 1410454, 23246716, 4048625, 41839022, 91563553, 97534634, 56784821, 11910802, 68776269, 22132771, 16916774, 85041506, 36920246, 84024086, 59726596, 36505211, 47420692, 34860336, 53390572, 41220446, 67174669, 63345262, 86266978, 79691976, 72153840, 86068517, 5634062, 91690245, 10670202, 82909811, 52101051, 86972145, 92336673, 86675116, 25606501, 48454014, 92934813, 58668786, 45715410, 72227186, 48228445, 24468964, 68970590, 47639912, 79659139, 39116399, 62433106, 56012578, 73678570, 65789810, 61573201, 3265414, 76077868, 72527387, 86388420, 43226891, 32645443, 27339736, 72473090, 39031210, 80022180, 95916866, 19232537, 60062001, 60180862, 57697843, 74925026, 54877925, 26976105, 79636757, 51959724, 81402866, 50469744, 46308080, 89052876, 24866145, 89066544, 7316857, 24403886, 67347286, 15175792, 56551296, 23164369, 33584204, 94585699, 41494494, 80435091, 78155906, 90080436, 29638032, 42940313, 25974906, 91398706, 27964232, 67165182]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/baseline_run_0"
