# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 35955622
config['train_seeds'] = [99160125, 84299382, 18678860, 88374538, 27258963, 62013044, 51458684, 26048456, 23680109, 15877548, 19993098, 38012492, 94620225, 32316461, 75776873, 67629630, 78534302, 6291153, 59682530, 25901418, 29215655, 98749753, 33643508, 50259696, 43645955, 59296440, 2026397, 69607189, 24400160, 31516481, 43519744, 55010447, 10245509, 70526622, 47382289, 18643950, 90870274, 65894867, 84451738, 83318232, 9647279, 46050801, 58606768, 36476625, 77265032, 5420114, 23340813, 70111274, 63793992, 43016269, 24845892, 59907462, 83742719, 45441369, 49781165, 19467707, 64645699, 98418842, 32605648, 46009577, 2263747, 83049730, 67899474, 94879399, 25740553, 53663339, 35161588, 93908174, 42421165, 746893, 72310989, 36413924, 94038516, 52394824, 24999407, 84932620, 72789679, 5989044, 76571684, 7259790, 64711594, 59922017, 43288527, 90271986, 92481622, 11478828, 10928732, 59598744, 77158381, 5276245, 79689327, 64141434, 40903398, 95769707, 28317585, 28448880, 41103947, 45273801, 21095075, 75102829]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/mgda_ub_run_2"
