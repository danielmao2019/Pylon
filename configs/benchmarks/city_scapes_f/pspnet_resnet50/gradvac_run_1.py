# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.gradvac import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 17871388
config['train_seeds'] = [50755749, 23137482, 34854387, 30681502, 8166990, 22411824, 40793669, 38212615, 30718407, 98777562, 89627373, 83773167, 35034657, 32303786, 96611882, 9155284, 5645932, 68743920, 51458809, 67397686, 81462048, 13318115, 945230, 55609288, 27514877, 8518027, 92524232, 66178216, 26395646, 26201497, 24080032, 14310415, 4910375, 1015479, 99751561, 95148176, 42456439, 77639625, 44488774, 89629685, 6693126, 2656949, 57508715, 18835865, 33376528, 24631572, 49279293, 56531088, 19731715, 8396616, 23004174, 60250741, 8998517, 71573377, 33782341, 83349872, 75974490, 34498566, 8250863, 63780545, 29792185, 7867025, 1188925, 65974439, 68261944, 72548308, 60997560, 60179166, 84547923, 29644688, 34572016, 82994750, 39773232, 89015739, 86862772, 72136106, 74148411, 8493667, 57460949, 82836066, 85171330, 92056995, 7175663, 39143322, 52595709, 42544426, 69793040, 89321298, 6237724, 71013526, 69164172, 78258300, 65928339, 62930668, 37521827, 45571250, 20539620, 35589080, 95049743, 72801669]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/gradvac_run_1"
