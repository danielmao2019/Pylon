# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 89965617
config['train_seeds'] = [16154138, 60538111, 28043383, 7638896, 36963475, 72844299, 21196280, 47144785, 49809757, 43105476, 44469516, 77653725, 3487060, 47397815, 20888765, 65731229, 67231422, 11558158, 22511214, 91914416, 20753690, 61394541, 78579908, 57187795, 40288374, 47995691, 80297438, 90212277, 48089105, 6071693, 78957936, 36963818, 50513136, 59635539, 47581450, 6378724, 10587744, 40357814, 56919285, 68620643, 53016868, 20351383, 95222707, 54588630, 4442002, 84189172, 61209715, 22369726, 22349048, 37299680, 26828181, 23210845, 39010684, 82295756, 16376720, 95279033, 80731168, 21729749, 78977337, 30215040, 40708135, 96022392, 49853035, 43649737, 89214593, 34698403, 2043308, 94091493, 45092907, 73629834, 97062505, 87723557, 21664397, 84578939, 90606448, 21315717, 37429449, 81690231, 66742924, 72527773, 61154, 56217076, 72233969, 92143581, 25708327, 6531905, 40972643, 46760821, 58949991, 7506092, 90166008, 8708009, 9405227, 34020589, 53673174, 75638178, 39260654, 98885457, 63156759, 29515308]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/mgda_run_2"
