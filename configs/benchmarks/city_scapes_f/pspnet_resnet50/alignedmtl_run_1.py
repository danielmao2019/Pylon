# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 66939649
config['train_seeds'] = [2259241, 48366703, 84530403, 98194420, 65688412, 96892278, 68395535, 62321975, 59818619, 19433142, 57221124, 24068526, 53923287, 99119229, 12366437, 92807365, 19436762, 47505335, 98469803, 12793835, 41061339, 22310444, 5563039, 41378546, 48179728, 63516977, 83437732, 44533596, 76439009, 23062651, 75341332, 23560200, 99100793, 46372978, 66977944, 50935714, 15448869, 92429370, 86906419, 34848382, 82965255, 29533233, 51550062, 50224484, 12500882, 76549642, 3752925, 41212710, 7109522, 68459940, 96262333, 94160492, 88110482, 94541723, 4181648, 96212351, 19323121, 12081016, 18726781, 94344500, 22484212, 20651147, 65512790, 54393407, 9547027, 47656158, 55467714, 158340, 97449844, 97569083, 16224040, 89441025, 91763410, 16534936, 69012974, 2778881, 60935989, 55841246, 43504347, 73506756, 92984031, 9223606, 937587, 26777667, 63523500, 73886256, 49031493, 75673759, 39535525, 83275276, 71003995, 46962028, 40522184, 80012452, 63884592, 5127580, 90419555, 10353250, 79753272, 47321684]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/alignedmtl_run_1"
