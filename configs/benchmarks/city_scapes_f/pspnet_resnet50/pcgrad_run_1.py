# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 43602189
config['train_seeds'] = [27134768, 43278079, 29560186, 36191371, 55813346, 89456007, 15461410, 10200700, 94963310, 87389395, 90943150, 13080964, 21137447, 4961628, 61980204, 89467841, 21570854, 82099238, 14987958, 18043526, 12200115, 23558445, 98484822, 9040263, 90160944, 23429745, 80303435, 22234140, 35105784, 92679020, 18124753, 93607661, 252989, 84260988, 58755849, 15660633, 96782607, 99478245, 53868877, 23134002, 92428688, 15486135, 16695601, 80912365, 99367634, 92370398, 79719881, 69790218, 66096389, 1785023, 268078, 68345407, 49158064, 94898221, 32917800, 41880798, 76318115, 74894397, 61070988, 67057523, 91450690, 8710811, 37432644, 3180478, 64164062, 34180622, 17866931, 21117393, 71811297, 28431546, 95709748, 5448371, 23512154, 83352561, 30400885, 61902327, 73298395, 34802284, 60999144, 16153658, 17139014, 25816869, 26049970, 88397355, 18021184, 56687442, 88699305, 17634869, 23036028, 1581137, 5024207, 6722984, 89946069, 22007859, 73595436, 54960315, 22164517, 29769203, 44740725, 43642290]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/pcgrad_run_1"
