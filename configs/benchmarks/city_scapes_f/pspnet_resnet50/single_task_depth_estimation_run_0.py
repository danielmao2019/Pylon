# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.city_scapes_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['depth_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['depth_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['depth_estimation']
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_depth_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 32364161
config['train_seeds'] = [27764076, 36689725, 88351772, 72713763, 45749352, 61118641, 5217632, 70667889, 84934996, 31981310, 21311676, 4566279, 82411898, 3449207, 95763927, 5990880, 46820614, 2253130, 5219668, 15087685, 94569389, 35843262, 50519714, 14712327, 61898405, 22141429, 30463527, 64088344, 71615118, 99375301, 71278591, 4609589, 20686662, 10768287, 8272672, 19135266, 3960377, 47031187, 73655530, 41560761, 795976, 83610889, 22354986, 25485659, 66927346, 54369558, 46354060, 72892537, 67767632, 24341190, 23924242, 11128161, 12449139, 54933152, 12068098, 62210731, 93771955, 89286315, 90217499, 89702241, 22987087, 16396987, 60325312, 27992107, 14954494, 2955801, 42897621, 24175055, 47617690, 92463888, 10872847, 61067783, 37688999, 28514720, 93502263, 26647581, 7924565, 27801542, 46762100, 72760916, 25269443, 97410564, 29746588, 79169780, 66283820, 45834989, 81582129, 74271722, 7619315, 65341762, 52271265, 325897, 28494853, 37890409, 14474722, 86130153, 56404722, 3617657, 6049260, 27717407]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/single_task_depth_estimation_run_0"
