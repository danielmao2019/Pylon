# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.city_scapes_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['depth_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['depth_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['depth_estimation']
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_depth_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 54459753
config['train_seeds'] = [13915530, 56218826, 7322142, 80584080, 78950083, 19029638, 18282590, 80077972, 63054799, 66084552, 40472575, 24871802, 29688223, 46093111, 90828151, 49344457, 72059664, 14217718, 21992424, 51087177, 73882650, 23129152, 39076265, 74610094, 46336727, 74622488, 30703347, 61677055, 36210121, 17802991, 59259712, 91566769, 69656932, 73013390, 97309515, 23239200, 83576390, 49964522, 32797337, 95395114, 90706589, 19332878, 14993514, 64374014, 35946638, 93130337, 40900384, 85553788, 63610943, 1054036, 1222604, 81182804, 49476859, 92086626, 30556547, 45650394, 49237358, 60238394, 1299122, 33280281, 8563537, 77909999, 72711382, 18725492, 22149129, 35868095, 49252635, 17396147, 8294775, 11038770, 32775707, 15049715, 77288960, 20761800, 77373126, 56689445, 7872496, 12743648, 73380474, 17248252, 88682666, 8096880, 54521317, 33457937, 17489976, 28939319, 93936854, 12836364, 57510928, 41189402, 12491366, 16155326, 10168043, 41561614, 86418527, 3127660, 53785506, 92287505, 11607686, 23927464]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/single_task_depth_estimation_run_0"
