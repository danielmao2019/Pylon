# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 83091992
config['train_seeds'] = [52484435, 24227263, 51620382, 17453549, 40428021, 1094764, 81856366, 77680508, 11566343, 78103826, 44349639, 56833751, 50118918, 47617906, 69300109, 42928932, 40602580, 93029548, 70495062, 35100215, 96906171, 76052719, 89744476, 26899007, 93877397, 30905756, 49246610, 46263674, 25859304, 18741664, 25341211, 75611874, 94565645, 91111178, 87218902, 27949718, 60237374, 54859607, 52750906, 52117548, 28650510, 67134584, 26147267, 57688887, 29214607, 27501468, 88123560, 79862106, 82155201, 44453426, 43279757, 46316821, 44664013, 8076112, 97076381, 33659849, 79907284, 58552515, 56795794, 48439558, 60490894, 94698714, 88445667, 35904560, 41863085, 63962229, 20798321, 23476845, 88243602, 52616789, 61041914, 14946217, 86006244, 93451756, 4269162, 75832584, 72709181, 22341113, 74043959, 39759894, 43073744, 66910899, 82928558, 82232751, 68878529, 30373878, 54768111, 19923960, 2255142, 32185143, 14222493, 31145274, 14166648, 67329632, 37149026, 83531954, 85003919, 44777700, 35461573, 44765928]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/mgda_run_1"
