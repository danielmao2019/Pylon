# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 9214006
config['train_seeds'] = [13614868, 2317219, 3460474, 61525152, 8008, 55939771, 50348558, 24318258, 69765000, 13301703, 26255226, 75716800, 25830061, 54805640, 75531467, 64691506, 83084236, 33838797, 75288574, 54753209, 53132713, 29088088, 56820509, 88289999, 1999004, 36534801, 71982632, 28697902, 98136491, 74396676, 23575657, 3254755, 59597476, 68713466, 28534525, 21580346, 9531397, 48640165, 103716, 85971037, 93389269, 47029421, 69092325, 85957248, 39991764, 40491741, 19260891, 3959218, 6411010, 82646524, 36544743, 75033221, 11419663, 42241068, 35595409, 31000497, 37807178, 19648359, 61569436, 25513934, 40812032, 35832870, 34496729, 55541757, 41707448, 2876061, 90253586, 96626050, 30310846, 252917, 36397353, 1010870, 75471127, 94694848, 10162764, 3301571, 14452839, 31771856, 27522559, 87100687, 44918294, 20938890, 40232595, 47082918, 12980874, 32339870, 48567850, 21233349, 20135106, 88063075, 27175560, 66158397, 98629740, 42200833, 80322515, 76970108, 14513056, 69483886, 13078221, 16268187]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/imtl_run_1"
