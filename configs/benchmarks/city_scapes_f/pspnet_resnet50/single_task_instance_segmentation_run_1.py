# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.city_scapes_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['instance_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['instance_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['instance_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_instance_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 80632205
config['train_seeds'] = [7406827, 95127338, 62558800, 40377149, 91388640, 80941027, 28684857, 81419166, 22211208, 16700255, 75155090, 20942336, 14435405, 57638997, 36683600, 7465739, 53480315, 59997031, 38753541, 22161721, 66469265, 81824880, 85961010, 28176138, 58550626, 56554798, 4388953, 48619031, 31761367, 42110884, 53258297, 45446617, 52931811, 45989584, 65922624, 93638311, 14832309, 63212885, 16046196, 20312102, 55917058, 74069256, 84736731, 20887852, 16852755, 53710458, 43747228, 8249624, 64599208, 61220297, 64708911, 38784287, 21063714, 38209914, 64774620, 70825892, 46576131, 91024044, 75136772, 97094255, 69238201, 32999568, 74987703, 72192114, 21414577, 40026813, 9845180, 5831665, 20498598, 59006373, 21709745, 61987421, 3800536, 45409001, 67697891, 65476301, 3468040, 90604532, 45403796, 98871037, 90595106, 93008770, 93396854, 41354246, 26224329, 86302371, 99646807, 33986784, 32466405, 15123485, 86970373, 89950660, 56963249, 78690390, 13715626, 27520027, 96139552, 90151498, 64622894, 12500402]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/single_task_instance_segmentation_run_1"
