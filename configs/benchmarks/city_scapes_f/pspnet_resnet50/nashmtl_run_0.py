# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.nashmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 33475578
config['train_seeds'] = [24312513, 26920570, 76253364, 12713704, 44452280, 47395320, 20944130, 23721868, 79661345, 30149492, 89849588, 76433648, 88419862, 93381164, 48456866, 61735213, 69537316, 32369214, 14594021, 24987215, 32431720, 1424704, 91762732, 28819595, 93509835, 48621404, 1754110, 23184786, 16653423, 72527988, 95831922, 60728516, 46334860, 88656631, 3643943, 75393031, 71659939, 34919345, 1405846, 69602159, 55566561, 75630895, 94790422, 51619203, 71197305, 66910516, 96547809, 90528432, 40857892, 59657477, 76382875, 96354577, 75419240, 9824692, 74937135, 4292971, 64017024, 94205262, 85801584, 68200182, 65008457, 61371826, 60202065, 90202988, 91015, 56947501, 74521810, 4115259, 87115873, 43326835, 91528792, 69691147, 95200720, 51820836, 93892694, 71076044, 18546590, 94791319, 73579689, 83795631, 54762404, 82815869, 82369322, 69045595, 50944773, 82450545, 63297413, 89636774, 44762198, 88984329, 68317726, 5053406, 4862516, 16408643, 33228883, 53968170, 94901806, 68339203, 7202228, 87377866]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/nashmtl_run_0"
