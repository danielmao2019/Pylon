# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 10497205
config['train_seeds'] = [70366746, 34965932, 11957571, 19031299, 34687579, 67082745, 3142216, 98513877, 55435857, 49268450, 31522424, 91567797, 11139672, 33749478, 37235485, 8082490, 63895596, 12227502, 83183679, 80714981, 54306435, 74753990, 40505575, 34793435, 86449337, 44259337, 93976511, 90989084, 46590956, 61851354, 41909450, 8085514, 750716, 10635074, 17863714, 91046447, 68078334, 62951002, 10633485, 93307271, 55030862, 31480252, 32885540, 65969540, 62935568, 29517197, 64765651, 58677713, 33626301, 14289462, 5103294, 22173811, 82892689, 97324524, 30684628, 31944699, 65141130, 38041217, 31036395, 8766142, 14461800, 41556990, 81537535, 29038660, 66731959, 74954044, 52473830, 85925499, 68708834, 73213272, 28536001, 21541801, 39499972, 5818944, 80878413, 90023866, 48790604, 56355938, 77269074, 50248376, 22411066, 30882889, 66430939, 73472318, 28693471, 15329800, 84945036, 54122143, 51100802, 8936134, 57403853, 71862071, 60021140, 20421647, 90188215, 57009481, 73000019, 68729477, 55878272, 336245]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/graddrop_run_1"
