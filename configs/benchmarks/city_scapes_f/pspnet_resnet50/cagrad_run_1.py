# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 25481189
config['train_seeds'] = [92368286, 17732506, 66719294, 37400123, 983015, 49279885, 58748526, 31552159, 71013758, 79656281, 94091925, 31404926, 42453023, 10419182, 66023041, 74236155, 81020163, 92229659, 9246230, 86873020, 28985314, 30202116, 63885678, 98387309, 79077861, 63666028, 88529023, 17428262, 51469220, 10083352, 45005462, 61482225, 34605852, 84370154, 11286935, 85914754, 85881160, 4469474, 97348862, 79452473, 62005754, 41624867, 98815532, 15634706, 72654710, 45856928, 50711234, 23489273, 68793043, 14861705, 66818909, 93433325, 58195765, 25995948, 9913136, 24461450, 51840324, 8172984, 83028353, 84410143, 68421011, 83624838, 20843660, 4406645, 86507679, 8362203, 23640661, 71201085, 10623041, 24063704, 69358313, 33875188, 98768040, 49995788, 37301504, 62734, 92952836, 59537931, 80838092, 57049046, 73605971, 92801620, 6924207, 1887406, 18479722, 82496793, 21457400, 64938450, 86994352, 56264515, 43471390, 84669960, 649394, 73381137, 62723835, 52224190, 52870695, 7591801, 94332758, 44891073]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/cagrad_run_1"
