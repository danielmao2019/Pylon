# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 1789880
config['train_seeds'] = [68741712, 23636609, 63737261, 41195946, 4572958, 35116717, 69448081, 1138081, 70491794, 370503, 33756749, 99092423, 88970940, 50726521, 97987586, 79408310, 46687144, 40274340, 32964270, 18521813, 84856290, 40553830, 75510565, 16787504, 37608681, 24716847, 12425028, 37766940, 86065480, 93857589, 63137376, 29779019, 50493649, 43215867, 24482023, 73412120, 46264509, 18543960, 81825713, 62587542, 92783884, 73994113, 88604748, 94844627, 78726866, 29556343, 33292227, 79594135, 80936195, 48547115, 64091966, 3916179, 59424558, 20885027, 89006162, 52400456, 50447864, 78111638, 11769104, 83151109, 78184759, 22471271, 10300626, 38146447, 86064291, 64933270, 33634604, 87871064, 90587943, 75995698, 6693508, 18310173, 47332384, 75522518, 13955295, 9587826, 55316714, 36355882, 69407049, 19473166, 2236814, 39015635, 56214790, 43940396, 93865172, 65388064, 65693829, 44748670, 94161329, 39973868, 28747769, 25926011, 84672273, 50744744, 93363139, 26329112, 88675208, 72736255, 18244857, 28445881]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/imtl_run_2"
