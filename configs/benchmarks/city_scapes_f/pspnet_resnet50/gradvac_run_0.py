# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.gradvac import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 68540336
config['train_seeds'] = [69695268, 86909263, 2474937, 51709683, 52897854, 54971671, 96622769, 13032611, 38807867, 49214467, 36380027, 89433217, 89049211, 42848512, 67104505, 7930207, 31568704, 33567848, 65604514, 86361081, 70146036, 16940242, 55420827, 20865016, 17549341, 86335979, 99416183, 25923768, 64043319, 64891446, 42040117, 97907657, 95641299, 70592308, 74302716, 1587009, 97084438, 68744730, 32530073, 59618731, 29932271, 87753862, 64324170, 58145839, 19537903, 74819978, 75205194, 35989495, 53811652, 77212051, 93841124, 19726229, 14440994, 92821114, 98394824, 70505783, 80580078, 92589560, 6318157, 51981334, 27655181, 63828593, 80941787, 13957490, 5683324, 72216681, 72758730, 75728356, 48288344, 69313914, 55564255, 41646792, 98275856, 9597994, 42601519, 76534074, 7272606, 37364041, 3806738, 47068164, 30190703, 53400682, 70624329, 36513079, 90077980, 42296854, 86655192, 72556039, 96858558, 33693589, 1568107, 68379270, 67028553, 91023190, 87746908, 45772646, 52120481, 36601518, 3290414, 39502443]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/gradvac_run_0"
