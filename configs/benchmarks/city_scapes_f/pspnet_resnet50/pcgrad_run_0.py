# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 49069515
config['train_seeds'] = [53110546, 32209904, 96708636, 56457057, 37404644, 93043186, 379542, 97385586, 44354749, 18786184, 28692469, 24940560, 52596524, 99993794, 30668117, 56065252, 80161580, 9715972, 36412755, 73994928, 10220092, 60329708, 4019354, 82927905, 80740484, 90618751, 30257448, 40722088, 3669114, 66195530, 14809164, 20556839, 43868492, 64471133, 26876076, 52549430, 39838086, 47452007, 47018927, 35590210, 83834631, 52793150, 8324410, 39743304, 53504869, 81523513, 19161490, 71413957, 90355960, 53798375, 15311618, 7312368, 36266508, 36805401, 72338688, 16349084, 13184304, 44493358, 92195419, 42152751, 63376909, 60265247, 9753491, 57192428, 85255809, 40552425, 94564500, 87697782, 13384171, 63616156, 25493634, 21323789, 81234981, 80942454, 58324548, 91753427, 34369681, 25038476, 79321137, 89584197, 14347189, 38732735, 26819275, 41738114, 79999972, 5442518, 38194049, 34075931, 39708445, 99062091, 22305200, 37193630, 15172037, 85829945, 61649371, 21222378, 32422381, 28225837, 73036537, 54944335]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/pcgrad_run_0"
