# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 32845187
config['train_seeds'] = [89761139, 17303644, 43447371, 59604944, 59082469, 63143737, 19120970, 8076574, 87242267, 12794853, 12496227, 77392052, 9994894, 38730123, 36915227, 74033430, 48362581, 59451791, 9701869, 80839011, 8408084, 58866278, 85753140, 17995163, 24906332, 27562835, 49617787, 17209738, 82302052, 6293591, 49333745, 29246637, 95160095, 67518229, 61377590, 37997921, 23361492, 49514843, 48127589, 39942256, 69165100, 29904431, 97870593, 94854470, 10797701, 34076965, 77303377, 70109633, 83640681, 29183713, 29603879, 74115120, 39201466, 63139164, 75275846, 6407365, 97997196, 86617826, 89414644, 36621327, 88464613, 93849230, 10431689, 37036369, 86568961, 28568438, 88112020, 55048993, 48586522, 85772329, 47052144, 42464524, 57057210, 77127481, 81245750, 83466815, 59757421, 50471073, 3531943, 81693257, 54740062, 15027297, 59937832, 87741508, 90961010, 17892615, 74867338, 65509076, 56480774, 88857835, 13688943, 27107370, 9758206, 96074352, 53158465, 4118506, 85701942, 36691346, 73999968, 14482878]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/pcgrad_run_0"
