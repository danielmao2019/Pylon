# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 80312831
config['train_seeds'] = [80210970, 7501411, 17742264, 96605859, 87409739, 47643539, 87735241, 11733430, 54364365, 79210399, 36025766, 28625194, 37958831, 92291227, 42074249, 91526474, 37370616, 88659396, 71185321, 31600293, 63433695, 7879906, 97061769, 26929663, 83552680, 5854539, 33942784, 63457149, 61887023, 20675555, 91304395, 55261822, 28703401, 30739668, 25376523, 6714278, 75988084, 27166877, 37536208, 60806789, 62670592, 3140500, 11971065, 30793167, 20031274, 12570317, 29027005, 73840410, 71309042, 32944951, 12026880, 4339183, 13536741, 74543411, 94825950, 97474833, 37851441, 50516064, 63162555, 59512709, 59305518, 64762841, 82770476, 17449583, 83507939, 86389389, 31860366, 50694675, 8202641, 1369801, 84944932, 11046765, 45677236, 65785099, 46754085, 47701811, 38646050, 44104332, 63367900, 93055884, 7171228, 45085748, 69061359, 96836721, 49526884, 97382221, 66956145, 29627912, 33230725, 33419849, 52125574, 37361028, 74755736, 35461136, 68689336, 86712666, 46839370, 31239882, 61738588, 4835848]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/graddrop_run_1"
