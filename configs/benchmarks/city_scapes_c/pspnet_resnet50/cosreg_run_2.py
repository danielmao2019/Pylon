# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 78316614
config['train_seeds'] = [96726510, 51527818, 52450253, 24758934, 4667105, 18012752, 82201385, 68666987, 752611, 6587524, 40632198, 46515999, 24581536, 2548141, 37126010, 50940164, 2745286, 39568834, 35877562, 2706655, 38099704, 85268765, 73685001, 45144800, 80474334, 94789834, 75544997, 20016475, 1987733, 97891573, 98883565, 90254558, 62640634, 88773901, 82809990, 66443529, 49643515, 67871921, 69010518, 1320481, 42126166, 21122422, 26503535, 39909188, 47973030, 84269953, 92343417, 48961875, 79851715, 79893767, 93273869, 61539665, 7343984, 57195851, 47769124, 75865756, 28663148, 82869494, 73536095, 46637198, 36244212, 22093321, 16755822, 36966767, 62298981, 28552843, 34878928, 5549076, 24705675, 12463460, 73183736, 91760665, 58774403, 80433659, 36132138, 1609018, 97883504, 86845067, 76962715, 58694230, 68932254, 34855676, 28244767, 38722964, 99368623, 43997069, 76016672, 60959380, 51599413, 99531443, 83333455, 90005196, 18110539, 63780531, 4208466, 75040474, 4359668, 96317314, 87113492, 50432366]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/cosreg_run_2"
