# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 56255732
config['train_seeds'] = [2636217, 69434023, 38341049, 68889367, 14924480, 35476913, 82227111, 70264390, 78576758, 92802015, 64876011, 75223307, 69929829, 51972256, 57122891, 66115660, 81292150, 32761556, 55177043, 91697744, 59416209, 88401918, 7285817, 81115641, 45486176, 45693302, 38802445, 4155123, 63295005, 72115398, 36305237, 46518865, 98317629, 271331, 46711479, 54322709, 4831289, 69560718, 34684047, 1315271, 2638581, 95543179, 91332239, 10482603, 1568723, 89306518, 70000856, 70377910, 62059653, 69774142, 37133956, 29225122, 38372894, 61313590, 44757059, 51843761, 29153026, 50550263, 75314568, 59851011, 36889623, 15547131, 89640603, 76159396, 92799001, 49337206, 58429410, 83652071, 72790735, 70337563, 63581405, 7971641, 16344343, 21779588, 96238789, 73142132, 92086725, 12303410, 11680110, 90486975, 96529833, 3318624, 57020513, 63599168, 35917456, 10384199, 56420143, 55637662, 74140781, 37552798, 57372906, 72832767, 58951371, 51435878, 82709642, 36686656, 10597361, 30930745, 92268530, 44279064]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/imtl_run_1"
