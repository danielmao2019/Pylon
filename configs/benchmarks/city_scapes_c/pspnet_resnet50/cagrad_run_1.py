# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 19367873
config['train_seeds'] = [10028985, 22312929, 17515952, 15103661, 4031022, 28189168, 46854790, 45095618, 63053802, 15113162, 13099154, 71003500, 88766002, 72664955, 29674052, 35490379, 68806092, 84677137, 49658852, 66046896, 88133819, 242092, 14027085, 21267865, 65580417, 33683716, 21607647, 51608668, 6518224, 44428942, 19334840, 40230505, 80284876, 88162200, 62351233, 95007474, 68978084, 36818267, 21292913, 79922042, 91606571, 71768371, 78052838, 76500091, 89422341, 73979167, 65744041, 79737487, 30381419, 17638363, 24282471, 6624333, 2707132, 34636845, 61526106, 4440668, 17964062, 79724278, 2367350, 59069495, 74738295, 40802415, 4089207, 46332734, 1223640, 53733098, 25256818, 17730841, 6012605, 82313081, 69989157, 8124622, 89365157, 12186961, 50344708, 68462722, 54859842, 80100302, 92847363, 31969684, 59514578, 84053399, 47373836, 61029429, 43051527, 24517379, 49417710, 78450991, 49902575, 24334073, 99667502, 17053263, 29140309, 14175124, 98678186, 4686537, 98409703, 30347829, 70398847, 76866946]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/cagrad_run_1"
