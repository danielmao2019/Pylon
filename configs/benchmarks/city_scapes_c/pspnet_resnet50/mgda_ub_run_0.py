# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 78825465
config['train_seeds'] = [96785510, 51734764, 77218198, 32343751, 29530023, 61111024, 19262745, 9754564, 61606390, 37190514, 14882143, 23498576, 85898461, 61157474, 24093341, 20321941, 1550660, 81063095, 77369234, 28732894, 52710754, 38577122, 44663431, 43555797, 71187309, 30290144, 38860492, 94738643, 61087477, 13097307, 93816984, 17210174, 89619556, 30885269, 49376673, 93458252, 75185074, 2228039, 40263148, 35280512, 6792891, 18575294, 84826957, 95757983, 6166914, 67390773, 92493128, 53045358, 24568914, 11597022, 46352779, 78326795, 16082540, 45713038, 15143419, 4658525, 8056309, 92376690, 10015277, 38368538, 71224118, 74103460, 73247484, 6989322, 69642369, 22474016, 14117957, 59098878, 39757378, 43223505, 78343193, 14978470, 29046724, 92123922, 10184513, 94407185, 42887516, 53305982, 19911725, 43573852, 75215001, 24058257, 97375554, 74964023, 10897537, 82526791, 15269662, 3772342, 14663238, 82143972, 18239202, 86783125, 26075668, 68716414, 68236607, 12539004, 80391783, 14126638, 51811063, 926873]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/mgda_ub_run_0"
