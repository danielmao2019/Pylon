# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.nashmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 20295731
config['train_seeds'] = [71106778, 902423, 27799232, 43625371, 87146830, 16853557, 7842431, 51946739, 50684941, 3415404, 1140925, 3555021, 63057487, 57248072, 99597501, 27029271, 19258648, 67432681, 14586466, 22783408, 23860596, 52016138, 78568473, 28243424, 37635032, 64731301, 44808422, 54939598, 26233598, 32773468, 60915119, 79861744, 9573254, 70545638, 26267699, 9538346, 94024577, 69639256, 38328208, 16352953, 50703402, 65788755, 77570525, 69132725, 22635840, 41047929, 80349098, 20832146, 18140396, 32080203, 90574324, 98769763, 79208058, 6427551, 68234909, 77988267, 20244197, 29755200, 52608731, 97062171, 72469147, 89198695, 14078725, 51601086, 17938228, 49614117, 92080152, 65431984, 49859655, 27350975, 85941701, 27610594, 38269232, 56036750, 61723848, 7489446, 59958678, 5443885, 241176, 53634399, 42203303, 16241405, 96106561, 31585734, 46918950, 13775093, 66660393, 66834013, 23871848, 86612508, 59899301, 36776385, 36709351, 57375978, 15126242, 97875964, 74174476, 76770527, 57992628, 84356085]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/nashmtl_run_2"
