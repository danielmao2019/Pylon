# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 43335120
config['train_seeds'] = [31924945, 58161664, 93658636, 82362525, 91254227, 89810271, 25845521, 99570703, 57218695, 28400035, 40447627, 33463643, 98432127, 4719090, 92128635, 87325568, 76352008, 31658935, 92677092, 25561389, 19853680, 7928424, 39903889, 34199433, 7532421, 22977543, 78114116, 81047031, 51915315, 45814859, 73431319, 31516440, 54518233, 96064969, 59976451, 24596945, 6147803, 50050196, 78755976, 74673942, 57794704, 8332750, 89797896, 8582416, 24772611, 29425321, 47710361, 71547749, 40903056, 64079991, 63723745, 52933312, 30704439, 84575623, 95222333, 52670669, 38115669, 23058628, 27386180, 49948397, 69072730, 93168256, 40454873, 81482338, 78276176, 9841507, 77274674, 18170783, 42455855, 32503011, 31948264, 34265244, 44695211, 57501403, 64453922, 79228584, 29832883, 95366432, 3603570, 41380854, 21185932, 94704488, 54433347, 60427222, 24989349, 90420807, 97877726, 62450131, 344287, 54720848, 73630523, 30525470, 9445684, 3516987, 30230130, 26642173, 87474959, 21689611, 38871353, 87723996]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/alignedmtl_run_1"
