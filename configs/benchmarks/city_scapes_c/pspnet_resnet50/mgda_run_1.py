# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 61349231
config['train_seeds'] = [38997592, 94385137, 19436232, 31346463, 88276590, 76021266, 2736775, 52377950, 51456345, 94082731, 75993103, 7220253, 30838939, 95475264, 66860384, 27591675, 1787102, 19156690, 2038678, 85991295, 18522668, 2744851, 97714721, 50061589, 12736935, 77464644, 86129731, 57582666, 87728833, 20426543, 43134364, 9901733, 1444694, 77441316, 95810834, 11790877, 64314652, 75391180, 15421405, 79015818, 44668223, 23049775, 25304627, 35315972, 95430753, 16747280, 91753217, 9519333, 31035772, 69844727, 46554545, 86181902, 84803710, 25822658, 6698922, 76697446, 14879096, 45136385, 49550705, 27237385, 13597494, 53048462, 91736150, 92724962, 4605275, 34461721, 52627239, 32334868, 48695459, 72056216, 85802435, 96957188, 16275711, 22943235, 15126160, 53810549, 49444744, 830855, 94899004, 68604575, 49142884, 5542066, 45083064, 30442457, 34507633, 87342518, 53385873, 98444182, 64050212, 72883625, 22522781, 26083267, 32718282, 66579411, 63999786, 21047306, 75717047, 78054051, 52634138, 81684144]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/mgda_run_1"
