# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.gradvac import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 91316745
config['train_seeds'] = [94832668, 3988221, 2228504, 66906624, 25568438, 81016822, 69663478, 18680453, 61634352, 39136579, 13674328, 76440124, 55925738, 20573966, 1087050, 35622295, 46122209, 60798781, 26405990, 36613403, 53541821, 44941469, 88828962, 48646531, 10230857, 78066601, 11245514, 26736869, 83870855, 72695661, 27782683, 92500657, 3564516, 88476118, 92939864, 59590001, 35327093, 14640892, 76815389, 2716301, 57605011, 49224148, 65596653, 49209532, 92097527, 77968136, 79479052, 96572358, 94070864, 79879931, 43826067, 15583549, 70957497, 35977646, 61890688, 47265256, 57343337, 89693766, 56887224, 27427788, 28769108, 94167182, 4838157, 72327337, 48109541, 50980472, 10541280, 4435661, 38851816, 96139357, 82871181, 17246635, 79603644, 76044836, 99962350, 26862137, 87758783, 80136227, 23565144, 87714360, 46848113, 48799217, 26928765, 29199557, 1368483, 44858668, 4752017, 93472817, 39524222, 50276581, 47782421, 23694488, 86980480, 6992892, 55657766, 46985143, 53419329, 10056070, 75436896, 58703308]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/gradvac_run_2"
