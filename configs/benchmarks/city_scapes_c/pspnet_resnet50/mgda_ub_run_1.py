# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 91033299
config['train_seeds'] = [11240712, 85343200, 94288873, 53246653, 2906111, 99339696, 16950505, 11954488, 37383403, 31175148, 77507673, 24116439, 97822772, 18478387, 37729504, 33166629, 62597260, 72359009, 68994186, 68195263, 27013782, 66226745, 88240877, 32535622, 52866190, 80965857, 87519427, 85411003, 6605608, 44693943, 15519297, 72191299, 71861591, 817649, 61383426, 19746573, 27246705, 13538740, 53048760, 77516130, 72331449, 54062950, 29066545, 7743413, 50883697, 19244319, 90044544, 20279416, 22482197, 85268915, 31420815, 29214431, 915963, 89777942, 20683819, 55668071, 36889998, 4626126, 33961690, 13100650, 96230444, 21899954, 18508446, 11114943, 26691988, 9764539, 99254613, 8757970, 18656065, 2277906, 5150886, 33585635, 75693596, 34664884, 2200673, 79117571, 82762900, 78773639, 94785532, 17527479, 91979605, 953915, 83677410, 77589637, 20524833, 20324668, 38474857, 40835030, 67958443, 90760048, 86039389, 37133775, 81075019, 79754305, 41008111, 20127119, 73576688, 49944930, 39694759, 37837517]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/mgda_ub_run_1"
