# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 74053504
config['train_seeds'] = [8373301, 86824896, 26589260, 71665955, 18689517, 16859050, 89452846, 47978158, 91989759, 71209510, 28177892, 86073466, 16789169, 49969624, 75611907, 64698467, 96358674, 80379414, 76812991, 15922476, 51416733, 94339980, 63004665, 21334429, 13550911, 43983180, 55535699, 35642142, 19864651, 577119, 23380626, 79283714, 92566248, 14157325, 53072690, 66588325, 32913513, 47868162, 20594280, 17310907, 73260310, 2779776, 5120580, 45612495, 20922192, 64066815, 82371180, 118702, 33846349, 75884022, 71912057, 52331407, 83936816, 42661145, 17777348, 32389598, 1370677, 18554957, 62806469, 35995651, 42053946, 27496467, 41303976, 72017142, 41016457, 65887365, 54700577, 43862896, 96319060, 10086024, 72509975, 36040139, 37377471, 20630651, 95783785, 29124498, 14075850, 75283995, 92732004, 71086950, 39209603, 76770843, 613553, 82297156, 22978721, 63136329, 45561753, 23374165, 45512262, 98593189, 21992204, 57336742, 14563092, 74233160, 43760997, 5354916, 57971761, 22855246, 3271067, 48090449]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/cosreg_run_1"
