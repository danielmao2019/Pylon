# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 8146083
config['train_seeds'] = [73995241, 32996799, 58551501, 64090660, 44725685, 65197492, 17978833, 88517013, 44674325, 79286348, 55316048, 93638210, 32095064, 48650273, 13115271, 10983864, 31415345, 31463324, 58675892, 68990777, 34208245, 49780474, 6034366, 59965677, 63663952, 95782067, 50265427, 2444410, 52265700, 15450999, 63611131, 70033760, 49613911, 81949582, 87448323, 19456539, 94772507, 82329485, 54134622, 26331734, 25523111, 30155855, 74471750, 59749225, 51647376, 14468379, 32004348, 40565650, 94146822, 68174065, 294448, 56482661, 75801529, 80182931, 52233709, 68328605, 39494010, 81035427, 95121443, 95367205, 4184, 13834803, 1390461, 64534609, 38202524, 22975215, 65711724, 35753224, 51617096, 62418608, 92931661, 58611240, 89425248, 44079106, 57779723, 26644045, 13888251, 17895157, 9109851, 37092873, 61765872, 48657973, 46377700, 62250031, 3466108, 66703713, 46100835, 13887430, 71187322, 51285576, 38813497, 63591181, 98008410, 15992045, 99013984, 28424663, 47672529, 58644898, 32013726, 338633]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/graddrop_run_0"
