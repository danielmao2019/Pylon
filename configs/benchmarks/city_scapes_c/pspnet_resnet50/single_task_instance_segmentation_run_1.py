# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.city_scapes_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['instance_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['instance_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['instance_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_instance_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 21868640
config['train_seeds'] = [28775937, 71486455, 59348432, 43453039, 1498584, 27342167, 52078742, 72338268, 6736937, 92412733, 52169170, 18950961, 64815976, 4497311, 93479510, 88322531, 91619746, 3717835, 74950881, 92429093, 88741851, 56029808, 89348543, 85624636, 93772477, 7988393, 56258288, 70677601, 93683091, 25218076, 90945299, 59447986, 3955847, 36154794, 28217659, 92675050, 20968344, 98351915, 50757243, 56688378, 71084583, 74250668, 81790841, 92157362, 57458054, 57278584, 69584123, 47205912, 62579510, 48883335, 53397503, 31797609, 82982013, 65066568, 42860716, 22692583, 1203476, 4630908, 56435710, 60321090, 57554156, 56714305, 7512032, 12517552, 79172179, 71873562, 53699048, 16735995, 967257, 30057458, 62170802, 34959204, 43290811, 19776621, 39108390, 56183242, 90555446, 2088397, 35093031, 88208885, 51575813, 38350100, 43551200, 646442, 72218747, 78318342, 62315300, 72407632, 32703072, 24704290, 35459787, 5682264, 67858434, 41164481, 66930229, 98054664, 35089109, 71391850, 92475156, 36181391]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/single_task_instance_segmentation_run_1"
