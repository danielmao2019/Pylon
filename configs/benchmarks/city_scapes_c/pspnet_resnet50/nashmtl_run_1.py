# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.nashmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 76886162
config['train_seeds'] = [9982725, 4318345, 83348708, 28714014, 19393428, 53450132, 91818863, 73961531, 80516544, 42616583, 89056812, 88347228, 75009569, 23828882, 23746990, 38934801, 80068601, 33995624, 46699305, 29256833, 99561774, 84174836, 44940874, 48538522, 80662076, 60531428, 22625189, 9049411, 88332942, 79223597, 52957160, 79334767, 1997636, 79607451, 66282539, 85704530, 90058055, 38554599, 12523815, 13279376, 27596934, 45782236, 51565214, 63509198, 10158068, 80450012, 34874279, 33014691, 2452003, 22637193, 25742490, 64802671, 44444403, 33700508, 84569454, 32979364, 30332802, 93845773, 28888647, 1259279, 94810274, 17273562, 59252737, 28075213, 90505122, 95572741, 61048995, 89892168, 62087328, 12166282, 87965996, 11425821, 52326170, 35368518, 4776045, 33341118, 68178310, 9560331, 77334391, 85323139, 24751840, 41806775, 71673184, 90872119, 32284827, 29860394, 46899229, 9798664, 57499971, 19251616, 85895690, 70511172, 14058890, 87373539, 78337804, 50758966, 48350357, 2134207, 70465636, 96030184]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/nashmtl_run_1"
