# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 41068909
config['train_seeds'] = [97087718, 69218584, 72971821, 56029063, 95538872, 43479804, 64456298, 97615950, 48070964, 37098993, 70112536, 75147231, 51319472, 48929287, 65268506, 20947225, 4136248, 25603389, 55869723, 92169263, 90921917, 90291470, 40500405, 49984297, 47687058, 63737890, 24702520, 63821799, 77846981, 94856467, 38572514, 57213056, 45281838, 11268287, 74684312, 69707435, 62371793, 48066212, 36734620, 59968972, 1814644, 1155931, 76269211, 18820582, 50002196, 62668157, 39359406, 75145400, 9051132, 96198104, 7132211, 26084668, 89386614, 5630949, 66234275, 78248693, 47958406, 56114238, 12174014, 24431973, 35475841, 89072086, 35027153, 20203469, 2697364, 44922842, 24670309, 23201392, 44314756, 35393658, 31043821, 55417881, 85073482, 3376439, 49294088, 54447136, 50943346, 69416470, 97288839, 7311299, 32827519, 59315160, 23856754, 77352064, 13027404, 52376854, 72869725, 8721359, 28067892, 91533544, 54312077, 30128416, 33341092, 22886215, 64565412, 39994430, 81476194, 14203755, 98397311, 9356186]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/imtl_run_2"
