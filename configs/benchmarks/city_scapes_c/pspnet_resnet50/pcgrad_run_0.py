# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 43802073
config['train_seeds'] = [82409381, 92759299, 79421629, 41154710, 2251841, 84731735, 38401452, 59966175, 21629784, 99678275, 1154276, 8241918, 56736738, 46394847, 42832716, 93928291, 457407, 50651073, 11093945, 98958343, 74353937, 66167010, 83076659, 48899108, 96052210, 92300789, 23321938, 679372, 34322710, 37481502, 40407076, 45111546, 58412707, 43380415, 89072284, 89169512, 64299773, 66026092, 39874923, 88422582, 78981047, 70887509, 18069935, 84462019, 93500324, 56677317, 75006812, 62816302, 68779660, 15684013, 90141370, 98557943, 77927467, 20699892, 36675348, 22773537, 35081959, 55873428, 2442003, 52914158, 43576384, 84177313, 4226656, 37505294, 44064339, 36389985, 30723299, 20180787, 4256910, 23912763, 62164739, 18621702, 89774810, 31889563, 73622657, 7084327, 74602902, 32267666, 77416300, 5512537, 53886799, 10336436, 46822289, 74949847, 7485732, 78320634, 23247475, 43252962, 77131281, 64478864, 44868380, 44613613, 54321403, 4272248, 39656663, 87118483, 44591946, 14424683, 43894612, 28123866]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/pcgrad_run_0"
