# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 16311240
config['train_seeds'] = [91809859, 73500852, 58826624, 10549980, 70265274, 15865502, 58087887, 27891899, 75699239, 46779613, 47236572, 50859231, 32998412, 58944745, 25746764, 83344620, 97527423, 72093874, 63677432, 21174036, 55793832, 37119218, 39718094, 68120522, 11905344, 88707989, 67136820, 96336043, 42204821, 74598576, 80499843, 51231955, 56917343, 2544127, 53288116, 61878881, 86995788, 89659229, 98644342, 11626348, 50223937, 26494843, 97305975, 59595171, 7644232, 14983762, 84491162, 51564818, 10563990, 50774609, 478492, 21401569, 61651309, 70304881, 96984969, 65768591, 61624605, 33239742, 70061511, 51846332, 25043278, 81714243, 98579123, 48156518, 6049017, 68649019, 90673810, 56636006, 4883198, 99504915, 40336703, 71450662, 25978051, 98440748, 83531911, 75226076, 70122285, 7520481, 30900671, 27373821, 5118122, 46870864, 936195, 1338049, 73053812, 95830730, 69858454, 47910780, 96740120, 63551724, 84712617, 33525007, 79610758, 14002880, 44686922, 27487396, 95485689, 49357451, 82294119, 36211274]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/cagrad_run_2"
