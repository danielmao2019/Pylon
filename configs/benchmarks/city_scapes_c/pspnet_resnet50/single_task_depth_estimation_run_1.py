# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.city_scapes_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['depth_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['depth_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['depth_estimation']
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_depth_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 94780613
config['train_seeds'] = [97722749, 2534462, 24831973, 16233681, 66363155, 39196273, 27961321, 79852725, 65801349, 51097366, 45717469, 72663125, 46690129, 36243935, 26922506, 80096804, 37007700, 62810559, 63697278, 96310479, 5986490, 45969190, 17233574, 31574093, 10224154, 70360957, 31990414, 87761198, 37677776, 35838826, 9335313, 86450402, 82353617, 44242237, 15035057, 85543112, 5544698, 45095044, 71237221, 82918274, 53227379, 33658857, 94743143, 21410079, 91731888, 37500765, 94651282, 78684691, 39937862, 17811210, 11018873, 67062158, 87928148, 69740019, 93663900, 79424798, 90308635, 71415490, 23738966, 32150277, 68268579, 41736429, 17204571, 91510981, 29426242, 40711538, 73661324, 20592888, 66087712, 77417459, 33800668, 91415152, 65712278, 99823603, 61944954, 25871064, 94575300, 35769083, 47414705, 57629030, 45496881, 54974184, 99918551, 94407355, 7312344, 93990418, 88026697, 5811567, 41068465, 21514375, 96557380, 27962572, 80936037, 81160985, 2237358, 82168236, 40575727, 47059044, 56859438, 83491672]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/single_task_depth_estimation_run_1"
