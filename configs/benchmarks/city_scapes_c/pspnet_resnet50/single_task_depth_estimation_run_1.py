# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.city_scapes_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['depth_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['depth_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['depth_estimation']
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_depth_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 20985374
config['train_seeds'] = [70611066, 39941076, 82668992, 95912643, 7177674, 57793024, 97667813, 35061756, 8503563, 85296509, 98314440, 89886915, 17658473, 6387524, 96276414, 38375387, 86991834, 12847482, 43483172, 50398795, 84446907, 13521250, 44110887, 85813340, 76480356, 42157237, 53893116, 94011024, 71221863, 47391110, 2942702, 65944417, 61037097, 35340985, 63863618, 40098354, 40462770, 25472048, 6787963, 23375617, 40202937, 9206034, 7457263, 57564608, 44796355, 71413187, 86069877, 48690070, 63469674, 92304136, 25876716, 91153299, 84309079, 94170876, 38071357, 83448558, 30200652, 81514001, 59600492, 17269149, 77653835, 4066656, 44962081, 1423600, 59837330, 57754393, 33510657, 20784907, 37482485, 12219798, 78636916, 36857134, 58488698, 20057699, 87547199, 42586292, 44289209, 89936057, 90493334, 18185827, 95991981, 59045411, 27701955, 27708454, 34152429, 33229416, 43217590, 49294202, 63569528, 62016098, 72624843, 36032247, 95860875, 68948539, 62947922, 45388106, 14209304, 59527072, 57187199, 78747165]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/single_task_depth_estimation_run_1"
