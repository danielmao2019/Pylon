# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 1773560
config['train_seeds'] = [36140949, 93759016, 93911089, 45955647, 54724629, 9232526, 16926338, 91191108, 24994091, 75849830, 25151226, 92189207, 27946457, 79465306, 51861525, 2238713, 32775621, 62604681, 10428293, 72939844, 96484209, 46937241, 17267192, 12786805, 62747287, 91901531, 37788774, 25020391, 32966361, 16311535, 47164361, 56772670, 40609464, 13559511, 50673456, 92251182, 26332036, 51714316, 60207941, 22133524, 37330156, 46128857, 60709327, 24055976, 28384097, 51399676, 48525010, 52111874, 25734897, 22170148, 13409103, 76622105, 65306228, 29961075, 22928591, 1355420, 76588804, 41587322, 42911118, 21254539, 52461170, 23250177, 84173939, 7379192, 40744242, 75008738, 79507886, 25889089, 41306841, 58874419, 97193906, 38736795, 45449551, 60558158, 53465946, 70952343, 98336759, 33311367, 53060852, 98585672, 45728667, 78300488, 74186089, 31526090, 35328510, 2151016, 16651744, 35236570, 55219498, 2620122, 4846870, 91496339, 16963782, 70467321, 56453271, 90569521, 87941604, 30785645, 70525895, 1515544]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/pcgrad_run_2"
