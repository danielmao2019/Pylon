# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 61174400
config['train_seeds'] = [68303818, 74505443, 2430899, 94824835, 3706741, 89037370, 57156992, 92940132, 31486679, 65474457, 47989625, 28154434, 58119113, 53812795, 35216903, 1001200, 86843682, 68704949, 45249175, 90666815, 75546566, 4302514, 85554572, 16600061, 90926973, 80528164, 20381964, 87011491, 95358456, 91562900, 91642857, 29239011, 30755586, 93463556, 25790478, 27428908, 97335335, 198068, 41607759, 81529312, 59977787, 35751449, 73849985, 56839397, 57135517, 83710577, 67601414, 47154256, 21525159, 45349340, 24224145, 43829464, 15149096, 79960118, 52298468, 76831641, 40207306, 94455363, 78998421, 80563169, 87016630, 36718982, 51420413, 17532296, 69674047, 89401426, 84245309, 14985842, 30941025, 35332684, 59827080, 37676666, 41906577, 72005179, 6518484, 71839971, 64501247, 85350909, 87182897, 25032862, 37169572, 51914982, 60966700, 39355143, 91278139, 75831702, 14687231, 37634579, 83441719, 84834994, 98904790, 87131589, 9426960, 66831147, 48426410, 73838035, 86836101, 91180793, 64553168, 70130120]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/graddrop_run_2"
