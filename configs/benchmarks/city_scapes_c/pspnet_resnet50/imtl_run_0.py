# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 86994187
config['train_seeds'] = [23480952, 84188303, 28419682, 16741300, 70990609, 21969494, 41634365, 95695846, 90757804, 65487344, 48829407, 76237262, 7537130, 55055190, 30135536, 92934370, 94274995, 22670456, 11126060, 79729712, 40754198, 57458438, 12263418, 26317644, 27445280, 60025336, 89926739, 57088133, 23608450, 79125312, 47916207, 67742307, 83504998, 52576651, 64201913, 85150234, 78323471, 52451344, 88860783, 26755403, 68813289, 98415824, 19377406, 73066792, 36625396, 68957334, 81417725, 11141169, 93647948, 88979762, 19572918, 94613763, 32604886, 1357857, 69446792, 1829433, 47765987, 55946799, 47818113, 49159872, 5463043, 7134941, 94005408, 28942174, 58086758, 76470797, 99516614, 53598876, 73891061, 735190, 29912985, 44363601, 34882431, 52096549, 7813881, 71926744, 54147472, 9707078, 8615567, 21121965, 48920256, 91735314, 18813316, 49937269, 84868316, 52551785, 84875738, 5180929, 21373599, 85522719, 52260700, 89418934, 69393165, 50710932, 185997, 5636087, 55419326, 78479480, 90935049, 8683802]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/imtl_run_0"
