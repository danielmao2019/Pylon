# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 43433556
config['train_seeds'] = [63602225, 42249926, 47278140, 9461297, 91567063, 6810586, 72912366, 72141761, 50142986, 19799558, 17212127, 99048233, 58425868, 79298000, 32410380, 72325325, 43933977, 55702016, 11385109, 24927375, 15148834, 43710350, 98474103, 59192127, 44288881, 72342385, 21174215, 5593169, 44616111, 41366244, 13927036, 21260728, 45401709, 52471438, 12163798, 47227143, 42239161, 40669224, 18395251, 98593954, 81412721, 94399705, 84819559, 49161177, 18578963, 4111018, 2454195, 98454751, 43774278, 71148521, 75141306, 76404742, 10158976, 53329635, 90543876, 99774594, 79303859, 23804779, 85189991, 35857133, 15409823, 40785721, 89235448, 65888514, 520503, 86475947, 21554899, 63915000, 23937446, 22696511, 26232548, 13529759, 61518400, 87390954, 68480148, 93548440, 79572274, 15411514, 2656551, 14353034, 6107382, 50180554, 91045151, 5077925, 93060122, 66507709, 92731097, 64100306, 44072954, 6696754, 8821345, 33875246, 24959231, 4854894, 61856673, 82480260, 70250, 96280348, 84040865, 55247392]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/alignedmtl_ub_run_0"
