# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.nashmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 44335013
config['train_seeds'] = [1668450, 38943351, 36387293, 79816050, 99902282, 71566143, 43161461, 10028137, 4040595, 74777897, 3995262, 17574463, 86654198, 7977932, 30430655, 62463357, 24611055, 95143894, 93013846, 70312260, 54070414, 94159905, 95532471, 10166340, 32306221, 3864260, 9397096, 79051195, 85924495, 89351553, 19204617, 6302669, 2370944, 75268024, 35528383, 64419263, 96015023, 94531432, 56030877, 30186738, 37163902, 17963131, 4353127, 12553117, 60135983, 89731591, 89942783, 10738724, 74271471, 27345410, 42455964, 12544219, 88305116, 40245491, 73808724, 56807124, 92886095, 54158426, 77670558, 93543589, 6169289, 2942019, 27927704, 60068582, 40379602, 83466975, 30130367, 96101345, 3386443, 48557565, 85142175, 63999925, 5548372, 52728923, 78323579, 90354431, 93223533, 16912753, 57196754, 62293249, 50040286, 18235866, 86344816, 56544153, 75894248, 63640798, 73312334, 88825964, 62223625, 82336272, 78314818, 60670550, 20238187, 62087707, 5457591, 37070797, 39928821, 20636880, 84879847, 44494458]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/nashmtl_run_0"
