# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 74464280
config['train_seeds'] = [51472588, 86651008, 14799856, 65948447, 31793905, 76891556, 91170594, 70372823, 29531285, 94672897, 19629079, 19921966, 55608749, 79532670, 36837367, 74111370, 73388485, 57060974, 36652000, 49551827, 48867526, 88008559, 69122725, 38038112, 77438419, 1397755, 95396367, 25714396, 17908204, 40391425, 77545136, 62484370, 88130216, 42790633, 74603923, 85117283, 47590887, 47266789, 990967, 83700966, 52192441, 12369157, 46950538, 7345223, 30477079, 22182668, 55816108, 19001426, 13400196, 76417914, 32468751, 90571301, 48495271, 97693316, 11592235, 67539112, 29056455, 25889846, 24845737, 58095776, 83840127, 24142035, 47910801, 16026567, 82339361, 1844673, 98164448, 38474858, 49025935, 21762096, 35278222, 10628626, 49270689, 97938776, 96207140, 27951705, 59069065, 51259057, 19777760, 54072098, 31280278, 49855893, 20789388, 52299396, 40881584, 65045493, 87602299, 19877512, 62102622, 90604122, 68935825, 7077298, 77243202, 80253530, 54445201, 34883413, 42306275, 81260264, 35208622, 82101987]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/cosreg_run_0"
