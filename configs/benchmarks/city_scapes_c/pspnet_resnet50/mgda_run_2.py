# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 7555169
config['train_seeds'] = [23472081, 45128502, 16631526, 22591921, 3468919, 93877314, 82771448, 17883744, 60054372, 99050763, 99248241, 36645925, 94900360, 1179696, 38135036, 36327075, 73286756, 78901763, 93447396, 89014580, 92723327, 94087174, 39782932, 98606415, 62882068, 87940229, 26325797, 32317816, 87170411, 64294060, 91814252, 70906966, 68651217, 87646070, 13569925, 69394406, 4526603, 51900339, 49569537, 86977482, 79333433, 56097155, 8082155, 23451092, 65954738, 18305870, 27462765, 3469711, 42466153, 78821509, 10939144, 48668340, 40045506, 52676017, 83924063, 18460451, 76133986, 618611, 55746144, 65321164, 69016295, 99577790, 26760977, 43130999, 53399446, 71076987, 4992411, 97206918, 13832456, 47331720, 88113387, 87596111, 28429911, 56555010, 19617179, 17648009, 83484383, 30075349, 82586690, 87689429, 7797609, 40999175, 19734484, 96062140, 74788659, 50016298, 30163953, 97989334, 30303983, 83512055, 32691280, 52766409, 44592194, 9154857, 16012357, 38885017, 12352513, 81324381, 94837895, 13372422]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/mgda_run_2"
