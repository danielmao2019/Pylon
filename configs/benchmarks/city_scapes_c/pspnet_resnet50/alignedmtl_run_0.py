# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 10401648
config['train_seeds'] = [52344188, 39495630, 38131416, 15799295, 18933096, 96457785, 68618125, 92678208, 11995317, 4261201, 28205959, 64994051, 94015599, 74006606, 88265114, 24311077, 86909836, 70003346, 12460591, 77121114, 25684983, 83936906, 90314633, 98663361, 83250992, 15923418, 46291483, 12112042, 40393310, 51824290, 76231660, 84062956, 35099162, 29026241, 51774890, 61383412, 92039408, 43816906, 31487380, 67288064, 79631188, 80476584, 61622298, 23635721, 12525821, 44316518, 7323224, 96134104, 26062381, 57022545, 80203256, 66330782, 12809860, 79129356, 39803829, 8351502, 17519741, 57841536, 97473776, 27922503, 81593481, 64757231, 96613602, 58813705, 69509984, 79809956, 30843490, 60278100, 40859684, 12737367, 23163961, 96384450, 41245816, 74799747, 42534898, 96613965, 98756354, 88101432, 82322150, 8257713, 30423729, 23496997, 44296601, 11001535, 80269826, 79145445, 34195690, 60090365, 96678299, 52183997, 54610213, 9770239, 52145686, 68653069, 27663787, 40625696, 24577413, 43935687, 1451329, 84769616]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/alignedmtl_run_0"
