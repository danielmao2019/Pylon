# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 24065413
config['train_seeds'] = [55430608, 95194064, 32321185, 76876945, 7060124, 85980509, 94621688, 10535596, 40414928, 4053067, 34088286, 75211910, 41854011, 37748459, 64527122, 3409574, 53835967, 30360020, 77452502, 45054001, 857629, 88937885, 18187864, 39782796, 13282293, 67488103, 12326182, 13794579, 89970686, 37402247, 109315, 5643868, 82104819, 57282928, 77559868, 27715084, 73172120, 92578321, 28796753, 69262393, 36459329, 93119932, 90087949, 5228945, 79354899, 37473895, 62014822, 27271843, 11082016, 89260499, 24925356, 95836696, 78848580, 29792318, 30886128, 19941929, 51419401, 34975250, 80164216, 38471994, 8946811, 13093945, 71545988, 73649318, 8988227, 93569813, 83264084, 4596343, 71378328, 43291546, 79418747, 98818819, 40840012, 81386744, 63242542, 3104013, 82427019, 62066058, 83787619, 42930897, 45501978, 62538308, 5314456, 14876602, 13314240, 20835416, 7466478, 27410587, 93473960, 55228248, 53977805, 46133234, 30741624, 83453358, 4783814, 31901401, 73078457, 34387934, 67690609, 28219235]

# work dir
config['work_dir'] = "./logs/benchmarks/celeb_a/celeb_a_resnet18/alignedmtl_run_1"
