# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 35867830
config['train_seeds'] = [43368245, 59578837, 1747384, 50946264, 53797841, 72049981, 44336341, 77043747, 3930032, 37719439, 88029830, 56265720, 89712903, 4817422, 4572072, 58954077, 93072414, 61906591, 82185778, 14274670, 38127141, 84144107, 33092140, 4036511, 74302590, 4162447, 60658214, 20147512, 21825756, 2332117, 23679043, 89453001, 7139185, 87195173, 39561348, 48748409, 69925683, 36342941, 49223841, 6037598, 58445421, 29407126, 68169585, 38904358, 7136524, 45482000, 55961716, 45508566, 7347034, 56283246, 61208441, 43766163, 39542003, 10622077, 70460541, 70522587, 41157791, 65267062, 80702077, 28841509, 17458421, 71124144, 70812476, 28696597, 34298164, 45972077, 49577666, 72354321, 22993461, 67067976, 44989899, 34298948, 46837977, 5241425, 54275991, 22526404, 74052740, 26785987, 28847786, 28954946, 65722845, 6961566, 65169551, 75535881, 81211203, 59595700, 71819422, 82847574, 56673396, 87578556, 78024968, 39577388, 84509492, 81363506, 21863491, 19800659, 37548368, 44517846, 24460008, 48751957]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/cosreg_run_2"
