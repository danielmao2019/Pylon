# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.nyu_v2_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['depth_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['depth_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['depth_estimation']
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_depth_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 77284905
config['train_seeds'] = [30766821, 77469332, 6338116, 99975550, 24799874, 23491196, 49766769, 85599559, 23481772, 89761225, 70164026, 53442649, 78231654, 16287093, 54213481, 34232515, 56231117, 79631616, 65560633, 50879510, 57451372, 18112546, 7627337, 45130641, 68091007, 20240755, 5919752, 68322614, 97953336, 10838550, 50417965, 11358644, 3581880, 10303506, 53268974, 55368461, 31685797, 43555346, 30170804, 38996614, 55127458, 84657641, 89111134, 49094035, 52688492, 13892629, 8439523, 69657716, 686717, 28029620, 9545254, 26993369, 11166700, 50427076, 81058413, 46468517, 70302248, 29445918, 90758523, 21671445, 39216579, 99675510, 752397, 43999038, 86600586, 12514092, 13730262, 82809321, 42853398, 57525139, 84658817, 36772062, 70301285, 49239076, 86739645, 88021277, 96049164, 53074959, 7677931, 55406545, 44334325, 37402141, 35416886, 91113036, 18672441, 2033267, 83279441, 74840483, 71106721, 54726349, 97445196, 10395983, 24979647, 38265857, 77511966, 786970, 72217321, 18274065, 65856951, 78107253]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/single_task_depth_estimation_run_2"
