# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.gradvac import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 87208100
config['train_seeds'] = [19420958, 57582042, 32701116, 4082683, 73721553, 89148442, 54348396, 79513539, 34819513, 59949999, 12371006, 18496415, 92599553, 15516732, 53947520, 43827830, 35249061, 11653658, 25297261, 54967682, 59986249, 78584198, 77180159, 94494505, 83498187, 68546481, 60229400, 66226689, 35807870, 48474765, 45569091, 20638789, 50986647, 93840131, 70602698, 48233728, 33038195, 40394564, 31680462, 62972860, 56966749, 55287749, 39105420, 33220598, 75629292, 59336040, 91303619, 32060785, 94366902, 76214631, 39285672, 57797310, 24834720, 46737878, 52800569, 66977989, 17266852, 49371588, 54308066, 50617597, 22623954, 12947711, 4564108, 87713623, 90506420, 32772903, 10817934, 86235118, 7541934, 58347585, 42516761, 47904926, 70449225, 55377859, 15378235, 89039882, 54991677, 82336871, 99357111, 52409431, 25450131, 51337419, 34577048, 14299684, 22226852, 73323025, 42039386, 2055899, 99827433, 25328533, 5748108, 40976229, 3696011, 67963407, 34524859, 41703993, 73139997, 63605674, 24325722, 48647248]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/gradvac_run_0"
