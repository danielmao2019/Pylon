# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 79282746
config['train_seeds'] = [77342307, 65040791, 14116151, 67876596, 23497958, 28826410, 81187177, 14355921, 66803886, 70650393, 20489703, 66711508, 13979643, 19871575, 72392723, 59777016, 21176579, 65624424, 70162647, 3581693, 16404564, 83743053, 30817382, 4473969, 58726653, 71677847, 30807367, 95745569, 86400367, 51451231, 42664038, 60214053, 19387836, 93214965, 63277324, 17426734, 39854374, 630263, 98486545, 80073663, 24363661, 93588352, 41303755, 28083214, 8456610, 8529383, 4683958, 73993145, 29712190, 8240144, 49581088, 91376275, 6320306, 97910806, 19577179, 55604619, 33327782, 88776957, 9666380, 94789269, 4187588, 90149299, 69760423, 45150780, 52849776, 3729273, 64385134, 97408996, 69984937, 36116077, 19149495, 54134841, 62172222, 74534236, 77198632, 69203090, 77810752, 90300894, 18930530, 41338720, 50083532, 38184533, 32797644, 11002231, 33193633, 32206347, 19430164, 68183614, 30939233, 34614978, 83391498, 27212737, 87826285, 47518361, 66803272, 87485851, 20931331, 30127645, 18123494, 37845817]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/alignedmtl_run_0"
