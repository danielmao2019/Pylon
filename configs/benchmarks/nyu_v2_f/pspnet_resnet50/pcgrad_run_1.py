# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 11064974
config['train_seeds'] = [79840138, 24018646, 11448772, 28140851, 65459740, 58610165, 72234217, 76214332, 69483911, 30964811, 69481724, 85208937, 32242635, 97896898, 46152201, 31462824, 36145130, 46174856, 27703591, 72568274, 66275166, 45932282, 54096620, 88108806, 69655268, 11618757, 9563759, 2395180, 28815745, 17669865, 24386495, 10541778, 29171214, 60188995, 49987000, 48963960, 19785637, 88250176, 66485576, 22528369, 78071938, 62830137, 24385504, 47638157, 9914223, 16103614, 23138801, 29549033, 96360493, 58006104, 2255040, 56532700, 20039100, 36501318, 91624247, 93982184, 50642934, 34807951, 50246034, 56804238, 84432438, 91996221, 87366899, 91032482, 90880949, 96122334, 41020169, 91350203, 54608181, 68911413, 29511700, 35559024, 54625578, 71224331, 99597163, 22751286, 84869603, 53704648, 32674203, 89952229, 61272150, 74787278, 28589388, 10829792, 60767558, 29363764, 29443349, 71323998, 58774303, 57827725, 42741677, 50725086, 19860716, 25162914, 98924706, 49049948, 50006180, 73761663, 68465553, 13968106]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/pcgrad_run_1"
