# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.gradvac import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 65630352
config['train_seeds'] = [30207358, 63743494, 2261551, 11771622, 44602984, 93573984, 58680716, 22918757, 88770981, 80925563, 65173231, 14192420, 6298506, 44367883, 79348544, 37118143, 86478554, 54996984, 54671792, 56161761, 92356170, 42674609, 9187688, 8074988, 11706682, 94271606, 63772389, 15595166, 80111824, 44324255, 91836804, 85182209, 54955110, 55097506, 95816163, 8453977, 94051453, 56010602, 58942392, 59992849, 91676, 22948318, 7195182, 84421156, 9491432, 83610383, 36501531, 83509676, 31553907, 54602049, 15147867, 99244146, 82486256, 5113700, 78657421, 24023988, 86367775, 649148, 88376092, 7858600, 12275891, 92508025, 17445616, 60398378, 18446722, 77158882, 87287332, 64328440, 52166193, 38285257, 58156773, 9369320, 77568298, 35756760, 22606571, 76926288, 68759562, 17696730, 9304797, 68250714, 54037967, 6958702, 12880426, 99831103, 63065786, 55471339, 41742074, 38547623, 31184481, 56801695, 267534, 27588122, 15234803, 22235985, 35226403, 26357202, 19221541, 74471395, 4390753, 78667313]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/gradvac_run_1"
