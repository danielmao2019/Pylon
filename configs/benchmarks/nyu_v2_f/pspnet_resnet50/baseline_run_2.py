# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.baseline import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 11714122
config['train_seeds'] = [49186039, 11939569, 12122106, 59601643, 24414355, 64979705, 5082849, 66507923, 5171586, 70656479, 41735544, 96468211, 78699123, 92817252, 42395902, 44638525, 77368594, 3217348, 11324970, 9778008, 41150113, 64307125, 91263062, 55029040, 97872529, 61024056, 87569551, 81384015, 47098705, 82949862, 25166194, 80403844, 56989053, 36058396, 40863691, 90345580, 66839780, 8271548, 55913362, 73552114, 31211139, 94475451, 10966835, 90099947, 87987806, 43743933, 24967521, 12211327, 61180357, 16205705, 81435306, 83185128, 12171531, 17131795, 92053408, 40289656, 74838566, 5944495, 15755990, 62900637, 66580344, 66064984, 16670820, 93201265, 65807182, 92755224, 98418143, 74371778, 31115755, 31403187, 59177105, 68285808, 41049046, 43161874, 53917033, 67384658, 16586039, 72064696, 84437773, 18247326, 66692431, 25218226, 34617914, 68729399, 66083783, 90140559, 36134803, 43601493, 91740098, 20581036, 22982244, 60532246, 98742170, 15958723, 23290405, 58360731, 79698152, 30123543, 63086443, 27861844]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/baseline_run_2"
