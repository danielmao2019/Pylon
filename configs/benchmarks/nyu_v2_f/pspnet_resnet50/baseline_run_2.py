# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.baseline import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 1918777
config['train_seeds'] = [47263597, 64768636, 89597219, 62644501, 61477175, 21915274, 62093864, 21631836, 88802343, 68389210, 43197082, 29522486, 43336523, 72088510, 84454211, 66719765, 92251711, 5261232, 77420789, 5584263, 9812293, 35209856, 7352586, 6753110, 10473604, 89525733, 257303, 95996730, 53298320, 61954835, 85471246, 53623229, 7278710, 32198296, 71546842, 17666457, 93840519, 85487089, 3121843, 78094388, 95942519, 32149452, 76096000, 54053575, 46237055, 6047840, 31106830, 92308818, 93258218, 23646099, 12855763, 55826518, 26017311, 58768335, 65125771, 11073815, 92192934, 32214503, 37938262, 88221766, 53512473, 40354575, 15918852, 15135008, 81009062, 7200904, 4296752, 50698085, 59967098, 55324976, 28190082, 69203090, 79462177, 24536140, 89200212, 88759627, 79663493, 91659862, 91682017, 40273969, 27605356, 15940761, 31091522, 33073221, 85093088, 84189260, 71334556, 63729459, 41061420, 11937909, 82819013, 2854521, 29276381, 50839911, 58594607, 80217812, 24958496, 41827143, 17436695, 16818216]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/baseline_run_2"
