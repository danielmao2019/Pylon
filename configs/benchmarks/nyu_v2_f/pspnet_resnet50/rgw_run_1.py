# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 54625471
config['train_seeds'] = [91416432, 38821060, 30490854, 71720819, 56333493, 20197841, 77354482, 37118749, 82389211, 48981964, 18311183, 6443644, 18753956, 11584443, 8078531, 19020198, 20844595, 93032900, 60572478, 33219252, 70767367, 12737859, 18449401, 54256605, 37373790, 1565220, 67804579, 96642965, 3405680, 37694812, 96954139, 26020418, 56848515, 39141682, 82321073, 64965929, 11964629, 89944770, 82118591, 38613450, 67979323, 46014063, 59290912, 69638198, 12878709, 71929019, 35815133, 8105908, 13774280, 1572055, 73568389, 99173185, 84481664, 76755521, 90068545, 59509158, 40664588, 24655020, 96996831, 58427945, 28804570, 66023999, 62990826, 69862765, 14037944, 93255323, 89139341, 90475234, 76811762, 31228125, 17802240, 75546316, 50882510, 99384299, 4683332, 80944752, 33690857, 67207452, 98185302, 93566172, 96518058, 47580782, 7103397, 11901681, 58415816, 46646861, 670825, 64933265, 34841470, 34657813, 78712183, 69915403, 77916062, 51400577, 92351905, 96894699, 74965598, 39869773, 14665450, 62805082]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/rgw_run_1"
