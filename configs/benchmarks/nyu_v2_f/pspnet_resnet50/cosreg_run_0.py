# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 67114223
config['train_seeds'] = [50055467, 99826386, 69017075, 93610564, 24416101, 20331228, 92359550, 30757934, 75625950, 92744887, 44471663, 18324773, 29417428, 96168069, 57968437, 13146847, 12440595, 56263118, 30826708, 12310029, 9033313, 14331441, 40181241, 82390717, 73163282, 84714628, 45429178, 92615270, 9041796, 89741118, 96336135, 39993596, 83684914, 86521082, 72175865, 89670410, 34078170, 83390602, 67138906, 74201514, 67217118, 97730999, 19447074, 72592234, 49672905, 53366187, 82348186, 70895436, 85501573, 76264574, 46633288, 94365397, 40091230, 71265664, 81453022, 40328514, 37489759, 99769467, 34776596, 76116413, 19967244, 7080974, 94430191, 53579900, 41992377, 11455497, 29228373, 79650527, 14323877, 72922069, 41539528, 49939835, 88674316, 67733193, 32909118, 65303363, 11454257, 35706588, 60504943, 65980462, 10399118, 11710489, 46444949, 63737986, 44158334, 71760077, 33081916, 89932620, 90316265, 64921315, 15526632, 34040562, 94907197, 5083963, 81885591, 38308751, 41274516, 75777759, 13375556, 71699803]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/cosreg_run_0"
