# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 49528535
config['train_seeds'] = [72186228, 32744425, 98712807, 19430608, 66086778, 40063273, 93727647, 95585146, 16331465, 90485345, 31249402, 37267574, 55560984, 66422426, 18831052, 68288335, 91420975, 961576, 31514115, 11056391, 789156, 17062007, 92903452, 23988574, 61524338, 4632680, 31210309, 18787954, 13811651, 9732520, 19134948, 19318060, 48549394, 82571810, 16937913, 5983275, 57373499, 96446634, 3472834, 84734456, 76078942, 179599, 45554546, 51308887, 6827129, 14674066, 55010189, 79398575, 83442206, 15364028, 47734939, 6325319, 46356315, 16839984, 18106081, 21275406, 57786839, 6905609, 11856803, 18598239, 19689233, 47396366, 9049539, 57831312, 211808, 62908724, 66599847, 83442049, 74672627, 49740684, 4102940, 95866116, 12491893, 4096122, 17144944, 71063458, 39957376, 53481781, 60877206, 61509662, 85881177, 60205095, 85488086, 25998288, 1237945, 16125449, 57016757, 13202010, 20071581, 20571711, 33221282, 82768559, 19662136, 84799277, 71711399, 69849167, 55908868, 63517909, 88559403, 35332567]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/mgda_run_1"
