# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 66213843
config['train_seeds'] = [66398831, 44479180, 64776356, 863374, 59353473, 11670557, 49958909, 66457046, 70356711, 74019729, 18617223, 33933624, 27042234, 48733114, 25883908, 90548769, 40854368, 15173895, 19183553, 54616019, 40271407, 62120374, 26642765, 70331083, 3802114, 31296230, 73796745, 88996894, 91150987, 3932703, 15789088, 90976310, 16922556, 23272951, 60979656, 82192993, 90504469, 67492907, 73701219, 58394402, 46880844, 21442835, 37159937, 21151119, 24088418, 12703516, 90901155, 30065163, 97250248, 63143615, 78176137, 79916147, 41134356, 40309934, 61420897, 15671458, 97576292, 98232553, 62378687, 69180081, 70002216, 81169016, 62748245, 93605438, 31828627, 53186725, 36159224, 2817070, 40343249, 76213868, 74694239, 68906242, 70707039, 57030721, 61315128, 68864583, 52809380, 92709898, 92111907, 93272217, 11273667, 27796709, 7636179, 18965323, 39818772, 77378427, 23296957, 91491301, 3996204, 20823346, 58823463, 85421530, 17122323, 15700063, 96691161, 97561479, 62669711, 22629216, 15226799, 70421277]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/alignedmtl_run_2"
