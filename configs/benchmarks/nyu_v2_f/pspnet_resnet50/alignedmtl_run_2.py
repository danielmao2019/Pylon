# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 80061285
config['train_seeds'] = [63531676, 96324998, 17157560, 53828495, 86092302, 76691693, 6468320, 87851100, 48912233, 94261218, 28203858, 75840617, 63118204, 14284723, 7191570, 51012192, 88224820, 6953756, 70544598, 388047, 93912543, 26269646, 13418377, 10594294, 83830315, 23486988, 51267173, 10978042, 43120098, 25235942, 32514911, 91370994, 74273291, 66351961, 26755582, 24038516, 9574579, 23163302, 21305397, 82219844, 14668586, 97788300, 47510834, 41775616, 4863296, 64957928, 36287302, 32007506, 94914527, 56268442, 13739616, 24258171, 29023498, 70366564, 89388412, 28042367, 80639179, 22191215, 6106847, 97827187, 29897920, 23821084, 13883177, 93423584, 39502963, 18161318, 33872885, 22050932, 87116806, 54975495, 66838353, 69428452, 77821017, 10214044, 60283228, 8877130, 78978987, 42188781, 4556895, 54918778, 27149594, 64661383, 26436852, 87519262, 63504318, 31481272, 60654249, 57524539, 19878639, 29587126, 20297905, 84465016, 19959529, 53453532, 75324892, 35525826, 91474248, 56613087, 4006297, 110914]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/alignedmtl_run_2"
