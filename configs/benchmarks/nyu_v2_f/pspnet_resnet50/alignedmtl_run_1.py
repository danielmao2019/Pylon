# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 68703251
config['train_seeds'] = [60859080, 59724601, 78936876, 60832899, 6618942, 94633765, 99565754, 28068527, 46097219, 32625428, 6302495, 52509834, 53077529, 61848550, 13818477, 99687806, 25781709, 21369586, 40908414, 5934228, 57015166, 76798503, 74541441, 11694849, 84330932, 99651948, 61638414, 73109163, 74475994, 57091792, 44176620, 63488110, 20703493, 55358505, 55003719, 83550670, 4153049, 48764639, 43253900, 27020649, 37049633, 73374802, 57764743, 52868693, 53501040, 4498800, 23341974, 97447108, 52958910, 88952365, 20486785, 30496122, 96439345, 86081470, 54548152, 84919389, 62825310, 47114724, 20753736, 28498011, 24694822, 14831975, 11970740, 68072705, 74057293, 32601181, 94393627, 69818084, 48569775, 77794137, 16634041, 86820729, 30080839, 69109815, 94053395, 73246005, 17290635, 67764623, 54185027, 82785252, 31111241, 92120661, 39298888, 24583806, 71964552, 2271935, 62582124, 24288473, 73141779, 61801825, 30101666, 90961277, 65726336, 92070198, 59767534, 1134302, 59455547, 3207847, 87063456, 79762619]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/alignedmtl_run_1"
