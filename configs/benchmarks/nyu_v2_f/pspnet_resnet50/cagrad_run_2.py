# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 95362640
config['train_seeds'] = [40748524, 80986363, 68193339, 11093276, 87321241, 16750933, 25318507, 71101359, 78392729, 17719292, 16994593, 53543811, 75364667, 15775906, 79510258, 26274852, 38392659, 77872757, 50226884, 90580911, 9460971, 49173239, 86152474, 36425998, 6186952, 12653520, 74249536, 94320429, 2808088, 36396886, 17791479, 78452592, 33788690, 50746812, 4945687, 14400588, 56088019, 56919026, 28368445, 61247213, 45233495, 5530309, 86271520, 44772677, 67761988, 47611414, 88491455, 54039247, 70256031, 67317495, 31557766, 31953202, 25372683, 94886519, 43120135, 1695693, 89919011, 91187142, 54829384, 29672154, 85555460, 98014987, 33042541, 94109223, 10985061, 50832216, 81207471, 11599476, 97791774, 42903393, 78933395, 47353030, 24697418, 14673983, 57949146, 71417588, 39414957, 62599748, 29736869, 42009065, 88788818, 22650434, 63646365, 43316851, 41241904, 42529519, 21129937, 8080147, 9428759, 38126968, 1765993, 78334155, 69387451, 90645695, 45011152, 74022779, 84669708, 40416798, 99055310, 31856017]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/cagrad_run_2"
