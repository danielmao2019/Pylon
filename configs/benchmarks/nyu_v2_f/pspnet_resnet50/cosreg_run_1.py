# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 16405773
config['train_seeds'] = [7845785, 43020228, 56062503, 14006600, 74821089, 82586209, 51504810, 1516894, 6282299, 79833900, 33802477, 18160222, 70504096, 51419557, 32600791, 62810672, 26660962, 50700162, 28305088, 13224463, 90065409, 14758284, 25242522, 46690881, 48609508, 17280359, 15675496, 14092478, 85763798, 31721045, 31596807, 77063942, 66507209, 32601355, 1188106, 76039420, 1406329, 91113160, 28964447, 87706624, 25320825, 29312701, 67933105, 60360773, 16910689, 6002008, 20899356, 49791358, 76583042, 65593980, 15037736, 8109198, 90179624, 32272629, 24006115, 53779866, 84939510, 36723833, 26769073, 67226673, 65002176, 24261861, 85149719, 12574234, 62699680, 44538923, 21730950, 74711701, 60465830, 4575775, 30471907, 89231973, 20950188, 60307402, 13131597, 32553040, 74123832, 19947164, 80212961, 1156854, 32184313, 45075691, 48212811, 1009875, 98237614, 54976078, 36396909, 87356543, 61158150, 49409523, 74753094, 52217227, 4087934, 67297948, 90791639, 33595000, 1204019, 72587384, 21320968, 51256500]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/cosreg_run_1"
