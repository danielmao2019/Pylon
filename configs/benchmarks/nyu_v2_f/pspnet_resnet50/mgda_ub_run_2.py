# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 7411004
config['train_seeds'] = [98374455, 59546724, 19545778, 36083185, 46777968, 36205562, 45029394, 30765354, 16430910, 23328707, 22970713, 34410853, 1359552, 70346103, 70820020, 4115328, 35875006, 7510258, 85034509, 85614277, 8553060, 76342, 54882417, 12533684, 81101600, 82722223, 90824508, 94404864, 98622988, 40105079, 66977366, 80373093, 81671345, 75766350, 35802367, 99318802, 94680134, 16834830, 77455900, 84646936, 44386327, 60810276, 12634174, 79029605, 44374813, 35223200, 74132374, 63585622, 85476772, 54162392, 84644231, 89026987, 13160749, 90164197, 97726627, 60104676, 85610245, 28673589, 41143181, 24558524, 90862112, 98217104, 34178657, 14164364, 26825261, 36611962, 67649817, 64668368, 83058022, 20675645, 29802720, 88070770, 20278901, 33778454, 23969265, 21481187, 63974932, 74823036, 48647529, 62397580, 89522010, 95347402, 27391479, 52983976, 40787816, 21264490, 11775798, 94902520, 34839660, 84817126, 95219095, 85205277, 96055159, 47157409, 69912290, 98182034, 18300507, 9991057, 29993083, 88751324]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/mgda_ub_run_2"
