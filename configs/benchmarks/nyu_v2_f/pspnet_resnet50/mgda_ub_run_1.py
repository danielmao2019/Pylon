# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 61125063
config['train_seeds'] = [84384349, 15595359, 9383868, 11405903, 95300252, 15368151, 44507891, 78643351, 27664277, 58243956, 25263428, 10301181, 76178399, 97041829, 52689246, 2902433, 63606638, 94125646, 46872032, 1892628, 82352603, 52202152, 41070947, 38334196, 30743424, 49458981, 20231127, 31719148, 69775923, 22823828, 60708709, 95252102, 99679647, 58056451, 81752879, 79104649, 25708588, 28753889, 21756637, 1534254, 42237018, 75194916, 95209354, 44874793, 88822600, 2829165, 65670481, 1655502, 26464283, 52205531, 14219611, 81371473, 26030241, 327043, 83600630, 75743963, 1294628, 22507048, 20705470, 17422111, 3499170, 8417440, 91796758, 84202376, 71567028, 62959127, 42115366, 70411893, 79858929, 25266982, 8236767, 32209308, 44340276, 5710658, 72321047, 72023040, 87508289, 76112414, 21370844, 17729449, 4221869, 68052265, 78662945, 81008908, 45097533, 44719972, 73855792, 3784399, 29618942, 77615626, 22956652, 72952459, 88023169, 12140392, 84671988, 93050938, 19472800, 95992494, 6813612, 75434985]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/mgda_ub_run_1"
