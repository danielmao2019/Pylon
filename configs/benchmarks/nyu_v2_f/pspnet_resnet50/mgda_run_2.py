# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 85566597
config['train_seeds'] = [25782288, 92612839, 22356914, 79944958, 78406674, 69715784, 90959897, 18222417, 88619336, 71026082, 91311205, 35236463, 93141050, 5704176, 33255233, 1931007, 55696897, 3922524, 18131597, 26664752, 33417585, 6124421, 22195550, 9898715, 48053945, 73132109, 32124220, 17208121, 96914353, 28556091, 17670748, 85802169, 83205619, 345966, 39483349, 83528694, 76590832, 83505616, 5133723, 23484102, 50261842, 38548807, 85197174, 76014697, 75315348, 32505776, 60907218, 98453114, 51948655, 85637488, 59529275, 49551074, 59490450, 35882031, 9316152, 27523779, 18472947, 71390250, 15461241, 53032074, 49828461, 96375310, 72220465, 12835066, 50690071, 26854114, 55073622, 3638053, 81909101, 60641490, 13952670, 83557644, 44468939, 38459129, 16398583, 92125108, 16920770, 74751083, 98172322, 4132101, 7140551, 82807010, 40526038, 79261690, 40623486, 12358605, 10338429, 77978750, 52392419, 28099853, 70008206, 86355335, 69620459, 15940702, 9504957, 30642136, 44239899, 79340753, 52181027, 22761794]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/mgda_run_2"
