# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 50316545
config['train_seeds'] = [5518869, 12621543, 16023450, 63305190, 37589099, 92495350, 88096586, 84099680, 52212053, 62717597, 2599708, 75818340, 38005399, 67602242, 65771922, 11437749, 31831293, 48399924, 12460185, 35231600, 76268435, 71137189, 48058429, 33202715, 3030813, 5019048, 80719644, 9927698, 90124534, 27822850, 14882458, 62448112, 16342607, 94463796, 78507628, 88002684, 2141247, 70577102, 79127908, 60062782, 68915623, 32713475, 74575240, 46520960, 43758361, 29919012, 73253415, 72561306, 27249822, 46107251, 3787366, 96259646, 88669745, 54155611, 13290183, 775597, 67995970, 79935782, 1888743, 75867790, 68660790, 20958053, 64729991, 4224109, 10823553, 47324359, 84113102, 45177932, 30598955, 45148356, 48524426, 12151947, 26675525, 11435343, 1997164, 62940421, 50149089, 3100537, 56086826, 28129785, 65604216, 60881008, 70311251, 17958932, 91216560, 47033202, 44274874, 19988114, 77833477, 57933155, 22983893, 48220766, 45426692, 90167050, 37185580, 73618930, 49766599, 16359254, 80445106, 39643263]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/rgw_run_0"
