# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.nyu_v2_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['semantic_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['semantic_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['semantic_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_semantic_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 85209777
config['train_seeds'] = [43388601, 9293266, 77004552, 4185236, 47601791, 43478040, 28512897, 81110150, 92336621, 76215061, 48181699, 32923627, 14105680, 25829872, 95744068, 21588515, 33081719, 98692354, 82456571, 68009592, 8323759, 62169561, 31318459, 93821984, 27342029, 55350451, 75602000, 49042771, 87576659, 79110110, 10490850, 80200472, 70861316, 10778375, 86225070, 48687873, 98360963, 44572843, 55279482, 89385852, 75354980, 28506379, 55830540, 31920346, 67765855, 84522501, 79344280, 27700079, 36295641, 73884127, 28827521, 71762036, 35205881, 93000317, 30554101, 46325001, 66095508, 67004058, 34769871, 65611322, 13113129, 35450236, 91638874, 82966476, 57218504, 73748679, 59546191, 68216798, 41281755, 62329902, 17314957, 58163069, 11201348, 63478159, 98208070, 80380906, 91466528, 86792303, 21626797, 57008802, 86784108, 95815137, 75843180, 3078241, 85607014, 93915800, 78189843, 92799436, 74954795, 38322140, 67351956, 29711390, 40134251, 22755158, 38689467, 17827138, 11098359, 44821046, 10834570, 14231266]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/single_task_semantic_segmentation_run_0"
