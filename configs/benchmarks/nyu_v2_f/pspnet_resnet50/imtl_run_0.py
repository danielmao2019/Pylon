# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 90252779
config['train_seeds'] = [55480145, 47782339, 25543258, 69112308, 54977630, 66176332, 10682825, 25858171, 19294702, 48568134, 74156643, 53870268, 56699049, 57006635, 58717590, 11574626, 93400741, 94990067, 72457645, 35031976, 93905793, 69543105, 60385461, 62819185, 91925431, 92470504, 52048299, 21745688, 80857282, 71562577, 35022961, 88182552, 32402060, 56457412, 55500784, 41452775, 37488053, 41059872, 7068521, 41221769, 60007990, 31321063, 94605031, 56350343, 66157081, 97020444, 22606225, 4830410, 87126126, 94687351, 22725573, 24143995, 38100386, 72397026, 57756857, 34665974, 69575281, 48977046, 73232096, 17099310, 16766500, 60713963, 46930644, 95440308, 26337998, 29003852, 51931305, 37221218, 35077288, 2734930, 6794750, 31298198, 80648750, 20249478, 77378830, 81165966, 80713087, 68881478, 23320606, 76675681, 6526178, 82405736, 49204249, 8953802, 75879009, 44428322, 98410808, 11549448, 43228754, 54718774, 53259201, 66707571, 79839790, 93420722, 28654978, 33943934, 35096537, 81901611, 25450052, 82669621]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/imtl_run_0"
