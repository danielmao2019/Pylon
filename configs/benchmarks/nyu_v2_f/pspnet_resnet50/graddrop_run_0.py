# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 36726628
config['train_seeds'] = [42994067, 6158882, 19235634, 77966524, 44594176, 65323601, 10150594, 66528757, 86158299, 44176236, 17173516, 21755575, 9521659, 37522130, 55438093, 42810076, 6672617, 30784226, 21371606, 11491204, 42225350, 89343122, 37289031, 15719782, 62894264, 41513305, 74384888, 90666128, 87256736, 54140965, 18341705, 8377532, 60229041, 18163458, 36197435, 91520683, 2868660, 58664138, 80460967, 75506150, 8476678, 16439892, 11515163, 7821209, 42406855, 16678281, 93080719, 85912959, 24996575, 83135928, 43051247, 9564684, 27873032, 67439675, 55576264, 78891422, 56324011, 3154096, 62541914, 24842181, 29495397, 49500047, 69370753, 55535362, 13747931, 64977059, 72061029, 18710897, 174361, 68424662, 24567692, 39395656, 65479233, 88352700, 77962456, 97713732, 64518038, 38296044, 38306, 40775171, 40146464, 15424589, 30035867, 65079207, 76057310, 18777143, 38219885, 28981491, 68513040, 73195790, 69919392, 61117161, 52406865, 55762261, 72573538, 86631669, 16852176, 6356271, 37787122, 57677154]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/graddrop_run_0"
