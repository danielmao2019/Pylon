# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 23452167
config['train_seeds'] = [75500777, 46407251, 66091529, 58113211, 63901391, 39170233, 51924432, 48178739, 1507150, 78455586, 73455167, 79054918, 92919262, 41934141, 46338156, 36123311, 19154022, 75634099, 93770563, 51390304, 71786523, 67801733, 81932127, 8457713, 85415507, 64703528, 83001387, 43527895, 10156561, 46410010, 73257037, 38374511, 42843763, 69433532, 59976320, 18883242, 10033057, 63577740, 13699156, 74321159, 3319267, 3394764, 93744554, 74191309, 75676285, 72803205, 43255285, 49136787, 70477899, 39929837, 16882190, 99065367, 56766752, 61510815, 93832549, 94593401, 68360429, 44910130, 19736575, 39149341, 16260765, 37125515, 49726393, 71324070, 67502709, 53301976, 2544616, 21596064, 62544451, 34314881, 64935815, 79458114, 34058967, 97622047, 80960258, 95722647, 15600776, 66997351, 65332452, 85692755, 12125194, 20293142, 96817888, 31112042, 49351736, 85919745, 80956667, 26536723, 39129797, 42637602, 37657712, 70779121, 80477843, 56258281, 91635097, 53748343, 94727627, 50609808, 49160655, 56600516]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/pcgrad_run_0"
