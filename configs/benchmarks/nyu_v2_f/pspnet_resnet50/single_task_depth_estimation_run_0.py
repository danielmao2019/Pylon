# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.nyu_v2_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['depth_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['depth_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['depth_estimation']
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_depth_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 31354236
config['train_seeds'] = [8630381, 6191695, 15304075, 17550863, 42451878, 81270903, 24504402, 55241317, 25739795, 39014921, 75943633, 74686857, 50230759, 91139885, 16478308, 34725365, 10911915, 68310562, 85149751, 74772068, 52587553, 22199702, 53980007, 55335854, 28245683, 83352583, 52057860, 50787041, 16055546, 29715261, 22587314, 23214592, 39764705, 14194337, 10201225, 39957983, 33628119, 5581659, 27340203, 60808221, 65107241, 78716740, 19633821, 57463194, 43422920, 10698663, 46504430, 9369231, 54890609, 96288802, 51651438, 36982950, 3743469, 6139630, 88669779, 1511513, 67836707, 47724879, 65266226, 79778084, 63037225, 30655409, 78990324, 32733501, 87738832, 55916486, 53268063, 92732778, 45825832, 91118069, 23973871, 34692940, 58508143, 74438615, 52793137, 64706084, 36898163, 23981252, 38391714, 82009855, 26495931, 96444460, 20808382, 64114885, 65067532, 45307449, 34702900, 42943540, 59200948, 33813091, 38226608, 98559107, 15992459, 97231242, 83727463, 80049767, 80101735, 74157458, 13835925, 58581290]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/single_task_depth_estimation_run_0"
