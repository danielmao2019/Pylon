# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 93404728
config['train_seeds'] = [59669060, 13107064, 93613265, 23297146, 99093892, 80685360, 2702627, 74648089, 95973994, 26998000, 94475131, 32470616, 85716442, 9794036, 29268951, 72575161, 252153, 34195055, 55855429, 39971630, 80240230, 15374657, 10192641, 12213965, 72694703, 61512272, 39771081, 35987306, 67147389, 9714439, 23436380, 89336972, 10045343, 6994968, 60938523, 65253899, 77345202, 37611834, 5533439, 91676334, 98802264, 39810767, 56521101, 42167721, 82282176, 99368518, 66463871, 52168467, 59069310, 19350720, 91384682, 7424022, 76845494, 86040142, 69550045, 64567887, 21581543, 78167994, 98820263, 8455277, 20264052, 35903477, 42067431, 78987076, 70311359, 31652521, 22521937, 95421789, 62371952, 18860079, 32853532, 75383105, 7466503, 45199899, 98769498, 50550908, 77562515, 67493279, 4077246, 31034274, 17268739, 62524000, 18232765, 48290005, 89661077, 27419540, 92540201, 72122256, 73599459, 40553140, 33140903, 74620242, 56400802, 68807106, 56846894, 62080136, 56537990, 7175150, 34462125, 7535199]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/imtl_run_1"
