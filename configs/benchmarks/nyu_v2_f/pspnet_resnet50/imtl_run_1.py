# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 28762924
config['train_seeds'] = [72992849, 47276120, 80641499, 71396560, 19535258, 19091167, 58337647, 30975154, 68393793, 82186565, 88318403, 90369510, 26452813, 81448073, 72164047, 45316797, 33027910, 7177774, 38625647, 75516798, 98177862, 31939821, 53617073, 85851098, 44063039, 39939750, 63413067, 94883264, 67016818, 80202390, 93145693, 43857957, 86449265, 99682184, 60398330, 81888944, 21743067, 727666, 42455482, 94641364, 79047317, 31422566, 19087547, 98793054, 54085491, 94361463, 50381007, 15275587, 48599592, 85872741, 59012576, 41187679, 40754108, 53646387, 98506063, 91826370, 48559888, 30594329, 33615077, 5124299, 17990991, 82292953, 94853972, 74123552, 64346264, 67748825, 24549011, 2656717, 5725128, 86456662, 74139658, 17710434, 38428225, 59754906, 13390594, 11263051, 84032437, 24822068, 71415286, 71060843, 69008815, 438174, 21661340, 55985501, 72230949, 90998812, 73057488, 25975308, 91830257, 87525695, 25135359, 55859183, 63249855, 63033823, 96258348, 91134184, 73524010, 86893383, 31915026, 89346306]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/imtl_run_1"
