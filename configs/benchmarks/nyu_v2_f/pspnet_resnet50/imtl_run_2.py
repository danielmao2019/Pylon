# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 68013353
config['train_seeds'] = [39214641, 79390255, 20679399, 88809149, 81603259, 84696314, 40039121, 91555315, 80434694, 78213669, 70707051, 5244341, 93605500, 34415619, 69103508, 75311809, 87053125, 135259, 94294612, 78708708, 71782663, 35751690, 6131345, 14807019, 17873960, 77968048, 60754942, 54839892, 92753697, 46707496, 62767697, 54021229, 39665688, 81080147, 47676629, 31766475, 86624471, 80720643, 27153815, 36330564, 42216434, 22348183, 91719824, 67321347, 62225720, 95716036, 22363748, 34388409, 31362043, 16447009, 21309295, 67159851, 31050081, 40397771, 62022122, 23201536, 47212228, 63610862, 58229347, 54301615, 72739197, 96003100, 12025905, 85608167, 46389311, 12005029, 93072250, 92593745, 32131577, 8615265, 28284506, 61280330, 75997595, 45340980, 55545400, 8749090, 48232838, 77185225, 79734657, 93769046, 27617091, 16713196, 85602297, 84874020, 51658437, 58003389, 62162679, 25636941, 81121844, 51994067, 50642799, 9747904, 33989763, 82798855, 17724813, 27318024, 60578481, 41543025, 46533567, 16640860]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/imtl_run_2"
