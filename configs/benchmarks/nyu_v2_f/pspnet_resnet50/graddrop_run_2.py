# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 81948446
config['train_seeds'] = [40194853, 57012900, 2660493, 96054128, 44889661, 19040426, 55343856, 51215699, 43973868, 50488152, 69285855, 24393354, 82086385, 37632029, 67160064, 40562331, 69814914, 19225071, 96458378, 24554908, 91359456, 76657662, 38203379, 25986983, 83300458, 20207761, 97696849, 59148956, 35208212, 1338600, 76513822, 92312326, 8410957, 33463317, 65922300, 41470623, 42233992, 97591065, 57260085, 79347800, 90120437, 83559537, 34947780, 59157139, 10368637, 41761624, 9673135, 1114221, 13629359, 14156043, 6708892, 47325317, 80570957, 52080321, 89452049, 29999152, 34926091, 49732039, 53077132, 37005512, 61488476, 2622659, 47831570, 19071346, 4977013, 37250434, 11533581, 59752170, 71784898, 27401020, 86425499, 59383081, 53603322, 88932928, 84177926, 10060944, 91472606, 90325000, 34722982, 44101375, 51813199, 23816171, 82489104, 74459220, 74963817, 78370675, 5809974, 34475392, 63404879, 31387616, 74999105, 65822505, 51193424, 41996561, 74130660, 47320304, 61796337, 55071270, 5152771, 42392680]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/graddrop_run_2"
