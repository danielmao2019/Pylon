# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 20202232
config['train_seeds'] = [55699215, 40519749, 49536821, 29459397, 33065731, 22486092, 13437595, 68130693, 79476669, 85143224, 39032969, 20604489, 18483117, 87959120, 83148505, 24718166, 29858179, 40309583, 72458250, 90324610, 79381826, 82392251, 89747432, 45593182, 76440221, 41812641, 23637119, 42297614, 40357544, 15082233, 84979623, 31071970, 44646444, 3556402, 34380114, 2565685, 85519224, 42423759, 85707945, 75428991, 15085006, 72371685, 97623762, 3298097, 50065293, 89180207, 25271211, 49853796, 1909541, 54314253, 86043075, 80192207, 20564010, 51578611, 21113085, 63912135, 44826056, 9979372, 23770321, 29361604, 26567724, 18051886, 41309787, 23154729, 6418112, 32039272, 5767031, 93270029, 20370131, 11506765, 21105448, 60066450, 52027377, 9406007, 6506001, 19393179, 18949370, 43889668, 39554855, 31158834, 29020283, 29526045, 21163157, 36449204, 56633226, 77627372, 75110997, 25235480, 55401778, 63458830, 37040107, 8973113, 30575155, 41886981, 97061048, 9802091, 20970525, 77820421, 88835134, 17040491]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/imtl_run_1"
