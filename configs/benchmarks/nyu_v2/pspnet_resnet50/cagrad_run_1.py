# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 91989949
config['train_seeds'] = [85152710, 50953008, 56392602, 7805439, 8688680, 57854508, 50568612, 90835941, 1637183, 28621608, 78350411, 28689460, 46334419, 13297933, 82655907, 9443825, 79219902, 48380121, 52662467, 47152059, 60069589, 11448960, 50582688, 94144559, 82767333, 92091289, 91944187, 58043040, 74346949, 50735057, 89174402, 5901863, 43597060, 27710002, 34219854, 56742963, 26078407, 37637604, 21174553, 85110930, 71545027, 22232019, 42224132, 27815642, 85734098, 26375634, 60752321, 58202492, 3803777, 74424832, 13518883, 398752, 85154339, 60012757, 16386584, 42176810, 11535875, 52027385, 94106187, 2908003, 69738224, 57168230, 49658715, 43794831, 36154322, 21755895, 84993775, 52905503, 38104943, 90912444, 6890211, 94614140, 45605016, 17403786, 84507929, 16077333, 52783019, 79851879, 12971012, 30510092, 58850882, 7804871, 68135333, 25824984, 16218572, 23748560, 94968138, 23932878, 56597377, 99957835, 52971490, 12511825, 15330590, 60265108, 35131550, 58516394, 74281229, 60857085, 14226819, 15069739]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/cagrad_run_1"
