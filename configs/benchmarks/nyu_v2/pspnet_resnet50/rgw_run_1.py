# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 3693136
config['train_seeds'] = [19094420, 88888664, 93092752, 65379975, 79643989, 73576010, 70723428, 81719671, 19191541, 38449201, 50467930, 60383384, 12429617, 13661172, 11558358, 84860612, 12530720, 80230331, 79369283, 55135856, 50827770, 49143571, 67186505, 30021105, 95513452, 20028217, 24803868, 87469164, 5923411, 77368877, 43830264, 9089176, 73440756, 74995159, 63830751, 92298774, 11715396, 25632, 83422529, 78178713, 80070399, 57750186, 7440012, 35425403, 67266775, 35170262, 13962486, 78399762, 98273821, 49243931, 63749001, 5978784, 2462513, 79868655, 20036598, 70977700, 30942502, 38513328, 62665338, 75985725, 51427845, 4811495, 56629761, 3725140, 45097524, 38933856, 10273298, 38535173, 30934746, 80829690, 40351317, 50723622, 7594867, 48376580, 2411461, 82839411, 93967117, 65560151, 54635878, 73092822, 24772134, 47474251, 69821789, 92807595, 72452957, 21400919, 45712065, 94749715, 81839736, 6494567, 29174794, 29868935, 79979314, 36905118, 68446906, 74844936, 52472694, 32894828, 19044262, 2382326]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/rgw_run_1"
