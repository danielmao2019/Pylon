# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 41126921
config['train_seeds'] = [1286782, 14037420, 88356027, 37329871, 43110421, 6313540, 43498328, 68459517, 93086681, 69963838, 44677625, 11111297, 22260325, 99275552, 53787897, 42036713, 32658632, 84118110, 9089219, 4382668, 80324395, 55848832, 36154423, 13961952, 5321759, 88480106, 4542269, 2656875, 36828562, 61669737, 59006875, 63690455, 77002330, 4367342, 14726513, 14530855, 86348822, 6506756, 44040388, 81985573, 71403161, 63467695, 69540635, 5363679, 59810943, 31770445, 39055754, 91786078, 67115442, 33751284, 18622631, 2975716, 84529247, 40521912, 22123964, 86781350, 79142703, 13882775, 10640885, 27307482, 78115706, 66146923, 56008422, 35282798, 22173080, 74777573, 23246526, 46479397, 82865008, 31368434, 18968709, 32704008, 94205503, 46558988, 25323570, 78284687, 23870299, 58229574, 37299155, 60190228, 94260710, 34594442, 85256585, 74879007, 29662668, 86926012, 19928046, 36028944, 65746076, 85900296, 4535698, 49066393, 15202083, 94333412, 61397625, 3817210, 39664515, 89862976, 10707211, 69137404]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/cagrad_run_0"
