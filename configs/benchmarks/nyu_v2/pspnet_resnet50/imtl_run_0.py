# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 73202544
config['train_seeds'] = [45816474, 46222226, 96342159, 59817050, 33512965, 13178541, 82179734, 24972136, 14207693, 63947409, 55682797, 37000522, 76519445, 23145316, 49544086, 64824793, 97505880, 41783025, 49996221, 58655202, 63946012, 19110058, 16245304, 46727809, 95665474, 41782801, 83330904, 6668671, 44587841, 39906978, 79588833, 84871823, 8863459, 48408960, 94242705, 76502677, 37073331, 68619178, 46635662, 53519463, 22828210, 48739525, 74757226, 21368931, 41318525, 76897092, 42586819, 27138472, 63244028, 46191523, 47179552, 31889095, 11319476, 18822286, 1028904, 99620387, 189599, 6223907, 38673934, 40372009, 55349165, 14982935, 55116021, 11340058, 73611283, 93765655, 4423568, 44211756, 91404972, 22712789, 85369264, 42691117, 95743323, 78531385, 14474111, 13760408, 26480249, 36466820, 87297382, 95248789, 63288346, 36837394, 72142424, 70478026, 59975171, 79618876, 79453087, 3241705, 75935395, 98163937, 35159873, 18871134, 93291480, 75132942, 81416614, 77040046, 8295829, 83898021, 36778597, 9134275]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/imtl_run_0"
