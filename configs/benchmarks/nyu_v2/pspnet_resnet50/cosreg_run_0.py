# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 26407482
config['train_seeds'] = [76692575, 53691966, 63389350, 33515551, 77396275, 84046055, 73066186, 25656613, 14197537, 98577364, 47383562, 86916563, 12895351, 67482730, 75100749, 74317585, 79868639, 72602552, 83357557, 57678249, 25969144, 49160630, 61352404, 91986021, 99598775, 18744570, 40286843, 89026623, 72082605, 93004487, 56377327, 99763493, 7399967, 98949913, 25223100, 3143001, 61272301, 77316986, 40467424, 30769834, 45346812, 94818609, 59987418, 25153556, 80764038, 56161860, 67501007, 63555544, 73601954, 33408025, 24504825, 37581662, 97596728, 32685078, 27480791, 88338331, 46577143, 46501868, 81217870, 90689115, 42795032, 28146941, 23931300, 24202647, 47841004, 27654635, 92814804, 44891667, 34319460, 82820009, 64336264, 87008475, 24136524, 53548880, 57877118, 33508430, 57633428, 61037949, 25458205, 15668450, 95815292, 73678221, 67745841, 90382647, 70363879, 41773973, 61508440, 18438116, 98693921, 70878499, 8963394, 70447655, 13989128, 88944736, 41674313, 99018372, 67765215, 30630879, 99775157, 29983927]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/cosreg_run_0"
