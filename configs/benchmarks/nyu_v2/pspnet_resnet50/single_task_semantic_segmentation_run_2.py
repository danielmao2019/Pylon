# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.nyu_v2 import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['semantic_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['semantic_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['semantic_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_semantic_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 56545016
config['train_seeds'] = [55598203, 92527731, 98228377, 3969929, 96334717, 88180648, 32746957, 30454571, 76428061, 31312946, 44393610, 53385447, 61401425, 65311481, 15207614, 7877105, 16905657, 49457582, 44274744, 39012761, 53411772, 35917969, 33141085, 57859010, 3935927, 79102150, 25491941, 45925037, 2793005, 56220744, 90030829, 45040567, 41501209, 79770220, 82213112, 2997510, 83644365, 30576179, 73280064, 69294393, 8542323, 85166661, 4622357, 34818145, 61861855, 39112152, 98486583, 34340907, 53123435, 31255235, 58853332, 83107071, 99555418, 33765907, 41049078, 68618726, 41374341, 61863634, 44350236, 66125792, 76163793, 22275292, 24264580, 53325123, 71286659, 81587581, 51968271, 9874347, 3457339, 63108847, 93815041, 11511874, 72420134, 87896084, 39268127, 41365154, 95239751, 70647912, 79917090, 1690563, 89307420, 1608071, 8086195, 2330149, 18631021, 90088924, 5102951, 47671031, 94152635, 10608807, 62394766, 64026219, 94302530, 73082239, 34203566, 12752220, 53349647, 49029136, 87733825, 8194792]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/single_task_semantic_segmentation_run_2"
