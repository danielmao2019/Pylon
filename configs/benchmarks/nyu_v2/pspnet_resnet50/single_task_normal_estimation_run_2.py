# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.nyu_v2 import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['normal_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['normal_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['normal_estimation']
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_normal_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 2114843
config['train_seeds'] = [18501517, 98752333, 60189869, 82460949, 79139797, 17884690, 8752890, 39408134, 41094635, 5186147, 38417457, 14764546, 96696423, 97451526, 90666287, 24149943, 27593929, 18261798, 37655028, 12622726, 34390736, 37689615, 32269611, 8462144, 47744579, 47579517, 54626578, 22718733, 7414393, 99885991, 75212317, 69107570, 54670306, 40321894, 10308457, 48653812, 63027240, 8886860, 40509705, 92181554, 75462811, 68870310, 9072410, 59053017, 55317798, 67862036, 18567615, 86872035, 4425923, 94042652, 48878162, 32998050, 92711836, 97517568, 37488312, 3381682, 66772495, 78474991, 42011228, 15344331, 66851702, 59361504, 44311947, 56281286, 16380634, 54412611, 72380087, 15005746, 32651218, 68618099, 78939135, 35363367, 63759576, 50436991, 20161153, 75001704, 68209026, 33188254, 3073803, 48396616, 86248863, 22966109, 54614259, 86448535, 41268626, 88443146, 62105447, 21831256, 41106532, 10570490, 23606078, 5097988, 36382501, 90164702, 12499103, 67141750, 70858262, 40709417, 66935658, 81648842]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/single_task_normal_estimation_run_2"
