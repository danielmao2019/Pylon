# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 42697778
config['train_seeds'] = [77456034, 29179939, 66568879, 14393840, 61113751, 48004785, 81091823, 78997926, 71120262, 99833604, 22149048, 19697793, 16466532, 44566325, 88336909, 22448805, 73947298, 40444493, 59506179, 59062681, 19864938, 64866704, 44346853, 33143406, 96529712, 41013135, 36702048, 79047554, 95134880, 53358954, 24256555, 13571431, 71121925, 36535573, 43185546, 77181996, 47444495, 53309059, 39236895, 92874928, 64111366, 53126270, 82533202, 71089681, 79314954, 60422338, 6064118, 64644487, 39986211, 50472096, 85491948, 61926084, 53588670, 87602199, 63275512, 43795020, 14941840, 51268574, 55123175, 63265106, 59138642, 15727123, 41334019, 92612267, 80465409, 77075976, 52887209, 91061258, 65576101, 74125554, 84988058, 92330968, 98708726, 58462087, 87454295, 43023797, 33776853, 91564989, 18273959, 77355281, 45234687, 13848296, 60652940, 32935085, 49421724, 54534312, 64576247, 36763740, 38035572, 63473168, 11326887, 58344938, 16472776, 58297527, 36396256, 73310085, 52445101, 57051130, 71431799, 59798836]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/mgda_ub_run_0"
