# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 34142028
config['train_seeds'] = [17881372, 24724257, 28828063, 90308321, 69721732, 42327635, 96151981, 80891684, 50629629, 86332414, 59555412, 47856124, 4532471, 98185142, 95636041, 42964523, 3848656, 8144225, 43133077, 62888685, 61804477, 15281970, 44631119, 97607317, 43963814, 57028890, 52129622, 58823594, 67415866, 99298412, 50615394, 95936961, 78587395, 65816707, 66894286, 1575042, 58211858, 7781891, 52301209, 16195123, 47979391, 67449501, 7165294, 76344413, 23285732, 14469277, 30081845, 17465510, 81802084, 32909083, 22252668, 55907361, 66768932, 38388170, 93844121, 95568162, 78642360, 64887761, 58589619, 85717340, 86271561, 73097375, 67053936, 2012686, 11489761, 18665873, 45727191, 56905677, 30175866, 54640952, 3098782, 73199647, 67596671, 15310424, 17602865, 53441168, 38740386, 14158642, 79308162, 88249742, 80053707, 77743927, 93142691, 68279571, 47390266, 63546506, 28193430, 95225387, 62945456, 87659200, 48439751, 94023436, 4592248, 29153622, 42281307, 17993998, 62668762, 11651934, 56227275, 79581374]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/graddrop_run_1"
