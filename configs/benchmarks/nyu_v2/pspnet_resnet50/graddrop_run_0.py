# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 6041944
config['train_seeds'] = [57181996, 9616279, 98001255, 7496882, 57347166, 61050700, 70078176, 16032373, 18415505, 14796770, 69983853, 63942969, 39833427, 91721541, 15443838, 50950743, 36850936, 82129829, 36011311, 1069361, 38654056, 54452582, 27826013, 81634336, 2927365, 55462066, 9383043, 25155223, 39133350, 78224137, 7778719, 89565197, 21590097, 8114918, 33250055, 48378907, 59612652, 91214976, 42206942, 49722230, 30681949, 73680642, 4592446, 87927339, 42693417, 37426932, 13051920, 41619384, 80418664, 25349580, 50118254, 97960979, 98682652, 63395445, 27198458, 1235315, 8919353, 95107682, 48033409, 42852672, 67896383, 76436204, 29068532, 949662, 43256974, 81905478, 97207595, 81291787, 2765743, 50226346, 97959764, 11313837, 27213991, 58459181, 89423035, 31808521, 51346490, 89736128, 87777317, 48511260, 96983742, 64339380, 56728591, 71385323, 79460542, 52495788, 85126527, 29611998, 72384022, 73578460, 146735, 98331361, 7679618, 87982639, 77822643, 30926883, 39213722, 60280273, 28704217, 981943]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/graddrop_run_0"
