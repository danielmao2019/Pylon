# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.baseline import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 50214754
config['train_seeds'] = [3787876, 54395190, 64826174, 22382395, 13306109, 1326107, 44543223, 28333729, 45094739, 42291341, 48427139, 32363239, 91124082, 59193404, 8846607, 51182109, 44084908, 66074619, 72020335, 70675852, 17782899, 28355839, 6235558, 48246868, 58342272, 73591269, 61878740, 39336035, 42940690, 62265120, 73055957, 55386988, 18173639, 9066284, 44032805, 51303224, 74741913, 50174742, 19126977, 44999472, 14520591, 59709114, 10799541, 21263100, 42757255, 84322951, 36109685, 15646852, 58429328, 51855394, 46100518, 66662371, 26987177, 24284174, 79111031, 97366565, 26001242, 86301672, 76182017, 95244025, 84265362, 10466250, 37254197, 86002724, 84094153, 27566775, 46517773, 6702374, 43052304, 62656172, 98906989, 53013496, 28380794, 58005184, 92261663, 63429280, 30125840, 88866250, 7923062, 81753391, 9015040, 17814865, 97976004, 14024485, 4096637, 77364882, 86971873, 30856986, 94090128, 65848364, 11880093, 46903531, 64657750, 88061663, 75207945, 6893004, 75854905, 50110234, 11245627, 58176012]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/baseline_run_1"
