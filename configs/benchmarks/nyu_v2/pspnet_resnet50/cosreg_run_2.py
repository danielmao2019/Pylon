# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 71751259
config['train_seeds'] = [39807756, 51872249, 97813002, 24364749, 75848982, 35550482, 4111880, 72352832, 19830399, 60060215, 63923741, 35914010, 82825576, 81238812, 81949711, 59155098, 37661076, 86021175, 83794095, 55651899, 88807221, 34921903, 11018832, 38231224, 57329810, 22585300, 46467750, 71677995, 37123248, 16590493, 33174648, 9380836, 32776135, 85997045, 21454140, 23452533, 20869703, 74079708, 99856191, 24072671, 91919467, 68967221, 58106898, 57639072, 85690880, 34696457, 6199480, 41757343, 58749012, 31880288, 22550853, 23248343, 45536379, 87614316, 63866208, 40746254, 25872033, 51716530, 54054081, 66846251, 95803434, 2948236, 86983349, 92336694, 29205428, 69096336, 36489293, 17228311, 16306121, 92500945, 55338734, 91553827, 572965, 58910387, 71245753, 60392168, 76074190, 78830613, 61446234, 83761904, 89250247, 66422522, 52465208, 72626251, 90880558, 25242233, 36459512, 76245460, 3664823, 8967817, 4060981, 1429914, 47381821, 6979674, 58470354, 88239519, 76525567, 52380556, 53090945, 33773127]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/cosreg_run_2"
