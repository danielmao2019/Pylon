# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 46724571
config['train_seeds'] = [75189902, 44663779, 21452954, 55233926, 87125551, 75602182, 97582393, 51273052, 57609216, 12597987, 69172256, 21917593, 39590517, 66515082, 82284386, 51153105, 74489505, 45136317, 28075826, 48449363, 20428444, 46058960, 10452901, 49960405, 29845757, 99437838, 7040173, 8851841, 55900282, 71094700, 61676171, 7803521, 99615246, 39865567, 10527032, 5744983, 12552259, 51637742, 68055941, 22632965, 45371210, 7600793, 38870982, 88947619, 86829626, 13159355, 71349438, 86079836, 21553451, 49094791, 43859797, 72537014, 8002231, 21461318, 17294498, 43773632, 61305780, 49356257, 46125659, 19490415, 73728673, 17012378, 40231037, 36022912, 37614765, 87260201, 83223488, 25361113, 64518800, 93153891, 71454262, 23673457, 1440799, 52684959, 35184734, 26109880, 591415, 66512945, 55887934, 41948251, 69304302, 19454039, 81717622, 1880890, 56737531, 61057252, 9232876, 48888541, 77424522, 29608523, 54017034, 63332333, 63898574, 5285374, 67425996, 87055872, 57502141, 15784256, 78122420, 28959439]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/rgw_run_0"
