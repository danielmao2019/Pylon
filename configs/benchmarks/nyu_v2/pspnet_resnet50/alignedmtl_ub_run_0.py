# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 45269050
config['train_seeds'] = [44439945, 60033214, 11533009, 99413065, 70203366, 91362614, 67659326, 59829772, 34226728, 23917389, 38522400, 22258183, 47641111, 59366206, 22154259, 44914852, 36774704, 17260783, 46328697, 50346608, 94693716, 95621138, 67938170, 54344323, 86519786, 65386531, 2484283, 91287215, 37887544, 50437964, 78875220, 42078615, 8676447, 41052015, 43077870, 51471464, 11836351, 60861094, 79551649, 80984441, 91470226, 5557919, 72871454, 61542581, 81281957, 86676211, 29818152, 1869226, 12606965, 17570079, 29524950, 39299416, 20655182, 89354757, 89855984, 46094110, 16041368, 80667557, 81301925, 97062835, 86761808, 19309237, 15198273, 87060782, 37241128, 12217811, 65922034, 56380031, 23642581, 51966482, 90826004, 84700215, 16282883, 29738403, 20618435, 74761081, 8599317, 57933983, 76248285, 48147262, 57057430, 49920096, 21106885, 43048771, 79924096, 92524018, 99957306, 38819521, 42485851, 19160766, 22018591, 54159628, 85429802, 29977697, 63174851, 8047949, 56634151, 44000306, 20468338, 25714125]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/alignedmtl_ub_run_0"
