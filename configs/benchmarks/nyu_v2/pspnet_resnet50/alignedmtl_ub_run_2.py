# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 78720722
config['train_seeds'] = [46638500, 32831721, 4554048, 71589710, 51145522, 86227178, 74942757, 37737400, 95062176, 42630723, 63044823, 26333199, 42459672, 44308630, 32209253, 43441499, 82674963, 89941782, 63926654, 80363525, 20032633, 98665102, 71482966, 83386332, 30518237, 68998050, 42663356, 65821391, 65831505, 24216350, 92471351, 11928299, 54626160, 56284207, 39012046, 93062370, 75925708, 94770371, 51170343, 89673185, 15868650, 97638147, 31120904, 69153278, 69055625, 21430668, 52297506, 21431706, 90278146, 59773429, 75956732, 35481752, 91389460, 96564452, 19967507, 76179026, 53548449, 51031307, 88623269, 74431185, 83418422, 12870106, 77840254, 90722214, 54504151, 95134367, 3900866, 56876730, 30022514, 31610416, 45173093, 1633074, 43271449, 53101142, 79697293, 85765335, 44276032, 54148852, 58608430, 20280248, 53320421, 50535181, 5860879, 30652433, 18408135, 75942485, 94995806, 53866362, 65160291, 62078124, 4906232, 11442848, 16177674, 69042975, 31241936, 88364183, 21007540, 68460410, 47994268, 14665794]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/alignedmtl_ub_run_2"
