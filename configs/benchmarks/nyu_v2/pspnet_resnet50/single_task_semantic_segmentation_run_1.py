# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.nyu_v2 import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['semantic_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['semantic_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['semantic_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_semantic_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 66596320
config['train_seeds'] = [9991674, 83013157, 10871163, 57135874, 64242642, 96396631, 85879675, 87534721, 45442231, 57934686, 37174301, 63789737, 65048154, 57982896, 89624938, 5425552, 10239214, 98010554, 36878817, 77956799, 64587253, 55446767, 48864049, 91062401, 48481287, 53073927, 58646808, 84498785, 46497333, 70611996, 69894715, 85014211, 30710853, 33421111, 3730535, 88088495, 38319844, 94415590, 47017998, 86614791, 44662450, 28242001, 64842930, 69856582, 58848109, 12183213, 66353072, 63199316, 34534532, 55088212, 28805478, 83308449, 31555344, 64267690, 5527623, 55580338, 75079, 26312917, 89782369, 4699577, 44708700, 84994063, 58520042, 77610590, 41119086, 17761568, 69957820, 5211374, 22685355, 22636216, 66872577, 14515193, 43662631, 45900941, 72040457, 73922889, 21360762, 21721371, 65086710, 75713122, 18294345, 61353379, 1827304, 10106183, 288115, 93291451, 90939018, 44310129, 19818529, 28237542, 88464910, 47337718, 7281817, 69316893, 92355371, 21638708, 67290838, 79871157, 45850192, 15975497]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/single_task_semantic_segmentation_run_1"
