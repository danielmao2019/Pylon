# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 83640938
config['train_seeds'] = [2517461, 82631005, 22152953, 55049267, 61781331, 29291412, 96504990, 70811079, 68529264, 96762175, 8893024, 58002052, 51589719, 24901895, 17289703, 7524221, 93307608, 75165771, 82047217, 31850281, 6946476, 57640365, 28161255, 56080370, 98689676, 91203873, 53228968, 90263399, 28319943, 46648265, 75701979, 4873679, 70938935, 42653411, 57096738, 70712308, 69834602, 58572003, 15848067, 11042839, 53585962, 12603537, 77601252, 46907222, 32752846, 9637896, 70987129, 67994280, 32971287, 3497582, 63239014, 80312227, 37890505, 47058236, 30580825, 93567324, 28057614, 13840527, 82884670, 43045843, 72937598, 88347170, 1527389, 51902149, 17939961, 42825330, 36552449, 86284124, 65717744, 30336645, 45931460, 66294059, 85571030, 93664107, 33388639, 3536463, 71511315, 8564483, 62297743, 77313243, 64382788, 60323824, 53877716, 35699581, 77820121, 1077916, 14260081, 38119762, 46931280, 79935663, 98261159, 94122810, 34631772, 46238055, 55842722, 78521107, 58768339, 50982935, 75935186, 3106932]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/cagrad_run_2"
