# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2 import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.nashmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 46834276
config['train_seeds'] = [60841238, 35062353, 47671064, 23917690, 67535037, 43606688, 75214379, 31083925, 5515628, 59362513, 41541323, 39668055, 71965606, 29252707, 8849621, 86196435, 2405946, 17721975, 97621317, 14172512, 77268190, 75410819, 32554098, 36871046, 29157929, 29550388, 55853842, 58663167, 26355089, 6101861, 59069051, 91319673, 85129208, 66031323, 41261389, 91259982, 51724854, 91589074, 38721279, 22246623, 15657742, 34016565, 46224477, 40177217, 56263956, 25202064, 61946093, 28037068, 69913181, 44992862, 90768599, 210974, 24202533, 3777481, 22544295, 45828134, 30393932, 33978973, 83555324, 6441920, 59429100, 13960977, 80589849, 14799874, 92744813, 14388682, 831033, 79203580, 41938916, 30515141, 20480445, 92673714, 47553918, 73366412, 12533794, 52411637, 6331309, 18015202, 83902679, 20481641, 39716034, 46947413, 79720095, 94409950, 55731006, 95683188, 2118074, 68584668, 529949, 52925990, 72927468, 20606953, 50798734, 53940701, 18119800, 26638671, 86844916, 3296846, 48803297, 46373892]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2/pspnet_resnet50/nashmtl_run_2"
