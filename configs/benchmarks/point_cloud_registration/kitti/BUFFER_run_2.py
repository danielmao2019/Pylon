# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import criteria
import metrics
import optimizers
import runners.pcr_trainers

import copy
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import get_transforms_cfg
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg

optimizer_cfg = {
    'class': optimizers.SingleTaskOptimizer,
    'args': {
        'optimizer_config': {
            'class': torch.optim.Adam,
            'args': {
                'params': None,
                'lr': 1.0e-4,
                'weight_decay': 1.0e-06,
            },
        },
    },
}

scheduler_cfg = {
    'class': torch.optim.lr_scheduler.StepLR,
    'args': {
        'optimizer': None,
        'step_size': 1000,
        'gamma': 0.95,
    },
}

config = [
{
    'stage': 'Ref',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_RefStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_RefStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Desc',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_DescStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_DescStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Keypt',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_KeyptStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_KeyptStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Inlier',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_InlierStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_InlierStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
]

config[0]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['model']['args']['config']['stage'] = 'Ref'
config[1]['model']['args']['config']['stage'] = 'Desc'
config[2]['model']['args']['config']['stage'] = 'Keypt'
config[3]['model']['args']['config']['stage'] = 'Inlier'

# seeds
config[0]['init_seed'] = 65761505
config[0]['train_seeds'] = [1111166, 84303021, 425920, 63133532, 52093191, 25964273, 3275193, 46284652, 50344357, 19042420, 36613880, 67401150, 92056879, 95487025, 31167637, 67532707, 36716538, 50978990, 70632606, 51417138, 18349749, 36705037, 63599473, 91417466, 38477120, 49206905, 43280659, 44243872, 38892743, 57457883, 34358172, 41717334, 90039618, 85220100, 32039686, 89038278, 67930833, 4930222, 25020563, 92510953, 97511312, 66491148, 15096140, 3475714, 36104028, 3698502, 46742694, 61850233, 87311853, 22082893, 43019185, 88084695, 78075002, 8867620, 61653865, 32233241, 667864, 75654855, 50621386, 84984611, 49679062, 82889407, 68168731, 13325547, 28589545, 3820309, 5686379, 19996456, 54844333, 38258638, 67237128, 55551605, 75485788, 87465584, 37337859, 4827791, 67457405, 37855442, 7354776, 54486541, 85853865, 57665274, 89405563, 62653273, 52607005, 19341306, 92669435, 23901578, 68335622, 80920238, 95478678, 65927248, 81851741, 83554793, 13879248, 90739334, 28183292, 73723784, 15757425, 72173534]
config[0]['val_seeds'] = [18138459, 29993793, 98660745, 38787745, 91824121, 64703817, 10981720, 71561374, 18864527, 57580110, 48565230, 37078987, 55590632, 75168966, 71195147, 86883442, 10806324, 86601292, 85335097, 70466832, 91585563, 77925317, 48537289, 95204500, 66643113, 34468245, 90240082, 43011420, 7363825, 73102238, 48854638, 42779268, 45486581, 75506370, 93065728, 46183961, 35662807, 21183689, 71493429, 16639689, 79541261, 44946002, 62573010, 32793541, 80046957, 939063, 48715454, 61517922, 46399539, 77794664, 68414951, 23013398, 89928273, 79881021, 88269217, 75500555, 50449856, 19586561, 60867983, 32410687, 80856129, 45827240, 40527528, 28713292, 72983176, 36196955, 46717210, 82424290, 33776805, 31639172, 53513950, 33527693, 42289706, 25088604, 32999543, 39740793, 88778696, 97369950, 43978805, 91020985, 28888676, 23728338, 16283839, 72041561, 59750517, 87288305, 213007, 67119602, 40709843, 70091044, 11794199, 57117041, 65348796, 54184524, 96220253, 48046216, 48267394, 55974478, 75597076, 71297035]
config[0]['test_seed'] = 32340445
config[1]['init_seed'] = 87009809
config[1]['train_seeds'] = [26171354, 1742282, 99070568, 15530449, 89997405, 95285596, 69819164, 61093939, 31897297, 50322336, 10592213, 87153067, 85744217, 674919, 64469503, 45772092, 9453083, 33584467, 90549730, 66499502, 76939288, 45016311, 54002415, 93677285, 68348243, 13234491, 22415943, 41624925, 95077627, 27860568, 71981299, 44795012, 51791592, 61045725, 97700195, 23611189, 85941358, 25053648, 44594492, 37292824, 78191297, 49254497, 98281693, 32527031, 96905921, 59867212, 23425944, 3538313, 99689552, 45335013, 58411624, 87006404, 52522645, 94377611, 46200998, 94757972, 34158658, 8585493, 9977997, 62741187, 5084307, 47556886, 28583900, 95833240, 45884995, 29598415, 77362918, 89201330, 36917397, 78001505, 42198324, 10269054, 66082114, 82752782, 16715448, 31040998, 48271032, 26714054, 45930560, 62671772, 21745750, 85360086, 52029079, 48214051, 63706483, 74704782, 47779883, 33289270, 56797419, 16779823, 62772596, 90690516, 63951367, 16826935, 49488589, 10573733, 74185059, 47463006, 5889467, 7505770]
config[1]['val_seeds'] = [29434988, 3822887, 31169991, 81566076, 20845673, 84686284, 83920418, 98334174, 86676305, 53311969, 609596, 17180098, 9536024, 59860628, 75166419, 45083642, 38090394, 19575846, 93739080, 38515421, 42041429, 24130654, 8808221, 51503337, 66952798, 38157064, 92476664, 57403298, 65802961, 61582237, 76922079, 71014683, 77323700, 59815544, 40458325, 66439163, 55549066, 37398334, 22548646, 93253726, 37902080, 41247087, 40457513, 93547903, 15802835, 97689876, 75970340, 78907858, 58532111, 31382386, 55102120, 81465408, 55469752, 56413387, 8674563, 46666059, 31490565, 89629757, 40783895, 89933399, 17854085, 95732423, 37436798, 68987495, 96932871, 94281464, 93409871, 48153721, 87824851, 80479945, 20320414, 24638545, 61078378, 28896120, 47807186, 88998312, 73935882, 57364168, 89843772, 72004244, 25691473, 58259770, 23803677, 52509426, 98919917, 79937423, 90578417, 5993564, 58738857, 69168854, 37468176, 20459130, 17679559, 80962673, 78719067, 71286705, 56927539, 21132642, 67123039, 23642046]
config[1]['test_seed'] = 88452654
config[2]['init_seed'] = 56111182
config[2]['train_seeds'] = [75926543, 3559680, 98066596, 4388501, 3191548, 47739830, 30619514, 6608720, 79771584, 67299960, 77871071, 85429832, 98129407, 38991798, 87921559, 13056374, 89445955, 52538884, 88074420, 17766710, 14856710, 30590381, 9570579, 37084712, 63888884, 27625157, 37835471, 96949348, 66066994, 2283428, 27958177, 54422160, 27527632, 91378793, 59388504, 78650772, 88209574, 26306826, 79446839, 96437370, 73650950, 44299757, 84068632, 97595809, 22113502, 64983335, 65157827, 15374683, 69610472, 55617923, 6164099, 53277993, 6952702, 82662053, 16910797, 33779821, 63397802, 15109406, 18437044, 47551685, 26931074, 63565918, 68021408, 32254780, 17581303, 32676600, 7376830, 54941062, 58230801, 76623425, 4214913, 63236752, 63538990, 59305711, 31743062, 94919954, 94772778, 36975912, 31177119, 27753972, 53418217, 41796111, 42459685, 64078950, 20499431, 90111390, 56197060, 91225727, 11989092, 84117128, 83979336, 48268404, 33594121, 3333280, 44871700, 9882120, 92990797, 77862785, 24984104, 52343118]
config[2]['val_seeds'] = [58386133, 16814061, 38666947, 40175876, 78292549, 18300213, 19773927, 64957600, 77720336, 10129053, 90196183, 51845876, 47117580, 40766234, 54681161, 7748643, 44640655, 49002665, 1406610, 71292058, 18001032, 3895476, 2899401, 20324920, 97503156, 71140090, 19821398, 41237251, 44611418, 65350496, 76685653, 49225512, 62584563, 6922397, 64453751, 9085446, 54772612, 32175376, 78787318, 19928401, 82876008, 85587575, 82290000, 38697857, 95088930, 38497925, 73658907, 47973941, 33494308, 22497422, 25583886, 70192471, 63441018, 73202693, 58037002, 27909870, 70013696, 66474697, 19781714, 77199687, 19799651, 8381703, 2002613, 91357101, 26711299, 38620874, 79223205, 35951634, 58914765, 27108973, 41959376, 3970025, 49741256, 56152811, 69600385, 80604228, 93931905, 42754380, 15853420, 40355832, 2364449, 90512426, 30727149, 32515121, 65708710, 89539166, 10183208, 10950308, 24624801, 5979890, 8210785, 63728105, 68837900, 7907066, 36986881, 41807584, 97853113, 29154804, 89762918, 94508228]
config[2]['test_seed'] = 70051546
config[3]['init_seed'] = 10442002
config[3]['train_seeds'] = [40774853, 67774378, 26121593, 17897889, 33045406, 751955, 67818633, 93693522, 57818741, 37822012, 55426743, 87443262, 50458544, 82560779, 69668078, 70279812, 68468680, 36497301, 7096209, 45178923, 76547390, 33338476, 98808434, 36393938, 74105328, 42906859, 46322586, 34633749, 44334540, 62371429, 71629255, 32037335, 23154889, 15531111, 53831524, 82215127, 40673801, 54667716, 53795794, 58445105, 87286219, 17413126, 297600, 79655931, 73934284, 66327855, 74719593, 1713226, 75729593, 17787616, 71361607, 58845028, 82777875, 42708286, 1088552, 57320381, 69520686, 39836929, 2086886, 17586894, 85140952, 96664135, 82724012, 12776418, 38131944, 53468825, 94730665, 5418802, 8039275, 28818631, 35349651, 36713433, 78170129, 82038959, 30396346, 55063110, 8185173, 5274987, 38186201, 69982512, 57671747, 73902350, 56071044, 92621916, 26891122, 63312472, 28615101, 80244842, 57790833, 11444109, 71466299, 64862451, 16754108, 25037947, 7193333, 89494257, 82588115, 83170562, 44778011, 41469605]
config[3]['val_seeds'] = [51041002, 23941015, 44616012, 64666961, 44635860, 7516592, 32944796, 3482601, 53853591, 8949157, 1398195, 28364352, 22681442, 17383194, 36241449, 62878053, 83618, 82574199, 59108841, 22059140, 15338197, 77540791, 31409125, 98337830, 65170395, 55312573, 7428637, 18039313, 50533756, 52765610, 10259798, 66004338, 87449201, 73500581, 96158221, 63691620, 27836860, 46081170, 75105837, 92598610, 93592267, 20854841, 60320719, 12269896, 22704327, 82246095, 1705857, 67713287, 8080231, 13558416, 74459330, 30157754, 95835819, 55242460, 49680611, 86125395, 41612024, 21794710, 49722778, 50609927, 44579313, 43695885, 84946057, 85043215, 27946685, 20014404, 5162893, 85598048, 60193263, 95778118, 4030873, 97863540, 23226201, 70989793, 83858368, 51844972, 90679622, 27640789, 81442159, 61132928, 6058632, 70700595, 43396347, 68896059, 2908449, 91330104, 67759139, 77990639, 46356536, 14915935, 73093654, 84000445, 57453460, 94958138, 26237046, 50133345, 6246778, 71689496, 51247734, 32106451]
config[3]['test_seed'] = 89861223

# work dir
config[0]['work_dir'] = "./logs/benchmarks/point_cloud_registration/kitti/BUFFER_run_2"
config[1]['work_dir'] = "./logs/benchmarks/point_cloud_registration/kitti/BUFFER_run_2"
config[2]['work_dir'] = "./logs/benchmarks/point_cloud_registration/kitti/BUFFER_run_2"
config[3]['work_dir'] = "./logs/benchmarks/point_cloud_registration/kitti/BUFFER_run_2"
