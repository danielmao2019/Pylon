# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import criteria
import metrics
import optimizers
import runners.pcr_trainers

import copy
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import get_transforms_cfg
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg

optimizer_cfg = {
    'class': optimizers.SingleTaskOptimizer,
    'args': {
        'optimizer_config': {
            'class': torch.optim.Adam,
            'args': {
                'params': None,
                'lr': 1.0e-4,
                'weight_decay': 1.0e-06,
            },
        },
    },
}

scheduler_cfg = {
    'class': torch.optim.lr_scheduler.StepLR,
    'args': {
        'optimizer': None,
        'step_size': 1000,
        'gamma': 0.95,
    },
}

config = [
{
    'stage': 'Ref',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_RefStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_RefStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Desc',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_DescStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_DescStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Keypt',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_KeyptStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_KeyptStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Inlier',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_InlierStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_InlierStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
]

config[0]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['model']['args']['config']['stage'] = 'Ref'
config[1]['model']['args']['config']['stage'] = 'Desc'
config[2]['model']['args']['config']['stage'] = 'Keypt'
config[3]['model']['args']['config']['stage'] = 'Inlier'

# seeds
config[0]['init_seed'] = 87582075
config[0]['train_seeds'] = [92751298, 16273951, 78152568, 18822820, 72561738, 41518371, 91573318, 66389164, 24690371, 4970818, 26134069, 34859699, 18886822, 50034011, 91653676, 92737875, 71358956, 11863845, 15712338, 45955652, 55119011, 64996009, 40563760, 10310378, 46006279, 4859549, 98432051, 92620641, 83855841, 33687798, 76127004, 91432553, 66141277, 98186560, 92652498, 70190785, 7444522, 98702857, 95893163, 3450838, 57120426, 42053051, 19498808, 22739540, 49135465, 55314087, 28031751, 16904631, 13963777, 51132602, 79562171, 88633903, 1636746, 21175156, 58906305, 62045030, 10019498, 685036, 34109251, 27958228, 97197441, 1988716, 30189599, 94029268, 5733532, 76747588, 8914218, 82078097, 64933600, 5540907, 14255841, 36042312, 17215371, 35611101, 91693445, 41775384, 57751566, 6467461, 83062520, 31585255, 60754738, 24726954, 3409023, 1173244, 6314548, 54131531, 79341647, 6586147, 85604129, 14588965, 16850259, 51706283, 91741365, 63941595, 11512508, 84848073, 33442601, 58517401, 82438755, 18233823]
config[1]['init_seed'] = 8323361
config[1]['train_seeds'] = [46139250, 1389250, 57803831, 67619585, 24369785, 5220291, 7405170, 12506276, 13231666, 81590323, 97547811, 29383572, 76156104, 78377380, 60679775, 59664827, 49371968, 43132493, 64003303, 23045601, 23801829, 96292137, 72123219, 36551256, 12840650, 65472149, 90161043, 33152536, 65787315, 45518213, 54370444, 53573816, 66077569, 43898540, 86369948, 96217355, 59280982, 57172412, 16667346, 81219363, 83085394, 83209562, 10530266, 40022381, 9769991, 58553298, 73118480, 69254552, 45997665, 34647054, 60947826, 20314508, 59061393, 54449584, 57028661, 64860457, 80040066, 5504959, 19953691, 71291640, 62713766, 60382608, 83240493, 22664307, 11461379, 6646751, 13896181, 42452646, 40931838, 62323348, 1311164, 69323195, 98388904, 39791521, 40174336, 93608790, 85585425, 20797852, 74800510, 5174529, 94058789, 56995613, 23590357, 59116332, 44156900, 90704207, 87012251, 77300566, 56817956, 80814585, 76545435, 96891500, 77119348, 93232504, 41334225, 73292656, 12300384, 47580757, 77789781, 97424602]
config[2]['init_seed'] = 18166144
config[2]['train_seeds'] = [27871647, 53407709, 55110191, 88934746, 69551376, 85653446, 71776771, 48481123, 94190742, 7553533, 17113852, 28390513, 54056569, 53698915, 55356352, 85159256, 28728166, 33814425, 3226184, 98625638, 4076328, 11344200, 21316368, 45935617, 45749843, 49756997, 61570362, 71804431, 78796429, 97970101, 75245234, 48322851, 93787180, 66474015, 10277146, 20363802, 55441048, 3069873, 2711270, 95153270, 5788801, 3217084, 38655252, 57057261, 68499552, 88146917, 12148904, 66620074, 8390163, 73133748, 50993983, 90108468, 49739729, 33743241, 82648304, 70592746, 87705744, 52473226, 98037785, 24938177, 28232794, 43290019, 48049536, 15630394, 93803243, 92585440, 89197461, 89540664, 13686547, 58083560, 81721013, 1928268, 12362979, 87285848, 8237585, 5695241, 48664758, 75578750, 1725222, 39892389, 52955640, 68306679, 42872032, 66899103, 21124390, 81998164, 74180611, 46619925, 84209495, 46452331, 7840157, 26854909, 5769794, 1773405, 8589172, 47556012, 33565007, 60396809, 16052667, 84362778]
config[3]['init_seed'] = 30534252
config[3]['train_seeds'] = [22728636, 71509282, 50093522, 67388087, 30985922, 4860921, 16337541, 94655828, 61591863, 61053821, 82422707, 86529149, 52414926, 55588510, 56896077, 10409374, 43348826, 5402834, 8479845, 70717402, 85310896, 50327804, 87398922, 91919806, 22417465, 36136723, 5343587, 68281100, 26988143, 91954170, 52551702, 27849895, 67977648, 45427546, 77502018, 80561419, 49526263, 49434609, 47348994, 53086443, 32137904, 24865661, 74986553, 25260014, 10263259, 64437549, 72265514, 93164353, 54838981, 62900678, 25434336, 68765181, 12734954, 18288065, 76566708, 173710, 78738919, 34724454, 55179936, 16310317, 69832370, 96289359, 15107616, 12898415, 83391411, 74871720, 81894812, 59695603, 6216275, 21501022, 6851374, 5296132, 94195168, 68840314, 55083791, 11858970, 37265660, 74942832, 6180393, 16101626, 56100281, 76138615, 46973934, 97921300, 64407668, 39775028, 79775572, 75152767, 22862741, 17067347, 90543745, 80066298, 40006315, 31304226, 37089309, 81651201, 54556341, 76977860, 47462693, 84531137]

# work dir
config[0]['work_dir'] = "./logs/benchmarks/point_cloud_registration/kitti/BUFFER_run_0"
config[1]['work_dir'] = "./logs/benchmarks/point_cloud_registration/kitti/BUFFER_run_0"
config[2]['work_dir'] = "./logs/benchmarks/point_cloud_registration/kitti/BUFFER_run_0"
config[3]['work_dir'] = "./logs/benchmarks/point_cloud_registration/kitti/BUFFER_run_0"
