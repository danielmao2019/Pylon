# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.Adam,
                'args': {
                    'params': None,
                    'lr': 1.0e-4,
                    'weight_decay': 1.0e-06,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}

from runners.pcr_trainers import BufferTrainer
config['runner'] = BufferTrainer

# data config
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
config.update(train_data_cfg)
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
config.update(val_data_cfg)

# model config
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg
model_cfg['args']['config']['data']['dataset'] = 'KITTI'
config['model'] = model_cfg

from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import multi_stage_criterion_cfg
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import multi_stage_metric_cfg
multi_stage_cfg = []
import copy

ref_cfg = copy.deepcopy(config)
ref_cfg['stage'] = 'Ref'
ref_cfg['model']['args']['config']['stage'] = 'Ref'
ref_cfg['criterion'] = multi_stage_criterion_cfg[0]
ref_cfg['metric'] = multi_stage_metric_cfg[0]
multi_stage_cfg.append(ref_cfg)

# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.Adam,
                'args': {
                    'params': None,
                    'lr': 1.0e-4,
                    'weight_decay': 1.0e-06,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}

from runners.pcr_trainers import BufferTrainer
config['runner'] = BufferTrainer

# data config
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
config.update(train_data_cfg)
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
config.update(val_data_cfg)

# model config
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg
model_cfg['args']['config']['data']['dataset'] = 'KITTI'
config['model'] = model_cfg

desc_cfg = copy.deepcopy(config)
desc_cfg['stage'] = 'Desc'
desc_cfg['model']['args']['config']['stage'] = 'Desc'
desc_cfg['criterion'] = multi_stage_criterion_cfg[1]
desc_cfg['metric'] = multi_stage_metric_cfg[1]
multi_stage_cfg.append(desc_cfg)

# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.Adam,
                'args': {
                    'params': None,
                    'lr': 1.0e-4,
                    'weight_decay': 1.0e-06,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}

from runners.pcr_trainers import BufferTrainer
config['runner'] = BufferTrainer

# data config
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
config.update(train_data_cfg)
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
config.update(val_data_cfg)

# model config
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg
model_cfg['args']['config']['data']['dataset'] = 'KITTI'
config['model'] = model_cfg

keypt_cfg = copy.deepcopy(config)
keypt_cfg['stage'] = 'Keypt'
keypt_cfg['model']['args']['config']['stage'] = 'Keypt'
keypt_cfg['criterion'] = multi_stage_criterion_cfg[2]
keypt_cfg['metric'] = multi_stage_metric_cfg[2]
multi_stage_cfg.append(keypt_cfg)

# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.Adam,
                'args': {
                    'params': None,
                    'lr': 1.0e-4,
                    'weight_decay': 1.0e-06,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}

from runners.pcr_trainers import BufferTrainer
config['runner'] = BufferTrainer

# data config
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
config.update(train_data_cfg)
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
config.update(val_data_cfg)

# model config
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg
model_cfg['args']['config']['data']['dataset'] = 'KITTI'
config['model'] = model_cfg

inlier_cfg = copy.deepcopy(config)
inlier_cfg['stage'] = 'Inlier'
inlier_cfg['model']['args']['config']['stage'] = 'Inlier'
inlier_cfg['criterion'] = multi_stage_criterion_cfg[3]
inlier_cfg['metric'] = multi_stage_metric_cfg[3]
multi_stage_cfg.append(inlier_cfg)
config = multi_stage_cfg

# seeds
config[0]['init_seed'] = 47520536
config[0]['train_seeds'] = [65194965, 9647072, 9887014, 53202315, 20730194, 56449352, 58147236, 12705153, 64914119, 8327781, 3514937, 54371703, 94161092, 44452619, 47442603, 47711900, 38036432, 9695783, 13882082, 67085300, 75738670, 26235074, 9658533, 14992789, 39325594, 26583521, 84160441, 62261370, 41112011, 30266153, 51603487, 98949238, 42401535, 64731873, 1679815, 38316876, 25279346, 43985117, 9661484, 61106759, 32575048, 82551110, 27828375, 74608359, 85300149, 92708014, 14442735, 60032466, 75365449, 42403822, 49012800, 54983960, 5981255, 37244068, 61470172, 38362554, 50771919, 90491683, 28559186, 93753729, 11658217, 257097, 67048739, 22857741, 62723162, 38192747, 31826272, 27246377, 23209944, 39743864, 62793670, 15636807, 24495659, 82178725, 19298913, 17896422, 38366346, 62693816, 12642209, 79791571, 59106836, 32742338, 52725485, 30536132, 69968258, 11462388, 1004172, 31817661, 91826275, 52407389, 74545796, 58708976, 3034675, 99396214, 94917052, 75619534, 984710, 33247607, 61270167, 27646088]
config[1]['init_seed'] = 86832331
config[1]['train_seeds'] = [49780548, 85871591, 67771844, 77157896, 85870596, 56102099, 85516421, 77796994, 78152700, 51893111, 60284632, 38446493, 37538054, 98345015, 18357102, 95277941, 8698356, 17300421, 20301541, 91178497, 30085708, 4134439, 71666721, 4881638, 52764106, 69138385, 82976568, 17506626, 82983795, 89252943, 91119650, 60658294, 21084951, 32702572, 50202883, 13970005, 51559833, 66086277, 77811913, 49907988, 40447189, 40900037, 48679784, 74225466, 94989058, 43555463, 83925492, 45787286, 50187822, 79764417, 10269986, 21178617, 73215083, 36178965, 38091460, 6973343, 43627111, 35950796, 99146158, 43603509, 29503332, 70562087, 13158333, 73871771, 83209069, 43966470, 86360694, 43541652, 18348063, 73876747, 39392840, 31110907, 76777583, 40104104, 73351395, 49440777, 93760006, 41283077, 27685605, 54189443, 822214, 13265100, 71305332, 80222593, 75828186, 39793611, 20626055, 66771981, 3152927, 11153310, 72015849, 75604616, 40004974, 60406149, 86676186, 71302540, 19134020, 70067513, 58619980, 20229836]
config[2]['init_seed'] = 4792112
config[2]['train_seeds'] = [65891566, 57781275, 81741024, 67510912, 31908296, 54747165, 35214698, 2441177, 72751677, 30503583, 91127884, 29121671, 30905683, 78398337, 43665576, 75146218, 57837000, 250555, 69575915, 92819227, 10690613, 4528601, 16851042, 90232073, 70580753, 18312925, 50651469, 21477558, 10200351, 58617876, 15614047, 96384158, 62323732, 90915080, 91224268, 21153301, 8966241, 71304870, 25216773, 54692737, 16343840, 43429505, 67646873, 94387346, 58025592, 89916346, 69347739, 92124476, 93818756, 50850259, 24445808, 34016724, 43459955, 14677680, 47169144, 10691452, 77800929, 31574822, 99744357, 84110592, 44811190, 14207363, 674615, 3876429, 311070, 39121354, 70261219, 62905759, 35961300, 8615150, 86868256, 5853957, 16029034, 52867795, 98240250, 26404760, 20456727, 95023363, 43740328, 99479117, 8462351, 66390793, 26307234, 52302162, 80352703, 19589138, 89236598, 38610690, 8824967, 76934862, 84123279, 39218819, 73539079, 50890435, 22659214, 30275675, 73229531, 98741454, 18680947, 77227945]
config[3]['init_seed'] = 85997094
config[3]['train_seeds'] = [99858415, 66206771, 80100924, 19332635, 33420079, 79059035, 53837297, 11778775, 359200, 95474205, 24781089, 50430697, 1056617, 87579699, 35812073, 85558975, 56322781, 50355382, 24797245, 18030607, 63952699, 61549885, 22363791, 57351149, 17035535, 73394798, 6188110, 55238678, 99264848, 32926395, 73121092, 85905671, 56633275, 15765495, 94312986, 93445203, 3922809, 56363111, 35338569, 72513826, 75741736, 51016428, 84668218, 47073455, 53099463, 24791473, 28579249, 70695075, 24776744, 82566097, 60498347, 39786077, 27152271, 83437471, 67160473, 55395709, 9950904, 82227818, 28337231, 38001172, 23482767, 82721529, 53244796, 42314581, 58928640, 13002694, 83083259, 62980207, 24558198, 17868902, 85731044, 37749456, 62412802, 76147187, 25682951, 55958951, 48532497, 7742824, 91382251, 11988067, 73752886, 90187274, 2047988, 31092543, 93253026, 32710408, 31909070, 30134652, 55153594, 6843810, 9892963, 87600066, 96973545, 12277611, 516338, 75334659, 45358832, 83777113, 40123237, 54498583]

# work dir
config[0]['work_dir'] = "./logs/benchmarks/point_cloud_registration/kitti/BUFFER_run_1"
config[1]['work_dir'] = "./logs/benchmarks/point_cloud_registration/kitti/BUFFER_run_1"
config[2]['work_dir'] = "./logs/benchmarks/point_cloud_registration/kitti/BUFFER_run_1"
config[3]['work_dir'] = "./logs/benchmarks/point_cloud_registration/kitti/BUFFER_run_1"
