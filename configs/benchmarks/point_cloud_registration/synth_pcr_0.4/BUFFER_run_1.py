# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import criteria
import metrics
import optimizers
import runners.pcr_trainers

import copy
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import get_transforms_cfg
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg

optimizer_cfg = {
    'class': optimizers.SingleTaskOptimizer,
    'args': {
        'optimizer_config': {
            'class': torch.optim.Adam,
            'args': {
                'params': None,
                'lr': 1.0e-4,
                'weight_decay': 1.0e-06,
            },
        },
    },
}

scheduler_cfg = {
    'class': torch.optim.lr_scheduler.StepLR,
    'args': {
        'optimizer': None,
        'step_size': 1000,
        'gamma': 0.95,
    },
}

config = [
{
    'stage': 'Ref',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_RefStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_RefStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Desc',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_DescStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_DescStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Keypt',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_KeyptStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_KeyptStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Inlier',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_InlierStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_InlierStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
]

config[0]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['model']['args']['config']['stage'] = 'Ref'
config[1]['model']['args']['config']['stage'] = 'Desc'
config[2]['model']['args']['config']['stage'] = 'Keypt'
config[3]['model']['args']['config']['stage'] = 'Inlier'

# seeds
config[0]['init_seed'] = 92585173
config[0]['train_seeds'] = [15130950, 78242226, 30650123, 62810409, 45026822, 80327271, 66684957, 92758014, 27146597, 91074844, 37439156, 80340611, 44361616, 52978097, 80881550, 50642753, 3135483, 43663609, 68779892, 35546379, 84774561, 29853236, 42782018, 37279388, 81017843, 20737087, 94559957, 36364857, 57969129, 31149345, 79134134, 31401693, 399463, 7884216, 63968315, 18622233, 55195337, 10998928, 89482528, 28562850, 50816538, 5905638, 86108293, 37491591, 85486591, 68872080, 33460598, 8631620, 74519888, 65789973, 17506459, 47781888, 94932214, 70106368, 31458964, 84341143, 5527403, 39644950, 45637054, 39898925, 78547548, 58064885, 13665203, 57957103, 45989340, 89847914, 55064394, 67359549, 78271910, 39927347, 79773800, 92740464, 76589498, 57160118, 54637352, 10843016, 93700018, 82991371, 12911479, 49998703, 52253624, 9601313, 63470012, 87099881, 74529668, 47988873, 9012782, 10179027, 35508710, 77362228, 73506008, 72668577, 28674722, 39832771, 19913780, 96664226, 53896450, 38854833, 72121353, 47999032]
config[0]['val_seeds'] = [96973631, 85134188, 5186021, 43377739, 794784, 57194573, 2455130, 8361556, 11868116, 3350719, 99937420, 90415424, 77898213, 95308114, 33740947, 90170623, 49309764, 98896797, 730997, 99676353, 1398745, 67180179, 35005851, 21368692, 4216765, 45773698, 43396731, 13456485, 6153812, 24873545, 73416653, 67462681, 7265014, 90233959, 18870885, 75904314, 91706114, 81645554, 37797748, 15006769, 56992828, 34308572, 67993367, 76762356, 2472897, 36561291, 638738, 24782483, 45073094, 22146135, 9393787, 9431319, 21234353, 16357728, 8400883, 49665109, 47130103, 82454271, 67976704, 31077236, 97776468, 87097154, 8617868, 96258022, 84476400, 17351607, 65244458, 1666557, 88172634, 99894123, 81024613, 78799891, 34483720, 63317567, 17332383, 52362910, 277478, 14943937, 63401867, 86182511, 72399372, 70455813, 33508198, 58541534, 69871792, 44373249, 83029924, 24897147, 3926919, 25120878, 75855570, 93260908, 47524896, 51050561, 61372577, 19686121, 30985338, 31950236, 78419818, 9306376]
config[0]['test_seed'] = 41788195
config[1]['init_seed'] = 90644951
config[1]['train_seeds'] = [74525120, 56123683, 79221250, 27381016, 92217542, 99657052, 68550811, 81414935, 8991450, 54491938, 95751979, 51167190, 51228624, 25797778, 41488408, 54955454, 8498632, 6398441, 40447248, 40697688, 38739088, 93478687, 59693319, 16843822, 27315433, 65243188, 44932365, 79839659, 2158819, 22917777, 2934004, 19325945, 24940960, 49054460, 4801710, 69338773, 41343700, 36324997, 62167303, 66362894, 53516780, 52828793, 36516499, 90610673, 43059028, 60516024, 44756914, 5993765, 26781388, 7764320, 99959780, 35110852, 84689139, 71730697, 35763423, 68421319, 12699903, 20050646, 79121688, 20220481, 45156648, 1212831, 92954826, 38299936, 88323094, 92249804, 8633030, 7072775, 23028176, 91257633, 99814370, 5844195, 61876530, 39341445, 32947781, 83028154, 78715294, 34211661, 87826815, 60331606, 49537707, 83735691, 15361336, 34961575, 24886368, 98498460, 83862518, 35081324, 51238628, 21953468, 50137962, 99952550, 185731, 85920147, 19713511, 67181032, 9284399, 82916769, 71875079, 73378705]
config[1]['val_seeds'] = [42245724, 22495222, 33241629, 2889127, 43868401, 68961303, 12670371, 1522928, 35776686, 66972414, 23554078, 61941972, 98084466, 20987903, 54198588, 88734803, 97458333, 97993931, 26169533, 83409586, 10613887, 46883765, 83269919, 73475959, 84546259, 50828381, 52913476, 43952213, 13359648, 15580041, 21287582, 87649324, 854841, 88212824, 17153774, 20112854, 86433847, 99116438, 48718595, 58019461, 68459594, 35332647, 89086458, 43723081, 58666612, 62469010, 36881131, 93661217, 33183388, 66882507, 5903096, 87360933, 80914353, 87774593, 40041917, 87546610, 11068789, 37948013, 21163559, 19693334, 41208497, 81089026, 89829513, 3690744, 86111132, 50949844, 51056627, 81687355, 92981114, 20258301, 32216164, 89838717, 48911018, 73099209, 71973853, 53362023, 15247057, 86774617, 7178023, 20389231, 59672300, 64534413, 18297404, 49273117, 28321552, 39940743, 10378689, 21700070, 59622415, 17557198, 33968065, 2901791, 35347457, 91941314, 76384062, 81446597, 63141131, 96496540, 39231398, 3038475]
config[1]['test_seed'] = 55716227
config[2]['init_seed'] = 25384807
config[2]['train_seeds'] = [48632175, 71029633, 55685988, 5918492, 22860414, 78004089, 22359483, 89844397, 44937331, 35983914, 14956371, 23107506, 28616176, 29546527, 12714833, 44211657, 94869855, 51660145, 32494527, 15024796, 12309376, 33325513, 22651326, 20849818, 58447778, 51632384, 27700748, 43135709, 22169074, 99922255, 18158443, 54935589, 4964225, 39331280, 14822425, 85248215, 49427545, 67383924, 79626201, 2086184, 81630040, 54323215, 44737463, 15650159, 40685136, 58034393, 56353309, 52444719, 71455164, 4255863, 52180076, 74335874, 13825316, 10598149, 27449584, 1874061, 47021245, 1749524, 44244468, 47308556, 42930338, 62844544, 73965849, 55524361, 83394589, 85679138, 53892116, 71462851, 79826739, 81799124, 24311436, 34616546, 45670179, 76048109, 49151538, 50124740, 77918677, 43588366, 31251339, 83786452, 17100469, 90790738, 74261895, 13495990, 30155876, 89299091, 25621846, 38187708, 47819426, 4078172, 7306094, 25977988, 29314906, 28761580, 97526199, 76455664, 1772990, 64535375, 8221290, 51717612]
config[2]['val_seeds'] = [80137258, 49360956, 27686053, 52346296, 69085272, 5494706, 66374674, 17375418, 71630466, 75581824, 37296770, 95380104, 58657124, 32800244, 66643065, 85904932, 76671468, 71222723, 55057996, 9877430, 55573821, 7709317, 1426547, 52484597, 4504660, 73191712, 94960049, 83108187, 53729031, 30984315, 42822800, 77653281, 24899739, 23471127, 53814022, 87344050, 91194330, 20534415, 64837003, 81709395, 63597869, 65634590, 37688833, 8164501, 18651857, 92376485, 52809654, 37163157, 76338435, 5936858, 87742719, 50983740, 52764152, 14652488, 49798616, 42620862, 57225419, 77121161, 97221019, 92220000, 82267524, 99244918, 8104057, 99580653, 21378853, 57345764, 1813558, 2685133, 91237178, 2932914, 35663265, 49513329, 12858842, 50937083, 88100565, 54472011, 38774368, 16517427, 29411092, 31221684, 58407965, 61400911, 1435323, 9315048, 14396783, 97357466, 39585540, 55963509, 18526301, 61845843, 92669054, 63439530, 68363938, 58384809, 10676932, 44678864, 66230765, 93243288, 6265933, 4476460]
config[2]['test_seed'] = 71213729
config[3]['init_seed'] = 43635372
config[3]['train_seeds'] = [2044626, 45290623, 42112143, 98419466, 87057445, 98420071, 6433418, 38921522, 70762735, 74156859, 12843155, 75113096, 8505547, 58534993, 68942345, 70005200, 70741332, 12352102, 59514588, 79568160, 1026804, 66998735, 59603901, 43183855, 57706388, 77705084, 36908424, 68490623, 83146888, 76984072, 17686014, 10415615, 95126894, 4470264, 58090415, 11257998, 70215475, 42312238, 29037707, 80595259, 88002020, 76734284, 11652733, 20833070, 13647691, 37577638, 33190388, 99385081, 81710514, 58439011, 72977381, 56327223, 20552291, 10086493, 88389312, 243951, 91983962, 70535648, 72398336, 53597136, 98251784, 23260832, 56267854, 83806185, 38623748, 60688866, 8164434, 19062424, 79334188, 96029744, 88000485, 98917233, 16991644, 91578250, 78451493, 12200329, 44626379, 54031808, 61684709, 72952020, 19622701, 17317831, 91493465, 40455104, 49653365, 83654714, 66925838, 62095467, 23389977, 69944842, 58503981, 26240651, 40213361, 54129136, 57589326, 98485909, 96429151, 21648109, 75637560, 75062395]
config[3]['val_seeds'] = [78697816, 34074265, 6809364, 87756742, 98172025, 68898276, 41174501, 50340464, 58909756, 63641583, 86605566, 18441346, 88669334, 53233893, 95621637, 2501650, 24123421, 38437275, 21670959, 38422036, 480952, 81518399, 48555942, 17560368, 72166821, 60453539, 83875403, 17066169, 89391372, 95524708, 49386651, 23472163, 82600026, 58816968, 56358685, 59973792, 29233685, 58886016, 36205206, 25534060, 3195846, 54326320, 97752669, 89954562, 60558218, 66420568, 58661634, 82621601, 57978415, 16309110, 77124611, 83541383, 86634457, 31096461, 69982771, 13667012, 5571526, 21837480, 8708060, 81524636, 12159194, 85348028, 93055944, 70752516, 95147920, 73622102, 21817481, 69192514, 39616385, 45669493, 73654367, 85227958, 59105007, 30749372, 80050752, 92252452, 72493854, 74474791, 50024272, 68614715, 92104849, 57334476, 11402674, 12107402, 33469081, 17443636, 16081728, 21455378, 39630023, 45482238, 95631335, 56695616, 23061322, 89561831, 5233523, 19455848, 58871863, 83645858, 22387109, 62673142]
config[3]['test_seed'] = 73212106

# work dir
config[0]['work_dir'] = "./logs/benchmarks/point_cloud_registration/synth_pcr_0.4/BUFFER_run_1"
config[1]['work_dir'] = "./logs/benchmarks/point_cloud_registration/synth_pcr_0.4/BUFFER_run_1"
config[2]['work_dir'] = "./logs/benchmarks/point_cloud_registration/synth_pcr_0.4/BUFFER_run_1"
config[3]['work_dir'] = "./logs/benchmarks/point_cloud_registration/synth_pcr_0.4/BUFFER_run_1"
