# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
from torch.optim.adam import Adam
from torch.optim.lr_scheduler import StepLR
from criteria.vision_3d.point_cloud_registration.buffer_criteria.desc_stage_criterion import BUFFER_DescStageCriterion
from criteria.vision_3d.point_cloud_registration.buffer_criteria.inlier_stage_criterion import BUFFER_InlierStageCriterion
from criteria.vision_3d.point_cloud_registration.buffer_criteria.keypt_stage_criterion import BUFFER_KeyptStageCriterion
from criteria.vision_3d.point_cloud_registration.buffer_criteria.ref_stage_criterion import BUFFER_RefStageCriterion
from data.dataloaders.buffer_dataloader import BufferDataloader
from data.datasets.pcr_datasets.kitti_dataset import KITTIDataset
from data.transforms.compose import Compose
from data.transforms.identity import Identity
from data.transforms.vision_3d.clamp import Clamp
from data.transforms.vision_3d.downsample import DownSample
from data.transforms.vision_3d.estimate_normals import EstimateNormals
from data.transforms.vision_3d.random_rigid_transform import RandomRigidTransform
from data.transforms.vision_3d.shuffle import Shuffle
from data.transforms.vision_3d.uniform_pos_noise import UniformPosNoise
from metrics.vision_3d.point_cloud_registration.buffer_metrics.desc_stage_metric import BUFFER_DescStageMetric
from metrics.vision_3d.point_cloud_registration.buffer_metrics.inlier_stage_metric import BUFFER_InlierStageMetric
from metrics.vision_3d.point_cloud_registration.buffer_metrics.keypt_stage_metric import BUFFER_KeyptStageMetric
from metrics.vision_3d.point_cloud_registration.buffer_metrics.ref_stage_metric import BUFFER_RefStageMetric
from models.point_cloud_registration.buffer.buffer import BUFFER
from optimizers.single_task_optimizer import SingleTaskOptimizer
from runners.pcr_trainers.buffer_trainer import BufferTrainer


config = [{
    'stage': 'Ref',
    'runner': BufferTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/bi_temporal_pcr_1.0/BUFFER_run_0',
    'epochs': 100,
    'init_seed': 93840279,
    'train_seeds': [83471678, 50370288, 10458096, 91844691, 35604856, 88033294, 23689807, 43131496, 83573250, 76180644, 33680703, 70074086, 69228077, 72839204, 3613812, 93941578, 36156007, 92447455, 95135341, 70747746, 36513691, 35042587, 98626247, 95208684, 58529957, 15286458, 23179460, 97622655, 12117619, 44833587, 47909173, 41460487, 53382293, 24151911, 6470002, 19723813, 17227561, 19410661, 82254988, 52981977, 82397441, 50053568, 45104832, 70685095, 63447467, 78931690, 63026849, 70658684, 30767155, 393412, 51778127, 24645533, 66473271, 67850292, 90839412, 22472, 20539794, 77924972, 10234607, 49724937, 68605688, 597658, 90314790, 41599321, 92081823, 34614615, 29902632, 94461438, 13029284, 88520526, 28722910, 71371844, 34684362, 18813451, 93849043, 76997872, 18892102, 23302308, 11032813, 90486394, 81224822, 21817848, 30887642, 26054731, 40515006, 75810423, 44097541, 65353035, 13677312, 17667756, 53572121, 181962, 10291529, 89997107, 90456330, 47097595, 92000762, 81761706, 37209528, 54016915],
    'val_seeds': [10044192, 16188263, 90422623, 72984057, 14760682, 32835396, 59406882, 25648043, 6927471, 79175259, 36207674, 58720189, 46329767, 37593475, 38317571, 72774342, 15615100, 46136988, 71042633, 50277454, 95848220, 66754770, 29759393, 17106387, 79043849, 73328483, 69527130, 99971678, 58759596, 50676812, 25716301, 32583037, 30394064, 60702004, 36466567, 42362841, 28643149, 24878324, 8262672, 28744117, 62371865, 85411265, 13597984, 73076179, 44536833, 88151792, 88903195, 98879446, 74880952, 71361511, 96341217, 9863557, 20077844, 90242543, 20879595, 56457684, 63317047, 61137652, 81545256, 91135573, 64435223, 78550662, 7609691, 51513378, 26800750, 89967637, 46660616, 89609730, 65954989, 64772521, 2403913, 78523720, 96196609, 80408420, 14839950, 59081917, 59389222, 47410588, 44681739, 14419691, 86102399, 8528813, 45789041, 6943836, 19272993, 42727247, 42672271, 64045114, 71455281, 99959046, 98511448, 96088516, 53446981, 77368050, 52535272, 26390691, 73015168, 33295148, 97268149, 67715868],
    'test_seed': 89386071,
    'train_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'train_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'criterion': {
        'class': BUFFER_RefStageCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'val_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': BUFFER_RefStageMetric,
        'args': {},
    },
    'model': {
        'class': BUFFER,
        'args': {
            'config': {
                'stage': 'Ref',
                'data': {
                    'voxel_size_0': 0.3,
                    'dataset': 'KITTI',
                },
                'train': {
                    'pos_num': 512,
                },
                'test': {
                    'scale': 1.0,
                    'pose_refine': False,
                },
                'point': {
                    'in_feats_dim': 3,
                    'first_feats_dim': 32,
                    'conv_radius': 2.0,
                    'keypts_th': 0.5,
                    'num_keypts': 1500,
                },
                'patch': {
                    'des_r': 3.0,
                    'num_points_per_patch': 512,
                    'rad_n': 3,
                    'azi_n': 20,
                    'ele_n': 7,
                    'delta': 0.8,
                    'voxel_sample': 10,
                },
                'match': {
                    'dist_th': 0.3,
                    'inlier_th': 2.0,
                    'similar_th': 0.9,
                    'confidence': 1.0,
                    'iter_n': 50000,
                },
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}, {
    'stage': 'Desc',
    'runner': BufferTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/bi_temporal_pcr_1.0/BUFFER_run_0',
    'epochs': 100,
    'init_seed': 59115183,
    'train_seeds': [5535951, 87907780, 51053388, 1927842, 89849539, 81087699, 64505784, 13765202, 2338338, 76225357, 68110250, 16605010, 25309343, 88822052, 24360266, 86575559, 67550621, 34194332, 68541475, 44293320, 81267376, 64224256, 79798631, 50113713, 51184497, 27229743, 55342899, 65072017, 90476218, 81523676, 44703970, 90301270, 22338396, 60466657, 40501576, 88087102, 88632005, 11325596, 36595004, 84443018, 34981714, 56651702, 89986557, 41895019, 64624949, 3167676, 49759334, 73743962, 78346560, 37897416, 13095040, 57726672, 71647081, 43832802, 13260975, 38456191, 57698112, 88997945, 31069442, 98691000, 15777804, 74256032, 94699376, 87962099, 460630, 61649446, 19403886, 55863329, 8974660, 27662839, 34410310, 46573680, 23367831, 21698184, 41536681, 51137576, 5922949, 35667356, 70197919, 20828513, 10884835, 6661043, 2469014, 511298, 31018823, 14065631, 55435337, 75798218, 51595822, 11010281, 85494281, 85308302, 71399205, 97068899, 33739588, 7811353, 69173054, 48089196, 24911365, 21548207],
    'val_seeds': [18192750, 70014074, 45513144, 82715253, 35488377, 91391764, 52802370, 79621396, 7549698, 80912481, 35564375, 40318662, 2305050, 71723442, 23013408, 46088559, 65187922, 16005682, 27238185, 89361890, 29056859, 42113956, 54732615, 45377534, 6762901, 11621750, 90364804, 63010714, 96369254, 77301130, 4170242, 60185297, 34272744, 36051758, 27137028, 54154241, 74219983, 38035717, 99814648, 28439326, 76324430, 30885631, 1385964, 72463246, 93358334, 55753451, 6662998, 72933133, 23534672, 8854079, 76758260, 45383970, 31361959, 47411242, 35371196, 63977625, 93769557, 69312198, 84806997, 45018968, 98453710, 27227938, 63200022, 48090218, 46268117, 19203126, 84942197, 84509247, 6499342, 66644504, 77964346, 9116993, 66552270, 61726506, 69342955, 63173606, 50189148, 31593517, 18899117, 89427566, 26583674, 12964368, 21616036, 38630855, 10553145, 55152962, 29663057, 86713586, 70186269, 24783532, 33346750, 29374016, 66984479, 83762137, 34475153, 64842883, 50715341, 15932287, 3172327, 63626046],
    'test_seed': 24118934,
    'train_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'train_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'criterion': {
        'class': BUFFER_DescStageCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'val_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': BUFFER_DescStageMetric,
        'args': {},
    },
    'model': {
        'class': BUFFER,
        'args': {
            'config': {
                'stage': 'Desc',
                'data': {
                    'voxel_size_0': 0.3,
                    'dataset': 'KITTI',
                },
                'train': {
                    'pos_num': 512,
                },
                'test': {
                    'scale': 1.0,
                    'pose_refine': False,
                },
                'point': {
                    'in_feats_dim': 3,
                    'first_feats_dim': 32,
                    'conv_radius': 2.0,
                    'keypts_th': 0.5,
                    'num_keypts': 1500,
                },
                'patch': {
                    'des_r': 3.0,
                    'num_points_per_patch': 512,
                    'rad_n': 3,
                    'azi_n': 20,
                    'ele_n': 7,
                    'delta': 0.8,
                    'voxel_sample': 10,
                },
                'match': {
                    'dist_th': 0.3,
                    'inlier_th': 2.0,
                    'similar_th': 0.9,
                    'confidence': 1.0,
                    'iter_n': 50000,
                },
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}, {
    'stage': 'Keypt',
    'runner': BufferTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/bi_temporal_pcr_1.0/BUFFER_run_0',
    'epochs': 100,
    'init_seed': 58223017,
    'train_seeds': [63749477, 29626862, 45562881, 76025506, 33525847, 51565608, 64144320, 23756587, 28143417, 96684322, 43893086, 82459081, 33899767, 26481949, 15656976, 39808500, 32042646, 62900773, 31398841, 29351523, 38604079, 87215127, 59937749, 44557219, 55129118, 42112044, 51370986, 46970753, 48133053, 25905836, 38610882, 68991278, 1103620, 38779997, 69635908, 47548276, 91625802, 46991093, 50426724, 88923213, 26860641, 96787506, 71615717, 11016817, 65596219, 82580305, 47906296, 91616550, 60225784, 42294200, 12291444, 675056, 46452099, 88659981, 39360370, 50773759, 97888798, 54260045, 90786599, 3592130, 42343219, 77346550, 81544876, 12607643, 83647821, 88757679, 78380995, 35359444, 40178122, 46094739, 72244746, 28984139, 13375376, 10029074, 96556952, 82388136, 43700155, 32483844, 62208462, 68599191, 32816782, 39677252, 27595453, 34695351, 64171663, 37486046, 56857454, 93780241, 39194679, 81106539, 93110108, 58779379, 39955067, 96418269, 73311354, 33482044, 80226875, 7255424, 7425614, 69176507],
    'val_seeds': [62608889, 84572985, 74297343, 9746855, 31230029, 84494060, 18226862, 53685192, 83496794, 64352032, 6791869, 80493082, 22250950, 61431204, 97742199, 64886458, 70537952, 19422965, 37568487, 99527775, 17638182, 4889988, 98541559, 16329572, 54401348, 11149703, 38680823, 2451276, 48417885, 31955885, 27213360, 80944741, 3408074, 38621929, 95272043, 98506669, 38366669, 76021080, 39597532, 58601939, 32522087, 3900380, 22073484, 78795352, 90906052, 64847428, 36361670, 98762337, 63699743, 67035831, 71128835, 55800319, 15678141, 12228688, 39360675, 22294650, 83386608, 31275419, 45810132, 7889976, 41606655, 95516849, 5402805, 92187959, 57634920, 73105535, 86537714, 66045254, 52545042, 21176221, 88293870, 52920258, 49225107, 18982305, 31384213, 11321292, 72663482, 86982924, 19162955, 66617616, 40713142, 33089840, 51950088, 64604040, 41452755, 66119174, 38699741, 78590749, 12294381, 71318518, 1534175, 25162650, 17522636, 86248230, 54161419, 49796585, 72694267, 16561163, 24062751, 78758248],
    'test_seed': 14025988,
    'train_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'train_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'criterion': {
        'class': BUFFER_KeyptStageCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'val_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': BUFFER_KeyptStageMetric,
        'args': {},
    },
    'model': {
        'class': BUFFER,
        'args': {
            'config': {
                'stage': 'Keypt',
                'data': {
                    'voxel_size_0': 0.3,
                    'dataset': 'KITTI',
                },
                'train': {
                    'pos_num': 512,
                },
                'test': {
                    'scale': 1.0,
                    'pose_refine': False,
                },
                'point': {
                    'in_feats_dim': 3,
                    'first_feats_dim': 32,
                    'conv_radius': 2.0,
                    'keypts_th': 0.5,
                    'num_keypts': 1500,
                },
                'patch': {
                    'des_r': 3.0,
                    'num_points_per_patch': 512,
                    'rad_n': 3,
                    'azi_n': 20,
                    'ele_n': 7,
                    'delta': 0.8,
                    'voxel_sample': 10,
                },
                'match': {
                    'dist_th': 0.3,
                    'inlier_th': 2.0,
                    'similar_th': 0.9,
                    'confidence': 1.0,
                    'iter_n': 50000,
                },
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}, {
    'stage': 'Inlier',
    'runner': BufferTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/bi_temporal_pcr_1.0/BUFFER_run_0',
    'epochs': 100,
    'init_seed': 87246294,
    'train_seeds': [435610, 39408186, 20768143, 30274519, 79457899, 75878104, 18315272, 47364546, 54658397, 75946059, 43139517, 96123592, 35369416, 98179295, 10961968, 89959738, 58327537, 83831615, 50461440, 74925220, 28303585, 27371008, 10579022, 90339933, 85470766, 81972661, 34103039, 32002270, 59158325, 63357371, 39968515, 40817453, 18396138, 86308301, 25065639, 4914631, 91185095, 14585406, 61212324, 45919558, 18576905, 70765243, 34723163, 92561562, 24367132, 22180218, 76527175, 52681093, 60810851, 43188465, 40779506, 16267275, 66963248, 81275881, 86011950, 16173965, 18485732, 88482295, 87047743, 68966998, 11065307, 37078971, 89393808, 28195235, 92191375, 34087694, 11228707, 41577892, 18838610, 92126535, 65297678, 82235318, 99630329, 46297005, 99232062, 48902723, 66619605, 40231934, 12056084, 56677823, 4102629, 41823478, 59684977, 87605196, 95217243, 51416354, 36099346, 22594447, 10251542, 75388683, 5674756, 196970, 87890359, 20380832, 74247842, 40278895, 17051701, 66961197, 47776485, 25383564],
    'val_seeds': [55958786, 11066838, 5784465, 7580893, 7993568, 15839263, 99473917, 44687649, 8449147, 83353118, 91433531, 1242851, 22323862, 50909443, 14147118, 34446166, 72137880, 3660318, 75879137, 56234113, 13503106, 25813797, 71489090, 457700, 80620757, 24311252, 6247891, 5066993, 75981024, 29767449, 66792559, 26152659, 988553, 39887442, 87606407, 72706758, 4822619, 61137709, 19398795, 40505413, 51751778, 11200297, 86460315, 91180629, 36045408, 58970617, 39060587, 48137236, 48367394, 70585962, 86049863, 15775048, 15987631, 96733309, 62416374, 66031946, 59652143, 43364654, 85072566, 71780084, 1848840, 3592553, 41394938, 42152157, 46289909, 86025202, 95034148, 13082406, 15737192, 48071214, 51812785, 43952185, 67824616, 1100165, 43957396, 47568328, 5068855, 4294740, 14946702, 24921580, 33498507, 19149314, 92872206, 19242576, 31600883, 92521259, 16391999, 90086957, 34455756, 60632089, 30457516, 52810665, 63498966, 49629709, 70079232, 18228656, 7552458, 47178900, 49207306, 57713762],
    'test_seed': 26488251,
    'train_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'train_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'criterion': {
        'class': BUFFER_InlierStageCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'val_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': BUFFER_InlierStageMetric,
        'args': {},
    },
    'model': {
        'class': BUFFER,
        'args': {
            'config': {
                'stage': 'Inlier',
                'data': {
                    'voxel_size_0': 0.3,
                    'dataset': 'KITTI',
                },
                'train': {
                    'pos_num': 512,
                },
                'test': {
                    'scale': 1.0,
                    'pose_refine': False,
                },
                'point': {
                    'in_feats_dim': 3,
                    'first_feats_dim': 32,
                    'conv_radius': 2.0,
                    'keypts_th': 0.5,
                    'num_keypts': 1500,
                },
                'patch': {
                    'des_r': 3.0,
                    'num_points_per_patch': 512,
                    'rad_n': 3,
                    'azi_n': 20,
                    'ele_n': 7,
                    'delta': 0.8,
                    'voxel_sample': 10,
                },
                'match': {
                    'dist_th': 0.3,
                    'inlier_th': 2.0,
                    'similar_th': 0.9,
                    'confidence': 1.0,
                    'iter_n': 50000,
                },
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}]
