# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.Adam,
                'args': {
                    'params': None,
                    'lr': 1.0e-4,
                    'weight_decay': 1.0e-06,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# data config
from configs.common.datasets.point_cloud_registration.train.overlappredator_synth_pcr_data_cfg import data_cfg as train_data_cfg
train_data_cfg['train_dataset']['args']['overlap'] = 0.4
config.update(train_data_cfg)
from configs.common.datasets.point_cloud_registration.val.overlappredator_synth_pcr_data_cfg import data_cfg as val_data_cfg
val_data_cfg['val_dataset']['args']['overlap'] = 0.4
config.update(val_data_cfg)

# model config
from configs.common.models.point_cloud_registration.overlappredator_cfg import model_cfg
config['model'] = model_cfg

from configs.common.criteria.point_cloud_registration.overlappredator_criterion_cfg import criterion_cfg
config['criterion'] = criterion_cfg

from configs.common.metrics.point_cloud_registration.overlappredator_metric_cfg import metric_cfg
config['metric'] = metric_cfg

# seeds
config['init_seed'] = 91253885
config['train_seeds'] = [71413919, 47052508, 34064804, 60946762, 28738075, 95161680, 11884358, 69211386, 63417791, 72301417, 56470023, 28535723, 37275071, 39817153, 14994320, 5745500, 31515577, 8694073, 66600436, 76393564, 24486333, 67681668, 78540156, 74551568, 84484155, 26158564, 90324474, 29850792, 6123123, 67428960, 23709492, 50075948, 39589625, 39650906, 98580145, 88021241, 71636171, 49139710, 76422964, 29813745, 10369214, 97702719, 87566988, 71159294, 97279790, 34998493, 28663955, 55364913, 34186266, 13784592, 2719580, 47299811, 41660460, 29227703, 35962159, 68755024, 37431187, 96990264, 75268721, 55309387, 29707667, 72331141, 66163471, 73731468, 29489499, 15626671, 87668996, 90627527, 38995722, 16187384, 38141092, 28112096, 63498606, 42800893, 32889078, 44096466, 1061073, 16199494, 50609368, 98217037, 78156209, 35809378, 83222689, 98883763, 45652058, 95112063, 67751280, 98718726, 11399511, 81720687, 34862435, 59336159, 91776162, 35357833, 8949315, 67698445, 96171918, 30902962, 65241071, 22373769]

# work dir
config['work_dir'] = "./logs/benchmarks/point_cloud_registration/synth_pcr/overlap_0.4/OverlapPredator_run_2"
