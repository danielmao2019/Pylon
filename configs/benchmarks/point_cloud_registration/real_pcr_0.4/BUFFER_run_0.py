# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import criteria
import metrics
import optimizers
import runners.pcr_trainers

import copy
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import get_transforms_cfg
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg

optimizer_cfg = {
    'class': optimizers.SingleTaskOptimizer,
    'args': {
        'optimizer_config': {
            'class': torch.optim.Adam,
            'args': {
                'params': None,
                'lr': 1.0e-4,
                'weight_decay': 1.0e-06,
            },
        },
    },
}

scheduler_cfg = {
    'class': torch.optim.lr_scheduler.StepLR,
    'args': {
        'optimizer': None,
        'step_size': 1000,
        'gamma': 0.95,
    },
}

config = [
{
    'stage': 'Ref',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_RefStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_RefStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Desc',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_DescStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_DescStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Keypt',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_KeyptStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_KeyptStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Inlier',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_InlierStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_InlierStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
]

config[0]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['model']['args']['config']['stage'] = 'Ref'
config[1]['model']['args']['config']['stage'] = 'Desc'
config[2]['model']['args']['config']['stage'] = 'Keypt'
config[3]['model']['args']['config']['stage'] = 'Inlier'

# seeds
config[0]['init_seed'] = 78456540
config[0]['train_seeds'] = [26725235, 50069626, 13833448, 88502737, 48077283, 80106479, 63701025, 13939593, 28100950, 81602880, 54189456, 3213077, 8371204, 92093229, 32441265, 90172628, 56340338, 26344445, 84237548, 39813335, 82305592, 64329255, 44568221, 70447499, 1160491, 72203856, 66363, 26132054, 78299707, 10987425, 52517973, 48846801, 90345113, 66744716, 27669584, 24913197, 13452765, 99935531, 77151517, 21984349, 18616064, 89170935, 42343762, 48968343, 48887030, 75687229, 88312356, 39772195, 29051550, 38153834, 39789970, 8444268, 81092151, 41409042, 847757, 37341195, 61617851, 78257616, 59136904, 60809483, 98107827, 57086590, 35501520, 57105354, 27277378, 92558185, 26052491, 77673572, 66324987, 62380458, 52026665, 2917022, 89866130, 37999958, 42814194, 66063719, 53947156, 58821009, 64163020, 80258153, 32873351, 83763787, 39609443, 9971770, 45530471, 87170069, 96098448, 49118962, 8904458, 56339503, 17895803, 3142987, 76057221, 89233737, 98343440, 30352424, 39064819, 39504898, 34007634, 97057784]
config[1]['init_seed'] = 63237206
config[1]['train_seeds'] = [14175945, 13994198, 24929686, 26078962, 20844040, 98956474, 12302317, 21632515, 73270241, 72238976, 81144428, 31804281, 58949424, 27862020, 37749582, 3640779, 31413369, 17920610, 83863331, 76582545, 89794634, 32059887, 61821755, 14348061, 94200922, 74651708, 39862434, 90993796, 69127986, 76161962, 45597725, 21079690, 31120052, 35807788, 70799004, 87850836, 48410032, 38179664, 53927800, 18944029, 6351732, 92814406, 49865843, 80793469, 70806924, 82567672, 14725372, 41434526, 58720282, 4914352, 24374810, 41597452, 36916277, 88086447, 25189564, 16884284, 21205519, 25569510, 16219524, 94165079, 99696044, 57362634, 83774059, 16186875, 61388222, 23358997, 63996332, 37418178, 12184794, 96607293, 65100598, 4945022, 65450021, 63928681, 87807616, 63668322, 24200245, 72959253, 95460421, 32116118, 95090808, 45195515, 64322959, 48073533, 5183442, 61402960, 25482498, 48148727, 93160479, 45080537, 73580566, 46043479, 78125412, 19172787, 38314281, 45011397, 21846659, 75524371, 24147187, 66551156]
config[2]['init_seed'] = 63873272
config[2]['train_seeds'] = [9821809, 97250499, 29881369, 76725237, 61973544, 60162266, 91769982, 33697543, 94463931, 51495168, 99758128, 44700401, 95760082, 12181786, 42389318, 7761119, 70071283, 17230804, 46628947, 66114773, 33391566, 38323698, 92160365, 23460762, 12833137, 27309343, 64196518, 67970013, 13842913, 21728633, 30828647, 24361181, 56246705, 38846881, 37096760, 12877021, 93693998, 13852328, 12102695, 27334186, 4162853, 86977643, 22016972, 33951703, 94875067, 67085596, 45854812, 63857288, 58928031, 6621291, 31092690, 21767030, 48640876, 3667004, 47457023, 68830635, 60048278, 67489546, 26418347, 57573890, 49673901, 40948537, 94258868, 96688524, 36170688, 45037433, 95829494, 34892575, 34347241, 42642871, 35509466, 92208692, 80864398, 91335628, 76926234, 9399220, 99967675, 23112595, 59220560, 77158480, 59842580, 60205065, 76061629, 73297654, 34752783, 59824455, 31522413, 72101232, 25511755, 75573319, 2371787, 57915016, 65990261, 83439574, 39580649, 45862757, 490350, 93320956, 77525341, 54916277]
config[3]['init_seed'] = 42768870
config[3]['train_seeds'] = [74522142, 98297042, 56720925, 97172215, 59370230, 53859404, 32509673, 70617493, 34848821, 61273440, 61425879, 61641616, 99070820, 60007986, 1164652, 86712838, 59314386, 84327247, 34129972, 50148216, 73843632, 17641733, 9161172, 13097557, 51081954, 4896633, 95377034, 26906756, 80935692, 5682812, 34290815, 33251237, 17941480, 14514168, 90952069, 13724356, 7079088, 38141935, 99995332, 28537267, 97800548, 20349833, 82058808, 78221775, 82363046, 89921269, 98823940, 75296453, 49218459, 31671133, 94101191, 40058060, 14210745, 56429994, 6747783, 58495848, 98214117, 94094304, 64596523, 97851186, 32314250, 48670285, 3498035, 18387, 30271205, 52763577, 45624480, 73304671, 56637082, 36618824, 16215918, 93321277, 28357931, 18496744, 11116719, 72082465, 58818530, 40556035, 53147375, 21187723, 10706134, 15581692, 60210825, 80721254, 98195814, 22872936, 98250305, 32022317, 86054758, 74539140, 68868174, 34521575, 47134302, 3325944, 16191327, 8593633, 74758798, 73789540, 14080953, 55846906]

# work dir
config[0]['work_dir'] = "./logs/benchmarks/point_cloud_registration/real_pcr_0.4/BUFFER_run_0"
config[1]['work_dir'] = "./logs/benchmarks/point_cloud_registration/real_pcr_0.4/BUFFER_run_0"
config[2]['work_dir'] = "./logs/benchmarks/point_cloud_registration/real_pcr_0.4/BUFFER_run_0"
config[3]['work_dir'] = "./logs/benchmarks/point_cloud_registration/real_pcr_0.4/BUFFER_run_0"
