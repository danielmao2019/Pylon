# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import criteria
import metrics
import optimizers
import runners.pcr_trainers

import copy
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import get_transforms_cfg
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg

optimizer_cfg = {
    'class': optimizers.SingleTaskOptimizer,
    'args': {
        'optimizer_config': {
            'class': torch.optim.Adam,
            'args': {
                'params': None,
                'lr': 1.0e-4,
                'weight_decay': 1.0e-06,
            },
        },
    },
}

scheduler_cfg = {
    'class': torch.optim.lr_scheduler.StepLR,
    'args': {
        'optimizer': None,
        'step_size': 1000,
        'gamma': 0.95,
    },
}

config = [
{
    'stage': 'Ref',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_RefStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_RefStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Desc',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_DescStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_DescStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Keypt',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_KeyptStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_KeyptStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Inlier',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_InlierStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_InlierStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
]

config[0]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['model']['args']['config']['stage'] = 'Ref'
config[1]['model']['args']['config']['stage'] = 'Desc'
config[2]['model']['args']['config']['stage'] = 'Keypt'
config[3]['model']['args']['config']['stage'] = 'Inlier'

# seeds
config[0]['init_seed'] = 80195969
config[0]['train_seeds'] = [809274, 62485060, 96540230, 64524257, 33264354, 71764446, 55639057, 24415844, 7745877, 49413040, 45969112, 13307631, 24382693, 49442319, 84940414, 7027866, 49266045, 25549525, 83937391, 87742620, 11255859, 87736053, 34989614, 18450652, 55193495, 78499700, 66454563, 70548378, 35178048, 30838480, 5865139, 56461577, 83085157, 98179307, 91443930, 40536665, 67251420, 41177769, 62329198, 93442289, 7279298, 75782381, 81618193, 90264571, 52491812, 57430686, 75965969, 66295297, 64516372, 15054701, 21381327, 43164909, 16342863, 86158899, 52575885, 91123285, 14490001, 57510029, 43016640, 45829421, 92101562, 41407275, 81252176, 70838671, 26251354, 73365848, 43411004, 72022842, 95096936, 24270512, 98862406, 88035541, 12589415, 16925776, 67559576, 47222564, 68361900, 11485404, 58589324, 38995335, 64840773, 84296390, 57822536, 6265876, 53919804, 25387452, 30981893, 31139558, 13209986, 36848375, 51103524, 6371462, 29749318, 27832221, 38983930, 96568240, 89893911, 76899398, 9756944, 14878088]
config[0]['val_seeds'] = [57538788, 87628514, 9565985, 13403885, 43214934, 33786631, 21982734, 43000193, 548440, 15890781, 67041297, 29917202, 80264916, 5077148, 91740394, 58210967, 37662720, 5850245, 50651229, 50076907, 97731095, 37429674, 4783510, 87205648, 71813436, 1222160, 14511643, 71055964, 30442599, 15280868, 83127022, 50760544, 50378447, 42584918, 554981, 35555271, 49509576, 98560927, 42329876, 6288786, 6590723, 2200396, 57773441, 61091510, 12515896, 46830258, 96314702, 22627657, 88525668, 99919950, 11543852, 57660709, 81816844, 76416668, 43413294, 12317150, 34670471, 19840028, 48370505, 85501702, 92264432, 80481937, 11446306, 45891503, 60508801, 83141275, 66379865, 77642060, 16907164, 98201266, 47709238, 12844227, 6075530, 9752828, 44659323, 48348868, 16058499, 85457643, 12712070, 96147479, 87499779, 54606422, 47506051, 62511404, 58283263, 61870954, 55186448, 53710889, 66136799, 64009234, 39751790, 71185261, 94952704, 84814328, 47594485, 99268662, 605895, 34640198, 89030921, 26857582]
config[0]['test_seed'] = 83889370
config[1]['init_seed'] = 72742078
config[1]['train_seeds'] = [7007079, 63894426, 63438079, 32344911, 56255131, 95556723, 11402448, 80384810, 76540906, 29699671, 59387982, 82199914, 25361511, 75083209, 7443863, 53108330, 57458039, 50308866, 67996863, 3975877, 23691555, 50651071, 28401621, 8623501, 25574977, 68237632, 45165528, 61002367, 62643573, 45978677, 68050610, 19135567, 79295034, 58452684, 58573215, 66748621, 75969043, 83654984, 57471848, 5302915, 64870857, 2476996, 44411449, 75830289, 55406479, 77933999, 4895177, 40146648, 51394712, 664698, 90098857, 75881201, 38251161, 71299934, 82042248, 27310474, 52384247, 83993612, 99800272, 71560115, 86060119, 68007122, 49829172, 79218712, 8291676, 18724440, 78010703, 97035341, 10834630, 25266988, 27515163, 41126130, 16900884, 21382141, 69173010, 66734781, 51252353, 81281124, 17114945, 98481770, 77540426, 68514401, 39881307, 64683758, 89134364, 97377528, 1813251, 97182679, 3249041, 33696979, 46847013, 20974918, 38788880, 23244375, 5359141, 6356427, 51005845, 49630404, 77204494, 64148266]
config[1]['val_seeds'] = [38260081, 89196323, 3122513, 65058841, 43735008, 33560630, 66469084, 95534396, 29854548, 61179784, 82447549, 55796926, 13519543, 86904798, 90736953, 4689518, 51274182, 88317128, 1772967, 68378476, 43162887, 37683210, 19216821, 10462237, 97652839, 60604266, 39317945, 68984731, 15068461, 26263887, 35931996, 38009078, 2360134, 39864994, 92288254, 97553897, 72131448, 71328504, 36694025, 87842680, 91960662, 29962795, 74921164, 3450881, 14370918, 1454815, 67871074, 92740208, 31581779, 18371925, 45103770, 19726040, 41064926, 39552065, 88579988, 27008659, 95140732, 61555909, 65372545, 33899356, 56872949, 62823470, 9918448, 22787705, 54738373, 21451607, 49396149, 89020811, 68379608, 89082384, 13450588, 39524664, 51559880, 95040429, 58302694, 92673312, 60123222, 36989357, 84652942, 77905794, 40272034, 91014194, 94940836, 20963150, 28843039, 63420436, 83617670, 64185777, 34415896, 92488395, 40573711, 56230028, 13975298, 5750699, 83544486, 74272082, 86685861, 93544137, 36024029, 73186305]
config[1]['test_seed'] = 9996080
config[2]['init_seed'] = 57268185
config[2]['train_seeds'] = [54662818, 24725465, 69205030, 86190205, 25566688, 61330167, 54909178, 46184617, 46489063, 36711080, 87165680, 73773117, 53069, 17324408, 90163729, 474063, 93366293, 76241119, 12327372, 49204310, 92444058, 46643040, 20522262, 69997043, 11838447, 7851587, 53193023, 77055977, 97092458, 83829800, 54521620, 19918772, 97125067, 83423157, 71323872, 96134046, 30699620, 95878795, 94028237, 67168607, 48467127, 23546550, 37431215, 49560177, 96044555, 96113795, 684867, 1326214, 2041524, 46771865, 92678397, 18398726, 64234120, 89483896, 78419939, 51955864, 37343971, 26948496, 65858194, 47600232, 2708361, 47566490, 45632743, 75898909, 20159922, 58059000, 24482044, 2190893, 21234689, 83379722, 62084270, 78762750, 72277421, 49054692, 96275431, 53293331, 9431741, 73857919, 21822902, 7365591, 31343636, 40884038, 44324517, 53363999, 69103011, 46751661, 17385737, 12721185, 26286002, 25603424, 90161631, 93817996, 34961297, 66829456, 47034198, 71404417, 73979851, 12265704, 80503215, 98276950]
config[2]['val_seeds'] = [21618258, 1334287, 85766389, 71274986, 8296683, 10420641, 46069831, 33831776, 95609389, 45408293, 36327095, 81093544, 43478252, 71454946, 55122234, 77919921, 38567875, 33397299, 90811747, 11320315, 67937061, 37374591, 91872236, 7619891, 83677233, 74819088, 55782665, 8113537, 24190441, 34625034, 56488989, 7210640, 85029448, 91515996, 70734335, 60383452, 42914760, 31045471, 86000711, 77344017, 15675048, 58022483, 38176720, 71340790, 74406232, 91992497, 88363361, 48361081, 52451687, 80850039, 41540056, 95117493, 29159786, 25327361, 81310423, 39490960, 46381130, 14217898, 47286542, 32502831, 75533454, 34919928, 524406, 6901270, 93001894, 40130131, 3502746, 13772279, 54132077, 30246028, 4243109, 79095833, 68336093, 19793686, 51223636, 97447530, 63481147, 81890653, 81347920, 6162585, 47384799, 7235936, 21037126, 91588065, 70602391, 69959303, 95430098, 39330810, 19464707, 59418239, 62873339, 32278325, 85294392, 23934407, 14581767, 96323089, 99061602, 93059283, 97604641, 38460839]
config[2]['test_seed'] = 47193573
config[3]['init_seed'] = 45549842
config[3]['train_seeds'] = [1119482, 83249176, 996554, 7906997, 62408641, 8309630, 52689321, 12443907, 16900430, 52074647, 18663868, 90685261, 3401549, 7826580, 3322381, 71722636, 36569071, 37674356, 24107202, 18207842, 83381562, 33044099, 51560931, 16767843, 10822137, 79965358, 43078212, 75921357, 23028916, 71979606, 82426268, 61722477, 73330032, 9406535, 93946845, 87591174, 78868051, 18932111, 53090786, 84269947, 20711934, 99631338, 29926997, 30084731, 68183243, 23319797, 16570382, 43131017, 25887596, 43263790, 92211932, 95732056, 28950846, 16201210, 13771040, 90742621, 50864886, 53734228, 41339459, 42959164, 81729907, 67077406, 88995003, 15315628, 91003373, 38534073, 85903279, 88334988, 96782457, 86170323, 46162184, 11580362, 51139878, 49442719, 36059939, 48873526, 28986086, 20247416, 87189407, 56841688, 51115184, 55309725, 98236890, 47664912, 10906972, 68988866, 1677082, 22825727, 77538909, 41496049, 62809264, 93322928, 94334590, 46190729, 66714938, 35315864, 38899388, 75239999, 31563798, 81695915]
config[3]['val_seeds'] = [13072370, 59348858, 61228082, 93345105, 71642088, 32559480, 45560514, 59793082, 20194074, 53441187, 98365860, 94024041, 21262450, 74549663, 51838615, 23068310, 40067536, 37891185, 79615660, 40165136, 63582839, 98387020, 78540320, 81551275, 54539048, 22792568, 9030624, 50551287, 15759834, 71793044, 23140342, 29282344, 77565501, 66218546, 1472923, 65150225, 76701653, 13438951, 48833759, 19567190, 75228123, 87290985, 45622734, 41149715, 83052380, 8801325, 71603835, 25005993, 70194041, 92541503, 90014166, 85462066, 69559202, 26003302, 71361143, 80962170, 69664209, 66740596, 60606216, 52596795, 81322674, 57313642, 61672285, 64662982, 69719549, 67086734, 97704715, 64746376, 79615, 50032863, 69673676, 39961670, 24376205, 58500797, 48228771, 21976616, 32396391, 68773227, 13839219, 60515537, 28113227, 153409, 82015255, 59796828, 19231628, 56888080, 95684942, 93765837, 90222152, 79705149, 9883353, 19984946, 99539942, 555570, 42008157, 53916806, 33749430, 66640485, 878504, 84263432]
config[3]['test_seed'] = 20014228

# work dir
config[0]['work_dir'] = "./logs/benchmarks/point_cloud_registration/synth_pcr_0.5/BUFFER_run_2"
config[1]['work_dir'] = "./logs/benchmarks/point_cloud_registration/synth_pcr_0.5/BUFFER_run_2"
config[2]['work_dir'] = "./logs/benchmarks/point_cloud_registration/synth_pcr_0.5/BUFFER_run_2"
config[3]['work_dir'] = "./logs/benchmarks/point_cloud_registration/synth_pcr_0.5/BUFFER_run_2"
