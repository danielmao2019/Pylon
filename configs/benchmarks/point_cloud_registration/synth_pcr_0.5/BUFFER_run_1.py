# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.Adam,
                'args': {
                    'params': None,
                    'lr': 1.0e-4,
                    'weight_decay': 1.0e-06,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}

from runners import MultiStageTrainer
config['runner'] = MultiStageTrainer

# data config
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
config.update(train_data_cfg)
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
config.update(val_data_cfg)

# model config
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg
model_cfg['args']['config']['data']['dataset'] = 'KITTI'
config['model'] = model_cfg

from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import multi_stage_criterion_cfg
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import multi_stage_metric_cfg
multi_stage_cfg = []

ref_cfg = config
ref_cfg['stage'] = 'Ref'
ref_cfg['model']['args']['config']['stage'] = 'Ref'
ref_cfg['criterion'] = multi_stage_criterion_cfg[0]
ref_cfg['metric'] = multi_stage_metric_cfg[0]
multi_stage_cfg.append(ref_cfg)

# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.Adam,
                'args': {
                    'params': None,
                    'lr': 1.0e-4,
                    'weight_decay': 1.0e-06,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}

from runners import MultiStageTrainer
config['runner'] = MultiStageTrainer

# data config
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
config.update(train_data_cfg)
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
config.update(val_data_cfg)

# model config
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg
model_cfg['args']['config']['data']['dataset'] = 'KITTI'
config['model'] = model_cfg

desc_cfg = config
desc_cfg['stage'] = 'Desc'
desc_cfg['model']['args']['config']['stage'] = 'Desc'
desc_cfg['criterion'] = multi_stage_criterion_cfg[1]
desc_cfg['metric'] = multi_stage_metric_cfg[1]
multi_stage_cfg.append(desc_cfg)

# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.Adam,
                'args': {
                    'params': None,
                    'lr': 1.0e-4,
                    'weight_decay': 1.0e-06,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}

from runners import MultiStageTrainer
config['runner'] = MultiStageTrainer

# data config
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
config.update(train_data_cfg)
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
config.update(val_data_cfg)

# model config
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg
model_cfg['args']['config']['data']['dataset'] = 'KITTI'
config['model'] = model_cfg

keypt_cfg = config
keypt_cfg['stage'] = 'Keypt'
keypt_cfg['model']['args']['config']['stage'] = 'Keypt'
keypt_cfg['criterion'] = multi_stage_criterion_cfg[2]
keypt_cfg['metric'] = multi_stage_metric_cfg[2]
multi_stage_cfg.append(keypt_cfg)

# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.Adam,
                'args': {
                    'params': None,
                    'lr': 1.0e-4,
                    'weight_decay': 1.0e-06,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}

from runners import MultiStageTrainer
config['runner'] = MultiStageTrainer

# data config
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
config.update(train_data_cfg)
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
config.update(val_data_cfg)

# model config
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg
model_cfg['args']['config']['data']['dataset'] = 'KITTI'
config['model'] = model_cfg

inlier_cfg = config
inlier_cfg['stage'] = 'Inlier'
inlier_cfg['model']['args']['config']['stage'] = 'Inlier'
inlier_cfg['criterion'] = multi_stage_criterion_cfg[3]
inlier_cfg['metric'] = multi_stage_metric_cfg[3]
multi_stage_cfg.append(inlier_cfg)
config = multi_stage_cfg

# seeds
config[0]['init_seed'] = 32611073
config[0]['train_seeds'] = [61616609, 49341628, 98011890, 38053985, 189863, 9142055, 97158482, 61723023, 91413598, 28940822, 46406028, 39841057, 75500318, 72375211, 5938914, 9030727, 95774988, 95635915, 87791125, 81192810, 96835151, 12843904, 90629446, 24028092, 43180687, 94035220, 66598449, 41452650, 59688438, 65856741, 46056302, 35650707, 28819290, 3289557, 12648464, 77289331, 78286045, 56469969, 900596, 29738662, 39070606, 48055661, 76166465, 84222508, 10542968, 10630044, 91666050, 78412921, 38297742, 92989983, 209940, 65865556, 9352016, 91091233, 23487379, 3464376, 47774816, 55814219, 35886129, 69577970, 56093226, 68954034, 22356855, 23761258, 76447665, 376502, 42612205, 38554598, 65426340, 73033663, 78388511, 89886888, 93853238, 15026872, 83133400, 59163641, 64641973, 9903663, 94024809, 49057749, 20689690, 33716318, 30096124, 98562561, 49553489, 90546816, 72552042, 34612442, 62836618, 17006575, 91170582, 70527933, 49772814, 75025150, 31956092, 42790075, 39959825, 44680627, 44937869, 87675815]
config[1]['init_seed'] = 48103225
config[1]['train_seeds'] = [22812761, 64316320, 48511758, 75692465, 12557115, 80929953, 43915947, 79617829, 66118217, 32492003, 89938625, 74493734, 52175849, 78138265, 20642294, 81235683, 79358633, 3201813, 11893136, 51776554, 93703942, 18460656, 19351922, 41223004, 7472911, 20554645, 94730591, 31186272, 88522387, 74672959, 52374096, 82392361, 48750998, 59622399, 13399767, 98033258, 20908165, 4880435, 77447603, 53477456, 5150970, 63913934, 31920324, 53890563, 62416022, 73149914, 99680835, 98789700, 7928729, 65893024, 36878982, 94412866, 31953435, 13775808, 81915237, 46309929, 12185346, 44284642, 20254446, 50645594, 77722451, 31325218, 60168905, 80625297, 23124267, 88509999, 80892067, 43027125, 53999371, 38029881, 48495188, 92885207, 87653863, 75780391, 37419438, 74082302, 54849906, 60024474, 48988219, 9948762, 63489227, 67986324, 77770052, 85115153, 80831776, 67864851, 4603699, 34514268, 45767710, 83117112, 9881973, 26570700, 62538544, 77301305, 9443958, 93675903, 81217175, 68287389, 72290913, 67922706]
config[2]['init_seed'] = 63555337
config[2]['train_seeds'] = [21185687, 9769369, 80337235, 48734720, 12551504, 59789739, 65320058, 82899347, 40876702, 58132829, 34923008, 39039812, 18658372, 59661759, 12964735, 29319302, 44943863, 88256049, 17948206, 8251825, 3599562, 68057826, 63451575, 65849540, 72791220, 52245335, 51429769, 86590195, 26086506, 98772328, 18134727, 36937920, 56320093, 14478949, 91483027, 67778975, 68908666, 85179264, 97781359, 54326829, 8257073, 45729681, 53398706, 8055317, 73928559, 75963646, 47895478, 59278908, 26561369, 67800560, 89828309, 50830727, 96326293, 909679, 26592700, 66361171, 18714960, 38923502, 66180527, 94653595, 66979597, 11747308, 64558166, 80936533, 80639638, 52837658, 13604093, 33351646, 84884623, 92271000, 11951396, 25688556, 99854112, 40182771, 81250048, 79515504, 65385318, 69735332, 14740518, 41639462, 88614068, 66079258, 33627309, 5800525, 10730105, 82139968, 26126183, 77556017, 32289860, 49043405, 51746150, 13043839, 31089314, 51624747, 81941290, 51414097, 17623753, 72464559, 90938710, 8886316]
config[3]['init_seed'] = 22931043
config[3]['train_seeds'] = [59987140, 84520516, 89512391, 76868279, 96957643, 49783595, 67752243, 28335436, 5302539, 19389368, 41260137, 35730212, 12158547, 57879708, 85709087, 15473844, 53212955, 99612008, 20927122, 74221476, 44778613, 37807337, 90428995, 53104409, 95648642, 44818131, 49451548, 84762082, 41821270, 50654388, 48587246, 1512067, 7111850, 9734572, 32920217, 85324871, 94959428, 49480924, 95384476, 91480466, 1722998, 42550258, 73535228, 45150509, 41619182, 20502265, 21682778, 52819267, 32867689, 43722937, 679460, 74171774, 51708825, 25410847, 45863651, 71286416, 36076743, 82889877, 35140869, 18683703, 42764543, 31282299, 75697653, 93453562, 68307674, 61293666, 31714313, 74861089, 50815928, 52611168, 94559298, 79554054, 45338502, 25477074, 19825485, 64740186, 2891978, 49829752, 84255956, 36573712, 39940359, 65062910, 84370722, 41374675, 91931247, 45003528, 46293065, 52251303, 75980645, 86997034, 12099011, 30444899, 43910059, 58027889, 97184172, 53340876, 98748707, 34700114, 71186982, 48610339]

# work dir
config['work_dir'] = "./logs/benchmarks/point_cloud_registration/synth_pcr_0.5/BUFFER_run_1"
