# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import criteria
import metrics
import optimizers
import runners.pcr_trainers

import copy
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import get_transforms_cfg
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg

optimizer_cfg = {
    'class': optimizers.SingleTaskOptimizer,
    'args': {
        'optimizer_config': {
            'class': torch.optim.Adam,
            'args': {
                'params': None,
                'lr': 1.0e-4,
                'weight_decay': 1.0e-06,
            },
        },
    },
}

scheduler_cfg = {
    'class': torch.optim.lr_scheduler.StepLR,
    'args': {
        'optimizer': None,
        'step_size': 1000,
        'gamma': 0.95,
    },
}

config = [
{
    'stage': 'Ref',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_RefStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_RefStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Desc',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_DescStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_DescStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Keypt',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_KeyptStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_KeyptStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Inlier',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_InlierStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_InlierStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
]

config[0]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['model']['args']['config']['stage'] = 'Ref'
config[1]['model']['args']['config']['stage'] = 'Desc'
config[2]['model']['args']['config']['stage'] = 'Keypt'
config[3]['model']['args']['config']['stage'] = 'Inlier'

# seeds
config[0]['init_seed'] = 64109778
config[0]['train_seeds'] = [51482983, 3393055, 17516276, 27700978, 32888396, 61640132, 48288810, 75464469, 77637273, 23877192, 85565340, 31200010, 56135383, 1806051, 49627714, 65988303, 12776700, 67406631, 80877363, 10366215, 99557815, 1948570, 18365154, 79419770, 84135943, 10066900, 33349645, 49415864, 5924248, 38245546, 79655122, 29488819, 92311646, 87005925, 35175029, 1574196, 82958257, 38538142, 97201119, 88783229, 49661781, 39331748, 90878616, 90664436, 91361833, 21598001, 17314282, 84710904, 75184813, 43805337, 21039322, 34408819, 90955223, 46380448, 65153970, 24093573, 11940994, 38973591, 29084882, 33398710, 71952259, 46735422, 78057705, 78102455, 13102546, 29773139, 43499783, 45558497, 53119527, 24475928, 49381757, 93496717, 31873490, 78672081, 66098419, 82401182, 83740004, 76756157, 61324740, 73281213, 75038215, 36499081, 71882794, 40178471, 56449323, 33071455, 33279152, 18548166, 80493040, 83147758, 20432291, 19431442, 82816486, 54238432, 33467412, 51909756, 80080038, 95173145, 90931362, 61369738]
config[0]['val_seeds'] = [44170968, 72211280, 72291382, 54920703, 91660359, 88533974, 46081586, 53078570, 30637973, 45353644, 93896503, 81070228, 73256058, 76251572, 89810901, 96955010, 56296828, 85355580, 50528369, 95849689, 686898, 22858157, 67332162, 22073390, 74680350, 76615910, 17205728, 92354895, 5297033, 37697406, 2278981, 12028060, 31124798, 24670397, 28564915, 26662111, 19841075, 98739683, 21450636, 99014151, 52026396, 55102746, 14118593, 4472252, 21480585, 37991833, 51613928, 11110011, 11143897, 29044363, 34857805, 62482550, 36886501, 84195270, 58287699, 90513311, 24769499, 22874938, 43215066, 93654150, 76148057, 77589443, 36006814, 18385306, 83555288, 90917568, 22747813, 25454169, 51052695, 37301317, 80121654, 35146751, 56446040, 87849544, 74692314, 7900552, 95480776, 11556092, 3328715, 44814657, 60428122, 22071063, 44646073, 31886098, 98127797, 41805118, 11007126, 63159425, 40704166, 70538020, 40613603, 23668260, 32923794, 25444736, 15963711, 10100355, 57784478, 25869658, 97111820, 65044004]
config[0]['test_seed'] = 62020974
config[1]['init_seed'] = 57545753
config[1]['train_seeds'] = [98142393, 41397916, 13548203, 35393583, 56789255, 20195482, 68591761, 67009553, 41956500, 12061405, 90324708, 4393552, 41046330, 82991785, 7820060, 79764420, 40779883, 23033432, 80756968, 82634995, 40972395, 67002216, 26266943, 7112795, 58142742, 58541718, 73188274, 62343248, 46097932, 24553335, 81841717, 10036118, 98536596, 28042850, 39490040, 80834678, 26534474, 70359778, 80680134, 91488848, 18666161, 18918651, 98549116, 84902358, 53070217, 21547296, 63171927, 25523484, 61454787, 53405262, 40155351, 79811692, 3545200, 19511413, 27393374, 12732415, 80482788, 34207831, 15446696, 37727782, 71163402, 97156585, 46976884, 34225389, 62081138, 30047018, 17052761, 32709421, 61621116, 83544290, 3607299, 71583267, 34574618, 49648910, 51197575, 95823601, 53120302, 95212285, 43324484, 38137587, 20187141, 18987933, 87519831, 96064484, 8246586, 83869595, 56550941, 53873655, 24858672, 47954304, 77674806, 96718359, 33693846, 68792418, 93047370, 95227062, 96227251, 71483846, 52708875, 18908524]
config[1]['val_seeds'] = [74082678, 59290771, 15734124, 33888237, 75623598, 82914837, 36167280, 37279882, 77925344, 90417981, 31746269, 41155419, 42289113, 42451390, 96405124, 44553753, 83375677, 18350624, 44870223, 1576636, 88466681, 82359762, 83727685, 39053966, 42513239, 18928530, 71901725, 22498422, 85158378, 79932646, 26884677, 1038210, 2368518, 16993182, 94198778, 66627937, 63520163, 5474356, 25516214, 47672723, 86232968, 89338585, 54196016, 67652156, 61428632, 5446638, 52659786, 87900530, 72736338, 39233352, 69636103, 13527302, 42124099, 47465727, 59112076, 91538372, 56721516, 95481594, 94068612, 70380553, 21141032, 50463379, 15577778, 20197144, 12980762, 52641461, 96776661, 93528243, 28872153, 51291758, 95598944, 18844026, 53876083, 73889436, 73524241, 71122975, 97551965, 70366970, 51728873, 1301892, 4312935, 96248389, 338492, 65162064, 35065055, 4661841, 61370938, 5212014, 63204555, 25512984, 33906789, 21899510, 43911085, 1106954, 61680852, 30412718, 63302333, 98279278, 80532898, 54003307]
config[1]['test_seed'] = 70126919
config[2]['init_seed'] = 93182190
config[2]['train_seeds'] = [32260403, 85783852, 80720200, 65545808, 20304181, 19191582, 2525189, 44304888, 13162748, 13168445, 76069818, 45027805, 73120947, 80636245, 14358301, 70086673, 52460284, 26484116, 28224372, 37517189, 88429500, 85859524, 54724575, 20889039, 40563500, 56879268, 93095895, 87931171, 51251563, 68110070, 4232936, 66863660, 62670491, 25546117, 20951128, 14406375, 14410809, 48985163, 98456839, 29706347, 15603623, 98250423, 6472164, 118606, 61550230, 72739173, 46177258, 94827787, 21614214, 41458592, 63599870, 12894878, 75951220, 96132962, 34274084, 62265639, 71978200, 41181886, 99974814, 5524965, 64574255, 59660866, 62920908, 54368213, 98408528, 46695752, 68293913, 43225006, 39510058, 10247873, 94335715, 60580439, 86241459, 47980639, 11885258, 62294582, 45770353, 69485214, 11023200, 73655345, 18462908, 78423115, 35792375, 46603489, 29641055, 11354713, 74685466, 63561928, 633179, 88693226, 73913922, 54575509, 20970458, 68977494, 90874801, 63869326, 64310517, 21513792, 80060761, 93437766]
config[2]['val_seeds'] = [18908323, 41898546, 14618844, 81289622, 64242158, 69285198, 94771837, 89632110, 65311629, 8971206, 26614479, 61850195, 24660259, 81338387, 52037284, 14556395, 11757064, 27921443, 69538814, 38331193, 27905330, 54342149, 36820834, 89585451, 58374544, 39457855, 46647072, 49465075, 24956748, 28739202, 35178585, 47169504, 88578029, 249791, 17222831, 76636150, 58798995, 28953048, 34431539, 29472332, 44847354, 46035336, 16715933, 92370223, 61392280, 58778753, 41707446, 51724487, 18288994, 3776875, 25831595, 73058584, 9525086, 71497322, 30326659, 32987858, 25954266, 58728283, 78851416, 88148989, 53197585, 10952633, 31098276, 90073593, 34294127, 97476793, 59383726, 24303556, 91501590, 5667204, 16057658, 67944514, 56550945, 67095754, 89801377, 52384848, 25033541, 1171548, 80609721, 38502457, 84282187, 77780165, 95171346, 52756509, 47722600, 91105435, 77417299, 35301146, 42590580, 58642453, 86010885, 26875075, 82125660, 49405420, 37501390, 43398731, 1266057, 35587296, 40273164, 24631742]
config[2]['test_seed'] = 42661973
config[3]['init_seed'] = 88304707
config[3]['train_seeds'] = [98029023, 50232605, 28046436, 42907597, 98486524, 85526890, 59806206, 7513270, 79747619, 3083100, 20761113, 27668087, 90998007, 3195135, 80501286, 91129092, 25738596, 85509281, 75907504, 82495655, 51546883, 79500463, 51951249, 3528409, 35236703, 18547752, 78182736, 19477103, 75709444, 68995505, 70991316, 44797441, 77775662, 36618447, 57834889, 25258933, 60354947, 91134071, 1609157, 21992782, 2374666, 99323920, 52338678, 72464254, 97712201, 17815481, 17247102, 60646719, 30962744, 27156066, 70228035, 20667571, 85799896, 81381750, 84008883, 76998993, 77319908, 72525897, 38387618, 29877958, 43502397, 79272069, 47280694, 96741878, 20229976, 33030087, 97440491, 32634051, 43351798, 76682238, 71392704, 74552026, 8969442, 30099049, 50722714, 19903200, 10495546, 50454070, 58901782, 66670636, 21518295, 62852851, 88576195, 40909524, 38760620, 83579232, 13104699, 72379451, 12837824, 42572225, 64641498, 64528754, 63571327, 36833835, 74182003, 97867927, 90492964, 7467438, 4130170, 64370234]
config[3]['val_seeds'] = [96859702, 12499611, 66346262, 18100824, 55090537, 27359498, 23189913, 53518279, 25030876, 86554978, 49615457, 30573093, 33865231, 35468865, 55679432, 53101914, 15256215, 47693828, 34071541, 29632861, 31743267, 12372317, 21942396, 90137855, 25694712, 20138850, 45276671, 83926158, 44558269, 5459553, 86007210, 8957130, 44579770, 15774790, 10022848, 28135225, 72191470, 14666380, 66520159, 35752244, 13293446, 35969917, 64496384, 74253635, 50816499, 65067270, 17140107, 76091986, 91122717, 98591008, 68745132, 89890135, 90495754, 95600009, 94654014, 95796930, 30810190, 36579358, 753297, 21113677, 27411312, 1527643, 22691782, 73878789, 53194811, 38984608, 12468252, 5055309, 69312655, 52533840, 56075899, 26271351, 84836620, 53062891, 51198320, 46163942, 49639236, 76375980, 88406588, 68290133, 68710598, 88133441, 94994849, 22641107, 82944880, 43620396, 47158453, 13056932, 85421792, 25468735, 14998504, 12088235, 52213961, 98243418, 1319522, 60305458, 57769635, 4067804, 32983155, 6806643]
config[3]['test_seed'] = 66301867

# work dir
config[0]['work_dir'] = "./logs/benchmarks/point_cloud_registration/real_pcr_1.0/BUFFER_run_0"
config[1]['work_dir'] = "./logs/benchmarks/point_cloud_registration/real_pcr_1.0/BUFFER_run_0"
config[2]['work_dir'] = "./logs/benchmarks/point_cloud_registration/real_pcr_1.0/BUFFER_run_0"
config[3]['work_dir'] = "./logs/benchmarks/point_cloud_registration/real_pcr_1.0/BUFFER_run_0"
