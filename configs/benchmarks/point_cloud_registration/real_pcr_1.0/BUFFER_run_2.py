# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
import torch
import criteria
import metrics
import optimizers
import runners.pcr_trainers

import copy
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import get_transforms_cfg
from configs.common.datasets.point_cloud_registration.train.buffer_data_cfg import data_cfg as train_data_cfg
from configs.common.datasets.point_cloud_registration.val.buffer_data_cfg import data_cfg as val_data_cfg
from configs.common.models.point_cloud_registration.buffer_cfg import model_cfg

optimizer_cfg = {
    'class': optimizers.SingleTaskOptimizer,
    'args': {
        'optimizer_config': {
            'class': torch.optim.Adam,
            'args': {
                'params': None,
                'lr': 1.0e-4,
                'weight_decay': 1.0e-06,
            },
        },
    },
}

scheduler_cfg = {
    'class': torch.optim.lr_scheduler.StepLR,
    'args': {
        'optimizer': None,
        'step_size': 1000,
        'gamma': 0.95,
    },
}

config = [
{
    'stage': 'Ref',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_RefStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_RefStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Desc',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_DescStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_DescStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Keypt',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_KeyptStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_KeyptStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
{
    'stage': 'Inlier',
    'runner': runners.pcr_trainers.BufferTrainer,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': copy.deepcopy(train_data_cfg['train_dataset']),
    'train_dataloader': copy.deepcopy(train_data_cfg['train_dataloader']),
    'criterion': {
        'class': criteria.vision_3d.point_cloud_registration.BUFFER_InlierStageCriterion,
        'args': {},
    },
    'val_dataset': copy.deepcopy(val_data_cfg['val_dataset']),
    'val_dataloader': copy.deepcopy(val_data_cfg['val_dataloader']),
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': metrics.vision_3d.point_cloud_registration.BUFFER_InlierStageMetric,
        'args': {},
    },
    # model config
    'model': copy.deepcopy(model_cfg),
    # optimizer config
    'optimizer': copy.deepcopy(optimizer_cfg),
    # scheduler config
    'scheduler': copy.deepcopy(scheduler_cfg),
},
]

config[0]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['train_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 3)
config[1]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[2]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)
config[3]['val_dataset']['args']['transforms_cfg'] = get_transforms_cfg('Euler', 1)

config[0]['model']['args']['config']['stage'] = 'Ref'
config[1]['model']['args']['config']['stage'] = 'Desc'
config[2]['model']['args']['config']['stage'] = 'Keypt'
config[3]['model']['args']['config']['stage'] = 'Inlier'

# seeds
config[0]['init_seed'] = 62577261
config[0]['train_seeds'] = [6133156, 45300235, 71573058, 7651082, 27901946, 90726971, 68936486, 49419456, 65041971, 45899399, 39023359, 87758618, 49919748, 95647869, 72493869, 12415611, 49760396, 31237123, 7187445, 76262347, 80985685, 43939797, 98901250, 12935828, 45387665, 62659732, 76941458, 21661320, 12030601, 19374120, 70083231, 65191619, 4448265, 52375115, 14864305, 48981417, 2415416, 82852550, 59638274, 19036404, 71905920, 53752393, 6385695, 24164445, 50725608, 15040870, 64773264, 76967331, 81059606, 26191983, 16996138, 22549387, 83819657, 84666320, 32580291, 95428516, 98615232, 75225464, 7308407, 70495944, 7306115, 33006108, 80805573, 39582681, 80255093, 95897748, 48939040, 27808119, 87775011, 90687145, 29774151, 33703441, 65630461, 58605683, 4720229, 16850606, 92178084, 84434728, 93760328, 24592287, 49867274, 95719968, 43871681, 54556263, 11996402, 4842433, 23095661, 46614034, 72462000, 62103295, 20587958, 68690450, 35960684, 61852903, 89705799, 11009875, 36501021, 65195696, 13948927, 93161010]
config[0]['val_seeds'] = [11092561, 53735729, 62805457, 50494818, 11193925, 79358836, 4824848, 47507257, 9349108, 11128392, 3015708, 4812583, 31980387, 55673579, 92547279, 86196175, 55897620, 34067194, 50428671, 6972003, 68045582, 76472393, 67902349, 56695385, 88850511, 14156913, 18941544, 90945085, 9209649, 94605102, 75976978, 44008225, 29425549, 72307321, 84626247, 85356845, 3816600, 57946237, 48713659, 37654407, 5694893, 46792164, 36817671, 52637598, 72354862, 16170783, 27583323, 44473581, 90615082, 58578355, 45963953, 94304976, 29025887, 48494373, 47741163, 27451272, 36210802, 2905336, 70009251, 79516313, 1919686, 73699215, 2100817, 25926437, 67727635, 44978939, 17687979, 79898468, 48368642, 83987836, 16840316, 72731716, 78620710, 73499645, 3021509, 72174533, 34618240, 39512645, 93928232, 62129391, 98723690, 61592973, 17848897, 6109650, 97689322, 61491346, 35353169, 8186430, 95210766, 58094071, 32485922, 83977733, 95672332, 64722532, 66186715, 62927211, 67663672, 43920316, 12810136, 375559]
config[0]['test_seed'] = 89076692
config[1]['init_seed'] = 63607524
config[1]['train_seeds'] = [67081378, 34862595, 92304079, 47195841, 29108996, 42673273, 17406538, 79140984, 51031379, 46602777, 61683059, 65961925, 49080936, 69717675, 35005538, 81402845, 10006594, 29998427, 24109306, 46289692, 1504353, 83322922, 24975451, 18864131, 30587323, 92694115, 88824728, 14567471, 27667511, 41085512, 42005155, 91557993, 42123887, 19536516, 77964676, 80938371, 11516877, 2434573, 79963954, 28926771, 16349188, 61180829, 36373991, 56490517, 16763787, 53701388, 51188434, 17394908, 66532894, 46772256, 79719291, 4422139, 70850813, 96407542, 75090982, 11608032, 22491037, 78228999, 38710359, 71750777, 36922063, 49919145, 91375902, 45468180, 74600392, 55899564, 34316870, 94930119, 85093622, 1814645, 32389556, 12790372, 67232510, 86991169, 70070094, 16296730, 99343696, 18889295, 1647299, 15117537, 80239321, 96604979, 67018978, 92002916, 64462898, 2355205, 70539022, 44351191, 32944767, 6804771, 7604789, 51993707, 72558559, 39200223, 59114074, 95343716, 88771223, 43538378, 32526869, 94406529]
config[1]['val_seeds'] = [3899256, 21735879, 37034605, 3589535, 83372458, 79681058, 48780108, 82108342, 33006583, 60016624, 52138240, 4768109, 77060980, 92409419, 39697829, 76448025, 14454648, 36577389, 2271297, 70444716, 47634068, 10091759, 88760487, 55687626, 18185222, 32743159, 4009766, 26556388, 6866272, 26622639, 4228231, 90713530, 56101178, 43161209, 64216222, 49902474, 41135792, 78009541, 63854849, 84945433, 79099668, 12448195, 17383571, 71151847, 86874029, 33960674, 89587291, 36138380, 88625824, 55973973, 67941940, 67269752, 84353694, 8143188, 55021603, 65648709, 19886763, 25838813, 78448015, 89859701, 20269678, 81697606, 96144198, 94273887, 31592754, 19170222, 83353519, 97177304, 55817960, 96056659, 9250013, 14900256, 53103575, 58601633, 77726877, 68317015, 80746364, 74150137, 15677328, 57642077, 46000211, 5774171, 57165925, 70209425, 13429996, 19559128, 49751418, 7831238, 38275412, 58207941, 53801008, 31916341, 89038363, 26243865, 68868920, 47617420, 75606307, 89167465, 38708447, 51701173]
config[1]['test_seed'] = 25024264
config[2]['init_seed'] = 49886815
config[2]['train_seeds'] = [86718175, 19612872, 46143640, 56486240, 74594539, 11345379, 3178589, 60109601, 66851591, 35322484, 34533820, 10943, 31659270, 21508118, 76642928, 34861868, 44931815, 10835533, 81962346, 84403512, 81970325, 20832495, 62861828, 82961682, 79776803, 50232540, 42808579, 70926164, 85392082, 77150621, 19840118, 5831016, 95737027, 22416728, 80655376, 56353865, 71706853, 59690634, 14174014, 74282205, 65225660, 86045201, 45774951, 25433247, 79118910, 74129355, 80753847, 69854047, 16109155, 4032670, 39935554, 34347855, 26518065, 72393744, 80862931, 87311245, 21459267, 91289252, 34176752, 22214836, 31577323, 81607715, 18791592, 77668999, 64829810, 20809185, 1137360, 34796069, 99072317, 6705941, 66268275, 77657093, 73438358, 68840470, 43287184, 87170806, 93960599, 80377035, 77528549, 76410351, 25698336, 17670864, 39078233, 26762526, 81220480, 52277268, 90820965, 6441512, 99351453, 86557952, 2918294, 83245232, 60528236, 68992515, 53249141, 9526856, 88688811, 7457039, 21864407, 79286946]
config[2]['val_seeds'] = [83296168, 33885589, 18076943, 11633758, 32927910, 62736701, 13501381, 10866863, 88819014, 33075710, 57791406, 34012386, 96466235, 1168704, 67617471, 13955050, 23945502, 81238199, 66192424, 68817229, 26605619, 87620734, 26293298, 23929544, 55859577, 52853283, 58543259, 57077852, 12878839, 45257281, 5375515, 46930838, 6220221, 46084251, 67192962, 94272123, 94401033, 6388355, 64207428, 45589173, 22541145, 32843449, 81982161, 11308387, 33109683, 25658133, 22458217, 11350272, 34598419, 89181724, 89027613, 46106336, 96857933, 4296987, 41644232, 12268017, 67116068, 31142286, 24008429, 58203499, 79099003, 44386047, 67068199, 46191333, 2761507, 64582115, 90819708, 45831211, 23746848, 56879492, 94362848, 45478318, 29043579, 80460091, 46578120, 63365597, 14419130, 46021422, 19937163, 46793138, 74512666, 3057431, 26581436, 98145898, 52687781, 46222943, 15758619, 49217613, 64214680, 37045354, 5709155, 15066494, 95944358, 30763295, 60997164, 23114216, 17219865, 73283706, 92992238, 91241334]
config[2]['test_seed'] = 51233589
config[3]['init_seed'] = 13678067
config[3]['train_seeds'] = [2182452, 3262848, 68197339, 57191335, 74558203, 39273541, 95258888, 45470366, 34319732, 11400869, 84581246, 12598294, 73156942, 73631744, 39254040, 67805339, 74897623, 7794885, 72185404, 63737081, 1572589, 81909969, 51194907, 30195933, 20748306, 24580582, 26072731, 36432659, 59806433, 57388180, 29526526, 13551431, 35805726, 46939146, 92833185, 71897541, 26641646, 29648265, 33958628, 35097607, 51386519, 93255535, 5321196, 59494442, 84905139, 8991605, 20459047, 9708778, 95880048, 70884798, 31026377, 21314867, 76639114, 30002550, 50931710, 62539860, 98378619, 55314713, 1470728, 48368202, 61376401, 24161424, 28249299, 90317077, 37515150, 26632427, 67050964, 35734131, 54080122, 90744572, 44802418, 76247134, 76768763, 71678788, 99382032, 63858164, 17626787, 66111016, 45890551, 14758456, 5072848, 99184456, 57609769, 55261254, 68680453, 65527770, 61899642, 27177097, 22368265, 65264785, 97538119, 78423670, 33123149, 96856763, 14547569, 33809623, 66272200, 18806678, 2672602, 43234879]
config[3]['val_seeds'] = [49321004, 39323048, 29981717, 65468029, 2222187, 12988673, 16044819, 9276154, 33269081, 29828740, 37854392, 52022174, 43317021, 68608624, 86236574, 14656526, 78240516, 70574362, 62591039, 86838782, 90990480, 40671598, 34941258, 35679690, 85637858, 4737784, 31607814, 56555239, 36778978, 8186726, 72068172, 86950558, 80541538, 79964035, 64787471, 53178184, 49590658, 19087297, 89377386, 52085080, 50953416, 84214093, 2652687, 48209039, 17886777, 14398171, 29654424, 17873143, 7965881, 92918532, 31598118, 48335505, 63247235, 15677246, 13213550, 65972279, 14005995, 93525511, 40473638, 49059863, 44058244, 73296268, 16526512, 21912195, 34986566, 61891179, 36652429, 53680614, 91621425, 81815971, 91233506, 89955919, 27101707, 43018606, 42627529, 16046711, 10248390, 95874583, 48232084, 26211574, 86496030, 58918428, 62368110, 15786396, 60498, 64867134, 88619849, 33739450, 68863331, 18755732, 77016874, 61333964, 38788619, 98137496, 67013333, 61739474, 93933861, 36567038, 20086960, 39057531]
config[3]['test_seed'] = 25192554

# work dir
config[0]['work_dir'] = "./logs/benchmarks/point_cloud_registration/real_pcr_1.0/BUFFER_run_2"
config[1]['work_dir'] = "./logs/benchmarks/point_cloud_registration/real_pcr_1.0/BUFFER_run_2"
config[2]['work_dir'] = "./logs/benchmarks/point_cloud_registration/real_pcr_1.0/BUFFER_run_2"
config[3]['work_dir'] = "./logs/benchmarks/point_cloud_registration/real_pcr_1.0/BUFFER_run_2"
