# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
from torch.optim.adam import Adam
from torch.optim.lr_scheduler import StepLR
from criteria.vision_3d.point_cloud_registration.buffer_criteria.desc_stage_criterion import BUFFER_DescStageCriterion
from criteria.vision_3d.point_cloud_registration.buffer_criteria.inlier_stage_criterion import BUFFER_InlierStageCriterion
from criteria.vision_3d.point_cloud_registration.buffer_criteria.keypt_stage_criterion import BUFFER_KeyptStageCriterion
from criteria.vision_3d.point_cloud_registration.buffer_criteria.ref_stage_criterion import BUFFER_RefStageCriterion
from data.dataloaders.buffer_dataloader import BufferDataloader
from data.datasets.pcr_datasets.kitti_dataset import KITTIDataset
from data.transforms.compose import Compose
from data.transforms.identity import Identity
from data.transforms.vision_3d.clamp import Clamp
from data.transforms.vision_3d.downsample import DownSample
from data.transforms.vision_3d.estimate_normals import EstimateNormals
from data.transforms.vision_3d.random_rigid_transform import RandomRigidTransform
from data.transforms.vision_3d.shuffle import Shuffle
from data.transforms.vision_3d.uniform_pos_noise import UniformPosNoise
from metrics.vision_3d.point_cloud_registration.buffer_metrics.desc_stage_metric import BUFFER_DescStageMetric
from metrics.vision_3d.point_cloud_registration.buffer_metrics.inlier_stage_metric import BUFFER_InlierStageMetric
from metrics.vision_3d.point_cloud_registration.buffer_metrics.keypt_stage_metric import BUFFER_KeyptStageMetric
from metrics.vision_3d.point_cloud_registration.buffer_metrics.ref_stage_metric import BUFFER_RefStageMetric
from models.point_cloud_registration.buffer.buffer import BUFFER
from optimizers.single_task_optimizer import SingleTaskOptimizer
from runners.pcr_trainers.buffer_trainer import BufferTrainer


config = [{
    'stage': 'Ref',
    'runner': BufferTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/single_temporal_pcr_1.0/BUFFER_run_1',
    'epochs': 100,
    'init_seed': 72364814,
    'train_seeds': [59772838, 49424999, 14478572, 92985532, 62171902, 87632363, 96734048, 20250919, 91787878, 19215273, 50739358, 70310893, 75839612, 79944357, 19871126, 1639175, 8126440, 65282433, 59293143, 1129004, 12916382, 96436870, 16726720, 99235811, 53771230, 51249397, 34823306, 20289727, 6324900, 68472523, 24578660, 81741712, 75815019, 89582067, 61661194, 52008688, 89942385, 76393071, 3057654, 61670770, 99667786, 54748987, 88233238, 8619631, 47688885, 57359500, 59351676, 25802635, 57405673, 95062224, 25320253, 74256561, 85516906, 17264751, 66292780, 80230522, 66077527, 20089881, 74074705, 1591125, 27705624, 4937375, 83392113, 54354360, 57833251, 1720774, 10183110, 85602461, 10685276, 46351720, 74229022, 35450364, 17138502, 49563723, 89314612, 87967858, 44988389, 30320413, 80470450, 58266028, 49810299, 82471448, 81908650, 69344735, 12170076, 58743222, 91803265, 37372831, 26870945, 18318418, 50473274, 56515450, 26439392, 19553130, 3623527, 84255393, 97088770, 95845307, 91899600, 36271995],
    'val_seeds': [6701302, 65046887, 797715, 53279372, 26277781, 48631811, 72970616, 89758727, 75489558, 16855156, 11712685, 47972223, 14192778, 18127959, 23661350, 67546446, 42866262, 65861489, 79165610, 33923540, 69117354, 20672985, 44742485, 75681477, 93112286, 69157965, 8564178, 70990945, 99283585, 94858496, 55105810, 23376452, 50299904, 14581523, 51059607, 96600254, 38658508, 23049558, 32774329, 48734588, 37747176, 16943061, 35543252, 73125724, 44672624, 39951017, 1277893, 53032374, 47306328, 67259619, 2475343, 94167222, 11293385, 35441261, 84579996, 59431447, 52975333, 25776858, 64294972, 40636410, 47214427, 92920436, 49748808, 69774995, 29968782, 7654032, 72467192, 73935707, 77203871, 84254827, 54924232, 90919283, 31909621, 50246646, 10014171, 29867934, 29360171, 79671517, 39538493, 13956285, 28938912, 83156917, 9698666, 20440010, 95066187, 28614717, 54813396, 78356011, 12001179, 73179562, 33241744, 13233225, 8358016, 63495240, 80735630, 74916111, 37371922, 77825956, 48789479, 9972631],
    'test_seed': 91073435,
    'train_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'train_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'criterion': {
        'class': BUFFER_RefStageCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'val_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': BUFFER_RefStageMetric,
        'args': {},
    },
    'model': {
        'class': BUFFER,
        'args': {
            'config': {
                'stage': 'Ref',
                'data': {
                    'voxel_size_0': 0.3,
                    'dataset': 'KITTI',
                },
                'train': {
                    'pos_num': 512,
                },
                'test': {
                    'scale': 1.0,
                    'pose_refine': False,
                },
                'point': {
                    'in_feats_dim': 3,
                    'first_feats_dim': 32,
                    'conv_radius': 2.0,
                    'keypts_th': 0.5,
                    'num_keypts': 1500,
                },
                'patch': {
                    'des_r': 3.0,
                    'num_points_per_patch': 512,
                    'rad_n': 3,
                    'azi_n': 20,
                    'ele_n': 7,
                    'delta': 0.8,
                    'voxel_sample': 10,
                },
                'match': {
                    'dist_th': 0.3,
                    'inlier_th': 2.0,
                    'similar_th': 0.9,
                    'confidence': 1.0,
                    'iter_n': 50000,
                },
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}, {
    'stage': 'Desc',
    'runner': BufferTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/single_temporal_pcr_1.0/BUFFER_run_1',
    'epochs': 100,
    'init_seed': 5665516,
    'train_seeds': [98194558, 51618781, 27476898, 71491505, 22658220, 7754165, 23608493, 54488775, 47572470, 16764890, 90034475, 71484936, 65412119, 93282656, 14318927, 86629371, 21260997, 45122950, 40293701, 75017182, 73704210, 18175100, 81203382, 65982555, 81777829, 41275196, 55564159, 46603671, 47635029, 52891907, 19726001, 11418203, 42805217, 16842265, 77672554, 75772748, 62929409, 39518897, 65021821, 44665726, 12095721, 37831756, 1100492, 97944401, 59167472, 14279570, 78597889, 63269554, 925477, 32234271, 98257632, 99846994, 19196246, 72530143, 96940275, 1920849, 41813558, 66400041, 8982327, 72479806, 67798818, 88153295, 78396820, 57712230, 18140697, 28318186, 76571253, 82296677, 43044046, 60995268, 5533000, 18380833, 50100221, 70509251, 5956226, 9856100, 2177253, 12818196, 50929492, 80178424, 57748506, 7744897, 31621766, 93126427, 98353805, 87939258, 92240223, 31950554, 47947080, 10617459, 61648315, 76330886, 6487291, 68354671, 6828335, 58051776, 93106858, 88216594, 5741166, 35556976],
    'val_seeds': [98213255, 39634644, 71017285, 3922166, 86042093, 27283188, 78704456, 833891, 88418664, 62863827, 1756676, 67125404, 61473543, 15513281, 37526512, 91976338, 99485037, 23226090, 88197941, 80424329, 4834767, 71657851, 51572663, 93249356, 18288760, 37201900, 75609506, 65403125, 62617611, 1558428, 81222579, 25127922, 14449772, 31310862, 65866483, 60683549, 42107521, 16595759, 7139929, 58717370, 51863876, 48132002, 58423235, 89160738, 51923381, 14074273, 84142530, 8298933, 18995301, 93257953, 20896209, 99668600, 30946704, 80759100, 55843931, 51156106, 64454786, 69558647, 7938557, 19982231, 6094281, 74549499, 70500330, 79646688, 50431876, 13936547, 62894357, 5660396, 35861438, 84771910, 52808681, 35681216, 14975830, 15288512, 49458826, 19534050, 46790690, 43429804, 75290049, 87183635, 54385195, 98392278, 55545214, 78974589, 16920253, 98360525, 95559780, 97340412, 780414, 51846548, 75064740, 23781789, 41050255, 91385412, 67018956, 77599653, 99166513, 48549066, 89268718, 93971040],
    'test_seed': 28032716,
    'train_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'train_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'criterion': {
        'class': BUFFER_DescStageCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'val_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': BUFFER_DescStageMetric,
        'args': {},
    },
    'model': {
        'class': BUFFER,
        'args': {
            'config': {
                'stage': 'Desc',
                'data': {
                    'voxel_size_0': 0.3,
                    'dataset': 'KITTI',
                },
                'train': {
                    'pos_num': 512,
                },
                'test': {
                    'scale': 1.0,
                    'pose_refine': False,
                },
                'point': {
                    'in_feats_dim': 3,
                    'first_feats_dim': 32,
                    'conv_radius': 2.0,
                    'keypts_th': 0.5,
                    'num_keypts': 1500,
                },
                'patch': {
                    'des_r': 3.0,
                    'num_points_per_patch': 512,
                    'rad_n': 3,
                    'azi_n': 20,
                    'ele_n': 7,
                    'delta': 0.8,
                    'voxel_sample': 10,
                },
                'match': {
                    'dist_th': 0.3,
                    'inlier_th': 2.0,
                    'similar_th': 0.9,
                    'confidence': 1.0,
                    'iter_n': 50000,
                },
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}, {
    'stage': 'Keypt',
    'runner': BufferTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/single_temporal_pcr_1.0/BUFFER_run_1',
    'epochs': 100,
    'init_seed': 92830787,
    'train_seeds': [45402683, 54072843, 22563747, 95699984, 92085574, 7381100, 45790821, 17853032, 8653354, 49296131, 71612923, 95804215, 57354271, 83322846, 57286632, 53740639, 15369801, 96429579, 64355923, 62198763, 9238956, 96518916, 55925558, 32685577, 64933010, 69825382, 74134033, 18387472, 42675316, 49222443, 46292362, 63105036, 1524548, 33167816, 5711217, 89686424, 41156983, 78073297, 84597221, 62221293, 74400605, 91364853, 91992169, 4790687, 75393742, 51955623, 99090769, 14556137, 73009763, 63085143, 52823987, 81751381, 90291624, 48296309, 84230179, 5749222, 66118062, 36834476, 96360766, 98654397, 2719962, 53591794, 85190413, 14803337, 16319995, 14681743, 52236618, 72766355, 1350964, 53523395, 66097049, 84924400, 40669980, 22060307, 32630154, 59618957, 89816512, 99461933, 27419545, 64615103, 17945918, 96019813, 67382125, 56901266, 53420354, 27462730, 67084077, 47163019, 26016643, 94773834, 78285701, 48742563, 55742120, 64982668, 33611176, 84813737, 20642376, 76821804, 87878087, 80235304],
    'val_seeds': [34377041, 27219314, 33128468, 80905277, 72492390, 10838574, 71731770, 56022426, 3833858, 55895296, 77661586, 91611019, 173684, 58954032, 92770879, 17207197, 1937758, 57264815, 60938066, 30597675, 60674508, 11278390, 19444313, 47649726, 95429602, 9737040, 16256073, 8159072, 78852973, 21888487, 41589123, 45164528, 89825577, 36557488, 86654864, 66086388, 54166783, 61985157, 57965687, 36476853, 76731905, 12961913, 36055323, 76014527, 34111590, 34308342, 52025613, 30298261, 57454716, 66300388, 30253928, 30338542, 21796456, 69060439, 96706549, 96381511, 82443923, 55402274, 74134952, 805570, 70466173, 37735675, 79776966, 97933014, 59141182, 84536999, 18517520, 28632309, 72148912, 39525868, 39500372, 94356973, 62150329, 97572623, 38393875, 27209590, 71018991, 36310018, 16805183, 21538044, 2091681, 6698583, 80461747, 82440687, 8892226, 65516882, 74025037, 27088305, 38735913, 44444464, 93763121, 51136506, 75883768, 64406922, 11317293, 99060690, 21725632, 81557553, 80026280, 99159278],
    'test_seed': 570024,
    'train_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'train_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'criterion': {
        'class': BUFFER_KeyptStageCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'val_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': BUFFER_KeyptStageMetric,
        'args': {},
    },
    'model': {
        'class': BUFFER,
        'args': {
            'config': {
                'stage': 'Keypt',
                'data': {
                    'voxel_size_0': 0.3,
                    'dataset': 'KITTI',
                },
                'train': {
                    'pos_num': 512,
                },
                'test': {
                    'scale': 1.0,
                    'pose_refine': False,
                },
                'point': {
                    'in_feats_dim': 3,
                    'first_feats_dim': 32,
                    'conv_radius': 2.0,
                    'keypts_th': 0.5,
                    'num_keypts': 1500,
                },
                'patch': {
                    'des_r': 3.0,
                    'num_points_per_patch': 512,
                    'rad_n': 3,
                    'azi_n': 20,
                    'ele_n': 7,
                    'delta': 0.8,
                    'voxel_sample': 10,
                },
                'match': {
                    'dist_th': 0.3,
                    'inlier_th': 2.0,
                    'similar_th': 0.9,
                    'confidence': 1.0,
                    'iter_n': 50000,
                },
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}, {
    'stage': 'Inlier',
    'runner': BufferTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/single_temporal_pcr_1.0/BUFFER_run_1',
    'epochs': 100,
    'init_seed': 34068617,
    'train_seeds': [73149197, 83570648, 54220714, 66577045, 45173483, 13897153, 69957395, 74127243, 34696716, 11368063, 79818417, 44412372, 32427943, 18499589, 88746868, 95501314, 67826571, 77653530, 22017467, 68508513, 64837700, 58105789, 15873258, 37521438, 13818218, 37472748, 63349193, 56951187, 18567104, 64681238, 59390378, 17399794, 49569392, 81605392, 53023876, 85065495, 65698134, 61114285, 23053081, 70497632, 71145845, 17243625, 92275725, 63440892, 34254816, 9170650, 299677, 68489856, 92581808, 98360522, 78273140, 80270515, 66326921, 58871598, 87258700, 20425910, 64437252, 11308306, 43130375, 69715123, 40419789, 64853864, 12395629, 45784796, 90454372, 34672671, 80359, 53209315, 23804277, 59516868, 82501351, 2784610, 82301052, 2364361, 31160386, 57570348, 30362475, 30589571, 85293501, 41159438, 25979089, 32047335, 43018336, 65872594, 30929087, 44299945, 8569365, 69010748, 93912919, 74542728, 95141150, 93020669, 14744817, 54343939, 9453096, 80290939, 42605455, 24084238, 84086016, 66250270],
    'val_seeds': [67176060, 37480408, 73469450, 92339074, 8877417, 42630658, 97517067, 10885504, 50518628, 31020637, 32665644, 76085394, 11255348, 23103143, 81670075, 30903170, 6002129, 40498366, 27465864, 54056163, 95194275, 2538203, 38542137, 65635096, 15311252, 34515849, 74618889, 97785608, 56081421, 32968975, 37802461, 38814217, 64345537, 26390248, 60162826, 69693775, 28307222, 56139353, 6811350, 99159077, 6729320, 15953303, 22514689, 42618556, 56743429, 22579717, 67755847, 94815742, 90899655, 85768128, 48840566, 25137251, 87502332, 25050642, 54645114, 78083249, 14826968, 59378456, 18555625, 18236991, 88861170, 53143004, 78366993, 57304181, 69799837, 16882598, 96425371, 40304241, 57290977, 58590681, 75292568, 36722567, 56101222, 61258543, 4372082, 73732274, 16706225, 49881540, 69300922, 60285877, 54833624, 98544806, 31678407, 36454409, 25895860, 58964019, 12479844, 26725219, 30056483, 82242328, 37330102, 73723237, 59690235, 97163541, 69548850, 87247623, 27961394, 7093574, 75114087, 94162193],
    'test_seed': 2864411,
    'train_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'train_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'criterion': {
        'class': BUFFER_InlierStageCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'val_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': BUFFER_InlierStageMetric,
        'args': {},
    },
    'model': {
        'class': BUFFER,
        'args': {
            'config': {
                'stage': 'Inlier',
                'data': {
                    'voxel_size_0': 0.3,
                    'dataset': 'KITTI',
                },
                'train': {
                    'pos_num': 512,
                },
                'test': {
                    'scale': 1.0,
                    'pose_refine': False,
                },
                'point': {
                    'in_feats_dim': 3,
                    'first_feats_dim': 32,
                    'conv_radius': 2.0,
                    'keypts_th': 0.5,
                    'num_keypts': 1500,
                },
                'patch': {
                    'des_r': 3.0,
                    'num_points_per_patch': 512,
                    'rad_n': 3,
                    'azi_n': 20,
                    'ele_n': 7,
                    'delta': 0.8,
                    'voxel_sample': 10,
                },
                'match': {
                    'dist_th': 0.3,
                    'inlier_th': 2.0,
                    'similar_th': 0.9,
                    'confidence': 1.0,
                    'iter_n': 50000,
                },
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}]
