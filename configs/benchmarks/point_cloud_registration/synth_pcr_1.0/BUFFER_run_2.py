# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
from torch.optim.adam import Adam
from torch.optim.lr_scheduler import StepLR
from criteria.vision_3d.point_cloud_registration.buffer_criteria.desc_stage_criterion import BUFFER_DescStageCriterion
from criteria.vision_3d.point_cloud_registration.buffer_criteria.inlier_stage_criterion import BUFFER_InlierStageCriterion
from criteria.vision_3d.point_cloud_registration.buffer_criteria.keypt_stage_criterion import BUFFER_KeyptStageCriterion
from criteria.vision_3d.point_cloud_registration.buffer_criteria.ref_stage_criterion import BUFFER_RefStageCriterion
from data.dataloaders.buffer_dataloader import BufferDataloader
from data.datasets.pcr_datasets.kitti_dataset import KITTIDataset
from data.transforms.compose import Compose
from data.transforms.identity import Identity
from data.transforms.vision_3d.clamp import Clamp
from data.transforms.vision_3d.downsample import DownSample
from data.transforms.vision_3d.estimate_normals import EstimateNormals
from data.transforms.vision_3d.random_rigid_transform import RandomRigidTransform
from data.transforms.vision_3d.shuffle import Shuffle
from data.transforms.vision_3d.uniform_pos_noise import UniformPosNoise
from metrics.vision_3d.point_cloud_registration.buffer_metrics.desc_stage_metric import BUFFER_DescStageMetric
from metrics.vision_3d.point_cloud_registration.buffer_metrics.inlier_stage_metric import BUFFER_InlierStageMetric
from metrics.vision_3d.point_cloud_registration.buffer_metrics.keypt_stage_metric import BUFFER_KeyptStageMetric
from metrics.vision_3d.point_cloud_registration.buffer_metrics.ref_stage_metric import BUFFER_RefStageMetric
from models.point_cloud_registration.buffer.buffer import BUFFER
from optimizers.single_task_optimizer import SingleTaskOptimizer
from runners.pcr_trainers.buffer_trainer import BufferTrainer


config = [{
    'stage': 'Ref',
    'runner': BufferTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/synth_pcr_1.0/BUFFER_run_2',
    'epochs': 100,
    'init_seed': 18362205,
    'train_seeds': [18480290, 96485444, 56862959, 90771905, 1383515, 79570714, 32929458, 4694727, 64743244, 88995347, 56775342, 85844457, 84142512, 81845068, 92068131, 1457828, 86881216, 64508716, 9446670, 96271122, 56260112, 48571301, 77021942, 72136042, 21135655, 94594686, 28877770, 83835509, 89737118, 56827529, 67803918, 16356065, 93046126, 39770542, 23434683, 71172847, 22945698, 70151023, 57381969, 57283646, 13217918, 28492477, 34920245, 63730294, 89231825, 69153440, 33949781, 60699288, 91404245, 51577747, 31344714, 81993402, 37320566, 62209867, 92191622, 47560987, 70056410, 89959611, 21383578, 48442125, 52126221, 18097586, 9329869, 23821763, 90991031, 44959409, 65788622, 97513349, 7766848, 68307110, 47433739, 50798605, 87255956, 59865443, 77492805, 63630579, 29922945, 31717298, 21670904, 93840038, 77424673, 97055891, 48542324, 3715777, 75731274, 83568607, 4136139, 25503444, 68149222, 94035241, 95157934, 60144988, 65985799, 94666624, 44608544, 2813061, 99891661, 45994438, 96359006, 97016441],
    'val_seeds': [86846838, 15636960, 78586638, 98339764, 72774711, 43367412, 72739990, 73168900, 84527496, 14941866, 19303840, 86299677, 94087168, 86966483, 5200459, 66338827, 63801793, 50764222, 8295844, 17128487, 33185769, 62778575, 475597, 31627719, 16520674, 55684368, 23027258, 8880995, 72327609, 73219862, 88372195, 94800133, 86792390, 28995229, 22235106, 97496294, 96126324, 93964280, 76582303, 10118244, 7992446, 70258797, 97086308, 47228349, 18656290, 23155621, 6072067, 73572384, 65134353, 26907368, 44138435, 93865250, 79187234, 53050763, 68072956, 78031292, 84490612, 99394884, 53696843, 18510625, 6240893, 55604182, 11939472, 89770420, 58683589, 54989068, 66353076, 6950371, 86666773, 76148001, 83475665, 60867890, 17648291, 48866760, 94316141, 77320867, 90456467, 49376292, 74169028, 63742855, 78721249, 4018750, 41531695, 77176447, 46334793, 75326231, 91433750, 50728100, 54107005, 42664712, 73234600, 9375258, 29578349, 96926300, 66852021, 58384683, 70415365, 56059210, 85484713, 30370385],
    'test_seed': 18883147,
    'train_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'train_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'criterion': {
        'class': BUFFER_RefStageCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'val_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': BUFFER_RefStageMetric,
        'args': {},
    },
    'model': {
        'class': BUFFER,
        'args': {
            'config': {
                'stage': 'Ref',
                'data': {
                    'voxel_size_0': 0.3,
                    'dataset': 'KITTI',
                },
                'train': {
                    'pos_num': 512,
                },
                'test': {
                    'scale': 1.0,
                    'pose_refine': False,
                },
                'point': {
                    'in_feats_dim': 3,
                    'first_feats_dim': 32,
                    'conv_radius': 2.0,
                    'keypts_th': 0.5,
                    'num_keypts': 1500,
                },
                'patch': {
                    'des_r': 3.0,
                    'num_points_per_patch': 512,
                    'rad_n': 3,
                    'azi_n': 20,
                    'ele_n': 7,
                    'delta': 0.8,
                    'voxel_sample': 10,
                },
                'match': {
                    'dist_th': 0.3,
                    'inlier_th': 2.0,
                    'similar_th': 0.9,
                    'confidence': 1.0,
                    'iter_n': 50000,
                },
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}, {
    'stage': 'Desc',
    'runner': BufferTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/synth_pcr_1.0/BUFFER_run_2',
    'epochs': 100,
    'init_seed': 40654666,
    'train_seeds': [11385671, 76577874, 70509369, 83863209, 52357961, 34385894, 33298994, 74610847, 29868385, 47821797, 30514147, 74118224, 12012552, 25486376, 64286406, 72941480, 6007567, 35387932, 11562324, 63711203, 29118794, 641621, 72227570, 20490863, 62927255, 56923771, 35300443, 46420944, 70544304, 81881343, 62959857, 63693731, 42460540, 12846746, 85544893, 29430213, 49189532, 91935101, 62870112, 98360025, 32171744, 17760493, 5489589, 95034583, 22235688, 59744767, 91094654, 66660421, 57628721, 60395703, 40126605, 18653240, 15364550, 95920516, 95935843, 46897239, 23477630, 12341092, 39458767, 67570886, 63356166, 89091405, 79617318, 30194404, 18665605, 31570755, 77393538, 91685471, 89208924, 41175186, 75155330, 22104489, 81410443, 30396023, 40286980, 32649087, 94393019, 893220, 87888054, 79998901, 78302371, 4719931, 72610936, 97772970, 91026876, 23177561, 66014526, 18738235, 20254216, 61087068, 16680858, 81215795, 18767590, 80421091, 71468695, 93646762, 48822697, 48228766, 41846210, 95876808],
    'val_seeds': [10372784, 71154900, 67391685, 95015260, 47851615, 29807303, 9113420, 38657246, 7094675, 44624603, 3996808, 75945526, 93394221, 6262714, 34498814, 49727321, 89697773, 84963591, 64328353, 65428373, 61778111, 41789620, 20454441, 25139802, 34713886, 55243530, 13880876, 23513023, 60470798, 64277251, 19658180, 17492113, 34635947, 60082828, 74801935, 17056245, 2202605, 73589659, 71468115, 85156541, 63091349, 45948906, 25168183, 42726512, 93611344, 2869890, 74523657, 61771434, 48470990, 95886024, 99799838, 8007266, 42263029, 99764541, 21419395, 71599654, 85601887, 4839991, 82175756, 19933261, 81690865, 19356626, 26639439, 66167884, 54849861, 87961841, 58458586, 73746623, 79035269, 19892210, 21544738, 46025484, 7038870, 1452673, 21956560, 18340669, 21341879, 26989831, 50015525, 62677183, 6631188, 66335374, 26970298, 92609907, 88956381, 74492789, 92671125, 72380700, 89267033, 86445375, 35991274, 71636802, 95159787, 93774104, 24987442, 61463102, 28703574, 47751565, 28538349, 7915214],
    'test_seed': 89663947,
    'train_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'train_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'criterion': {
        'class': BUFFER_DescStageCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'val_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': BUFFER_DescStageMetric,
        'args': {},
    },
    'model': {
        'class': BUFFER,
        'args': {
            'config': {
                'stage': 'Desc',
                'data': {
                    'voxel_size_0': 0.3,
                    'dataset': 'KITTI',
                },
                'train': {
                    'pos_num': 512,
                },
                'test': {
                    'scale': 1.0,
                    'pose_refine': False,
                },
                'point': {
                    'in_feats_dim': 3,
                    'first_feats_dim': 32,
                    'conv_radius': 2.0,
                    'keypts_th': 0.5,
                    'num_keypts': 1500,
                },
                'patch': {
                    'des_r': 3.0,
                    'num_points_per_patch': 512,
                    'rad_n': 3,
                    'azi_n': 20,
                    'ele_n': 7,
                    'delta': 0.8,
                    'voxel_sample': 10,
                },
                'match': {
                    'dist_th': 0.3,
                    'inlier_th': 2.0,
                    'similar_th': 0.9,
                    'confidence': 1.0,
                    'iter_n': 50000,
                },
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}, {
    'stage': 'Keypt',
    'runner': BufferTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/synth_pcr_1.0/BUFFER_run_2',
    'epochs': 100,
    'init_seed': 84300225,
    'train_seeds': [87097301, 91326220, 89913144, 96181798, 77006304, 19537852, 81444772, 96649737, 30919921, 36065623, 60868849, 96790007, 54097526, 79691153, 41928540, 9387276, 52833132, 1648811, 30483336, 85304371, 96407460, 57512137, 91143851, 44702746, 86323337, 87059050, 87434347, 37153704, 42854928, 20943467, 3894378, 34308533, 78543711, 94860880, 11844970, 53947610, 67842480, 65151376, 12704345, 89867607, 40716160, 39746137, 58255551, 10116475, 99934896, 16096203, 48844224, 80735071, 48621816, 21551089, 92107245, 24523375, 4855111, 74369561, 83795817, 94163217, 47438714, 81388218, 17664823, 38706141, 96676726, 79114510, 34840906, 82103644, 30982188, 72526044, 93665440, 69750285, 20834867, 61343491, 32378974, 85250041, 92732541, 68484904, 75418883, 61703725, 4891224, 74675354, 38865575, 68416770, 7958165, 26006649, 71612876, 96459430, 50436863, 8105723, 10524836, 42025335, 81123871, 13377907, 46556710, 84299869, 5361503, 10882724, 3708959, 59998211, 89834328, 23307649, 16409674, 541016],
    'val_seeds': [49285833, 94278992, 33318562, 58585544, 19048641, 78511727, 71981458, 43474803, 44475631, 70736648, 34883394, 45687626, 85060083, 78708613, 80242977, 4086151, 58440611, 92806340, 93335225, 35306376, 98831881, 98582716, 12082510, 62314055, 31188212, 79469865, 42997673, 71746468, 49740776, 65955276, 64100250, 75977224, 36258870, 68200227, 87045188, 71928050, 16947945, 74573264, 12721814, 36969843, 48300165, 51140539, 59715991, 78580226, 58562585, 13637731, 1470429, 7978316, 1592467, 53439472, 22257687, 42592173, 8480562, 92366690, 39545805, 50582961, 22935249, 87737797, 33276494, 31181452, 4424811, 98478997, 26152453, 42598876, 76283446, 36634816, 84293768, 78260761, 5913419, 37598864, 48990680, 70199753, 44956110, 63354516, 59383879, 93592029, 21273235, 84495488, 45323963, 53749125, 12297077, 74197452, 64094108, 322955, 17185096, 63320853, 65063197, 2434141, 70128862, 55334751, 3604401, 82754597, 27757353, 30530609, 11862136, 11534265, 34098823, 78918182, 23572004, 64817255],
    'test_seed': 15935925,
    'train_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'train_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'criterion': {
        'class': BUFFER_KeyptStageCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'val_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': BUFFER_KeyptStageMetric,
        'args': {},
    },
    'model': {
        'class': BUFFER,
        'args': {
            'config': {
                'stage': 'Keypt',
                'data': {
                    'voxel_size_0': 0.3,
                    'dataset': 'KITTI',
                },
                'train': {
                    'pos_num': 512,
                },
                'test': {
                    'scale': 1.0,
                    'pose_refine': False,
                },
                'point': {
                    'in_feats_dim': 3,
                    'first_feats_dim': 32,
                    'conv_radius': 2.0,
                    'keypts_th': 0.5,
                    'num_keypts': 1500,
                },
                'patch': {
                    'des_r': 3.0,
                    'num_points_per_patch': 512,
                    'rad_n': 3,
                    'azi_n': 20,
                    'ele_n': 7,
                    'delta': 0.8,
                    'voxel_sample': 10,
                },
                'match': {
                    'dist_th': 0.3,
                    'inlier_th': 2.0,
                    'similar_th': 0.9,
                    'confidence': 1.0,
                    'iter_n': 50000,
                },
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}, {
    'stage': 'Inlier',
    'runner': BufferTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/synth_pcr_1.0/BUFFER_run_2',
    'epochs': 100,
    'init_seed': 72664933,
    'train_seeds': [94015576, 35322302, 99995829, 63998598, 99408987, 525601, 10025063, 26771122, 99776792, 40580438, 36350553, 16850414, 54180963, 45853706, 73197861, 6528211, 20100979, 35159444, 65731281, 98357964, 95847976, 87913376, 37301548, 94824833, 16811418, 67931944, 66950238, 4678179, 61028726, 68921160, 23090288, 908170, 29742549, 61616739, 17901966, 39598747, 57717278, 12022621, 85837277, 34826581, 51645941, 70315211, 54034572, 23346669, 25228110, 70414595, 42062892, 4447886, 3383547, 30176284, 86087501, 78330274, 82210250, 16007050, 80119736, 56236444, 74677741, 28530850, 36503236, 58482499, 64087400, 72360531, 69913262, 70764110, 38586303, 43617425, 87567390, 35126578, 63426301, 92096768, 89284079, 36071789, 89891447, 95794997, 57459020, 88477354, 17016716, 69797323, 73220587, 51317554, 74696434, 40804726, 48631792, 12513598, 87442992, 33751020, 36520920, 35263469, 65556448, 58448980, 61361150, 49986121, 4460724, 60714596, 29549305, 56679365, 61081925, 66847025, 32097199, 10766535],
    'val_seeds': [9386324, 90734368, 91583338, 17651782, 36373390, 58156410, 24899551, 32209730, 56640023, 75235725, 34379679, 41468893, 33056616, 75729678, 12740117, 40869306, 63520460, 98746945, 77529608, 64353320, 79999344, 72560454, 37071885, 80433346, 92557627, 68617534, 2069880, 32131593, 25766008, 15897256, 38398218, 2668340, 10262712, 85340858, 74947376, 54413327, 94193675, 34235461, 21187375, 3351206, 21104565, 22080326, 41321424, 86424926, 78074229, 17957729, 16862598, 53486496, 88445673, 59540254, 10424257, 55967641, 65661144, 41311314, 25725453, 22184079, 59518394, 8801279, 48539390, 90733389, 55258971, 11509970, 37042565, 54418574, 32068770, 1785419, 73095140, 76079365, 6395808, 82223580, 4714998, 56681885, 78416867, 96400797, 87499091, 74527387, 51716328, 94859204, 86505362, 12090192, 22555924, 60636582, 91337044, 7573431, 10924018, 1838233, 44222518, 70543176, 69411443, 70940382, 90350191, 74785841, 5049514, 47301926, 42223598, 87690012, 15412848, 96748490, 29324389, 85644067],
    'test_seed': 95553606,
    'train_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'train_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'criterion': {
        'class': BUFFER_InlierStageCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': KITTIDataset,
        'args': {
            'data_root': './data/datasets/soft_links/KITTI',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [{
    'op': {
        'class': UniformPosNoise,
        'args': {
            'min': -0.025,
            'max': 0.025,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.05,
        },
    },
    'input_names': [('inputs', 'src_pc'), ('inputs', 'tgt_pc')],
    'output_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
}, {
    'op': {
        'class': RandomRigidTransform,
        'args': {
            'rot_mag': 180.0,
            'trans_mag': 0.0,
            'method': 'Euler',
            'num_axis': 1,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('labels', 'transform')],
}, {
    'op': {
        'class': DownSample,
        'args': {
            'voxel_size': 0.3,
        },
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds')],
    'output_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Shuffle,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Clamp,
        'args': {
            'max_points': 40000,
        },
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': EstimateNormals,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds')],
}, {
    'op': {
        'class': Identity,
        'args': {},
    },
    'input_names': [('inputs', 'src_pc_fds'), ('inputs', 'tgt_pc_fds'), ('inputs', 'src_pc_sds'), ('inputs', 'tgt_pc_sds'), ('labels', 'transform'), ('meta_info', 'seq'), ('meta_info', 't0'), ('meta_info', 't1')],
}],
                },
            },
        },
    },
    'val_dataloader': {
        'class': BufferDataloader,
        'args': {
            'config': {
                'point': {
                    'conv_radius': 2.0,
                },
                'data': {
                    'voxel_size_0': 0.3,
                },
            },
            'batch_size': 1,
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': BUFFER_InlierStageMetric,
        'args': {},
    },
    'model': {
        'class': BUFFER,
        'args': {
            'config': {
                'stage': 'Inlier',
                'data': {
                    'voxel_size_0': 0.3,
                    'dataset': 'KITTI',
                },
                'train': {
                    'pos_num': 512,
                },
                'test': {
                    'scale': 1.0,
                    'pose_refine': False,
                },
                'point': {
                    'in_feats_dim': 3,
                    'first_feats_dim': 32,
                    'conv_radius': 2.0,
                    'keypts_th': 0.5,
                    'num_keypts': 1500,
                },
                'patch': {
                    'des_r': 3.0,
                    'num_points_per_patch': 512,
                    'rad_n': 3,
                    'azi_n': 20,
                    'ele_n': 7,
                    'delta': 0.8,
                    'voxel_sample': 10,
                },
                'match': {
                    'dist_th': 0.3,
                    'inlier_th': 2.0,
                    'similar_th': 0.9,
                    'confidence': 1.0,
                    'iter_n': 50000,
                },
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}]
