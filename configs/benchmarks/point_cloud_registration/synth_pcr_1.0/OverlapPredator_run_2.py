# This file is automatically generated by `./configs/benchmarks/point_cloud_registration/gen.py`.
# Please do not attempt to modify manually.
from torch.optim.adam import Adam
from torch.optim.lr_scheduler import StepLR
from criteria.vision_3d.point_cloud_registration.overlappredator_criterion.overlappredator_criterion import OverlapPredatorCriterion
from data.dataloaders.overlappredator_dataloader import OverlapPredatorDataloader
from data.datasets.pcr_datasets.real_pcr_dataset import RealPCRDataset
from data.transforms.compose import Compose
from data.transforms.vision_3d.pcr_translation import PCRTranslation
from metrics.vision_3d.point_cloud_registration.overlappredator_metric.overlappredator_metric import OverlapPredatorMetric
from models.point_cloud_registration.overlappredator.overlappredator import OverlapPredator
from optimizers.single_task_optimizer import SingleTaskOptimizer
from runners.supervised_single_task_trainer import SupervisedSingleTaskTrainer

# Configuration
config = {
    'runner': SupervisedSingleTaskTrainer,
    'work_dir': './logs/benchmarks/point_cloud_registration/synth_pcr_1.0/OverlapPredator_run_2',
    'epochs': 100,
    'init_seed': 18362205,
    'train_seeds': [40654666, 84300225, 72664933, 18480290, 96485444, 56862959, 90771905, 1383515, 79570714, 32929458, 4694727, 64743244, 88995347, 56775342, 85844457, 84142512, 81845068, 92068131, 1457828, 86881216, 64508716, 9446670, 96271122, 56260112, 48571301, 77021942, 72136042, 21135655, 94594686, 28877770, 83835509, 89737118, 56827529, 67803918, 16356065, 93046126, 39770542, 23434683, 71172847, 22945698, 70151023, 57381969, 57283646, 13217918, 28492477, 34920245, 63730294, 89231825, 69153440, 33949781, 60699288, 91404245, 51577747, 31344714, 81993402, 37320566, 62209867, 92191622, 47560987, 70056410, 89959611, 21383578, 48442125, 52126221, 18097586, 9329869, 23821763, 90991031, 44959409, 65788622, 97513349, 7766848, 68307110, 47433739, 50798605, 87255956, 59865443, 77492805, 63630579, 29922945, 31717298, 21670904, 93840038, 77424673, 97055891, 48542324, 3715777, 75731274, 83568607, 4136139, 25503444, 68149222, 94035241, 95157934, 60144988, 65985799, 94666624, 44608544, 2813061, 99891661],
    'val_seeds': [45994438, 96359006, 97016441, 11385671, 76577874, 70509369, 83863209, 52357961, 34385894, 33298994, 74610847, 29868385, 47821797, 30514147, 74118224, 12012552, 25486376, 64286406, 72941480, 6007567, 35387932, 11562324, 63711203, 29118794, 641621, 72227570, 20490863, 62927255, 56923771, 35300443, 46420944, 70544304, 81881343, 62959857, 63693731, 42460540, 12846746, 85544893, 29430213, 49189532, 91935101, 62870112, 98360025, 32171744, 17760493, 5489589, 95034583, 22235688, 59744767, 91094654, 66660421, 57628721, 60395703, 40126605, 18653240, 15364550, 95920516, 95935843, 46897239, 23477630, 12341092, 39458767, 67570886, 63356166, 89091405, 79617318, 30194404, 18665605, 31570755, 77393538, 91685471, 89208924, 41175186, 75155330, 22104489, 81410443, 30396023, 40286980, 32649087, 94393019, 893220, 87888054, 79998901, 78302371, 4719931, 72610936, 97772970, 91026876, 23177561, 66014526, 18738235, 20254216, 61087068, 16680858, 81215795, 18767590, 80421091, 71468695, 93646762, 48822697],
    'test_seed': 48228766,
    'train_dataset': {
        'class': RealPCRDataset,
        'args': {
            'data_root': './data/datasets/soft_links/ivision-pcr-data',
            'gt_transforms_filepath': './data/datasets/soft_links/ivision-pcr-data/gt_transforms.json',
            'cache_dirname': 'real_pcr_cache',
            'split': 'train',
            'voxel_size': 10.0,
            'min_points': 512,
            'max_points': 8192,
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [(
    {
            'class': PCRTranslation,
            'args': {},
        },
    [('inputs', 'src_pc'), ('inputs', 'tgt_pc'), ('labels', 'transform')]
)],
                },
            },
            'overlap': 1.0,
        },
    },
    'train_dataloader': {
        'class': OverlapPredatorDataloader,
        'args': {
            'batch_size': 1,
            'num_workers': 4,
            'config': {
                'deform_radius': 5.0,
                'num_layers': 4,
                'first_subsampling_dl': 0.3,
                'conv_radius': 4.25,
                'architecture': ['simple', 'resnetb', 'resnetb_strided', 'resnetb', 'resnetb', 'resnetb_strided', 'resnetb', 'resnetb', 'resnetb_strided', 'resnetb', 'resnetb', 'nearest_upsample', 'unary', 'nearest_upsample', 'unary', 'nearest_upsample', 'last_unary'],
            },
        },
    },
    'criterion': {
        'class': OverlapPredatorCriterion,
        'args': {
            'log_scale': 48,
            'pos_optimal': 0.1,
            'neg_optimal': 1.4,
            'pos_margin': 0.1,
            'neg_margin': 1.4,
            'max_points': 512,
            'safe_radius': 0.75,
            'matchability_radius': 0.3,
            'pos_radius': 0.21,
            'w_circle_loss': 1.0,
            'w_overlap_loss': 1.0,
            'w_saliency_loss': 0.0,
        },
    },
    'val_dataset': {
        'class': RealPCRDataset,
        'args': {
            'data_root': './data/datasets/soft_links/ivision-pcr-data',
            'gt_transforms_filepath': './data/datasets/soft_links/ivision-pcr-data/gt_transforms.json',
            'cache_dirname': 'real_pcr_cache',
            'split': 'val',
            'voxel_size': 10.0,
            'min_points': 512,
            'max_points': 8192,
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [(
    {
            'class': PCRTranslation,
            'args': {},
        },
    [('inputs', 'src_pc'), ('inputs', 'tgt_pc'), ('labels', 'transform')]
)],
                },
            },
            'overlap': 1.0,
        },
    },
    'val_dataloader': {
        'class': OverlapPredatorDataloader,
        'args': {
            'batch_size': 1,
            'num_workers': 4,
            'config': {
                'deform_radius': 5.0,
                'num_layers': 4,
                'first_subsampling_dl': 0.3,
                'conv_radius': 4.25,
                'architecture': ['simple', 'resnetb', 'resnetb_strided', 'resnetb', 'resnetb', 'resnetb_strided', 'resnetb', 'resnetb', 'resnetb_strided', 'resnetb', 'resnetb', 'nearest_upsample', 'unary', 'nearest_upsample', 'unary', 'nearest_upsample', 'last_unary'],
            },
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': OverlapPredatorMetric,
        'args': {
            'max_points': 512,
            'matchability_radius': 0.3,
            'pos_radius': 0.21,
        },
    },
    'model': {
        'class': OverlapPredator,
        'args': {
            'architecture': ['simple', 'resnetb', 'resnetb_strided', 'resnetb', 'resnetb', 'resnetb_strided', 'resnetb', 'resnetb', 'resnetb_strided', 'resnetb', 'resnetb', 'nearest_upsample', 'unary', 'nearest_upsample', 'unary', 'nearest_upsample', 'last_unary'],
            'num_layers': 4,
            'in_points_dim': 3,
            'first_feats_dim': 256,
            'final_feats_dim': 32,
            'first_subsampling_dl': 0.3,
            'in_feats_dim': 1,
            'conv_radius': 4.25,
            'deform_radius': 5.0,
            'num_kernel_points': 15,
            'KP_extent': 2.0,
            'KP_influence': 'linear',
            'aggregation_mode': 'sum',
            'fixed_kernel_points': 'center',
            'use_batch_norm': True,
            'batch_norm_momentum': 0.02,
            'deformable': False,
            'modulated': False,
            'add_cross_score': True,
            'condition_feature': True,
            'gnn_feats_dim': 256,
            'dgcnn_k': 10,
            'num_head': 4,
            'nets': ['self', 'cross', 'self'],
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': Adam,
                'args': {
                    'params': None,
                    'lr': 0.0001,
                    'weight_decay': 1e-06,
                },
            },
        },
    },
    'scheduler': {
        'class': StepLR,
        'args': {
            'optimizer': None,
            'step_size': 1000,
            'gamma': 0.95,
        },
    },
}