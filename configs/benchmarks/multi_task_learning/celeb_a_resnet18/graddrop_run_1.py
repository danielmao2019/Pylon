# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 76298717
config['train_seeds'] = [66717460, 27760984, 87049232, 20079417, 91547496, 75990877, 55797513, 88193681, 29571808, 16384674, 88031620, 477361, 16958554, 10403510, 68149922, 92364041, 97643048, 70176265, 34186367, 40321767, 50072854, 48523288, 29264048, 31275786, 65394491, 79686102, 2852926, 37731373, 26913587, 89279106, 3267301, 76224943, 33238815, 91774301, 46802081, 93860821, 51851587, 97281440, 59736583, 93058398, 26633015, 83665157, 13043462, 52303450, 20220753, 54575725, 4396311, 98123736, 98283871, 24132688, 34866952, 60729396, 50894739, 26632121, 21200450, 46848794, 68467659, 94406380, 5942844, 58726667, 25501298, 26277017, 71848219, 7796035, 3877847, 23444001, 58724385, 6796462, 92850120, 72713471, 58454099, 19440236, 51588727, 39705651, 29959938, 91589628, 36489835, 95325796, 72452624, 76199388, 36185288, 38526155, 93207358, 66904391, 98851567, 2389345, 77275419, 14140086, 98213055, 21211216, 76678675, 63235853, 7783892, 50991167, 15074415, 90532777, 11081884, 65427044, 95254885, 78605458]

# work dir
config['work_dir'] = "./logs/benchmarks/celeb_a/celeb_a_resnet18/graddrop_run_1"
