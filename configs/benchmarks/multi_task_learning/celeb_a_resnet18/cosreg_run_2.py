# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 67186040
config['train_seeds'] = [62507752, 66094903, 6643536, 57153689, 36897184, 62864451, 21734448, 57821694, 1310267, 58883535, 48850738, 43651227, 34615049, 56896101, 7090349, 28480916, 10879507, 17356032, 75148522, 37136239, 27379853, 18593450, 67082635, 2827444, 44388478, 61148387, 23404453, 56988702, 41301236, 21536543, 2383369, 35108019, 70261978, 1643818, 1654500, 34282236, 2878942, 74138659, 6876526, 54972943, 89022671, 70671101, 97892328, 37845518, 93861087, 79547703, 76829989, 55672721, 51555951, 83301298, 40120655, 26436899, 58456935, 74854363, 81394996, 94264180, 4814811, 41349123, 16377613, 56345629, 3802836, 72705457, 24091407, 64683643, 6331823, 11511282, 97826320, 48570985, 4134526, 42388746, 52906196, 97336258, 95178535, 72937983, 69261435, 78158041, 60537396, 37799761, 3120309, 64103868, 55062793, 14713043, 78445838, 35688327, 80193255, 2915698, 35155384, 76356044, 36138177, 66179813, 24095527, 58239609, 60508197, 77698082, 35207983, 23998827, 83705188, 46637549, 112242, 90401792]

# work dir
config['work_dir'] = "./logs/benchmarks/celeb_a/celeb_a_resnet18/cosreg_run_2"
