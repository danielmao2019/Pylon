# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 24520874
config['train_seeds'] = [59463541, 57138434, 41368479, 88197805, 94896262, 34026252, 55494507, 21939811, 81667438, 61812545, 96055842, 52439440, 95344243, 14889471, 63269233, 62993613, 74471826, 16114109, 40150707, 70764805, 39036501, 38880856, 49793539, 23188711, 11769823, 24404695, 42963729, 43552139, 38124681, 18609373, 16596447, 81922283, 89517092, 12018077, 82596681, 82551773, 16927617, 52197264, 67476081, 89383849, 960446, 82681220, 69562164, 7237536, 755220, 99479530, 57096213, 91586322, 24392516, 12736247, 26170477, 97345062, 69720970, 97279, 72421258, 33799527, 10334758, 35812894, 81044046, 48486240, 74074995, 28372972, 17303275, 16420646, 65501476, 80146269, 39082690, 50754115, 83948166, 90251789, 45197934, 93089776, 84224412, 28344582, 40082085, 29876287, 94347785, 59486677, 25676401, 65603031, 99824084, 32362624, 96915440, 2396779, 33551559, 51837521, 30299137, 91789177, 87454955, 53739448, 94557717, 14584423, 15617705, 90419415, 67002354, 21885600, 39334295, 21493012, 94578279, 52714362]

# work dir
config['work_dir'] = "./logs/benchmarks/celeb_a/celeb_a_resnet18/pcgrad_run_2"
