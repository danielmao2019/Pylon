# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 23326077
config['train_seeds'] = [3202811, 38377307, 93724653, 97212519, 13116466, 99513461, 61911279, 38042572, 7236315, 27806635, 89233284, 75950560, 14109983, 33067538, 58925650, 92318288, 58961284, 16443159, 59088796, 30606853, 19651907, 74466108, 92180355, 26583899, 29723303, 86595974, 96350820, 30132278, 30435130, 39113020, 43751509, 56469238, 15977957, 71123657, 79366072, 33592768, 91840879, 2465394, 28332754, 705678, 62158137, 80601060, 6545521, 36884635, 15947423, 96667410, 2397668, 57795969, 28200373, 82589297, 99411376, 72124912, 66980651, 25352110, 45736897, 24948101, 7792357, 39741643, 77184813, 43295666, 85675923, 34527039, 14424257, 72800354, 19632417, 39272264, 13497450, 50609250, 31305336, 2955897, 48468228, 75973768, 44106162, 64822080, 53931331, 41934104, 20906011, 2204687, 81091746, 65586635, 49406494, 55410399, 63064302, 19320129, 96494194, 8764733, 22092167, 26354078, 81140277, 54570235, 80614624, 20344545, 46330183, 52378136, 99574414, 97831637, 92650388, 94636215, 11724490, 27208254]

# work dir
config['work_dir'] = "./logs/benchmarks/celeb_a/celeb_a_resnet18/graddrop_run_2"
