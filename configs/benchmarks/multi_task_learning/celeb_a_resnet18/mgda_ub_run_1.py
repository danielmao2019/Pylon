# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 20007781
config['train_seeds'] = [75400673, 74345631, 45865130, 45701213, 84007529, 24963321, 35138332, 1558196, 27816933, 41340564, 33976891, 42167128, 14278011, 1553334, 91089020, 47652253, 58834968, 35686668, 98725063, 94830470, 20814518, 63756661, 96938969, 30778332, 3949080, 21884167, 2976356, 23492895, 62508711, 86266749, 19241255, 83331764, 65316231, 76777951, 89897975, 74639422, 37867914, 61608056, 71805881, 66050352, 98306148, 97571882, 91645530, 58028928, 31262663, 77798761, 14457604, 96240942, 25488463, 26841543, 95544074, 35000365, 35418452, 45221742, 16504621, 13988867, 88851798, 34069200, 83066458, 45050999, 41882104, 45694675, 93548761, 44852808, 28509100, 73010421, 59840701, 70279215, 87378887, 33365107, 91739986, 13247396, 28107750, 91771460, 71985259, 97951056, 35811467, 32991721, 25887819, 66250950, 87469452, 43928124, 96095447, 63678839, 56596971, 74567744, 71039611, 94978994, 97872100, 8480577, 48334396, 14798811, 80952383, 87532711, 31559603, 49430399, 63007193, 13316836, 69817600, 33350709]

# work dir
config['work_dir'] = "./logs/benchmarks/celeb_a/celeb_a_resnet18/mgda_ub_run_1"
