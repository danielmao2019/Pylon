# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 522224
config['train_seeds'] = [84464123, 73048066, 81016870, 12409656, 87367798, 35270404, 82105270, 28162583, 6841047, 13804696, 77979022, 57888331, 79760568, 12087023, 45111303, 35145527, 26330688, 71147064, 42914895, 4597492, 65775519, 91214093, 10206565, 46120945, 1477498, 6052576, 32001151, 19666761, 98285401, 85667340, 79325442, 15699674, 97649707, 48708112, 30115794, 54122636, 50533127, 18350537, 33192098, 2552835, 37937330, 73240036, 47914179, 76145741, 10040776, 26349265, 18436650, 82062884, 2124202, 37380144, 37156369, 22881393, 81330745, 19018076, 74085274, 31202722, 28708310, 16361621, 10035222, 86293775, 85283511, 19378360, 84871631, 46168652, 77572535, 86141834, 91141052, 31695183, 85675990, 57319606, 3316583, 72877608, 40443279, 40331544, 32561383, 50440553, 63986007, 78980305, 1505122, 40141117, 38733408, 78996965, 95654889, 6031701, 14718835, 84142396, 93466037, 31830680, 42843610, 52005413, 72872929, 83047281, 14930952, 7309154, 50737254, 94791548, 2841188, 76271181, 23122606, 5190436]

# work dir
config['work_dir'] = "./logs/benchmarks/celeb_a/celeb_a_resnet18/cagrad_run_2"
