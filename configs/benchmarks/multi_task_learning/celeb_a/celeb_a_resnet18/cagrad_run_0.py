# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 82594912
config['train_seeds'] = [14260853, 57461513, 59694688, 3421002, 38387949, 78894796, 1861741, 55489797, 75673101, 57770977, 71229682, 82396877, 57272988, 57075584, 87406572, 17323467, 61270291, 41466374, 79736285, 38801864, 44037612, 66142526, 16974699, 84531383, 68830094, 56878084, 34508454, 99127849, 22545158, 9221441, 25157954, 7580708, 77977350, 83396958, 23194574, 6307498, 96722740, 27004386, 34207964, 66758728, 95838836, 4711827, 48934270, 11232821, 12232455, 45953058, 66768557, 87855800, 29299919, 78447425, 61752134, 36092237, 64943814, 84171048, 74830467, 50654619, 58756566, 88761781, 65968887, 63143957, 13833095, 66906185, 47343209, 14735836, 68063036, 53977530, 71333790, 84827119, 26833940, 86245406, 5640075, 88510575, 55098417, 37863078, 59238639, 85837813, 9769485, 60619691, 8487848, 72583162, 44323064, 60624468, 61975363, 94014019, 40067870, 64084530, 10284077, 22323335, 24434756, 54109455, 82229511, 24091565, 79146016, 60702061, 63359406, 30355360, 29055395, 12194753, 211358, 66512204]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/celeb_a/celeb_a_resnet18/cagrad_run_0"
