# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.pcgrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 35532780
config['train_seeds'] = [1293376, 56046860, 11445927, 93838626, 11810837, 71459678, 93715983, 91378330, 68458521, 27317166, 81565530, 798474, 31212447, 73640332, 17246789, 13174012, 31555375, 29944622, 98369500, 54923642, 87040726, 2947848, 35581590, 673172, 69692575, 67487836, 25265365, 10816003, 40152756, 60445886, 44105347, 25329693, 48447415, 17136675, 76006778, 77509578, 87430411, 59477254, 270017, 48223573, 82650859, 77706639, 52335776, 38033640, 69515020, 44946814, 84187308, 59514571, 53220134, 99528926, 31172426, 80362611, 89753500, 65878283, 357890, 73281555, 58995502, 36499074, 94083516, 86959508, 60915844, 28522002, 73315549, 25561, 64043397, 19477799, 21985063, 13607975, 57640797, 94655170, 95026646, 48650518, 52230472, 90712657, 6841600, 22086196, 26471118, 55721769, 79155572, 38228389, 55338020, 24611346, 62879524, 83898535, 92383476, 41738505, 86114643, 42016765, 14804011, 830113, 36275191, 82456491, 75729563, 43610158, 91115761, 47956057, 94445467, 51799179, 26505592, 88649323]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/celeb_a/celeb_a_resnet18/pcgrad_run_2"
