# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 21034248
config['train_seeds'] = [15152491, 64651028, 49117974, 93649408, 86172190, 2581435, 93416157, 85954744, 53001629, 80334162, 61672906, 46502190, 55962333, 26789760, 18239807, 87981127, 74652744, 16737341, 77613692, 78552746, 4949483, 36395333, 76962308, 53175623, 31233277, 84152244, 40649576, 90542376, 74158870, 43123448, 45108687, 93394493, 196486, 49790431, 67054384, 90734776, 93325194, 1836782, 64675636, 83390716, 78471508, 35972204, 78554599, 4982809, 83616215, 576949, 43489606, 98829785, 21444259, 26964337, 25916434, 43634481, 89692211, 15300977, 6081819, 18534985, 15372911, 3154093, 33966081, 54336290, 36442255, 78825931, 12763021, 67759622, 3254329, 86386360, 6727830, 97414295, 80480574, 85245598, 60856559, 44760803, 58394230, 57781044, 91375742, 83047803, 86153375, 7281705, 1556062, 59404034, 70699800, 66457086, 64939613, 17229218, 9141378, 69274797, 28356572, 6744153, 62938495, 9508926, 34293099, 13193311, 7786817, 68021936, 34662776, 77275120, 5635398, 76076673, 22945426, 14917947]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/celeb_a/celeb_a_resnet18/alignedmtl_ub_run_1"
