# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.graddrop import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 63752977
config['train_seeds'] = [55204459, 49627676, 63550499, 10740447, 29512110, 80567811, 77139605, 2625123, 97939414, 82263834, 37490898, 63565593, 12872384, 18879666, 61164581, 23186749, 65420328, 7998827, 75310792, 93200180, 73735184, 27871255, 7759228, 61394855, 91608767, 75903357, 17499731, 10006255, 54694713, 2150753, 73974465, 34136254, 35755638, 84040831, 46791231, 9423423, 85716362, 47398764, 62053432, 23336510, 26244286, 21301011, 1395332, 24714180, 44629053, 25994781, 55217785, 43723471, 26405008, 70628257, 44119018, 33812446, 49469948, 74495154, 28653333, 2745741, 70650461, 11722751, 77828673, 26637375, 24072748, 60460863, 44343505, 58253851, 85995003, 58366053, 3321637, 91494349, 14377615, 1426110, 33243689, 99348577, 38241609, 34354074, 70974850, 39027914, 72299970, 26528703, 88873106, 27107551, 36359703, 47657132, 75352778, 71700624, 39089779, 70018348, 1462670, 1142591, 74989840, 76832703, 28752242, 97541021, 65917611, 49369795, 24682415, 57151313, 46975452, 91347251, 60757546, 81331130]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/celeb_a/celeb_a_resnet18/graddrop_run_0"
