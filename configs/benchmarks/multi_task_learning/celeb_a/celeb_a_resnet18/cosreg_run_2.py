# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.cosreg import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 12586630
config['train_seeds'] = [34438258, 47616239, 4915353, 70538753, 29428311, 64279980, 78444651, 82313502, 85981571, 59979184, 28526172, 79786258, 27219899, 26961854, 34442197, 97384663, 18140692, 68166589, 40459167, 87459375, 34690034, 69642994, 81777686, 60508500, 32470445, 17069520, 64497014, 93393537, 46077500, 20777974, 7999204, 42549067, 1419384, 44550575, 98114241, 3727236, 71811376, 23416381, 18744634, 94851471, 69855282, 83861918, 39591047, 33688110, 9345511, 73406399, 36203674, 55133578, 52204379, 78049768, 37311574, 6054246, 92652352, 483856, 17133709, 91875503, 67611290, 32811089, 78376659, 71274311, 14059864, 72553533, 21010879, 96587197, 68361063, 52469916, 8295198, 28613166, 16750420, 84707628, 74267208, 7665028, 8338912, 24452106, 80879224, 23849412, 99870576, 68665704, 25469338, 52054953, 2677695, 38682879, 13462798, 7801626, 12919422, 79281737, 12064552, 37855290, 47389354, 13917115, 17746748, 66324535, 4234222, 75837004, 59475220, 24940637, 29191698, 39982023, 7021943, 80530026]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/celeb_a/celeb_a_resnet18/cosreg_run_2"
