# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.baseline import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 75178068
config['train_seeds'] = [76705483, 87106333, 1339326, 26568326, 33421259, 89341046, 12257760, 81495633, 42204394, 5527631, 41928842, 83644450, 7320634, 63457774, 39717605, 28919039, 60304913, 15867336, 97151020, 44178493, 23900206, 21093361, 79103070, 55966855, 9754036, 20402606, 59804459, 1866146, 67633187, 70421673, 84478905, 51105610, 58224326, 45250189, 22001908, 22146217, 22902277, 68201274, 61909751, 25614804, 48851965, 11651387, 89842070, 71508587, 4132924, 32641691, 43297049, 14213125, 2646104, 43776291, 95164899, 7869531, 31500742, 42761206, 63980382, 73343078, 29285220, 46027249, 56670425, 95141338, 56545318, 64064444, 87879816, 57841588, 69643551, 61678286, 93318606, 21932213, 26120519, 68541205, 41732963, 47604948, 82548378, 66703442, 19273558, 73595012, 63196815, 23739326, 285077, 37845780, 57263883, 4819802, 44560937, 93488938, 19457221, 6112185, 14545553, 39541732, 93757753, 82556862, 25663571, 54506782, 86670134, 26561924, 88577982, 84285238, 32829594, 82473749, 51767574, 30314025]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/celeb_a/celeb_a_resnet18/baseline_run_0"
