# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 68881870
config['train_seeds'] = [63879099, 24190564, 98388075, 8832163, 89782865, 50856207, 17589114, 64026301, 39813695, 1902929, 25076840, 87275867, 14330918, 34996308, 47450779, 99344124, 78348752, 11609437, 69940122, 33630598, 55450355, 46742026, 65971910, 63481917, 84390014, 34773855, 57681729, 20841560, 90136688, 47433605, 69565364, 72892522, 68418032, 76418996, 57891496, 52335618, 56956785, 32925952, 53105617, 21424804, 6893889, 38599590, 83220556, 77841107, 71877181, 82439230, 79753321, 49467544, 68196615, 74767782, 41787083, 10868150, 21742699, 42538219, 41128909, 50170712, 39655135, 60555766, 98044473, 19762885, 13626556, 95115312, 18219799, 53323588, 43720104, 38077163, 73653248, 47369159, 94450771, 22832945, 25835328, 33545705, 20291224, 35721185, 64493842, 94231538, 87500597, 64063311, 74776259, 45339314, 53011688, 8074844, 36719973, 66360786, 26161976, 82062986, 85369570, 35115320, 26695752, 20263658, 49029307, 10899523, 12826352, 56299433, 73661353, 51001518, 60942984, 58811342, 45912943, 66482076]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/celeb_a/celeb_a_resnet18/mgda_run_2"
