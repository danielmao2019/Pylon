# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 39651216
config['train_seeds'] = [12494308, 26264060, 13665783, 26090921, 5239859, 46574248, 57095085, 30185479, 98422903, 17209899, 27328450, 76440648, 30951399, 49706027, 63930985, 47351497, 16150325, 12301424, 14343360, 76782500, 917600, 60636945, 88894073, 42144574, 43266580, 57170119, 93297916, 11203988, 68196370, 92127023, 24903286, 73176637, 87277291, 53457590, 92631122, 25410738, 65761771, 26958089, 33118897, 98731536, 50456152, 2505784, 43697090, 88404344, 4914545, 13118748, 20935137, 3706773, 74056132, 46849674, 72203071, 99566856, 81831209, 41026506, 41979165, 7507202, 53878311, 75801732, 95021752, 60414464, 58344063, 80504056, 38007762, 8299144, 85573021, 66891407, 30141510, 3057158, 62700370, 55542092, 76922522, 89673971, 78122363, 66512358, 6699290, 25079152, 55413494, 39853768, 31398048, 10108124, 22758527, 33083658, 915541, 71378290, 93117894, 83258282, 15781494, 31157535, 82482630, 19545884, 92246087, 46930436, 34437449, 99334063, 39048655, 73403879, 78294779, 48015419, 71956536, 5396913]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/celeb_a/celeb_a_resnet18/alignedmtl_run_0"
