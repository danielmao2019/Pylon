# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.celeb_a import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.celeb_a.celeb_a_resnet18 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 70203565
config['train_seeds'] = [91981734, 94557562, 488598, 75035768, 87282545, 90006302, 57118935, 72554991, 65599001, 5600871, 56306016, 77983749, 26677227, 44624466, 26145774, 48609516, 70958514, 93910300, 8615835, 68544501, 44937887, 66977897, 40202618, 46764915, 1639389, 75109526, 79054172, 483116, 14658758, 85285843, 10912701, 31001612, 24757640, 17846992, 46118827, 84136287, 6694959, 77975044, 3523080, 40914792, 7777671, 65311387, 52909244, 20986128, 89500483, 31060607, 13314813, 97255797, 15010860, 37861192, 80064851, 64975686, 20688038, 61966437, 64371648, 35110142, 80117501, 11227060, 16278256, 87048586, 9295785, 84977634, 74074170, 63609886, 24067769, 68107160, 36813426, 92513736, 40101199, 54293602, 75567833, 16210670, 110181, 45021612, 5856023, 85067987, 32694219, 33810587, 15466392, 13400058, 32514233, 24529922, 63936316, 12909722, 73127220, 23689426, 56390035, 19858355, 52327730, 85647253, 29081564, 93467483, 70195001, 66534817, 15157561, 87905668, 6870075, 80836751, 63334193, 61797078]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/celeb_a/celeb_a_resnet18/imtl_run_0"
