# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['depth_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['depth_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['depth_estimation']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_depth_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 97181974
config['train_seeds'] = [4468822, 2084434, 33548769, 58109320, 78623474, 14538593, 66651361, 38352536, 64413111, 74369457, 89759943, 49427474, 51455776, 60205272, 89232244, 74223884, 63030301, 7872224, 70142619, 63550057, 22646335, 69804902, 54579071, 64051858, 26742919, 41140042, 2029032, 77267810, 28480942, 33454930, 56077417, 49153011, 52282415, 85661501, 52131001, 51528273, 2660682, 40230348, 39349627, 51984249, 82129838, 75956172, 87858540, 31014333, 14534325, 28611096, 93959022, 82092998, 61829536, 39757508, 24475957, 22184352, 8661841, 5976887, 47242685, 45200223, 99046062, 59523698, 587986, 99251216, 47414995, 57232043, 85848752, 68303917, 55133982, 48369315, 70393335, 99643022, 5904366, 72984824, 80412145, 43617192, 41089077, 99231423, 14834319, 94490865, 25405108, 8640061, 68373424, 70786450, 966766, 21419709, 80119088, 85060453, 77724649, 63736399, 65197631, 83779550, 6779337, 92833132, 20119510, 70417581, 91664578, 95973675, 51414226, 10646981, 18217497, 18212207, 29347444, 31760370]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/single_task_depth_estimation_run_0"
