# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.pcgrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 37437210
config['train_seeds'] = [11912473, 98343345, 19114653, 7177660, 72619291, 12243628, 25058449, 71617757, 48650908, 70585253, 45425257, 88653900, 57420857, 22467442, 89474084, 95368411, 75503508, 4977877, 99290727, 19936822, 72790897, 21206193, 43001286, 37466448, 3284768, 31452321, 73457854, 79744105, 84366614, 11554071, 42706333, 73967787, 93058163, 30004551, 72814162, 90661322, 77552212, 32718954, 22569712, 25772136, 39668664, 47529866, 69514481, 52458566, 28709629, 54550008, 95235231, 75874029, 98879462, 8773955, 40074135, 7765245, 97629797, 4599649, 79905534, 29951275, 56740765, 16401193, 68629197, 1710391, 72216920, 32604318, 40795865, 93169544, 67669480, 38057369, 10468297, 7294750, 8960347, 57996833, 2898306, 83254974, 10411284, 55406951, 17057771, 11083673, 75147540, 32207494, 87882928, 66779085, 19792926, 63677891, 96060449, 79136740, 93980025, 94556427, 8786842, 48637047, 60472890, 3603892, 70298777, 55389415, 5779174, 97026705, 64298770, 2359260, 27025971, 54172044, 91175042, 70675299]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/pcgrad_run_0"
