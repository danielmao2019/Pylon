# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 21001703
config['train_seeds'] = [62942000, 24426851, 53327879, 24839950, 70496086, 63692489, 814432, 61970153, 34279486, 71393818, 91525198, 3713326, 37842221, 57391917, 56917548, 666142, 1383223, 83842410, 9812241, 42918609, 77444369, 41052122, 81374263, 3986252, 5392274, 76072498, 28170584, 38504125, 30187445, 69672788, 80721529, 20834022, 59912775, 26874163, 46777682, 6872801, 46591340, 43842003, 98320161, 59017227, 17375731, 38010043, 46353755, 77821570, 72475244, 78881734, 35567067, 54858709, 71899755, 74437909, 23503995, 94286300, 25305586, 43294684, 91799229, 667493, 40205429, 31698154, 49522058, 15574388, 70856361, 59216519, 85369109, 99941868, 84730848, 34191905, 32629967, 65998123, 28194642, 80905935, 10941871, 20965224, 65114780, 11270138, 11460378, 19751560, 72775079, 46784609, 66355066, 9750335, 47044902, 25009207, 41142189, 34084998, 20691250, 59450875, 81792648, 34186, 53428612, 70593555, 90721122, 63999481, 86224163, 89334748, 80459973, 33595353, 97012509, 80029233, 66697329, 11661479]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/cagrad_run_0"
