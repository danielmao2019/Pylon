# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 69777497
config['train_seeds'] = [67164178, 82987229, 89577696, 94009247, 75328738, 20838573, 24596730, 38478904, 70683962, 58311218, 13264380, 78279926, 47827677, 18984987, 16185295, 96422357, 8931648, 41624561, 56960609, 24221948, 67806558, 63774555, 8279064, 80208219, 17116139, 41541354, 52536778, 1544920, 16666533, 24407432, 15245615, 22590133, 57793562, 11434440, 86571107, 54550949, 611483, 60952301, 33811918, 4429535, 85896220, 72778727, 61398506, 50692704, 32964699, 55828553, 62527949, 18828052, 15695745, 67292166, 81646351, 32084464, 2009907, 70881852, 33910036, 47723176, 15024327, 54183558, 50667192, 4260776, 29191422, 18659996, 88913120, 53721693, 67965101, 88508539, 64681337, 43340277, 87076840, 41935199, 3317631, 93402091, 55881952, 90155597, 72131941, 9043674, 94692958, 32435529, 44586436, 86183877, 898495, 68700189, 94301732, 27345975, 84525899, 78310978, 37746826, 62029618, 1950748, 73494424, 19062502, 85047826, 75264745, 82674237, 16874391, 60437476, 32060009, 52531163, 6788122, 8699855]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/cagrad_run_0"
