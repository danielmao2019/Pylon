# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.gradvac import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 78477513
config['train_seeds'] = [86194482, 19752217, 56109208, 97438094, 21279922, 12726958, 77697243, 17308093, 41271171, 34895219, 58232947, 49468075, 34904218, 87189507, 2040918, 17710244, 66870656, 21402097, 6458005, 45607215, 8126558, 67096532, 55383465, 8774400, 72496675, 31503527, 82380509, 94191507, 54430924, 86868757, 77405022, 32538900, 39337154, 67104736, 24340091, 87365631, 8926216, 98961242, 92972832, 43145739, 23823297, 24615139, 35037792, 61793455, 62536933, 26027288, 67055464, 91091842, 20753605, 93460519, 48332767, 98415232, 21692211, 37942703, 26737972, 62918049, 83629862, 24206932, 69308898, 3251880, 15091319, 97972159, 56213159, 2162223, 79552583, 24451525, 5725054, 7036486, 79007954, 24556904, 85320605, 93690369, 4198946, 77630948, 97784121, 1305315, 474987, 35924766, 41440321, 37815288, 27544405, 58158727, 8551328, 43685958, 7515665, 12598329, 8441920, 40846378, 69200, 12978163, 35616017, 95385189, 80739833, 85725132, 61911074, 56389530, 55030157, 82487329, 72772708, 59279216]
config['val_seeds'] = [119941, 57021580, 1363850, 99170927, 24899461, 72896899, 72348403, 19221516, 80361438, 8900241, 36630937, 93567017, 2471696, 2521038, 2470925, 81548654, 20846715, 44918887, 97394850, 35569841, 56904710, 75155106, 5817480, 57434477, 65242510, 57591623, 28848370, 90900892, 62750973, 74197042, 99437942, 85976572, 6320880, 51604063, 81165859, 17461353, 82582680, 53676472, 9582598, 48005451, 32530805, 7021740, 89484178, 37440605, 56935325, 27839132, 67077093, 59793027, 70398123, 11875519, 87986750, 81658338, 56871244, 4754260, 79765966, 26954968, 66457232, 45933913, 90740725, 30405088, 86683501, 85886417, 15081117, 9670617, 46950402, 94230405, 87916065, 41300252, 55396317, 86378608, 62368452, 40213283, 5510066, 59436493, 7697579, 41504016, 59093472, 91086605, 64016707, 62379085, 78214948, 34963828, 10294074, 1026932, 36198035, 14368838, 67844081, 98919528, 44788237, 26411785, 8402833, 98835962, 42997069, 52093291, 92096656, 56686589, 2181863, 71265087, 24635171, 41373066]
config['test_seed'] = 17496544

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/gradvac_run_0"
