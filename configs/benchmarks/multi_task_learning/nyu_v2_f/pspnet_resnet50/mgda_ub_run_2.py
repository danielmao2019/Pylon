# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 13914329
config['train_seeds'] = [88914682, 34253543, 61604642, 44014161, 98941689, 36019479, 82219990, 3434946, 61976772, 3320272, 80742243, 4744688, 28878021, 65023609, 25554435, 23363355, 18180917, 55479415, 13021850, 45122077, 48098985, 70622512, 61530626, 19575617, 10350687, 39590896, 91087292, 95124942, 32818358, 18413844, 41459611, 77677393, 25127807, 82057384, 47542783, 78955631, 43612047, 21466240, 31191444, 414341, 37131991, 73259808, 16284583, 27478893, 28390148, 97624511, 89096662, 48778125, 70300768, 45847414, 49819252, 43151497, 82119563, 24923979, 85250253, 13218764, 19372807, 26785389, 61328066, 71009714, 59618371, 56478087, 18024496, 58765092, 46135360, 97154141, 34149294, 2454189, 29905116, 44224341, 69753740, 77440230, 36849839, 77694350, 93022871, 54916327, 46003643, 55833196, 86485364, 44382707, 27015758, 20044345, 42100080, 54290899, 69190410, 86617161, 71376851, 54311775, 79027067, 43713870, 10041807, 8709069, 79778467, 50392497, 67574546, 7377602, 25775871, 76773438, 28127818, 1375745]
config['val_seeds'] = [79652960, 42187669, 59117126, 69892408, 59425108, 79293079, 97354009, 79729701, 48896483, 33655290, 79691709, 46044092, 23636660, 50547204, 13917398, 26943921, 72410746, 78712278, 38156988, 66795826, 90872394, 34688729, 77767292, 17511851, 50325134, 64274953, 64430907, 22829624, 41528437, 58574739, 22889225, 72924112, 31321438, 98878167, 33703914, 92668610, 18375461, 56825535, 67715215, 75877804, 83095248, 21534300, 42937320, 82298157, 55515292, 64771794, 71711179, 74379746, 30846607, 32180032, 30590367, 14972400, 46530737, 52841891, 91974025, 61578040, 70564084, 37912223, 30775217, 88392720, 85205124, 85093793, 25271468, 284978, 1377518, 34948876, 65342194, 38680635, 82490951, 37988750, 1872668, 81328142, 76351289, 17317382, 58744552, 22020174, 37745412, 22808669, 36806620, 80280208, 79931936, 43489165, 9798147, 72707247, 21742138, 71709902, 35026331, 59219377, 11551947, 57817935, 66856830, 95577893, 29596265, 99789256, 25600987, 48176723, 80526637, 23003316, 29809858, 57197098]
config['test_seed'] = 99329944

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/mgda_ub_run_2"
