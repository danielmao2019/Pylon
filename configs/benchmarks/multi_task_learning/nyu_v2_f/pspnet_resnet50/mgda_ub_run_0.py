# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 81061851
config['train_seeds'] = [86591448, 26819699, 58225757, 10802874, 76342855, 65242166, 46539246, 18027196, 38324119, 87010629, 24784679, 35764074, 370661, 44598466, 92455191, 30874954, 92656588, 45119984, 52965974, 78909787, 80088706, 88829596, 24189502, 92958611, 70962926, 42761691, 67297942, 63891338, 36416455, 46061294, 92499529, 72499476, 34322805, 91254214, 4871976, 47436781, 44511213, 4956137, 82146557, 46377862, 70408878, 99476634, 5444084, 54860689, 56552537, 52049235, 64552459, 89004171, 82382158, 12116566, 47368743, 13787613, 8336813, 31346486, 66741276, 55951554, 8686726, 27984229, 96625160, 51772834, 77623329, 44701911, 47337182, 7186479, 88258519, 36050224, 76929012, 6033238, 14587061, 35443231, 65767511, 61448872, 46295769, 91074517, 87697713, 86992195, 97181431, 43859510, 68745335, 58756342, 26624968, 12690909, 71905091, 48936345, 76512452, 88668404, 82617716, 11806066, 23440858, 48629790, 28553045, 20772291, 6958810, 4984688, 11344885, 77227768, 79154303, 51295576, 73780644, 12281018]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/mgda_ub_run_0"
