# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 69178941
config['train_seeds'] = [7361045, 49736726, 12636328, 84476403, 74151879, 14866100, 42891741, 2215553, 14615962, 16932503, 71846683, 5021918, 44218922, 43427788, 47623920, 45812902, 12299804, 16775152, 95130027, 84621210, 72970530, 86829702, 62563101, 91435733, 42075307, 28839215, 35604020, 23536090, 34172613, 89470284, 50370258, 21020125, 6972539, 58303667, 24609503, 89015764, 32688016, 44589483, 98627028, 84957256, 61937625, 3960125, 8738364, 39251102, 20109764, 92938096, 95019902, 73519895, 22815665, 72619078, 77301188, 17751562, 34249398, 82417002, 56321258, 33728699, 11008926, 83582863, 13932025, 57045256, 38302500, 90633633, 40210467, 26590676, 71195144, 16823187, 4947696, 45481923, 76660250, 47703754, 52526709, 31573537, 28733462, 3581, 44801037, 67221488, 49430762, 31051196, 8925839, 79887147, 22623475, 72444755, 68432899, 80813029, 17199352, 91347207, 85247537, 84516922, 67534679, 37372825, 16234034, 14299949, 72032996, 96791675, 72246879, 91109591, 10818701, 4638941, 73945652, 74727500]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/imtl_run_2"
