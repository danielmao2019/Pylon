# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 8279306
config['train_seeds'] = [48841845, 43016082, 6472763, 64890926, 76561851, 15874730, 31764532, 37197230, 4261778, 18073991, 66259794, 92214618, 14461328, 5085960, 82930946, 59337173, 89507396, 86636757, 21563219, 7791637, 4998493, 43953655, 48260806, 3835106, 48056087, 83618886, 76318645, 23105005, 97344550, 71673342, 38476831, 25131770, 64759748, 46059919, 79810654, 11481208, 20525826, 7801875, 81815674, 75760325, 79464491, 70017133, 33696328, 17961362, 7555124, 32363339, 73949716, 66473090, 12624354, 92880175, 60588002, 25204808, 36763855, 22965146, 92357362, 25871892, 98179935, 9432223, 53161633, 60599441, 23390514, 35630504, 78343405, 8436915, 92622126, 78703811, 27223569, 41586547, 95856335, 3659614, 97376269, 16426010, 2449077, 4392614, 62179342, 92101432, 49450849, 48138920, 62043793, 22880661, 77083493, 51959199, 3045278, 50050083, 14321791, 88795469, 54797118, 18933278, 77892383, 33365927, 36879224, 14942786, 60225384, 97463032, 91374992, 37345686, 23424170, 28098250, 19741583, 39328170]
config['val_seeds'] = [59968092, 38438136, 51715523, 80566399, 62604249, 31392224, 85117031, 39650797, 86400096, 78264025, 77902395, 13856926, 11114545, 49403582, 89151374, 65734095, 47907255, 42347888, 63435490, 20685442, 12567854, 71418614, 76480035, 21313698, 4931690, 7077987, 63997488, 71695455, 69284857, 54471852, 96779744, 85808493, 36015172, 59221085, 81157208, 52054886, 97504081, 79015143, 67275139, 54776937, 63332796, 85582165, 1065126, 71556068, 4112139, 46831485, 71371262, 2580956, 17774845, 82444297, 46799920, 94487630, 23789676, 97232267, 59265754, 51266097, 79609491, 29676980, 50093502, 62589169, 11653884, 49940230, 42596784, 63746049, 57935443, 17952666, 7065895, 43377211, 66878235, 8138050, 97143703, 42249265, 94783815, 43719063, 11739322, 90836859, 35116000, 14883338, 5666313, 98921277, 86460124, 97837030, 83916182, 13150775, 14176681, 9522152, 74166458, 24175352, 96375679, 19633683, 14757831, 10736573, 18470663, 83332237, 42471262, 7490528, 37150152, 72028643, 84909493, 7883413]
config['test_seed'] = 61752281

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/imtl_run_2"
