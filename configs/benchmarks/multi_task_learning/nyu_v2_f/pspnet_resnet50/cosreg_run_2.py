# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 27222012
config['train_seeds'] = [23739321, 45105568, 47754820, 58758139, 1740871, 50359505, 31120783, 12009900, 16583466, 38025812, 80943184, 77450993, 72515790, 42626650, 3252510, 1203331, 80721641, 93857877, 21483363, 42271719, 41335565, 97205042, 6346147, 59496868, 53685924, 88073708, 284912, 83261448, 52239996, 60462989, 66094214, 99524402, 98447055, 68272955, 49741029, 27355302, 42516902, 24523603, 8717978, 71071847, 55023215, 58738682, 46738209, 74588030, 68598936, 52058917, 19511169, 51938075, 99026137, 60867561, 30741998, 20549695, 85796532, 29464058, 17832930, 91841100, 57887223, 20363461, 47001196, 42403537, 84487731, 53793457, 29669536, 375382, 94347168, 45625496, 654145, 4990525, 83285342, 31348261, 85311148, 80609633, 29250390, 95568753, 66146660, 48571002, 5698999, 33951054, 20820610, 27959108, 63286572, 32255551, 39029774, 31560682, 72825588, 5085646, 89823928, 19546811, 78212446, 98927875, 20633161, 89873109, 87220634, 66746303, 77587816, 72049098, 18965165, 87281327, 44623510, 34245204]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/cosreg_run_2"
