# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 56459694
config['train_seeds'] = [96284792, 61133690, 80667270, 5399269, 57580939, 27553555, 91590749, 29921873, 78779297, 64622088, 31981521, 11798514, 39279855, 96712250, 81380277, 97018701, 74100789, 71053009, 99600094, 8914606, 59271509, 80145185, 99971556, 41880695, 17457308, 36971707, 66606141, 81495124, 16643548, 44730599, 79491709, 67273995, 52981323, 61487352, 29977191, 61949002, 24032583, 99157126, 79332359, 91391927, 46080890, 30402924, 34392443, 76191443, 84255842, 31004239, 24873386, 7311366, 55481145, 48764587, 16666179, 31505188, 41641154, 68818647, 46198748, 57913256, 81351451, 37905337, 99171471, 81661697, 42850103, 7473326, 91120288, 95417247, 89670298, 86990636, 16232294, 26996843, 79811653, 41392837, 79881816, 94188537, 99153419, 84811625, 27220825, 45507008, 8734311, 56929642, 35087450, 75497330, 45933855, 91369325, 10792276, 91142406, 32041871, 32641863, 49872751, 26690549, 54515517, 56099586, 83582366, 83820319, 25014596, 84222305, 84187638, 90903386, 55553081, 40526414, 93044452, 15836493]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/mgda_run_1"
