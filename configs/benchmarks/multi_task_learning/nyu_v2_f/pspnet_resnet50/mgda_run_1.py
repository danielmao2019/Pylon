# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 56459694
config['train_seeds'] = [96284792, 61133690, 80667270, 5399269, 57580939, 27553555, 91590749, 29921873, 78779297, 64622088, 31981521, 11798514, 39279855, 96712250, 81380277, 97018701, 74100789, 71053009, 99600094, 8914606, 59271509, 80145185, 99971556, 41880695, 17457308, 36971707, 66606141, 81495124, 16643548, 44730599, 79491709, 67273995, 52981323, 61487352, 29977191, 61949002, 24032583, 99157126, 79332359, 91391927, 46080890, 30402924, 34392443, 76191443, 84255842, 31004239, 24873386, 7311366, 55481145, 48764587, 16666179, 31505188, 41641154, 68818647, 46198748, 57913256, 81351451, 37905337, 99171471, 81661697, 42850103, 7473326, 91120288, 95417247, 89670298, 86990636, 16232294, 26996843, 79811653, 41392837, 79881816, 94188537, 99153419, 84811625, 27220825, 45507008, 8734311, 56929642, 35087450, 75497330, 45933855, 91369325, 10792276, 91142406, 32041871, 32641863, 49872751, 26690549, 54515517, 56099586, 83582366, 83820319, 25014596, 84222305, 84187638, 90903386, 55553081, 40526414, 93044452, 15836493]
config['val_seeds'] = [18071096, 78865791, 10141600, 94801052, 97263802, 82226192, 31294571, 98028779, 92423403, 7047902, 72049293, 95507606, 48419713, 81077987, 43765621, 90488659, 44793541, 93584681, 72483201, 26314827, 16075438, 18890380, 33969865, 32030549, 15847909, 41583311, 62642956, 92869893, 57000865, 30031750, 97877820, 60652419, 5834596, 10649770, 7370032, 62034045, 29803341, 33037435, 33154611, 4656998, 94056569, 23967867, 83073686, 33190165, 44383411, 54625134, 16140286, 59913953, 23819417, 29563974, 39205609, 45203482, 62706390, 91390700, 89952417, 56795022, 20435659, 99812800, 47009437, 79943969, 20670798, 5768224, 22809473, 5882381, 81363258, 98931431, 34733335, 33099332, 15234682, 52577409, 83931876, 4291046, 46110097, 71553710, 19674152, 63638569, 25619076, 76368692, 91133935, 94312659, 2258072, 70113133, 50868681, 37011940, 51148569, 23954253, 99748696, 47903978, 53344477, 25054606, 95443046, 9890616, 19462496, 72201273, 27544754, 12399755, 71107841, 2912563, 33291593, 33282907]
config['test_seed'] = 59297721

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/mgda_run_1"
