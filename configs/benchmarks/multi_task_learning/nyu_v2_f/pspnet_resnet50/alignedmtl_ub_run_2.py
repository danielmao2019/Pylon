# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 79714940
config['train_seeds'] = [22867602, 15664334, 69839224, 37012270, 47851294, 88159835, 19644108, 20374839, 818010, 88020886, 21668804, 69601371, 34849937, 76293789, 13130716, 31246572, 90484774, 30061263, 1692112, 27257652, 52497312, 42243917, 74559915, 6989094, 95302315, 10908532, 16919561, 35925570, 72425852, 98923647, 37357563, 1817256, 69003002, 13731018, 61443912, 91239546, 11186163, 36382770, 29400335, 42780707, 82418781, 78093768, 18626820, 44714503, 81483610, 86907684, 51101271, 83211108, 1791232, 65438037, 83385043, 41703904, 26355997, 97033184, 24168514, 81924516, 42234259, 76946009, 78069429, 20134658, 42363644, 24351643, 63058209, 65729616, 82641173, 51903869, 74113108, 10467231, 90076070, 51933855, 4988838, 18701087, 60447078, 81268373, 14745198, 86552160, 43799384, 91410461, 49777102, 74613226, 74595765, 88753608, 2417432, 93750878, 87087882, 52799220, 87644120, 41245018, 87541778, 79072720, 55313178, 46032110, 32013506, 96867988, 10169985, 42972201, 41427857, 63491505, 35946672, 98291578]
config['val_seeds'] = [37478360, 52237661, 93451413, 47033316, 31024438, 91349394, 15240174, 85629860, 13967177, 31308592, 40361693, 24876580, 36697834, 94833872, 23317225, 94410031, 37312535, 58317901, 92378022, 9437125, 83629512, 4112102, 68820909, 25417443, 2445377, 4989683, 90531335, 38392239, 24923118, 30659903, 14655314, 85847410, 87664734, 27086525, 8836123, 95232121, 78742371, 40947464, 8682221, 38925312, 66816590, 57649869, 68528403, 65318335, 32074326, 88909223, 10562772, 31205923, 53916134, 34259531, 59475237, 75189691, 66914495, 31707757, 3423665, 77228658, 88835898, 35428962, 71363652, 93237750, 52653955, 64940911, 43030530, 84204473, 68801409, 68439867, 17542232, 45440011, 51702999, 14380884, 28585913, 88576952, 7787595, 39018060, 7524934, 33574924, 55364259, 46676596, 91348942, 91286949, 83934241, 16498355, 26047328, 64435985, 56473844, 2665269, 34982863, 3389665, 44685912, 12301036, 26843670, 26021408, 60602285, 31040302, 74730585, 66995397, 73977263, 77915174, 3791341, 26656100]
config['test_seed'] = 33315074

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/alignedmtl_ub_run_2"
