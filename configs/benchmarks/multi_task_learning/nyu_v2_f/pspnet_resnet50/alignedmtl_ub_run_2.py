# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 79714940
config['train_seeds'] = [22867602, 15664334, 69839224, 37012270, 47851294, 88159835, 19644108, 20374839, 818010, 88020886, 21668804, 69601371, 34849937, 76293789, 13130716, 31246572, 90484774, 30061263, 1692112, 27257652, 52497312, 42243917, 74559915, 6989094, 95302315, 10908532, 16919561, 35925570, 72425852, 98923647, 37357563, 1817256, 69003002, 13731018, 61443912, 91239546, 11186163, 36382770, 29400335, 42780707, 82418781, 78093768, 18626820, 44714503, 81483610, 86907684, 51101271, 83211108, 1791232, 65438037, 83385043, 41703904, 26355997, 97033184, 24168514, 81924516, 42234259, 76946009, 78069429, 20134658, 42363644, 24351643, 63058209, 65729616, 82641173, 51903869, 74113108, 10467231, 90076070, 51933855, 4988838, 18701087, 60447078, 81268373, 14745198, 86552160, 43799384, 91410461, 49777102, 74613226, 74595765, 88753608, 2417432, 93750878, 87087882, 52799220, 87644120, 41245018, 87541778, 79072720, 55313178, 46032110, 32013506, 96867988, 10169985, 42972201, 41427857, 63491505, 35946672, 98291578]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/alignedmtl_ub_run_2"
