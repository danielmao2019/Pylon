# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.pcgrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 66322039
config['train_seeds'] = [2930468, 41905944, 45153017, 35225248, 60862530, 83268328, 53763574, 69653260, 15133007, 23631027, 84592075, 34885345, 78680105, 69357687, 52958065, 25379428, 92201356, 26816739, 20628296, 29081445, 91893485, 16139348, 83638946, 85959343, 49523505, 86526711, 8566704, 69459697, 65409931, 10031996, 6400284, 87607487, 38450930, 49483965, 16711675, 17230371, 78557006, 89776739, 15578954, 11655161, 38868769, 48069530, 45884260, 78042531, 57703855, 70702829, 22152992, 7197560, 88456824, 94294123, 61506442, 96681729, 87785316, 19950270, 47202756, 90044482, 40195028, 65491980, 1750419, 83950843, 58452971, 24653065, 1500596, 21882858, 68897606, 59476462, 39293268, 40762411, 27916736, 10588058, 40006752, 27696686, 53191099, 88534016, 30536828, 5267501, 93773247, 25878826, 99830261, 81971564, 19006421, 26079225, 49703374, 13545442, 73937561, 47029222, 63286282, 33517934, 11145929, 43622266, 39923067, 53281741, 40057851, 94350282, 62739881, 14243827, 78386094, 63797536, 77678925, 87447467]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/pcgrad_run_1"
