# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.gradvac import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 96857937
config['train_seeds'] = [57575427, 46667459, 58318321, 54586251, 69902381, 84820173, 99677982, 3800217, 56578492, 41308829, 33757225, 89266423, 49246252, 51682581, 72565184, 4061842, 7217639, 898585, 19626390, 62956304, 41196558, 46987640, 11538561, 63579052, 56125834, 8479836, 52982111, 52720814, 6090952, 70364099, 59464728, 87123210, 8827719, 22253562, 49176776, 5514274, 38457838, 23753738, 31546271, 56607652, 63606104, 12176300, 13543278, 93450797, 76182779, 92325001, 87257450, 45246794, 55139392, 21913793, 66989963, 66544785, 9551538, 41121352, 53422119, 15040257, 61501846, 44526234, 31887424, 8480686, 34241770, 37216622, 28830929, 12776428, 57162400, 80670735, 21510619, 42736069, 59628033, 24843550, 70879701, 62631436, 3865480, 90365686, 76377721, 73020622, 97914596, 98664018, 78737900, 86968884, 46902828, 74111446, 99140823, 82639743, 47546705, 25241571, 92502258, 39037522, 59480074, 78184472, 79346894, 89927657, 22235866, 84304121, 84227358, 96079836, 37096171, 12345133, 65683441, 97799643]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/gradvac_run_2"
