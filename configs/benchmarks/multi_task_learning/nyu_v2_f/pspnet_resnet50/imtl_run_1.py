# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 12474961
config['train_seeds'] = [68762149, 25962464, 9576209, 27595367, 39008577, 95188254, 17319707, 46128990, 97026662, 85136810, 77194020, 30418374, 80691664, 9997243, 4406572, 57776916, 32942859, 81141727, 54608554, 23433976, 4403547, 85305907, 96277469, 88556576, 46108770, 22417178, 43762285, 55768160, 9901587, 90598997, 45907536, 67864073, 60392658, 57240946, 98942158, 75692286, 53773747, 17725464, 63627685, 88466444, 73195561, 13368583, 43840837, 78837847, 23703641, 67141865, 48558640, 87033916, 96835123, 25332659, 44968007, 85038464, 79256362, 45946684, 21331470, 40759095, 27853053, 34543752, 13609745, 55934527, 34624007, 71257202, 82644376, 67903445, 64567043, 10459304, 53281378, 51442760, 37264581, 84315738, 30407997, 91165560, 45090029, 72476257, 82585881, 20528262, 48693949, 27070411, 3184130, 57448865, 49834907, 54753490, 26530816, 51600058, 10331580, 18518244, 51202545, 36831292, 51383958, 27149537, 26909762, 58808420, 38489390, 20393454, 6223953, 32332523, 84776376, 3190636, 15242894, 85756037]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/imtl_run_1"
