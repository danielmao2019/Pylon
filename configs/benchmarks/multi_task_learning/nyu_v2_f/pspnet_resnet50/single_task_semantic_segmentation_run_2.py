# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.nyu_v2_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['semantic_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['semantic_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['semantic_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_semantic_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 77195988
config['train_seeds'] = [3268050, 17275825, 35732481, 97993980, 94707487, 66471572, 64907547, 53614508, 18071962, 94848678, 7336614, 21526030, 83498523, 39701000, 34034745, 90647956, 70124542, 28707163, 58054231, 63071053, 68832846, 652129, 95552341, 44369194, 97738761, 79942334, 73225798, 65088134, 14259448, 58850496, 47202331, 3727720, 22117784, 16204239, 65887668, 1023254, 3999027, 27651999, 9677825, 55738134, 96056667, 27694527, 10587200, 75104246, 37029998, 60712765, 65665266, 40006744, 2164958, 28471254, 38225571, 12365943, 27357462, 7963930, 33779240, 21688528, 27001241, 49355267, 68137042, 41536770, 28587502, 26786248, 4358298, 41592350, 30153358, 72266471, 96523955, 55519002, 25308501, 64904150, 90910269, 79292345, 91283081, 92939980, 34040051, 13493406, 72141685, 65157935, 47917123, 32420689, 63736157, 53893284, 38153790, 96830072, 41417258, 62096940, 27143781, 55955346, 84213446, 91068045, 12619285, 3667675, 71138203, 82396957, 81011253, 32746890, 97293946, 80243250, 30988881, 24913523]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/single_task_semantic_segmentation_run_2"
