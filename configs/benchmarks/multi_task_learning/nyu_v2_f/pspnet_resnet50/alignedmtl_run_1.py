# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 30594323
config['train_seeds'] = [72260691, 22827674, 98270, 19548492, 29974240, 74658134, 13338837, 65001355, 11105569, 52945841, 95484976, 36819070, 68028444, 55511195, 50641117, 13868614, 64481319, 71851298, 98196998, 30213891, 50591515, 82769386, 39301734, 23905066, 46577897, 2232762, 53351473, 46301761, 73654921, 75529751, 94608039, 87603771, 41744495, 20137018, 68246853, 13252106, 91435955, 61872070, 80481639, 43897205, 5171575, 12990676, 68252160, 78845007, 10501612, 20327956, 96300039, 44918206, 30979615, 79180152, 13163008, 11504253, 69605317, 64447560, 26247447, 9200848, 3053593, 33002008, 60867260, 80592843, 62611222, 38853375, 57398873, 59773156, 61922387, 47515834, 49974920, 870224, 1183986, 49401731, 91328841, 90139344, 36340227, 38966776, 39959773, 47886269, 19447128, 86646255, 26062870, 93606580, 90645301, 96669994, 92535994, 11798288, 4211969, 39305275, 89294050, 8326464, 27085464, 31207558, 67566284, 7878140, 22902949, 73593124, 60355730, 43868435, 27493575, 2683045, 70955782, 3110306]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/alignedmtl_run_1"
