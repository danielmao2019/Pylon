# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 81106996
config['train_seeds'] = [94538990, 34835161, 14174003, 16158565, 66649490, 39712668, 61606479, 68776022, 32145386, 74393066, 32103730, 15369534, 19771528, 73609389, 84055028, 9480183, 43816903, 29869443, 96361255, 88428118, 17274911, 33529823, 22119896, 87838360, 81115938, 50669645, 63438180, 31843505, 12308648, 87500117, 1247067, 77078969, 64043157, 80033175, 60946498, 92241311, 97180, 46452693, 42137306, 97918991, 77563878, 78046943, 52043228, 99279837, 91257721, 16504999, 2158804, 11233629, 74053476, 36360297, 16498808, 76396037, 21963227, 27712788, 21829690, 8137860, 96194479, 16796380, 85714864, 66192191, 52357542, 19618802, 71704051, 29648454, 21068394, 69614985, 25530173, 25585589, 1259843, 73024360, 52076966, 7264749, 56948288, 90270952, 53313551, 61988038, 86861977, 85306112, 53369316, 16435273, 14008693, 36356951, 43145091, 864744, 2389497, 55790177, 86422412, 1869240, 61690436, 74616172, 70139512, 46678101, 61824892, 1609804, 59088286, 51114324, 85718028, 87648731, 92031464, 30229656]
config['val_seeds'] = [70854000, 6598132, 24940479, 7961403, 47494489, 72588320, 25238919, 68136441, 24505526, 72732270, 55737280, 31884407, 70772914, 18537654, 23986434, 35279925, 29724942, 73571300, 12384406, 87797527, 81426259, 32842401, 56295931, 21970491, 54556966, 16607409, 76250080, 27176340, 94579043, 75130669, 17873928, 10863409, 90864049, 96023021, 26033731, 41980431, 83270551, 74012388, 9441073, 59643678, 80745176, 27269896, 48410536, 9233741, 59939007, 67553466, 50676454, 28607829, 95846359, 89950756, 91353826, 71248561, 57957741, 15327186, 60191332, 64830154, 12321922, 43995763, 91711666, 39118134, 37758816, 12020692, 34906557, 4138908, 37822582, 16432520, 96459037, 71295096, 6915713, 39333283, 62028073, 60304240, 24959716, 92253823, 27351237, 55994493, 17958209, 90420621, 78519854, 64541166, 10139188, 2469677, 40912134, 50732689, 49393162, 19549741, 81454069, 34937369, 80416310, 38131556, 23870534, 98303203, 2598960, 13030155, 93249997, 59642051, 1076632, 13591255, 9100580, 27895637]
config['test_seed'] = 34779625

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/mgda_run_0"
