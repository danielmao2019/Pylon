# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 83066893
config['train_seeds'] = [73279224, 72155881, 29349099, 26729157, 84634158, 30285644, 53578646, 57159019, 92479572, 59738153, 99910493, 30891351, 59195345, 13373932, 95090820, 199407, 80628892, 20023052, 39931901, 54976894, 78614812, 36321804, 44212913, 83721726, 12057153, 94644676, 77400856, 12571001, 20435259, 14161735, 20158304, 58153605, 94516145, 4068395, 48504557, 79220883, 96945991, 31832287, 22904380, 39326107, 78324236, 36305861, 41107732, 55327075, 87319350, 6205918, 58358385, 12615256, 31130549, 55056012, 83603707, 61197936, 94837752, 76841174, 16277968, 51585357, 50036184, 10672906, 52900672, 62589909, 72717629, 91445954, 18145971, 22500419, 93675325, 27756209, 37207854, 84751062, 14009977, 23785128, 32598974, 25253869, 17491015, 14746342, 59682263, 7249709, 82245942, 94504000, 21541233, 32238030, 51307796, 25581880, 3374776, 92909847, 8803133, 97607181, 16665064, 23946041, 5855393, 17272670, 53212064, 66821383, 9019644, 87753633, 17899053, 62396445, 48500200, 37216930, 17462718, 43113145]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/alignedmtl_run_0"
