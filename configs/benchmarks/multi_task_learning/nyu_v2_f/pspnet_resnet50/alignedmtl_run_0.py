# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 42468455
config['train_seeds'] = [13310629, 26187998, 6670401, 8377551, 63625112, 84547297, 46502242, 3971833, 91186611, 48257157, 92088530, 33973535, 58310111, 19948841, 81453375, 11228677, 19820442, 99628477, 76400865, 94082642, 39226593, 2908634, 17341549, 24072226, 87954261, 49931896, 63339862, 43907414, 96908585, 61758408, 40798964, 23413969, 85029234, 56103071, 88821895, 80954266, 8136854, 95719612, 3326980, 73940403, 12688360, 87095564, 465891, 5967985, 78986259, 7292194, 50597679, 12991821, 23714817, 46334115, 93166340, 85302226, 58029801, 40234723, 52567205, 67678831, 4498508, 43456473, 28256484, 36889544, 94425076, 83513191, 82778218, 24319892, 15974594, 31348562, 83292008, 91231065, 69417480, 22861480, 56447877, 2656202, 68447657, 6911901, 20873384, 52375368, 89422567, 35877051, 22934347, 42119685, 29849352, 7860158, 78529261, 97761369, 840836, 66500266, 45042179, 44969048, 52119506, 34917901, 55382492, 10134180, 11676023, 72759421, 14897279, 79474875, 57807085, 94644248, 65011090, 66637227]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/alignedmtl_run_0"
