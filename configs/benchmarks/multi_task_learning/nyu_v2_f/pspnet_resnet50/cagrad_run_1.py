# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 98606791
config['train_seeds'] = [89254532, 90901328, 29601107, 9498621, 43377367, 90917918, 7463290, 33553971, 72018951, 67945850, 21753622, 51564739, 12289039, 71421723, 99734198, 5349517, 15432426, 97486360, 7272864, 1314972, 16925733, 63061516, 1299251, 88084219, 65092707, 76606626, 53439851, 97613858, 51454609, 35446463, 73205511, 85228150, 24053047, 88332022, 77675967, 82036497, 84693374, 34346037, 80102882, 60534019, 92433943, 52149811, 15097744, 79780249, 91868553, 12931013, 62164813, 70721294, 21677308, 1224348, 69635509, 35403230, 34947107, 76520106, 60152978, 9129289, 19639376, 52604818, 31462906, 67432800, 24645339, 14943316, 66842622, 85201382, 39040535, 47099194, 1752813, 58761633, 90509303, 83927730, 62377581, 83144971, 53627453, 55726899, 74481125, 47585703, 49773573, 14429871, 85481602, 43880695, 1125035, 47205487, 72743533, 76849393, 51541401, 84227523, 11339798, 62834041, 30013009, 18539263, 41753529, 46482716, 21630419, 23589567, 69275893, 6837225, 89187125, 30114845, 11412522, 93916030]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/cagrad_run_1"
