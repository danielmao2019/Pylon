# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 86339766
config['train_seeds'] = [24707659, 39239619, 65039112, 23527319, 73870337, 99515352, 67875459, 67460021, 45049850, 9929079, 61909166, 36512947, 57451883, 51921714, 97860492, 21372300, 4961538, 56345730, 33845324, 4850182, 80183255, 26345405, 23061412, 50609264, 72746697, 21942130, 43001769, 33939807, 10285974, 5035143, 27772948, 81445697, 24308701, 21809096, 74586729, 33884428, 69506982, 62398241, 77992105, 41891755, 49142116, 85351157, 54758997, 23048259, 49551500, 91176490, 49568679, 37439821, 74797434, 70159913, 64143107, 57213841, 14315755, 3564573, 1877371, 91840480, 12859989, 9940848, 70856260, 49384545, 59571863, 31198292, 96838758, 16915942, 88353234, 94856168, 79068612, 3749839, 84144993, 72403328, 27507341, 96892678, 38690025, 37935859, 71877982, 51067898, 69826896, 13044234, 29558990, 39479913, 4409436, 30541024, 81416794, 78868762, 95337152, 15493905, 84688914, 43522712, 21581798, 44654931, 32050177, 42683935, 61549272, 77907177, 2081562, 88918554, 42178422, 4939133, 45596921, 11055378]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/alignedmtl_run_2"
