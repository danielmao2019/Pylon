# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.gradvac import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 43414761
config['train_seeds'] = [92917424, 16351033, 93854989, 12027143, 45620944, 91339070, 39278871, 3751445, 19428722, 74719375, 29994408, 59623199, 36568044, 66001505, 17830728, 48261067, 70595983, 33456881, 1741454, 66668040, 10554018, 89998918, 15545790, 5212537, 28896173, 52735015, 8783331, 22501832, 61868754, 2413742, 62670002, 45712533, 28567740, 88849704, 53347673, 73372924, 27435757, 92103422, 930303, 7387274, 47187018, 27602648, 93769409, 52459068, 69467078, 61579649, 63542691, 81673523, 90157198, 88586594, 69501390, 18665027, 95479392, 62435914, 85664129, 32484016, 58109530, 12217010, 42570077, 39769832, 92354053, 16238006, 32167609, 33013745, 29456534, 79988596, 70445617, 37064853, 75681499, 42191485, 43753714, 56344918, 76052168, 65747553, 20148315, 67835069, 67909184, 37483498, 46567639, 68556033, 66822944, 54902818, 78863448, 86451436, 28590145, 25117475, 72415516, 61465837, 47592859, 5032087, 2422818, 82226610, 31529428, 45950691, 75353482, 54052878, 49169753, 29877076, 27694754, 80382791]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/gradvac_run_1"
