# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['edge_detection'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['edge_detection']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['edge_detection']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_edge_detection as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 47989475
config['train_seeds'] = [30696633, 16527999, 57346292, 60866417, 57343158, 72022641, 27469210, 5397889, 85983286, 36207069, 35668826, 67028800, 8981404, 99374913, 87444133, 26977153, 68504340, 20885210, 43518275, 19548841, 76983943, 84437117, 63016384, 25547259, 14974946, 2086213, 52096080, 3345808, 42838483, 49904830, 40047439, 56793126, 86584266, 19754748, 28379559, 73254813, 73790437, 33648485, 34929353, 63212998, 86179771, 512993, 41910891, 22749176, 29916249, 51813358, 6231106, 63617507, 61561063, 39504940, 8014278, 11743054, 18462994, 91329783, 24296515, 84667363, 86683628, 22656102, 72402527, 37039078, 1691621, 31630003, 89241755, 34620700, 83428547, 9790119, 98731411, 79887875, 78607435, 62809754, 82832065, 83687303, 57618323, 65182050, 73050691, 93613327, 19375321, 57676761, 5825919, 6652178, 36527202, 80878003, 29282646, 46902994, 70767088, 30038936, 85836962, 13800917, 94162823, 2594372, 4694169, 63415933, 53053339, 60482032, 80652997, 29957935, 59944289, 96369044, 68618868, 81853605]
config['val_seeds'] = [9653750, 17882284, 39543756, 71415916, 87968432, 60017603, 18453041, 98042171, 24209241, 28093047, 25969996, 10387752, 66355088, 96337817, 96060972, 77165828, 90674359, 18995449, 34021983, 73061610, 6358322, 23048101, 87254014, 76619013, 55622897, 50001105, 78431569, 98387953, 57516395, 64537946, 54689905, 23968613, 13492120, 97769352, 95582723, 78229488, 95366674, 22771170, 56269011, 55022954, 72349935, 4101873, 76327227, 31969671, 63514581, 30173982, 53457234, 13892946, 50186398, 57648574, 9587151, 47309275, 70043528, 75691520, 61386452, 6152236, 23377767, 70110075, 69204806, 97404100, 46287343, 80237527, 89824738, 77923127, 88013241, 72463404, 38931273, 21058001, 81056231, 88710223, 73791143, 25240242, 7136407, 19816421, 57288410, 25997864, 2201872, 89460254, 23424575, 48064489, 27870640, 66923459, 38839728, 59474896, 69791265, 79056044, 65553, 43516550, 16851704, 35335488, 94441198, 34856585, 19712749, 1488998, 42185557, 58574429, 70662343, 32196617, 6043283, 13683983]
config['test_seed'] = 64444692

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/single_task_edge_detection_run_0"
