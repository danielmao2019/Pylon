# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.cosreg import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 36767252
config['train_seeds'] = [35297978, 84631636, 78689696, 33245121, 48919179, 63590422, 61437734, 25794350, 83460048, 29481993, 8591619, 83186008, 49252632, 30766778, 34344526, 93230982, 39804813, 1534384, 25538223, 33004240, 2411878, 31692572, 36845296, 6360478, 93383938, 90433753, 65675276, 13812927, 92555523, 55357849, 81731048, 6053923, 98357018, 2695988, 94461396, 44956494, 82781650, 19086292, 27965608, 46357170, 73905348, 52543921, 92721745, 53643838, 39985981, 7773525, 71365121, 71058671, 40656936, 2313339, 83968889, 15898450, 6097256, 5263940, 78360799, 85012904, 99858585, 6547329, 27208338, 77364791, 34762628, 37426008, 49075309, 14245457, 42354291, 69975094, 54498093, 56018879, 88953077, 38011958, 24466192, 9484933, 35642245, 65323075, 24343159, 43444054, 89787232, 24825719, 1108008, 49850875, 99684482, 59115296, 20721992, 65948709, 87547184, 35621121, 98513508, 70914595, 42062076, 84478573, 24687981, 39172175, 65448137, 12351039, 8656278, 36650291, 54902202, 90797918, 72850251, 95257264]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/cosreg_run_0"
