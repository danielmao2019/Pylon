# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 36854202
config['train_seeds'] = [48701869, 22628842, 46324548, 87181786, 66602983, 22618979, 58924431, 15193590, 27177484, 11150785, 63937775, 79780092, 1757891, 46360598, 30070833, 32796127, 25081806, 16018511, 72393570, 64292991, 66928013, 32316362, 99298290, 52954936, 48619648, 5738164, 11107016, 23943909, 4364221, 59664943, 53422312, 85214420, 30205462, 4287655, 54150860, 23064290, 26785074, 94029199, 81221077, 98334404, 22795948, 66224552, 26125074, 24312766, 9029729, 1985899, 27565209, 83413549, 96317439, 73219202, 22385191, 66993189, 69876373, 25347941, 17706555, 75798879, 41802196, 44073937, 11386867, 85519770, 64564422, 29107000, 39205763, 93261508, 31733676, 87796436, 43373405, 9480112, 86340169, 9680553, 58658901, 87146287, 84878826, 63504734, 40604407, 90154898, 49362254, 56550629, 44982673, 43687199, 90848917, 351840, 13518162, 15012279, 52006551, 50824434, 19255702, 67804864, 92239667, 31150156, 16893620, 94047321, 22297352, 64917714, 18549865, 29460490, 40062000, 20596717, 20539879, 37118223]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/imtl_run_0"
