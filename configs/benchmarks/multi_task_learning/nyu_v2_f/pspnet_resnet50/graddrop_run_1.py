# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 4560775
config['train_seeds'] = [98300860, 75657958, 15424110, 76760180, 83065664, 26500082, 61679469, 40123143, 29148231, 70759254, 428970, 63357100, 9004390, 13105218, 20869159, 51113394, 18152358, 15942790, 69107112, 3578513, 66407482, 95178544, 10930618, 37569713, 59280552, 10047411, 54365623, 8575621, 43427854, 88444012, 99127406, 95358953, 55565253, 24815493, 83997498, 25642203, 47570369, 76500647, 19107709, 47893452, 26990424, 25386916, 77281733, 86264646, 67787370, 58420628, 34031776, 86877008, 46134247, 50729145, 58935077, 18097470, 80385838, 86951028, 83308352, 62037714, 31169595, 27664074, 6504114, 24383015, 75076898, 63159907, 86827755, 19312361, 85519710, 96952124, 17749844, 10481549, 86256083, 21145747, 94674673, 60672853, 9036136, 66169132, 23895996, 97406487, 9225827, 75185826, 64800670, 14567777, 40376725, 22159714, 41789880, 3831514, 40070303, 40445251, 40403922, 39992959, 83862185, 92678750, 69352878, 25063979, 6076701, 28733257, 62168682, 12603804, 66765488, 14592738, 13538866, 32056629]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/graddrop_run_1"
