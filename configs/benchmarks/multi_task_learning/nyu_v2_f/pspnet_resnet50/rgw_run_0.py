# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.rgw import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 67403163
config['train_seeds'] = [1424075, 82868361, 96239361, 6125464, 25134002, 64300996, 67338128, 26053432, 12288856, 59321615, 94043220, 52896158, 68002866, 76464785, 31527194, 93209790, 6031775, 37664771, 91160647, 16164288, 65864507, 63405342, 88567839, 45494204, 25411298, 93762727, 90424667, 35771706, 92998421, 60762837, 94354693, 75200594, 2349815, 72020147, 8012010, 11149006, 70378449, 13633980, 59785416, 80900395, 8567322, 61786067, 16020879, 28567849, 13310674, 28612722, 22254398, 85484778, 21756995, 19432616, 7023963, 50981420, 61710956, 73886466, 85781051, 22052597, 45181723, 36522520, 72730568, 33834197, 29826447, 25595035, 82148282, 75479817, 99066058, 79294521, 22358638, 55384203, 64723263, 82713780, 2772109, 74823745, 73472991, 30404621, 18114016, 17689808, 83059744, 3290001, 7466591, 93443118, 6698915, 73070410, 70741332, 17787338, 11663502, 89396567, 68511668, 81356579, 12761050, 99769888, 37809471, 57289628, 56083467, 97735329, 7426408, 53785272, 27253416, 51607290, 5905698, 54377702]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/rgw_run_0"
