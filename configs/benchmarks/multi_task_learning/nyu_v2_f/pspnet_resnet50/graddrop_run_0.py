# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 71756555
config['train_seeds'] = [85234596, 52715311, 55121542, 5665407, 4942203, 25011087, 50391893, 59766144, 54805121, 54163722, 68440404, 41693907, 3682752, 610844, 19661758, 52877108, 46554971, 96973179, 67321429, 51587068, 70482845, 7275353, 93625509, 82006285, 81950483, 3979402, 66298738, 26536887, 37183243, 65172248, 45472391, 38370206, 23752082, 47949764, 47432015, 77673998, 38896019, 5064400, 80737198, 64934257, 94461862, 26099940, 31695721, 81112094, 66140296, 93891767, 62629695, 70715084, 23441569, 8250470, 60348153, 19688617, 52008576, 75293788, 57094756, 49432737, 90607327, 64252013, 88293599, 5097357, 89572431, 67623894, 69074594, 21334685, 74876361, 78531444, 34149519, 21059454, 78256501, 16393561, 36209925, 93637194, 15691051, 23207576, 84070733, 99080567, 60884892, 78551583, 59787683, 58409212, 20229606, 52377636, 73083892, 95524142, 79567361, 71466697, 14198684, 60390729, 73796382, 471213, 49291183, 58769282, 10771235, 10701958, 51096763, 2680535, 10686736, 7739433, 70999532, 41671077]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/graddrop_run_0"
