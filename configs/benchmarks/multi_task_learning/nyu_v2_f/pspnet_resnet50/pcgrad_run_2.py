# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 31623683
config['train_seeds'] = [35008645, 49130714, 58264195, 16416967, 57112347, 47297004, 25239225, 20176192, 62910377, 51050515, 18364940, 8090163, 36398249, 69173531, 8162076, 17698443, 33145096, 24355184, 38976935, 90584647, 35317104, 82193458, 12050442, 91750156, 37548405, 56982816, 54410159, 29429399, 92497439, 38934605, 96418965, 12216049, 72182748, 21018845, 9038768, 21016307, 45170274, 91468596, 45300329, 68289644, 31032972, 38050533, 62127496, 4539677, 13262695, 35581653, 48465321, 46093998, 23872544, 20303020, 14960766, 60068665, 91305399, 12239756, 9843788, 1625947, 13590078, 65140914, 74294175, 43457576, 85039153, 24487167, 50705204, 23533286, 95287681, 57089454, 35487854, 99281128, 12021619, 48944261, 93185026, 97529405, 11552759, 36758710, 1604404, 95369006, 28977107, 40315161, 10981779, 36408207, 63785337, 30414355, 75090330, 75519008, 71180196, 82952914, 30540888, 83933725, 63081653, 35300919, 90635062, 22248576, 45305814, 47712115, 24309753, 21482224, 53470195, 94562686, 44164903, 96985778]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/pcgrad_run_2"
