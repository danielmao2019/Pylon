# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.pcgrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 88755592
config['train_seeds'] = [90731934, 45183492, 81036814, 61801711, 19251712, 70743043, 24989934, 69674982, 28394326, 72234082, 50462228, 65544633, 17992388, 33957637, 33003066, 95247151, 65275823, 13987790, 63497267, 35747029, 31044387, 28767256, 88017319, 87391436, 73957468, 46887163, 51435147, 13830083, 66883477, 63938706, 65334491, 44565479, 48429935, 17688838, 24121678, 2191697, 84787185, 30572760, 25998917, 8383448, 71900585, 23628996, 78128163, 20869107, 65919857, 43421769, 82726207, 76265348, 6528788, 70054931, 55727086, 83336293, 16031365, 11466243, 26295757, 56636722, 83091609, 67715386, 66658196, 85609847, 50314203, 32284804, 51863413, 68053913, 34665495, 89482464, 43640951, 10700235, 26451602, 24544447, 62394649, 3796795, 52460970, 96757493, 28134106, 78002093, 93378907, 51818736, 72341907, 42462092, 91276089, 66032313, 53483518, 96180997, 33095058, 6184505, 50834536, 99523173, 83152764, 74755487, 80090325, 62066959, 17602127, 82784747, 64770742, 78198288, 66184842, 34740911, 54179060, 5760894]
config['val_seeds'] = [54096105, 83475340, 51875595, 97919151, 42986659, 67207357, 76148358, 93610328, 90100505, 92462525, 2996266, 97615979, 2595046, 86182126, 64784773, 50233931, 6173053, 75738974, 86896817, 93966304, 62434547, 81764799, 10088381, 14339878, 72151765, 95818373, 20750143, 86242988, 88248353, 19225152, 57564534, 10159191, 29926737, 17442405, 45317451, 42404955, 416597, 37686722, 57395684, 79223959, 28058525, 56629500, 25196124, 77602198, 91605876, 7589469, 29234195, 86811545, 78839396, 63935502, 49097388, 30154924, 92685777, 41353650, 35151096, 61937871, 15455181, 21605059, 16077200, 68373674, 51920215, 37553290, 46649530, 58448788, 32235500, 83381282, 77591834, 67018443, 52281585, 24642591, 14305789, 7778624, 31708964, 82984730, 22060783, 1991265, 81793872, 85666979, 53190663, 15584476, 88069064, 93267733, 8543567, 25973734, 38870032, 59128407, 3751611, 4181827, 32367565, 75483983, 59805261, 21914423, 90609750, 56111186, 26545156, 54464735, 500623, 49023559, 97913846, 44589919]
config['test_seed'] = 23708067

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/pcgrad_run_2"
