# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.pcgrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 88755592
config['train_seeds'] = [90731934, 45183492, 81036814, 61801711, 19251712, 70743043, 24989934, 69674982, 28394326, 72234082, 50462228, 65544633, 17992388, 33957637, 33003066, 95247151, 65275823, 13987790, 63497267, 35747029, 31044387, 28767256, 88017319, 87391436, 73957468, 46887163, 51435147, 13830083, 66883477, 63938706, 65334491, 44565479, 48429935, 17688838, 24121678, 2191697, 84787185, 30572760, 25998917, 8383448, 71900585, 23628996, 78128163, 20869107, 65919857, 43421769, 82726207, 76265348, 6528788, 70054931, 55727086, 83336293, 16031365, 11466243, 26295757, 56636722, 83091609, 67715386, 66658196, 85609847, 50314203, 32284804, 51863413, 68053913, 34665495, 89482464, 43640951, 10700235, 26451602, 24544447, 62394649, 3796795, 52460970, 96757493, 28134106, 78002093, 93378907, 51818736, 72341907, 42462092, 91276089, 66032313, 53483518, 96180997, 33095058, 6184505, 50834536, 99523173, 83152764, 74755487, 80090325, 62066959, 17602127, 82784747, 64770742, 78198288, 66184842, 34740911, 54179060, 5760894]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/pcgrad_run_2"
