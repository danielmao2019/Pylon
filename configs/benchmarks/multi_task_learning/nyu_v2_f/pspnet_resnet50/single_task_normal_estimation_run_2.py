# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.nyu_v2_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['normal_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['normal_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['normal_estimation']
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_normal_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 60606137
config['train_seeds'] = [36306628, 36137367, 94961896, 44253822, 79981726, 77740479, 37180632, 62463753, 42924369, 58632025, 74748654, 10715543, 24337860, 47568627, 83107917, 24595289, 47288270, 80473555, 22497654, 25578532, 63764571, 74700983, 80818053, 59658594, 88724429, 23247938, 92112549, 40314301, 98452671, 19477147, 80892312, 18839639, 91738409, 94676349, 7902619, 37940352, 43903802, 20852841, 21490601, 8497970, 85026456, 8158267, 83753839, 45377126, 33231545, 27641399, 49190629, 19842607, 31324064, 32224608, 93815163, 37699546, 29008458, 30677675, 82600222, 86059579, 67439138, 54308805, 73610664, 19135056, 46204875, 59118028, 43039723, 72315462, 37286002, 42710296, 32292716, 26083059, 91044376, 82806309, 48705961, 82161107, 14221374, 35570104, 67243539, 63605254, 85697624, 5231178, 40047384, 98052544, 65736261, 51535634, 91583688, 65130357, 18933481, 96140809, 815027, 22243821, 81088390, 48047832, 88568132, 71268539, 28595650, 88259503, 15925312, 65423363, 4488514, 9656395, 22235034, 11201367]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/single_task_normal_estimation_run_2"
