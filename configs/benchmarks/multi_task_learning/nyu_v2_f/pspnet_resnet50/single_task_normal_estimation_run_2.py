# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['normal_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['normal_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['normal_estimation']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_normal_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 44151580
config['train_seeds'] = [26695142, 88664188, 68992732, 91323603, 34842087, 69608032, 28125348, 65236913, 48355522, 30707881, 84750664, 5345047, 15859952, 35990133, 39765785, 39364724, 89997991, 5827356, 39241405, 42803711, 98636324, 12867024, 46904261, 61596527, 42514089, 79772525, 95433697, 88732084, 98482439, 4930282, 62848996, 494756, 2305235, 40902607, 94429769, 56457862, 14413409, 51132047, 62940358, 26782370, 59102516, 21755671, 14250404, 61494404, 77030972, 49847702, 70587708, 72830639, 15367031, 88175187, 82420762, 70920005, 90220626, 65190173, 71081172, 61419435, 36339843, 12190622, 59600414, 16211835, 17296446, 76042146, 39558814, 87588080, 36948318, 60636428, 84980204, 55230245, 37237374, 39796104, 23976245, 44133603, 12477817, 45835126, 85522148, 38841736, 37085611, 94953215, 96027044, 72130314, 14528781, 2792862, 69579381, 99086427, 30521579, 49369389, 37903740, 76367361, 54766111, 23552207, 63915060, 16932635, 23911653, 11441229, 10805894, 37151909, 28572270, 77487354, 12780497, 26637386]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/single_task_normal_estimation_run_2"
