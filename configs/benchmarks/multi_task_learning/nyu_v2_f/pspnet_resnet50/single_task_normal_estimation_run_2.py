# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.nyu_v2_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['normal_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['normal_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['normal_estimation']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_f.pspnet_resnet50 import model_config_normal_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 44151580
config['train_seeds'] = [26695142, 88664188, 68992732, 91323603, 34842087, 69608032, 28125348, 65236913, 48355522, 30707881, 84750664, 5345047, 15859952, 35990133, 39765785, 39364724, 89997991, 5827356, 39241405, 42803711, 98636324, 12867024, 46904261, 61596527, 42514089, 79772525, 95433697, 88732084, 98482439, 4930282, 62848996, 494756, 2305235, 40902607, 94429769, 56457862, 14413409, 51132047, 62940358, 26782370, 59102516, 21755671, 14250404, 61494404, 77030972, 49847702, 70587708, 72830639, 15367031, 88175187, 82420762, 70920005, 90220626, 65190173, 71081172, 61419435, 36339843, 12190622, 59600414, 16211835, 17296446, 76042146, 39558814, 87588080, 36948318, 60636428, 84980204, 55230245, 37237374, 39796104, 23976245, 44133603, 12477817, 45835126, 85522148, 38841736, 37085611, 94953215, 96027044, 72130314, 14528781, 2792862, 69579381, 99086427, 30521579, 49369389, 37903740, 76367361, 54766111, 23552207, 63915060, 16932635, 23911653, 11441229, 10805894, 37151909, 28572270, 77487354, 12780497, 26637386]
config['val_seeds'] = [88354193, 32957174, 49996569, 45858611, 92496615, 19247810, 85986960, 28461358, 16666184, 60532409, 59074665, 46045154, 22245716, 3017210, 29916470, 38201757, 55408288, 15001251, 81028903, 72838101, 67276070, 39308255, 8668497, 88985771, 31714767, 22454633, 23297639, 58111650, 9199935, 41185584, 13299472, 80613161, 51941243, 97905150, 96215323, 82882675, 66183478, 86333617, 74535553, 1009396, 34251250, 13919366, 57602263, 3098451, 29439498, 75600992, 79223748, 41326819, 61110168, 72757672, 47638673, 54801633, 53392841, 41353617, 57230437, 58901652, 45762797, 83239827, 44428025, 97397874, 35897614, 88813258, 94379639, 31912966, 23044194, 99173024, 66266982, 40883123, 34607945, 46286921, 24050125, 76426362, 71945647, 23833205, 28618297, 84501148, 48687443, 32576509, 87935567, 31580438, 96917179, 29384156, 89301722, 44472943, 96179651, 96807585, 8910466, 95353391, 45407621, 81877181, 77695211, 72185421, 26985061, 27206183, 65635629, 52044415, 93337914, 38892930, 87172680, 90661621]
config['test_seed'] = 18830697

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_f/pspnet_resnet50/single_task_normal_estimation_run_2"
