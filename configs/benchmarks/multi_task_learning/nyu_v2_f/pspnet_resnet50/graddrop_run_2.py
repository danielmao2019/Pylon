# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 81719305
config['train_seeds'] = [98437850, 74843473, 8014259, 98759721, 99066099, 97740561, 85749854, 58172759, 94720364, 86339282, 93364864, 12210024, 6972724, 44680522, 68133224, 26904205, 70996036, 54175458, 38529656, 34067354, 85790366, 30793784, 87449369, 95366240, 8025123, 49692743, 72635569, 21769490, 16271858, 6210956, 52583993, 64743187, 94271175, 8175759, 77274804, 46941922, 24285942, 54220522, 24917372, 6303061, 29288304, 60882209, 55175269, 9692748, 47784318, 32313916, 6724837, 87698636, 46307677, 22922131, 51148796, 36367694, 99058294, 49624007, 92569946, 77739586, 55405494, 70176838, 25208306, 92891143, 95727263, 17944277, 16680, 83845577, 95037768, 33953495, 41890460, 98584073, 20352537, 14354831, 23980888, 60914683, 82325105, 24722240, 44135976, 74590167, 26606739, 21688887, 80917126, 92681203, 75761979, 93690706, 96958136, 40751568, 91712972, 20134248, 90136072, 25062739, 76880962, 6396751, 1315841, 76405663, 41780845, 30249048, 86821512, 72479799, 5054383, 22417090, 92277949, 73525029]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/graddrop_run_2"
