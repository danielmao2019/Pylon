# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 77881283
config['train_seeds'] = [32680313, 93065311, 992075, 92065651, 74827553, 20308493, 21829780, 54806856, 79084198, 8209219, 8664308, 67792888, 12838760, 11139313, 40067747, 53739318, 82940383, 72381555, 22134553, 9800131, 31622618, 63406631, 93277126, 75776702, 91693763, 38229052, 87210974, 19589679, 70385113, 99487708, 9716192, 42775876, 13846402, 81018365, 89487787, 48268203, 66587883, 91160574, 1329594, 3220746, 11080296, 6700218, 33184385, 9817441, 15086877, 62910501, 90476880, 5321439, 30449102, 12357145, 2052717, 32899372, 32799190, 8617391, 42209377, 1089893, 72575891, 74318739, 69030268, 25470959, 81662920, 61100790, 96285211, 31651266, 29739588, 18825914, 76044361, 78057161, 11574057, 98219399, 70659396, 36344739, 38361200, 30435448, 68024330, 2778229, 44169599, 43289230, 1354275, 34343422, 14562290, 42367280, 95328476, 70166214, 55776657, 13516449, 93520628, 23057868, 43235100, 38316969, 36301286, 58469401, 38981272, 13852273, 5356915, 38518306, 88523257, 81357652, 36040455, 83376722]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_f/pspnet_resnet50/rgw_run_2"
