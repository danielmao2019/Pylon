# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.baseline import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 98715233
config['train_seeds'] = [49354241, 49637183, 46321881, 35267505, 12594135, 40984267, 75001947, 23358695, 28812302, 43196579, 80481860, 7517906, 55463381, 35522884, 85313140, 99387910, 50216052, 50867718, 54517974, 31561292, 7118330, 3361804, 64144402, 75885749, 20832234, 48039890, 12401140, 42498864, 58209253, 49442615, 62545360, 4961427, 22939645, 27761661, 3690388, 65520087, 99332035, 84603010, 88434848, 16390991, 75135794, 2699680, 54874422, 47004665, 88169706, 3603012, 8205281, 24828246, 89273694, 29027002, 33161622, 71273380, 40284382, 2478632, 60925648, 91496294, 82039925, 37334083, 19002348, 1750794, 96267111, 63834957, 53601857, 51309578, 53803868, 83106937, 58385464, 21945283, 87907037, 46024094, 38857495, 36356556, 82971817, 21620268, 58861635, 7919294, 92393786, 91599919, 55232530, 96182186, 30370857, 81045059, 27976284, 49761415, 28930721, 72024868, 77670602, 60275315, 13327947, 27311002, 6163246, 48327611, 8585449, 63280884, 268652, 442562, 907662, 69660250, 71668760, 79945083]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/baseline_run_2"
