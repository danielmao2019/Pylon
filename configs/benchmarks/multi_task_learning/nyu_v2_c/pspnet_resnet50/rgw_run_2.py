# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 44159267
config['train_seeds'] = [41043545, 86393571, 74384356, 61994841, 83996981, 74832419, 51816502, 68642179, 22935054, 80258839, 49166114, 16717887, 86328295, 39550217, 54409478, 95678040, 97704856, 63509534, 58392970, 90074444, 77012117, 61955796, 90323934, 44450693, 34602320, 19766326, 75640782, 88859297, 39615939, 95738025, 62265161, 12253764, 64208722, 35926657, 53529397, 97452384, 25030262, 33315511, 94098210, 33014328, 71925303, 15350410, 82322547, 62259093, 56130694, 46537617, 45697102, 73998981, 92267913, 83179317, 71841032, 4141892, 77383835, 69110639, 19603780, 74750543, 57188674, 14095234, 6613738, 38157118, 66833893, 68971313, 41025154, 23560117, 773772, 47718054, 62753736, 26544909, 42862984, 27865816, 26481398, 44300527, 74366352, 91930108, 96025736, 49814615, 59765730, 37642967, 11709942, 26238182, 47431771, 46183034, 5554803, 91480254, 79432274, 41014388, 28765939, 68917917, 2489624, 29936522, 12457388, 52567433, 67598405, 58890629, 86075501, 93949631, 56714873, 62574939, 30397110, 47625153]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/rgw_run_2"
