# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 61290270
config['train_seeds'] = [80484428, 18621607, 92039465, 9527284, 72600133, 74846267, 91041421, 5298101, 9562963, 56095507, 98554059, 39174567, 33009755, 50573653, 37899552, 72667972, 99483552, 94118003, 51312523, 2709812, 64217792, 25478678, 70180081, 92849663, 46174397, 779795, 16861353, 41894832, 92936729, 5178323, 73690209, 41978382, 43349609, 31910443, 79853343, 28363857, 35225020, 29143959, 76813813, 93646260, 98371821, 85515824, 78731303, 63525963, 67649537, 55280124, 55917649, 11879818, 64133942, 93450230, 61464129, 46247438, 34642624, 77141593, 7099072, 32538165, 39566738, 82921365, 60676418, 24414724, 43298578, 43335867, 73231381, 17095051, 30222007, 23795415, 40946288, 40790745, 93035366, 2569469, 45212839, 4585494, 70351073, 52406737, 52153580, 80364003, 51310821, 83093527, 57577144, 17522321, 75230761, 19108135, 88217002, 84653905, 24312823, 51320140, 65996143, 32366109, 72342506, 72764171, 73574510, 64388260, 12550922, 62779689, 99043050, 46905520, 2469619, 75450040, 34149943, 22219175]
config['val_seeds'] = [54438627, 68531939, 68897969, 78489328, 8044443, 37163522, 40040203, 96496728, 64979388, 47482799, 88664966, 97017633, 83594971, 15557374, 49675466, 56113782, 33397273, 66685218, 26403060, 42374521, 38789084, 92982576, 84854237, 33410250, 77364760, 99334626, 84712933, 45702985, 71935654, 59373920, 98264700, 58243836, 98200549, 17670341, 21306173, 603713, 38223239, 64345996, 651216, 47088638, 20353211, 51903727, 86288645, 23509363, 52431602, 86384348, 90148623, 59103902, 47746219, 69392717, 76603363, 52975568, 24302900, 51889551, 8915118, 19465463, 33880933, 90584322, 98311691, 9002609, 84375892, 79722783, 80605348, 63503908, 79701207, 55140395, 2792327, 25078806, 80291953, 23474647, 6054687, 18726120, 63351012, 68628830, 47355567, 79354277, 87973868, 95744745, 32748659, 83925647, 89115919, 66476989, 23977977, 66248277, 79911621, 59972460, 25398837, 69854132, 44423143, 19225682, 46577499, 61192751, 77189834, 28786651, 59230494, 25023935, 32367473, 52666214, 14217700, 53404992]
config['test_seed'] = 23304229

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/mgda_run_1"
