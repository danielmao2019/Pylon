# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 18583195
config['train_seeds'] = [80406850, 65237147, 70267700, 96624758, 21791505, 98706618, 60565982, 75874570, 74123100, 30610724, 32374534, 98976672, 19138396, 99340698, 75907503, 37922438, 27873721, 1789063, 58983677, 78292284, 5090814, 7210909, 46556796, 75231482, 10774425, 65263687, 63449802, 47652155, 26300605, 11556693, 31792152, 86961633, 67813887, 33487003, 64480650, 11820549, 3492671, 68510107, 80017995, 55746614, 92352925, 44630416, 37678186, 23924219, 6871813, 46774869, 47696319, 16073291, 90052833, 77433777, 91803599, 1829215, 75958260, 52498718, 11819459, 50347022, 23454320, 79482889, 94768417, 13400653, 68150469, 21777967, 26025014, 59022625, 59693410, 87709489, 76965644, 82803045, 16811072, 49359401, 41004374, 23195590, 90921117, 83335251, 54436817, 61184409, 96975999, 86169351, 1763371, 63273096, 74256715, 18100923, 6888481, 558254, 21805093, 22855202, 61023746, 75958002, 70790589, 52201558, 19529302, 24104799, 94078326, 82395385, 13209308, 17799552, 17002846, 68547397, 73789927, 61591914]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/mgda_run_1"
