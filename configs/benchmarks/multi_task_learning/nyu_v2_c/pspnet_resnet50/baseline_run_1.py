# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.baseline import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 55192256
config['train_seeds'] = [42311742, 40013344, 54033363, 50026545, 76799701, 48287428, 79516307, 31864920, 83473479, 60194658, 82348978, 56366938, 58828479, 10701839, 26021796, 131851, 43760569, 82073019, 63789904, 69109717, 82579535, 4054284, 453001, 27246253, 77179894, 63647141, 91427169, 9146980, 31948535, 75429978, 13617789, 28877227, 515869, 30123704, 96794435, 6851622, 76239047, 38922984, 83445622, 62758627, 638453, 90447005, 33151752, 13273639, 16471597, 55742752, 71649352, 52101397, 67967859, 11300018, 7285414, 92795212, 51746281, 95561978, 80645704, 63914673, 44456339, 45272152, 61059019, 54637126, 27534889, 58869113, 37746433, 29817032, 10662287, 27295089, 80053963, 36866886, 66810103, 57395276, 98609839, 19806825, 45060876, 441723, 80281204, 86452159, 49059078, 26211743, 29466542, 73352949, 79046952, 71484047, 16241649, 81320839, 63241961, 87282703, 77404011, 11149392, 79611579, 95595447, 77216489, 31155581, 23174048, 68412666, 14844252, 7656861, 43521261, 58472163, 49197132, 3368923]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/baseline_run_1"
