# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 93150651
config['train_seeds'] = [25594811, 24674563, 58586454, 2790809, 39618576, 72608580, 68218373, 16472307, 70129479, 36060318, 22675805, 24107554, 57179272, 88155456, 83264542, 61012725, 28893377, 1402487, 68319253, 17463910, 95996671, 66680593, 84087218, 66054584, 63708794, 41505600, 65703751, 52846763, 70844658, 77648101, 27135885, 56332772, 54503055, 54354186, 73580020, 57420667, 31704399, 63412436, 84950003, 9164642, 20313906, 46996961, 12433730, 22297913, 53559798, 79281529, 65767970, 9271916, 7457812, 89816846, 15653637, 73586613, 62802467, 81402562, 91932646, 90312383, 66554814, 32412812, 73050187, 86214921, 67208570, 93923658, 37354329, 20858580, 56777225, 11369158, 42272840, 64339643, 50065128, 81531947, 22920593, 68293263, 66863358, 3397204, 71610573, 58043580, 39565310, 95703793, 81122407, 99514867, 24719929, 43582429, 57518577, 82341827, 37073531, 36098317, 28394816, 65798996, 22590190, 51734827, 66470633, 45253386, 15482602, 73207140, 65255886, 72461251, 57710040, 15362752, 92151590, 88508653]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/alignedmtl_run_1"
