# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 51114306
config['train_seeds'] = [98935819, 16589762, 26766950, 17584539, 87469858, 46752569, 76491630, 41628328, 65169694, 4672023, 226836, 17991654, 10807237, 63398389, 67809740, 15200747, 12240251, 61316635, 84094052, 66038317, 43370842, 8905320, 85869109, 84702459, 58047670, 49881686, 75890824, 53077812, 80492231, 26475827, 22242714, 94365714, 69807581, 86571390, 75536711, 42324593, 23484160, 10341992, 67266862, 10112177, 26350267, 17708153, 15248668, 55689998, 16987722, 88618087, 73618576, 3135803, 94620174, 44637975, 58127828, 38177622, 64521338, 13242238, 46309315, 96649446, 16197708, 41402567, 90706226, 62645237, 80887063, 79744642, 80877396, 35563944, 67288163, 79858604, 25901459, 76364622, 67430614, 8653870, 2001464, 13654047, 70854242, 55450672, 31678540, 82434340, 86908291, 55714774, 64263797, 59003735, 7546065, 44644845, 90952297, 36303257, 76891850, 70343274, 97414316, 49208838, 12035821, 15042618, 37571287, 64792422, 27182210, 18744235, 50991079, 40641682, 67577785, 25419085, 42968473, 59491947]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/alignedmtl_ub_run_0"
