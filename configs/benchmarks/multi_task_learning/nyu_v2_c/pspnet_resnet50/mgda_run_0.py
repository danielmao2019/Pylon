# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 44255427
config['train_seeds'] = [10045054, 86134577, 58752960, 27069581, 63505858, 37298225, 5941022, 69572981, 12694334, 81913033, 83375987, 7441073, 95222114, 69654201, 8280091, 58940579, 95119802, 8630308, 66813550, 5622378, 69352890, 23594398, 94134671, 96621859, 25072769, 24096407, 12269420, 49651290, 21460737, 47202545, 44964951, 6749205, 53496112, 46536610, 12303213, 50591847, 4122069, 34761434, 14354090, 23264016, 62024409, 5916810, 42730017, 12204256, 72943682, 69579846, 39086813, 2640853, 72673501, 88943871, 91763089, 97913634, 7269440, 10428076, 29675257, 97152586, 54930875, 69293052, 46399841, 48015356, 85970558, 24682423, 71033375, 47353135, 35902901, 80653723, 30279330, 73369629, 65047187, 4857809, 66416764, 72162243, 28829703, 714951, 49659190, 75601456, 58844886, 10912893, 13705944, 71627767, 35152800, 83059187, 60934497, 58456242, 32783616, 36640035, 46857829, 4526592, 76138000, 54131683, 3226053, 63934988, 48533157, 87988094, 65602667, 530048, 18084553, 37258671, 47351794, 47044337]
config['val_seeds'] = [14285201, 19158000, 9492561, 91739341, 92280858, 82537076, 37134069, 15269593, 36252363, 96024701, 8668637, 791890, 33674766, 49833030, 3315492, 39585980, 78518849, 17083048, 78247283, 44455156, 52763838, 21355815, 8282807, 79509601, 54972213, 42038171, 45269286, 12614260, 75969457, 36981235, 32965360, 14714719, 9322141, 68358360, 58240754, 95555372, 52211752, 22073563, 14169507, 81618202, 54863198, 42536140, 22803214, 60665307, 58316822, 82109087, 48606378, 63427684, 25397341, 66016813, 30908679, 61184222, 27361297, 7986227, 40826726, 97556301, 90254137, 92073273, 2761644, 48887360, 61405191, 56794581, 7629825, 80228772, 16099942, 5001080, 27123663, 46932395, 95794519, 71972821, 90235351, 64775221, 22274902, 4236802, 29154340, 88576418, 71949987, 70408428, 71583593, 47055514, 34210795, 84601754, 26110192, 62954450, 90840518, 83480167, 26990981, 48378646, 22377043, 22596277, 7377540, 62434026, 33628093, 84175377, 14591050, 97262167, 24486126, 78145233, 91705586, 17419940]
config['test_seed'] = 47592571

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/mgda_run_0"
