# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 18024171
config['train_seeds'] = [25940202, 66987133, 90305526, 96144675, 81836848, 5113001, 14852999, 29967459, 4064665, 70508074, 20736744, 54221262, 52800037, 94136699, 97720052, 34895506, 17505542, 87257003, 73351845, 83199249, 24460875, 35398508, 95914164, 68322599, 10853264, 75616260, 76011068, 57746666, 25447061, 95825164, 58077267, 30227376, 2094831, 654813, 46657008, 4420813, 31477245, 2670443, 60996468, 17968718, 59992566, 69483174, 16259112, 2019471, 16515164, 42709515, 95197638, 31019741, 37190018, 34775176, 7762909, 82890409, 48766564, 97955720, 40487125, 19504037, 19504398, 86821092, 88928742, 57201107, 3640060, 36650906, 42714121, 47673441, 48380108, 96111167, 1120256, 64748370, 83813376, 71881546, 26680412, 34955853, 14031463, 89089649, 57613954, 8031699, 12756867, 79198123, 10314429, 6718219, 19583775, 3711113, 23533106, 13340916, 38489009, 37746389, 84595399, 28032968, 10489734, 85555598, 49458013, 71375501, 79794275, 5646154, 73195621, 8569528, 1516800, 52664343, 71518517, 22704845]
config['val_seeds'] = [80669146, 74007264, 19019005, 78253143, 29016117, 50073560, 74588859, 89907345, 1742075, 20774291, 52781932, 7254192, 30811368, 81223754, 3919430, 83458712, 49710178, 35626125, 12007197, 40762711, 33325190, 91098823, 9715905, 60831489, 57977719, 84944543, 2774353, 81390477, 66132857, 56563595, 68484426, 76437420, 27498979, 29648310, 26914486, 2101415, 48254325, 75584892, 55397744, 68250480, 13642146, 93267682, 42188689, 66993163, 45027390, 47261613, 52672780, 56118451, 5043288, 78778216, 12188982, 54851976, 65739002, 6993885, 73243207, 66151635, 69993375, 9476397, 59281029, 11386466, 78343509, 68432256, 4410361, 48218292, 21405031, 38398738, 3334252, 4386400, 67502322, 81577179, 64657542, 84489501, 34848532, 57370746, 80617700, 95477378, 67501732, 13746649, 19105045, 59397452, 25520774, 26101211, 85717895, 68165835, 40518674, 27329687, 29046741, 43395179, 20184333, 59431324, 44450945, 24709674, 91126654, 17248984, 94729345, 93821539, 56179325, 34670829, 55737253, 83105023]
config['test_seed'] = 595914

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/alignedmtl_ub_run_2"
