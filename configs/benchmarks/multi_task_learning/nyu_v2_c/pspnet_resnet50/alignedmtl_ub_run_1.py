# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 77543144
config['train_seeds'] = [17984046, 42258247, 84809232, 11135672, 69465125, 35518678, 48097991, 14626736, 24338966, 46180301, 60097315, 44042287, 65181138, 79481429, 5947281, 25164086, 94583161, 22133913, 23655898, 93376295, 96534893, 13226006, 3887132, 18344016, 18416433, 71049144, 130746, 64391641, 24861177, 84250253, 89878226, 4947897, 72295551, 47807437, 41271578, 90118871, 66943330, 74433517, 53508784, 31027193, 64585649, 35700535, 25885068, 8728513, 82179768, 19787874, 72915719, 65793716, 40315614, 49783421, 77587330, 74450769, 57057892, 19326655, 65774287, 22718158, 16828417, 45724209, 55843085, 56899603, 56895319, 75319525, 72481807, 81043930, 41646969, 78639496, 72886971, 99042418, 2566637, 46366908, 34935800, 19237376, 58100208, 9325208, 26161497, 73581185, 92776435, 95865394, 76112697, 63827889, 53773471, 59756548, 59605208, 58334760, 48310151, 58670471, 42423493, 59869976, 28040976, 34933409, 65370516, 34322859, 63140453, 21048863, 10143963, 88554907, 34902459, 7495463, 80878923, 93524081]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/alignedmtl_ub_run_1"
