# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['depth_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['depth_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['depth_estimation']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_depth_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 74184491
config['train_seeds'] = [84176869, 70277585, 68555606, 97246387, 184699, 39142143, 30983891, 64580176, 8338333, 75624874, 25722303, 29205910, 38903857, 52515885, 40837099, 24783526, 32327934, 39819702, 30828063, 19068618, 98519147, 321835, 36918463, 27312714, 32534857, 6445946, 7979860, 78830317, 32271526, 51395728, 28316252, 2561893, 79464203, 8217401, 45845995, 33438329, 11679145, 14455536, 81785225, 27457756, 12883142, 60050529, 8717603, 20422259, 99471560, 98916983, 115070, 1623246, 89900565, 86127683, 74869455, 55585643, 1884834, 50230215, 49952042, 21748842, 35977929, 38209707, 18913773, 12368314, 84691379, 36306310, 70462972, 55418374, 57595946, 96434277, 82659231, 98327006, 55450588, 29334024, 21537193, 92536578, 91344453, 38208928, 9780313, 75658180, 81539864, 41318549, 92266453, 71254328, 87010106, 44914630, 77608655, 25786158, 19064341, 15955246, 11688285, 9653297, 23996835, 2126114, 28321744, 43634645, 58228698, 14269127, 84868169, 4140014, 45971421, 28930472, 66448708, 58032302]
config['val_seeds'] = [51820249, 60913728, 79293601, 50803830, 17599812, 56007509, 20674709, 22007170, 25038025, 99403791, 16733537, 30241346, 96423835, 92563577, 24161438, 439159, 13126410, 40851695, 76609234, 28244332, 75102642, 91132452, 60374893, 27812839, 80650529, 82009684, 4831185, 58726470, 36399978, 7547858, 60480509, 9996192, 94270150, 88241997, 66176774, 59003247, 90990033, 81264591, 94630807, 16056037, 19939416, 9477594, 66680803, 76060895, 629823, 46841367, 55545808, 8289073, 2482943, 74630055, 28903989, 36974825, 10143958, 99834494, 69562390, 19599684, 91482889, 33290564, 68502404, 59556744, 23247528, 3729037, 37188077, 71304545, 15790344, 21683574, 68493010, 63677119, 12696013, 4523644, 45222541, 2716950, 17648465, 46136694, 11549428, 47788394, 64119924, 94646574, 51320109, 92675187, 22235757, 27721558, 63730873, 32612450, 60290179, 48696071, 569242, 6887949, 24102459, 95986228, 15098118, 21931116, 52357166, 81910705, 44351464, 51228563, 29824032, 47793451, 53326596, 35577125]
config['test_seed'] = 55645698

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/single_task_depth_estimation_run_2"
