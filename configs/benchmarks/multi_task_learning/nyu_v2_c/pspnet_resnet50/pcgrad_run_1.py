# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 80411322
config['train_seeds'] = [31473899, 32978972, 488022, 65119555, 20767550, 66647686, 91863193, 28387987, 63477325, 93151726, 72422340, 20576342, 22370361, 61546428, 81839913, 34581223, 14942569, 34598167, 78275789, 17915784, 9203493, 5369283, 24300865, 7508843, 22268892, 94337789, 26040036, 44842093, 30461122, 97411184, 55452315, 40848843, 248072, 82481406, 6853175, 80128239, 29891489, 34487810, 65669107, 79121549, 83013707, 83942035, 51659004, 95080589, 42021569, 52046404, 27900056, 63589046, 13879799, 26940055, 63473818, 10537537, 93261526, 14001047, 4385744, 98172539, 6952809, 94885587, 29700413, 46238421, 55037144, 160758, 18991395, 85814891, 78424437, 22316745, 66033367, 34904829, 85623323, 25416806, 16762550, 12317053, 3365639, 78092660, 81470, 51125541, 21279250, 97293689, 13727030, 19089620, 34866469, 42057191, 41781749, 14366857, 29019738, 65151289, 73274401, 77157418, 44349561, 45073080, 68347657, 49379671, 93889617, 77718056, 6020349, 60271149, 82820283, 68853756, 78328069, 27766834]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/pcgrad_run_1"
