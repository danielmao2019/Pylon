# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.pcgrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 12497131
config['train_seeds'] = [11993946, 15483918, 42891614, 23804742, 29727491, 50961905, 75917855, 34127304, 54159953, 96976080, 63438990, 18583664, 8982723, 38839546, 62265400, 27986482, 91734728, 2602376, 53655680, 72770635, 1953237, 78716480, 66324756, 99085065, 40977467, 71469175, 28581469, 79991771, 99542069, 31495571, 52071923, 17336322, 23590285, 24806384, 40786228, 47187500, 1599197, 75048828, 1903757, 26260243, 54892965, 71438346, 79170849, 79821753, 6236088, 46131796, 43283840, 84769559, 71032361, 48812054, 36818150, 18222109, 83710999, 18793373, 67054394, 52635579, 8214534, 40591004, 93790882, 96700097, 10911264, 13255277, 60582556, 16264621, 71437962, 61394299, 40460486, 90792188, 51247659, 15643897, 67965592, 49829929, 63944760, 84519158, 42508942, 93556877, 660941, 99356036, 90352777, 54764763, 1037304, 32285331, 21049779, 46700130, 38009950, 35066301, 59954516, 11083665, 33151976, 36450015, 62311041, 25262358, 40851663, 25439001, 98787115, 83081911, 57563285, 29723695, 54176425, 97694438]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/pcgrad_run_1"
