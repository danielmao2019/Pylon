# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 47797197
config['train_seeds'] = [92151944, 80931122, 11340041, 11155880, 12958363, 90093801, 17970681, 82325379, 74856856, 61469302, 2423970, 33854738, 6025881, 68506940, 70762190, 68138524, 28370002, 93711928, 32145861, 61388666, 62119824, 89631025, 8298828, 79229160, 197688, 57117589, 53346499, 97019367, 46695237, 25263244, 35455235, 15950387, 28571167, 64364687, 88276753, 50316901, 44419915, 63702902, 96177080, 79581178, 4612695, 67030167, 63873188, 97534071, 97740558, 57246036, 92064791, 50116066, 22947727, 58887633, 19635867, 97292048, 85207212, 4619378, 57854390, 38399438, 73178476, 67083362, 43375699, 63416549, 89110679, 43324569, 41019800, 56456398, 25240756, 35302872, 15372338, 53576040, 97886598, 53996195, 22166884, 81685565, 8421773, 34656875, 5505490, 13237954, 14042903, 23801008, 49244408, 46305599, 71069117, 94223358, 53967111, 42480822, 71109486, 89279972, 49543073, 47168200, 20532709, 93210178, 62759446, 44940934, 73760753, 2016786, 42533197, 58074121, 95160816, 31079030, 96655760, 6871853]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/cagrad_run_1"
