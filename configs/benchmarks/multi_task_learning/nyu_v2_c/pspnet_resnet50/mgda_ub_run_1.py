# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 58124793
config['train_seeds'] = [27529328, 49674396, 44018036, 15374651, 56558306, 77943263, 95805271, 13992147, 43034899, 31761079, 36580130, 27601969, 41447274, 80896113, 3558948, 10443065, 35077295, 24389879, 24937511, 21176247, 94561304, 54133315, 55973336, 90286806, 58485956, 18581095, 72674074, 13629974, 46275249, 64597309, 57083286, 9061044, 79449630, 95573890, 95031285, 98054644, 88848536, 74517986, 39673757, 74348662, 43789890, 49309544, 16907283, 48127736, 88210623, 45082615, 55685628, 82936909, 47234952, 12662102, 50963050, 54813904, 33232776, 93210473, 1813211, 30258640, 56622788, 40566120, 99497870, 16119295, 75638835, 52620979, 31997390, 16693305, 82165682, 55181630, 33494517, 97569556, 26168903, 29977289, 68601852, 1934958, 47648515, 1257419, 24324432, 52223470, 43132321, 45134191, 7370687, 10416600, 61805874, 89843675, 30667707, 70672735, 19875112, 71173886, 80086604, 67509355, 90819326, 97340492, 10212021, 63543158, 16398592, 37310501, 15421696, 15121678, 76615586, 69685998, 6666980, 84768900]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/mgda_ub_run_1"
