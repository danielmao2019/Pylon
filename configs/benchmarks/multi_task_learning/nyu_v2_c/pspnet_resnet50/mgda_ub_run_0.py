# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 30206140
config['train_seeds'] = [19558334, 59408268, 59283205, 56815788, 67098825, 12277629, 70964819, 85714824, 51095363, 60685762, 9325956, 51767074, 15846665, 79206638, 66927778, 82220171, 22149525, 92862910, 22787672, 80473822, 16385856, 2800672, 84054013, 13134374, 63186331, 94328516, 79005735, 32574577, 77961527, 10034758, 99556502, 4366413, 92708992, 48362938, 79583288, 51182355, 96330433, 89280062, 10285717, 62455750, 33000646, 30037489, 20882071, 67690734, 701091, 79022119, 513084, 75211127, 14089992, 70171392, 38617842, 79543886, 25934411, 61697950, 70403676, 16932633, 89969618, 81117462, 7160553, 39847809, 98315669, 64857619, 4745698, 92911693, 22540386, 86472135, 53947398, 39742022, 37474304, 78559854, 77240473, 90290522, 8500569, 82749008, 21935217, 68466661, 95221724, 28423789, 41289846, 65077630, 46851391, 81630422, 34004951, 66427439, 47540279, 37391587, 49992639, 77747513, 3829145, 51805810, 61433329, 87866171, 7070067, 93112525, 72379254, 41255267, 81829378, 29377622, 33230362, 23312878]
config['val_seeds'] = [86628009, 2283453, 56507960, 37294343, 34066963, 68927756, 21547025, 15637911, 9687757, 15645091, 56499521, 40497647, 87468622, 56212123, 32496991, 15500689, 68856300, 60217008, 68550145, 5293889, 46105216, 38591753, 37528633, 23983116, 18487188, 68199333, 17291419, 5544390, 93346128, 74191798, 32598921, 43948194, 17659221, 14504041, 11091824, 44118431, 80495982, 89943008, 7186048, 54327863, 84357727, 31395365, 44736154, 53576821, 61213460, 4417550, 28149705, 98933970, 52437654, 60385719, 67885060, 68562805, 30392301, 2083097, 15819792, 96586856, 41392686, 95047822, 24250043, 46877510, 9555031, 90018833, 80610984, 85205963, 44458778, 8870755, 4809260, 66069350, 38579379, 95461580, 66234102, 49181190, 57273491, 29106398, 40259285, 86677883, 27141747, 33947964, 35708165, 45739464, 65942309, 35950561, 38063542, 11446089, 42249095, 56148826, 85096614, 91071819, 85430305, 70324274, 59135024, 85300284, 70692165, 24217767, 66527514, 84300637, 47135173, 63167828, 72721995, 91286210]
config['test_seed'] = 33013203

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/mgda_ub_run_0"
