# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 33915386
config['train_seeds'] = [39756991, 8719138, 7915283, 85659220, 2534616, 8983147, 41932440, 1120957, 1733898, 37273556, 95524538, 86662155, 89156261, 71772583, 20102686, 49995531, 94883630, 1085909, 30367956, 80995061, 25672299, 82501560, 4509669, 46043138, 1854613, 25093522, 16289093, 17335848, 37532466, 62671803, 65053912, 93019614, 60568299, 62259087, 50178830, 9125157, 17922865, 76572407, 96824850, 39701222, 91305376, 67656609, 39765534, 57619351, 80365324, 49700091, 29125223, 22165396, 42611398, 97982130, 15494446, 94132851, 68476358, 37148388, 1700205, 90656312, 23733929, 43236224, 30753004, 73199069, 94534098, 52127998, 39581951, 82333728, 33368581, 36568817, 10976222, 4253456, 72699884, 86069455, 96263258, 12712160, 30218712, 82623665, 92968853, 47536356, 98760933, 6475533, 33918503, 20139112, 97047734, 75975061, 86819289, 42677445, 23896432, 98681402, 49137239, 15817777, 9808268, 512339, 6189591, 8196423, 16844291, 49136045, 4073794, 61422800, 80454572, 73452890, 43220899, 16635]
config['val_seeds'] = [89771389, 38236462, 36785606, 56960760, 25643490, 29478275, 33116260, 3485794, 17689697, 11404192, 69031446, 25216758, 29053858, 70180748, 58626700, 17625545, 53959929, 91804552, 40672372, 52743740, 50780093, 18571737, 74028170, 3794018, 48884064, 38884171, 87549681, 26579518, 12615925, 6786143, 79600888, 84380677, 51130508, 69163348, 51791675, 97729836, 41365809, 82942472, 36975781, 87211410, 13321429, 94709555, 7752264, 92845868, 28215833, 90867495, 51793639, 29114433, 15070812, 23623711, 95350967, 67421143, 10699143, 35398557, 35178234, 16229002, 67509506, 18462559, 36253120, 60594584, 29078283, 96771077, 91897258, 82782909, 68129504, 89233462, 78279228, 40364327, 57900975, 41635688, 88022161, 82683294, 41936460, 36825150, 79759147, 23479993, 46151621, 49696183, 85545763, 71569281, 24131899, 16254544, 10640191, 64052054, 14287696, 79749768, 94953220, 83213088, 63338169, 60355056, 22578926, 40472480, 58551313, 12053029, 71346769, 35164671, 82679270, 9781799, 81375777, 28005087]
config['test_seed'] = 60238901

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/mgda_run_2"
