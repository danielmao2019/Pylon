# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 39786115
config['train_seeds'] = [868144, 33740276, 7285876, 81021894, 92604318, 31167232, 78864347, 33246600, 9165261, 5251036, 13121972, 53663508, 59276694, 32969574, 79735115, 31812487, 75673378, 69533155, 25400472, 33487061, 97406399, 19217646, 35759752, 2851158, 39407376, 6492772, 62759751, 34874728, 8243259, 63791356, 95340555, 35505400, 66820389, 26510626, 44068619, 14399542, 34445740, 49255339, 57624969, 90966610, 34768018, 78528142, 55244279, 56973248, 44746582, 88042589, 80031486, 49324303, 11058689, 39372767, 45597771, 26538298, 3618486, 38978381, 33939750, 43798076, 3196183, 16993899, 22128808, 67049449, 61351232, 98624445, 12940362, 78778541, 54716405, 65225429, 97064496, 14766988, 1060879, 99752113, 6449428, 90082000, 36762871, 6063648, 22120276, 87900072, 33873304, 83553210, 80009903, 67049491, 37002640, 94384216, 80720967, 29448004, 94203330, 63036608, 89824343, 48808194, 99495755, 90463967, 60098398, 79407944, 44801068, 21522656, 17920257, 80653410, 450764, 79699379, 15832512, 36794765]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/mgda_run_2"
