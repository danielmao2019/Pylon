# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.gradvac import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 25753129
config['train_seeds'] = [97771746, 7977278, 76324943, 54617271, 93513129, 42751129, 41386583, 46487657, 76422451, 66587273, 36877524, 27130031, 77767118, 92625135, 35349022, 61743246, 29197777, 12204233, 19674428, 72388240, 10283642, 12521564, 14035888, 51424418, 92878364, 77818206, 88434993, 48236919, 52301897, 64645333, 13023464, 10967188, 47842855, 27509536, 42117450, 74500932, 9111331, 94938448, 56517549, 28740328, 96676062, 96642227, 38858197, 4955439, 58285601, 93787561, 92844162, 66281474, 83220388, 65919122, 37958333, 86374228, 94336747, 67734412, 538464, 952954, 63180563, 43087892, 770812, 28502165, 85703357, 969779, 31918659, 17021256, 33926459, 23660901, 88722432, 38963348, 26236302, 75610029, 24273207, 23370736, 79703512, 51938691, 17304173, 66988654, 74679077, 69799562, 24572219, 82828112, 36015467, 62235040, 37621956, 94746347, 68923742, 73582409, 32289660, 74091167, 77973521, 44768187, 53659507, 66021238, 86085509, 49238630, 39268782, 32895217, 23162052, 65600761, 71311562, 57376875]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/gradvac_run_2"
