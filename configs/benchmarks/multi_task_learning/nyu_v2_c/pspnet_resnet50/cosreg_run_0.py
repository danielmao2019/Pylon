# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 60542904
config['train_seeds'] = [2368395, 43522729, 33502244, 46164810, 32527331, 52873828, 30683045, 30956081, 99393442, 46439230, 25658140, 27443759, 91067890, 19666522, 39008183, 41226076, 96490991, 28542537, 22904721, 71801458, 14788019, 5556893, 42767128, 60536428, 48938002, 13250393, 97835782, 67799498, 12012938, 37159588, 10089950, 70481627, 57836303, 98643305, 81674482, 14508940, 40773100, 20073253, 66344471, 24888628, 75947674, 38674597, 70207457, 57996396, 98615682, 3262159, 16489301, 97783037, 78343325, 91371148, 5863428, 44429154, 67407673, 88334541, 63782764, 61448616, 89997257, 42652969, 67659942, 26084357, 52719954, 83073959, 810580, 10271207, 81157243, 97721811, 28088748, 47329292, 78799793, 79437296, 59055261, 53874339, 17259862, 3311966, 69103713, 2529205, 97446090, 13254809, 17300547, 10276956, 42505771, 26692502, 4854295, 91425346, 27552752, 2872458, 48128001, 32644950, 38738948, 20367447, 34633915, 99695896, 83116953, 95217591, 83716561, 11074565, 897252, 22444691, 79887136, 89601868]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/cosreg_run_0"
