# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.nyu_v2_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['depth_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['depth_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['depth_estimation']
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_depth_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 41578859
config['train_seeds'] = [45982381, 43546468, 32246391, 45539557, 60209200, 29621137, 81026697, 99231449, 90591893, 18910586, 42345272, 16697732, 68967707, 95796180, 42266180, 29182931, 70562246, 20977733, 37608553, 91699407, 98389309, 96357034, 91813623, 99246696, 50923289, 12131570, 89389928, 22510298, 69075804, 48790941, 2707420, 98580475, 93591662, 31537779, 68724167, 36326786, 93139016, 24033563, 87934592, 30157263, 79420252, 73747158, 26529129, 91603145, 37849389, 76990422, 43541254, 68590166, 89240127, 18407949, 60985164, 75835937, 41623690, 91651209, 53908174, 30861273, 14943377, 22870913, 70749038, 17823460, 60881821, 45824684, 80918966, 33969568, 11064455, 24947047, 70920011, 93675651, 69815902, 98351963, 6520345, 36181871, 70115931, 33036743, 45047110, 72906264, 56934658, 76209329, 11427585, 98923916, 27222319, 57741978, 770271, 5976683, 74721331, 73893855, 96182492, 8452252, 39911781, 68935352, 43125457, 32790610, 20242142, 94387291, 19031877, 67442388, 90232015, 32935858, 81158768, 4129208]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/single_task_depth_estimation_run_0"
