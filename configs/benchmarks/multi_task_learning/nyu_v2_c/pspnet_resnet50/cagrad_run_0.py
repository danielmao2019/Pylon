# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 75931097
config['train_seeds'] = [12549928, 24993582, 50346808, 86017645, 75829628, 73927030, 37874984, 22383887, 79732384, 97837229, 31496283, 89050790, 25571365, 1113444, 79896183, 81702474, 65022212, 60244307, 65036513, 2219025, 88811785, 8462152, 21743694, 21877656, 60257776, 13824795, 4164509, 77062696, 47876525, 22483569, 922255, 33791651, 74498339, 35068766, 37050057, 12488365, 35011632, 74938496, 20288088, 19029125, 69822195, 72929081, 39534890, 48093329, 21248969, 34873509, 95893582, 79733762, 7282704, 55607020, 77019799, 41466711, 18649025, 44990122, 20377241, 82471529, 91737443, 52243791, 6492981, 58895984, 69477966, 9463908, 93197165, 85702374, 1701242, 92512582, 15247688, 77102199, 75296158, 68485775, 50023156, 96202255, 72399097, 97543882, 77192991, 78845401, 37336518, 2843180, 18411714, 1725385, 1501467, 53710960, 93677313, 56687464, 87236776, 19069986, 23901987, 18983954, 48661923, 61375406, 4175386, 33922757, 30175778, 81484896, 22437521, 92619841, 40316607, 86083303, 21668407, 97499411]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/cagrad_run_0"
