# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 89108419
config['train_seeds'] = [72407205, 86877573, 68215388, 49323961, 28819869, 40035923, 96701211, 64756985, 68962649, 552767, 10652752, 73033885, 45006490, 15758282, 58804636, 50808608, 78720051, 33638, 73195875, 29824890, 82934510, 91617305, 7944760, 53171493, 95276993, 27191110, 29714076, 80029670, 1712258, 70280023, 63742363, 73458499, 70705994, 93161863, 89823602, 97674418, 51916446, 47083386, 89399403, 64234598, 48326971, 45743751, 49996587, 62105635, 55860135, 11898866, 76007863, 63504819, 52656862, 73632625, 2015135, 54304293, 1543286, 82942298, 75691300, 49095256, 42082249, 91504460, 21171661, 49086639, 19411004, 10864051, 11842697, 92211913, 72111112, 25859884, 84656631, 87502124, 94056188, 21649042, 59512583, 85545106, 41180431, 14455936, 935682, 82158700, 83830217, 31468724, 23517172, 54118412, 67396293, 2172849, 93676927, 94354067, 57826498, 83661959, 3927328, 77675139, 3587162, 93857978, 34321556, 198456, 90292336, 12651286, 23862793, 85500936, 73175316, 42917948, 83252720, 90076223]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/cagrad_run_0"
