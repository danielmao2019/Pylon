# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['semantic_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['semantic_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['semantic_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_semantic_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 6828545
config['train_seeds'] = [88513918, 89869929, 85264848, 27491864, 9141552, 99704055, 97440503, 91057947, 51861815, 36254627, 40573734, 37162805, 58603934, 47115683, 1223634, 44805462, 56753453, 12072707, 54649037, 64161242, 24664870, 60159387, 10807954, 64947833, 57965012, 14610754, 8689358, 17032264, 58588811, 31993186, 90498815, 82050203, 39491883, 29717562, 94582761, 12661493, 18341169, 38827311, 73654276, 50221460, 31334896, 88497125, 27829208, 87582543, 32391413, 74451884, 55355508, 24890344, 45356024, 32919122, 88981452, 9105202, 64471962, 5708837, 65852056, 75929798, 42281763, 20947546, 51621438, 25506421, 80935893, 55444484, 22273529, 66745001, 29093076, 96359180, 30720258, 18464874, 86441802, 99482056, 26384807, 79477584, 53954855, 16293993, 97550647, 22645071, 43000125, 38297194, 72488568, 75113067, 20852303, 10231271, 66321549, 39418202, 68992552, 45972481, 43118564, 77866491, 81159710, 38074083, 50504201, 18453006, 33935110, 30999479, 59044750, 91822784, 22666183, 36912944, 87282034, 52838143]
config['val_seeds'] = [30509624, 75992601, 74704506, 51932707, 38956725, 85925264, 94952074, 62534958, 656780, 97662279, 30164666, 45794723, 98990381, 83554424, 417668, 59389278, 42208745, 86863216, 48191657, 14534360, 5730376, 49319299, 86997824, 3629986, 24608408, 54333865, 49891942, 65806932, 81274031, 65821529, 8375504, 55379725, 10377937, 71975524, 7011054, 21751489, 97991348, 34711547, 94035290, 55280974, 56763761, 80071233, 52370297, 30623343, 42859580, 82823808, 26547567, 60637516, 20031641, 83429706, 81274132, 72646269, 51383755, 8815453, 72930776, 67091753, 80843364, 2867108, 80245351, 40162014, 54396814, 76176648, 7312125, 76500215, 16234018, 55731988, 21152041, 83409955, 64517324, 14898515, 45562405, 35219965, 18788528, 6657282, 29747158, 59808829, 6073905, 40387390, 95725561, 62038380, 77350379, 57105062, 40216304, 89018701, 52779641, 40761507, 910721, 30084216, 44574934, 17898346, 12705029, 91452006, 45806814, 60113328, 99962321, 55882258, 39589189, 85482838, 41960246, 17082015]
config['test_seed'] = 58434736

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/single_task_semantic_segmentation_run_0"
