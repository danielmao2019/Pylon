# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['semantic_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['semantic_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['semantic_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_semantic_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 6828545
config['train_seeds'] = [88513918, 89869929, 85264848, 27491864, 9141552, 99704055, 97440503, 91057947, 51861815, 36254627, 40573734, 37162805, 58603934, 47115683, 1223634, 44805462, 56753453, 12072707, 54649037, 64161242, 24664870, 60159387, 10807954, 64947833, 57965012, 14610754, 8689358, 17032264, 58588811, 31993186, 90498815, 82050203, 39491883, 29717562, 94582761, 12661493, 18341169, 38827311, 73654276, 50221460, 31334896, 88497125, 27829208, 87582543, 32391413, 74451884, 55355508, 24890344, 45356024, 32919122, 88981452, 9105202, 64471962, 5708837, 65852056, 75929798, 42281763, 20947546, 51621438, 25506421, 80935893, 55444484, 22273529, 66745001, 29093076, 96359180, 30720258, 18464874, 86441802, 99482056, 26384807, 79477584, 53954855, 16293993, 97550647, 22645071, 43000125, 38297194, 72488568, 75113067, 20852303, 10231271, 66321549, 39418202, 68992552, 45972481, 43118564, 77866491, 81159710, 38074083, 50504201, 18453006, 33935110, 30999479, 59044750, 91822784, 22666183, 36912944, 87282034, 52838143]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/single_task_semantic_segmentation_run_0"
