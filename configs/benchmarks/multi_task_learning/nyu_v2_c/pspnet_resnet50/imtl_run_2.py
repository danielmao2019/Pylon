# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 96097176
config['train_seeds'] = [79082694, 82308782, 1659012, 7164883, 9671312, 85036992, 41044629, 3625493, 42477160, 30671697, 28431061, 23750478, 67333922, 7498674, 27716077, 70781232, 54114354, 68635714, 73683813, 43504050, 5939982, 60994512, 18559148, 89024774, 76052111, 57892075, 47278494, 84211241, 50496319, 20987576, 41299885, 68980640, 24123191, 60426869, 10079645, 94545184, 93522927, 77424287, 29266445, 5817604, 43458424, 14245704, 19329214, 60958092, 72495387, 77921570, 75233174, 16074724, 65749734, 36338012, 89310909, 55179457, 80900637, 74454827, 66275251, 37871171, 73072949, 82366127, 57630398, 41061711, 52840568, 3484220, 87443971, 34502904, 73666471, 12818013, 78522759, 20107918, 62335607, 65129769, 50806525, 92661326, 73799486, 87006609, 66424615, 69498207, 33810272, 66320029, 76982749, 32468611, 72800772, 40043580, 18784421, 68008124, 77289015, 25321905, 29256377, 54077828, 90789183, 14468926, 59477061, 34816215, 38483695, 10297311, 5725554, 49302223, 6772553, 30620781, 35767417, 51116655]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/imtl_run_2"
