# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['edge_detection'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['edge_detection']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['edge_detection']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_edge_detection as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 37164111
config['train_seeds'] = [27604993, 40195901, 85123982, 75104411, 21234476, 93249578, 8418466, 90840221, 97497722, 85249952, 93819307, 64082958, 12556799, 41803378, 46941258, 43013734, 25523408, 60851691, 47586446, 58740262, 19305786, 6161034, 43775652, 81632506, 89294395, 40644107, 54392346, 59025104, 27430496, 89860059, 25469683, 20226608, 83615908, 45244783, 56058753, 15454718, 47424554, 92017615, 36660277, 11710088, 86052262, 73672382, 40312373, 76448149, 98596663, 91832622, 96742787, 577375, 73717171, 68362518, 3811037, 61117952, 27925307, 81394535, 41804847, 12638699, 25150977, 42139479, 41400556, 46425856, 73976496, 16280984, 94254673, 98815894, 44260415, 38015101, 20779666, 3567598, 53722868, 1736084, 18268632, 88196632, 67718597, 10118766, 32185820, 98205804, 23788975, 63386607, 89767211, 60815309, 71777839, 52854485, 29888646, 87292716, 88172357, 40015485, 6333210, 12563739, 67150084, 23973849, 6044343, 75399253, 63368452, 33916627, 60634592, 3384262, 89521956, 714545, 95257179, 5106689]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/single_task_edge_detection_run_0"
