# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 95960285
config['train_seeds'] = [99208600, 6503874, 99826782, 41804271, 14461244, 77057531, 51405679, 26148564, 34312337, 12302722, 14191136, 10632482, 89601227, 99661172, 84183641, 7121259, 86806877, 25892068, 27210759, 65748886, 12130009, 6271232, 63425097, 13040434, 28782560, 20348523, 24372876, 78004568, 2255499, 41415997, 15855883, 98136795, 74630072, 77224091, 17805278, 16731068, 57391084, 29787018, 88264355, 40211961, 37482779, 84536274, 11203577, 23891841, 77409504, 61202429, 99860918, 6732616, 91062951, 4521166, 7716891, 91146543, 16778327, 47589584, 99288693, 27380021, 3768909, 6219209, 73495675, 84608802, 12778059, 67590714, 66622176, 17388282, 44008960, 88461407, 74312851, 92983882, 93051013, 79287629, 36156276, 10100340, 1810074, 52165569, 58584030, 90102126, 21470485, 22520916, 39671030, 49772755, 9021454, 11660877, 19735338, 98086641, 9629738, 37238175, 36001163, 52929108, 32462946, 28865236, 39890211, 8339878, 73154143, 53003068, 19909855, 75151770, 55544009, 24819836, 25353218, 32044991]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/rgw_run_0"
