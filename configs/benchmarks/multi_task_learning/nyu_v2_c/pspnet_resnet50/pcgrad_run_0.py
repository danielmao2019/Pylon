# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 66912037
config['train_seeds'] = [47768926, 26227635, 89163881, 91418673, 40337924, 47312066, 60887982, 92131744, 37603197, 98740442, 30039219, 29968028, 75546856, 46556240, 84928716, 48100406, 34786046, 50266244, 7464543, 92032122, 98731433, 96953665, 90932261, 82218054, 12905170, 40728171, 79049838, 43430949, 72390348, 27455836, 98627827, 32563780, 10329379, 79854793, 38201422, 10761155, 5062000, 70982082, 7083727, 12315441, 33659345, 7955558, 55727577, 44539989, 909374, 92777654, 87774565, 86072119, 68428935, 3751618, 26868033, 22735305, 42151451, 63462521, 97089842, 61723549, 2881833, 15855655, 51753, 11104620, 45912859, 49814713, 22143219, 84806849, 11757626, 35672372, 83629717, 60305497, 53356674, 71675756, 46040568, 56022304, 90410126, 64597654, 71966527, 25582983, 33923231, 86776173, 45472205, 93769889, 53602006, 4192033, 52158743, 20420342, 42703694, 78914256, 46295287, 85180302, 63655760, 11609240, 52857713, 48312555, 43435592, 9560471, 36684626, 80885493, 99562588, 67062334, 2583505, 78842168]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/pcgrad_run_0"
