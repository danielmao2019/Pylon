# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.pcgrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 38577871
config['train_seeds'] = [57134860, 50282021, 49618264, 18571270, 29030816, 994383, 11690539, 15830038, 67943104, 31217404, 728318, 49078879, 39877232, 41856430, 77134393, 79608567, 14363431, 16068683, 72975775, 16528633, 5586686, 54694968, 49416163, 64170204, 66683979, 92673381, 45477724, 23328819, 6595457, 95520417, 24662455, 90347491, 40491313, 37746913, 12516187, 70820385, 85620658, 33612733, 46683851, 93559698, 96776163, 44084758, 26965959, 73885912, 41130629, 3020048, 53722660, 29260092, 13841885, 63373809, 72624771, 79117622, 19546533, 77326256, 14025475, 97739203, 55248898, 83796815, 27871714, 53009916, 2950618, 80919037, 44816726, 96257525, 77204606, 86816441, 44415678, 72516283, 2370645, 56451058, 56151846, 22062045, 44560497, 65541273, 5972755, 42057372, 93893261, 63371057, 64275048, 57341401, 87151581, 67644218, 25610856, 9132877, 39796985, 4621383, 9194600, 64012442, 21915121, 5043643, 55026680, 13729572, 24303809, 7207057, 180800, 43240718, 42509146, 99153387, 34364268, 32299064]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/pcgrad_run_2"
