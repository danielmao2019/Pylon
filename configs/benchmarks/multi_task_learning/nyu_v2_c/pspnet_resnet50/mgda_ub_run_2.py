# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 73170543
config['train_seeds'] = [9546506, 3355831, 94974924, 37006836, 90209718, 14345778, 89358266, 94572015, 38439432, 20344185, 77399781, 92809193, 48499142, 39894753, 55514666, 5526293, 95337935, 9660128, 86709766, 77282065, 18855284, 39102047, 44479336, 86060863, 1420710, 69428515, 19786667, 81930698, 23940615, 90519655, 11850076, 97294852, 86373408, 43838136, 57145510, 86548948, 37872588, 31397865, 5513765, 64486738, 52759095, 88545630, 52173734, 14021319, 59850366, 5153194, 58656039, 69919711, 98079990, 63431589, 91709127, 92186481, 7425960, 93742978, 29188097, 50947877, 68528917, 54937231, 27027066, 72683303, 81898460, 22325230, 53629296, 46107787, 65675646, 66472038, 70772228, 14788001, 76297528, 57049449, 60135717, 11999038, 16337480, 60066217, 21377332, 90601339, 70358805, 21613838, 92754012, 49565930, 63217476, 35518086, 89913240, 39380710, 33553598, 52402039, 96302125, 23312470, 26198590, 35493602, 74013416, 68631695, 20995216, 49216746, 96536363, 41129750, 58498138, 39741563, 88199726, 42388080]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/mgda_ub_run_2"
