# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 67745255
config['train_seeds'] = [78741926, 11416653, 50065818, 39214181, 47695188, 76784591, 83074027, 86751100, 14388428, 56173654, 98179290, 2564188, 62688642, 15568227, 19108196, 20451100, 94834581, 47968322, 67877386, 66630272, 45454831, 94607971, 35027619, 3487149, 8652786, 24861519, 65717965, 48761434, 32095469, 18224207, 57909674, 98225870, 26592864, 79940564, 31264310, 29939945, 82443769, 63738131, 2166369, 28535028, 9513605, 59115388, 43646221, 84533779, 56867865, 94459661, 35497118, 25678625, 73152951, 40265334, 49687959, 27448937, 78924652, 94606710, 77262492, 37997843, 58894676, 94497759, 60175506, 21307866, 47825236, 23683597, 33710429, 7295075, 59269621, 10376489, 99660929, 73136639, 29267373, 84589402, 37107432, 68279057, 51418600, 16761711, 39608168, 18901225, 74114771, 53088654, 76799456, 54308269, 37210705, 35920657, 77471009, 47718100, 82482096, 38397912, 64138922, 25444340, 84150043, 14673746, 12479895, 66688025, 28460160, 61124476, 17725917, 32648354, 36607964, 24189431, 60752851, 57037859]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/mgda_ub_run_2"
