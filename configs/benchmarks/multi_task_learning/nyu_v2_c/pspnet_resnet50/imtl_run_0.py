# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 88809655
config['train_seeds'] = [83553919, 29785651, 18915720, 45619803, 40041113, 18501794, 95270805, 76877146, 16707472, 53475448, 81202777, 63617392, 41956978, 7291033, 73422856, 89454016, 29914363, 94850730, 20345836, 27171310, 39823736, 73500055, 31396312, 72277163, 70671274, 43815842, 88905471, 93142355, 31853714, 47710428, 13533231, 19345787, 81031713, 79627167, 83212702, 87498145, 96668650, 9858391, 83232705, 23622766, 96068729, 28662811, 69644718, 7206078, 68290699, 90357695, 22357121, 74992282, 69696210, 31401769, 68407858, 9039210, 47864450, 25101880, 81894693, 32066306, 45773783, 16493058, 44188451, 21005361, 70318663, 35467129, 46094383, 93118736, 47718258, 75431307, 45833955, 75396618, 97148828, 70080999, 93683463, 4597750, 82154841, 60050160, 90258926, 6544923, 92118264, 74051206, 21596816, 54016424, 5879369, 49050534, 34673261, 3891209, 54739016, 96179527, 36861777, 97770862, 68544569, 68336789, 54640645, 24596398, 43145452, 9687558, 73976503, 18412629, 56253706, 75917151, 411127, 61286476]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/nyu_v2_c/pspnet_resnet50/imtl_run_0"
