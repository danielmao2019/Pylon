# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 72709696
config['train_seeds'] = [94334006, 14259409, 60294370, 49218673, 16114421, 69254708, 29190483, 16135707, 91049269, 64019643, 8150442, 88781627, 90250068, 37660341, 79778454, 27306659, 29145653, 1732804, 21166531, 17105484, 47894847, 19824838, 38113547, 35958135, 2906789, 56554893, 2730400, 19503016, 89215701, 74981346, 91483916, 65592163, 83328301, 22220898, 78588595, 45530471, 14119276, 87940621, 58780512, 89456741, 18643248, 97044305, 52124316, 54174106, 91371512, 88372067, 74984200, 75703833, 4160877, 87376703, 70539431, 21981841, 16792277, 90263873, 43801635, 40662104, 60103966, 74038816, 38961861, 78226724, 96704173, 31686441, 21155036, 57892237, 96425676, 71483011, 25817401, 61181107, 54854659, 95745047, 69368706, 24576352, 96320746, 39417724, 4168399, 57942953, 90944921, 88880155, 73125281, 77571861, 30188334, 17830865, 84752314, 54735547, 76421312, 66198963, 37925304, 16984666, 84460306, 75778290, 81842936, 1526371, 49379294, 17673674, 5927929, 42820893, 40759420, 36200005, 71388006, 50678428]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/cagrad_run_2"
