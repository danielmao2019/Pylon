# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['semantic_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['semantic_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['semantic_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_semantic_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 5505341
config['train_seeds'] = [43345850, 22236471, 23512299, 20862937, 22640182, 10365877, 71922591, 93903983, 86928467, 90912529, 30942025, 44580060, 44060513, 24785270, 42983984, 64482966, 72193793, 68545526, 82757183, 25869370, 85044341, 14214315, 83224497, 83499953, 42369024, 90156814, 50379672, 56533555, 79780494, 33769735, 974394, 63509330, 2967509, 70586235, 28883032, 79864902, 50431378, 92880252, 41616191, 56569996, 68982807, 65411541, 18654416, 8242166, 16178323, 70339201, 86972085, 78858925, 2554984, 29048239, 48981955, 5355571, 11629956, 31365254, 67807922, 48487076, 39920612, 56454293, 69132788, 66322171, 50960105, 26508278, 98819426, 91812818, 1709529, 85608941, 62426672, 91346578, 4448070, 60380599, 80106061, 17438895, 38322362, 23245921, 80015342, 16935733, 75783450, 31815215, 84750457, 59975523, 22222302, 43614392, 93665324, 95606910, 70068519, 86148285, 21764236, 11304760, 11719019, 7889013, 9381953, 53262023, 49292061, 6794774, 1128324, 99799600, 47489830, 18113380, 67950541, 30534118]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/single_task_semantic_segmentation_run_2"
