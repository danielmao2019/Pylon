# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.baseline import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 15161864
config['train_seeds'] = [67021429, 16325880, 15730930, 98774347, 96873156, 71957796, 18671568, 1008321, 29388276, 62520630, 2915593, 75334301, 98063511, 366745, 69280671, 98502204, 16746556, 7063146, 50155327, 80714806, 84943227, 72847913, 54032663, 14859515, 51812866, 88690298, 13109141, 65074901, 63955794, 30484463, 79371448, 8014838, 5492126, 10247851, 38899868, 27051672, 54717181, 67832750, 66875775, 87067253, 87060110, 12672222, 24449113, 27337003, 98055134, 43122252, 9250032, 49024654, 53824115, 82769623, 51111525, 13755016, 69345619, 19524196, 26109454, 30533060, 70556545, 6677499, 30270031, 25897079, 61060285, 37108862, 86168617, 76420597, 46172169, 67255756, 54454404, 99235700, 21227363, 65990663, 67386931, 41290262, 11369965, 46346264, 75119833, 97791975, 90043779, 40875103, 76641634, 83186228, 36137293, 3716338, 8706266, 94296461, 53443950, 50930395, 77372696, 28411140, 18856485, 65835070, 54796704, 83776688, 34383439, 5349918, 47663026, 59402871, 50819071, 10166169, 42568491, 38597814]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/baseline_run_2"
