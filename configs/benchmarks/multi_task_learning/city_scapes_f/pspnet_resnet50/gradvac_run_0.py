# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.gradvac import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 76194938
config['train_seeds'] = [4561231, 59769555, 30237861, 62558192, 4483829, 96295189, 80222337, 17990930, 7557590, 73469490, 21655623, 77751227, 94913358, 11166225, 66527521, 14087521, 73361672, 83736455, 770626, 35806515, 32576435, 95325963, 23059606, 75887713, 74751090, 35197180, 5526949, 80930267, 7316443, 45071058, 67958977, 24664578, 16011109, 74759697, 59496977, 51326664, 75966800, 36309069, 10483432, 67546414, 78781230, 90668529, 18700949, 34793126, 46760429, 15228800, 48788561, 85212083, 28233797, 7552962, 70500622, 486798, 65167747, 58967294, 5502334, 3959252, 11400035, 54717604, 23617911, 39654267, 62629258, 99193493, 89328967, 43365779, 10630995, 40647493, 46351295, 90913715, 59130749, 25368572, 342206, 43630977, 42252504, 77000231, 39187539, 64485498, 86927267, 78742694, 83602455, 20629326, 57425039, 42352503, 25904620, 61761719, 82207771, 83920725, 10523046, 52049085, 2265793, 68911403, 61339566, 39914173, 75873982, 8550550, 93662149, 50510485, 14413356, 67320959, 8292931, 61199278]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/gradvac_run_0"
