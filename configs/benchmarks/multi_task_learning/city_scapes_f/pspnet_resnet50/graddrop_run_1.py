# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.graddrop import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 79998100
config['train_seeds'] = [24654637, 48464010, 45284749, 27346259, 70043841, 31285988, 75797032, 10991976, 12967637, 85343616, 35880130, 41029590, 98617046, 5132875, 54750883, 17681296, 74988785, 8151333, 7549706, 1839947, 43579969, 15634562, 50536874, 64203950, 59505062, 1638315, 95588245, 16231291, 38097413, 52848428, 41078245, 91185463, 6899112, 71277981, 69629141, 18002698, 83888984, 98874013, 51078735, 54197471, 60731242, 4442323, 85498134, 35617281, 44208900, 39661916, 86465609, 51104570, 29436452, 65057269, 77091257, 59473075, 44853059, 26056511, 70510451, 91840849, 25055303, 91774129, 45717022, 43374793, 1284477, 75307434, 24496307, 87389614, 34378748, 67533496, 75451217, 92533054, 867497, 87406367, 25221886, 51729583, 11695444, 49076524, 62737584, 48262831, 64358090, 72512693, 9139981, 36839376, 95519210, 18720928, 82007775, 37752727, 71900078, 10824780, 61857240, 4952396, 41701129, 54932237, 26423371, 25105611, 48319574, 61269129, 73531910, 68513709, 99200361, 67357516, 32610274, 25766919]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/graddrop_run_1"
