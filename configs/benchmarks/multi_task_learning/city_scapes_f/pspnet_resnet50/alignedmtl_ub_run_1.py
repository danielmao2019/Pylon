# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 99161185
config['train_seeds'] = [84417122, 22505708, 11371707, 47687659, 26336507, 82078130, 24556301, 25812245, 1640373, 17310621, 54407076, 26658801, 6390473, 79307534, 11741704, 95362360, 9741819, 51114934, 74407585, 98183866, 80846457, 53503533, 68698665, 74476280, 83728098, 65135728, 27272835, 79300487, 4085128, 45222597, 23626387, 26585173, 73863499, 94507539, 94306321, 93471134, 89217883, 80742156, 98558712, 5903257, 5200945, 86704781, 93802266, 40758071, 16721245, 95605134, 28031207, 71154429, 10582530, 73953691, 15213553, 74253212, 3254383, 59793203, 77555819, 60559824, 87033583, 68715052, 33412580, 6491373, 38124856, 24930342, 77389773, 63491570, 80398623, 20690549, 74017860, 17269640, 32900267, 48526499, 3082121, 62494367, 67124237, 94769488, 5698083, 71973983, 41585906, 51101816, 15831051, 15603290, 87136982, 6761590, 4919015, 85456078, 62669024, 37853039, 12945131, 2519508, 82696686, 68289190, 17019183, 87892393, 24283805, 71509297, 5895852, 2151187, 70047692, 41855446, 49147817, 10633120]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/alignedmtl_ub_run_1"
