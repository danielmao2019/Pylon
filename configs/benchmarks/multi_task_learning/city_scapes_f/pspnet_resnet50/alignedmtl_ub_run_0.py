# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 90313622
config['train_seeds'] = [6224720, 83552364, 96616641, 71344005, 98389141, 33875125, 10187402, 54773067, 96420491, 49047158, 85558437, 80114084, 53213291, 96667200, 67805472, 10102284, 86883557, 92144954, 38231630, 21405593, 41914650, 55677169, 14616782, 63113073, 10410672, 91524126, 53024083, 87009545, 93470301, 60659789, 37851773, 18311982, 62101177, 47669956, 15277513, 3170340, 2727527, 61865864, 81786504, 95477433, 10878900, 87603103, 39817813, 17072139, 121187, 15532459, 48306299, 5221384, 90900628, 65156636, 23019506, 10092554, 89472783, 9787836, 4409041, 21596886, 58063344, 26638759, 51745511, 47551551, 61174659, 70425617, 96904695, 25876678, 51739738, 47363876, 73101173, 98590567, 73201427, 94691729, 96456825, 74037965, 78710406, 57781054, 28415296, 42070833, 26828033, 13304753, 36821455, 33960609, 66809131, 21708597, 70343293, 19204957, 84916957, 25131716, 47806597, 35651143, 32526233, 16464260, 48569416, 65998240, 94882388, 97367697, 18621099, 79705797, 22742736, 82882458, 67629309, 38334209]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/alignedmtl_ub_run_0"
