# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 78117636
config['train_seeds'] = [41701000, 54282888, 41577461, 47852361, 16493677, 62811062, 22750737, 75186077, 96661162, 60379924, 45817912, 33580332, 73526188, 35421137, 53694918, 22320790, 99626815, 21568875, 1560681, 40073762, 81104806, 3679956, 82133981, 34253339, 60075154, 64714334, 10800775, 93713477, 14595989, 51497476, 92350556, 80620831, 49029281, 1139441, 53032001, 71024363, 43716387, 38710813, 91296839, 78660285, 97726616, 22932076, 53474252, 277037, 51407286, 28951026, 36803961, 77386176, 43885755, 89477984, 26151351, 23010442, 3793377, 5644715, 8964355, 11161402, 23020709, 41475286, 35640667, 31556944, 72673754, 91292827, 82907311, 42266071, 1528085, 44527670, 14574862, 57026835, 41157125, 93761347, 92473836, 99790008, 64869327, 11415713, 23783858, 48643290, 94124685, 92909730, 87848559, 83091302, 4825609, 55990682, 86056986, 48894943, 69175085, 55915964, 19218711, 28584564, 49359016, 93206277, 30668956, 37945430, 70155680, 36790406, 43755021, 51572894, 25761161, 18842276, 51986799, 67972086]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/cosreg_run_0"
