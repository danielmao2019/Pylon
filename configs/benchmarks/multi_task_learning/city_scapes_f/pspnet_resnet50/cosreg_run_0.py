# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.cosreg import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 52381703
config['train_seeds'] = [86961993, 32429483, 12607197, 30820690, 40095589, 53992669, 62129535, 10573235, 90901557, 86798465, 76312184, 8121525, 27501558, 57538595, 99282986, 87786277, 85379022, 20579018, 53460187, 48152989, 10368736, 44804455, 9040351, 99039380, 63201010, 54732455, 68857254, 31643814, 49230939, 15501, 10913135, 38205396, 99430923, 17393503, 40181683, 41473186, 64685968, 23368569, 63835335, 84888516, 62708779, 88593032, 65548453, 53569701, 81496625, 86269028, 66585364, 92847124, 84357486, 98397125, 96050002, 86886728, 3803757, 58483852, 22861412, 96336019, 30340544, 89953740, 73997110, 262225, 93084507, 52758558, 58475442, 99143594, 19859584, 65314560, 37354634, 54078317, 99917005, 79973488, 90835459, 24595093, 89259428, 32171526, 51645089, 27165662, 14706915, 82286768, 80994553, 53987940, 75403336, 90926567, 67578344, 19341470, 78992163, 6187368, 64286992, 30656352, 78592102, 59710985, 44023884, 34580010, 27516117, 26320768, 55900554, 89064678, 30522663, 6197023, 50048259, 14761112]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/cosreg_run_0"
