# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 23701643
config['train_seeds'] = [60612856, 85706075, 9927549, 12603662, 92699827, 48202667, 38906349, 31490752, 3327130, 33515535, 92546273, 87777255, 28896873, 95503722, 7244434, 1055753, 6058757, 36592547, 92534352, 17055126, 73909590, 69155409, 84921703, 27783122, 54436493, 1978625, 33000974, 25401156, 82439330, 10523071, 37454944, 76476978, 85653588, 3995437, 69734210, 14122209, 29234826, 26105556, 80498154, 35319732, 82270756, 54424791, 36586229, 40387782, 15444677, 96259335, 62356381, 98138090, 66570358, 85582228, 95481018, 63329678, 19192570, 87605481, 87583785, 90811044, 82616143, 29891539, 46753237, 96029795, 80573799, 45622786, 69238616, 49016688, 329736, 23403358, 99954625, 34245553, 83878456, 67823795, 5460423, 53851108, 22880424, 73329386, 5446865, 92045999, 6399360, 18274202, 32169730, 69732823, 24524864, 19235245, 55048702, 20165260, 22530159, 75544759, 70546287, 19244302, 10083368, 18656666, 17479793, 8316509, 17817918, 89089066, 39417054, 121397, 17964415, 50874834, 14025784, 50204067]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/rgw_run_2"
