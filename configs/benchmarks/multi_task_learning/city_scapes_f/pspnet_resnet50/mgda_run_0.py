# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 42617764
config['train_seeds'] = [34474853, 21493593, 98509854, 78963939, 22425305, 66933127, 14610783, 99713848, 93155245, 83037646, 1395697, 95135977, 65788493, 54219513, 64313589, 76594409, 15725536, 47987543, 79426410, 1776385, 85386133, 76393396, 79675395, 31258682, 27271502, 35899382, 3685054, 13706411, 2419867, 74395021, 16375505, 85951200, 85618122, 85536203, 11343906, 27194766, 76547327, 49594283, 99632188, 45472394, 91760321, 43303635, 85800523, 30185961, 13812769, 9986946, 41999274, 41514541, 68070200, 52402352, 70811208, 5790121, 9725025, 70592482, 98425693, 70804665, 41390813, 23905379, 82239610, 56671104, 32423547, 60791319, 54641539, 40429354, 51004171, 25026698, 34852884, 66519518, 78036646, 69894296, 26784108, 86007877, 64837471, 24518231, 65884073, 48268022, 82059716, 53563304, 25987681, 72443361, 46901813, 86910105, 58233143, 99117003, 61943816, 11923, 62132156, 65766007, 80533251, 52710773, 63167589, 46853037, 7413737, 75361680, 52050507, 60036651, 73038252, 67546700, 42116619, 50943117]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/mgda_run_0"
