# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 22989780
config['train_seeds'] = [61158270, 82090913, 19500129, 16396520, 56666914, 75180614, 44548428, 64888218, 72656009, 74544422, 67063195, 39643115, 24875491, 93357759, 90638378, 60337542, 42297592, 60784333, 5345260, 32150190, 4059298, 65995554, 82006334, 37139734, 61174497, 86772884, 61593760, 90256241, 43740290, 48762017, 17140767, 28689823, 54160399, 19160253, 80139107, 88554539, 95375857, 83774065, 72222769, 69805100, 65951873, 89581789, 42648009, 84347461, 72245626, 39875281, 18731364, 35094193, 91967518, 40412390, 99434395, 35165010, 80923630, 80407196, 29318605, 12014470, 42743073, 73737566, 72117710, 6626719, 62260261, 4238564, 21420437, 55964706, 84541797, 45951574, 50599223, 16155845, 61253744, 79110178, 59782057, 9955870, 22941637, 18914389, 65667424, 59196946, 85845097, 80734735, 87388929, 65379154, 73921618, 63041549, 1409678, 67977515, 12722661, 57794639, 26085219, 51444137, 88221968, 5577991, 34942789, 58761517, 92891060, 12906270, 25686048, 95737932, 36478983, 86731252, 48419179, 16919668]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/cagrad_run_0"
