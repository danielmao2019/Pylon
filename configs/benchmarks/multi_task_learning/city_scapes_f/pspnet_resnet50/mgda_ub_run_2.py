# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 431839
config['train_seeds'] = [54983654, 47558733, 95680882, 39081214, 50815030, 75215983, 97865890, 79247117, 83172023, 67243911, 10414352, 45695979, 14218744, 59062867, 76672486, 83319281, 51570805, 73859433, 20640576, 41604346, 63365152, 30521943, 73984447, 77108217, 11499340, 5170725, 81549712, 92636028, 86160799, 8204890, 12132228, 90569898, 67701872, 16740625, 87983729, 73124596, 96867488, 52517583, 38295317, 55515098, 73351297, 79321522, 38795717, 65017149, 26137544, 8369713, 59011322, 64255104, 54126550, 10033905, 65316796, 58382092, 55107434, 78088736, 25799598, 75309836, 29364001, 84893069, 18736507, 38947518, 24892364, 68220469, 70121574, 63190580, 17815124, 2048846, 88618016, 92867000, 74456600, 80689144, 42843776, 98675710, 50314598, 80101652, 12570112, 40570557, 25440898, 60241060, 84349198, 26603360, 74446672, 25912174, 50367330, 24580887, 15426088, 14304151, 53962911, 2860019, 83157116, 50836327, 62385977, 44167850, 55674471, 93014711, 41928758, 75573690, 42437807, 39430841, 78440264, 9388443]
config['val_seeds'] = [73866933, 29062521, 52972566, 29763325, 73008546, 89859994, 89447078, 60982353, 38767894, 11111606, 42648582, 87166773, 3435014, 95191982, 58170635, 1016454, 99707256, 81479419, 67903178, 11347502, 22303540, 63989345, 63989665, 85112578, 56046663, 77758192, 44232095, 70353099, 7276820, 74271772, 78367650, 56824031, 64173158, 18405315, 83187894, 32495629, 51108721, 80547556, 1310447, 23686103, 15615532, 72161531, 84074524, 32847751, 72792093, 3192667, 4046306, 3284406, 47318989, 31341830, 70252040, 22268538, 16097938, 48830312, 13042135, 30180831, 92022773, 67942747, 72320034, 73955250, 65040617, 40963225, 31383674, 37093447, 55091000, 2817852, 62141732, 13519614, 12134688, 52993842, 96169168, 679771, 93776966, 67227721, 25474258, 29279790, 54485365, 70094847, 70804216, 67115581, 69659873, 49793288, 60707131, 43799934, 70862244, 35424311, 57400157, 82049913, 32762912, 8362829, 71936406, 26368304, 76499564, 38167812, 58211497, 5603700, 46508798, 84123669, 54018727, 42361873]
config['test_seed'] = 15893426

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/mgda_ub_run_2"
