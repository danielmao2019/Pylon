# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 431839
config['train_seeds'] = [54983654, 47558733, 95680882, 39081214, 50815030, 75215983, 97865890, 79247117, 83172023, 67243911, 10414352, 45695979, 14218744, 59062867, 76672486, 83319281, 51570805, 73859433, 20640576, 41604346, 63365152, 30521943, 73984447, 77108217, 11499340, 5170725, 81549712, 92636028, 86160799, 8204890, 12132228, 90569898, 67701872, 16740625, 87983729, 73124596, 96867488, 52517583, 38295317, 55515098, 73351297, 79321522, 38795717, 65017149, 26137544, 8369713, 59011322, 64255104, 54126550, 10033905, 65316796, 58382092, 55107434, 78088736, 25799598, 75309836, 29364001, 84893069, 18736507, 38947518, 24892364, 68220469, 70121574, 63190580, 17815124, 2048846, 88618016, 92867000, 74456600, 80689144, 42843776, 98675710, 50314598, 80101652, 12570112, 40570557, 25440898, 60241060, 84349198, 26603360, 74446672, 25912174, 50367330, 24580887, 15426088, 14304151, 53962911, 2860019, 83157116, 50836327, 62385977, 44167850, 55674471, 93014711, 41928758, 75573690, 42437807, 39430841, 78440264, 9388443]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/mgda_ub_run_2"
