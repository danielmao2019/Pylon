# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 3127884
config['train_seeds'] = [5824171, 81895528, 9812634, 73488461, 53672456, 89126284, 85218077, 48065492, 52785125, 81765293, 42620675, 22348915, 25583, 92520509, 27313640, 36960483, 60887687, 42790478, 72257694, 26851721, 86011820, 53762712, 15854238, 53288684, 71080052, 88305786, 942846, 48132105, 86307904, 67831880, 86050334, 41714305, 75636546, 9310418, 84295243, 63436876, 97438983, 97000496, 70985979, 11850543, 58013721, 51862048, 56107800, 77634290, 78693462, 62000738, 20677234, 12477808, 54397948, 53713509, 48177158, 68432333, 43673950, 20630359, 10198977, 58585877, 6559166, 85012286, 63500155, 67813787, 65330744, 61399315, 95032308, 52006268, 43173225, 81743550, 4788344, 5148532, 46253860, 82999458, 38629103, 63344377, 47957971, 50196297, 86046992, 98967497, 54217678, 20093876, 62303493, 35025885, 75084188, 67050842, 92341881, 99145008, 81054174, 55178511, 68670469, 9566139, 8344533, 87284570, 96724551, 87577581, 72550084, 69359014, 538088, 26801468, 24744971, 75451979, 65369459, 92670729]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/mgda_ub_run_2"
