# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 26658737
config['train_seeds'] = [32504078, 21911703, 97376459, 28920303, 56874817, 48207559, 74221212, 65502856, 56498693, 99142169, 41207426, 24464659, 42540976, 86131328, 67003688, 70550572, 96135245, 8268868, 33226988, 63086475, 56705289, 77187934, 19093717, 72516444, 14006697, 87278923, 42320485, 33261656, 58473025, 24716862, 76382920, 93435783, 92052115, 56269674, 41963610, 28554932, 76483679, 47677653, 49495867, 16111368, 60780138, 82049115, 20395099, 86413571, 11743239, 18112620, 7000631, 72675944, 76479563, 6538339, 9465957, 31774574, 99712862, 58166192, 31077263, 42409126, 72203441, 28149323, 47661154, 1145309, 31963643, 80040642, 55267115, 24656106, 9780376, 5922951, 2562779, 58474965, 68496941, 34174044, 42822778, 94382513, 2790281, 86044551, 5326420, 82842408, 23735878, 76804789, 65527981, 94465340, 26495958, 9273180, 4127993, 29303780, 17122155, 54844086, 87391938, 17199554, 51913021, 4728026, 69874944, 2091256, 39035632, 92622829, 66346116, 50536866, 81681083, 94334685, 72563048, 77424828]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/imtl_run_2"
