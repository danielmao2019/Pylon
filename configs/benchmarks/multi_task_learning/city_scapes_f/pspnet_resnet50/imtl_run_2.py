# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 26658737
config['train_seeds'] = [32504078, 21911703, 97376459, 28920303, 56874817, 48207559, 74221212, 65502856, 56498693, 99142169, 41207426, 24464659, 42540976, 86131328, 67003688, 70550572, 96135245, 8268868, 33226988, 63086475, 56705289, 77187934, 19093717, 72516444, 14006697, 87278923, 42320485, 33261656, 58473025, 24716862, 76382920, 93435783, 92052115, 56269674, 41963610, 28554932, 76483679, 47677653, 49495867, 16111368, 60780138, 82049115, 20395099, 86413571, 11743239, 18112620, 7000631, 72675944, 76479563, 6538339, 9465957, 31774574, 99712862, 58166192, 31077263, 42409126, 72203441, 28149323, 47661154, 1145309, 31963643, 80040642, 55267115, 24656106, 9780376, 5922951, 2562779, 58474965, 68496941, 34174044, 42822778, 94382513, 2790281, 86044551, 5326420, 82842408, 23735878, 76804789, 65527981, 94465340, 26495958, 9273180, 4127993, 29303780, 17122155, 54844086, 87391938, 17199554, 51913021, 4728026, 69874944, 2091256, 39035632, 92622829, 66346116, 50536866, 81681083, 94334685, 72563048, 77424828]
config['val_seeds'] = [90605894, 17604002, 87025767, 45494089, 28019845, 54488193, 85199243, 98596600, 72188602, 69891083, 81405913, 52567739, 33557470, 3117948, 99254575, 33071337, 69460025, 26202728, 47096209, 25229004, 64766687, 34782568, 8841079, 5295064, 30222417, 29184217, 22153727, 45625713, 28205464, 69926170, 36148105, 46103456, 94242274, 12384839, 86373413, 83458189, 69091925, 77923209, 70664293, 54824707, 77153749, 31454171, 1638878, 66489233, 38564260, 35914017, 33131027, 38046105, 9488996, 6670453, 81048442, 4714218, 22008251, 46030664, 57261981, 90182470, 29599453, 24568039, 19653859, 23142919, 28592378, 29007776, 79335382, 32769656, 98353663, 67535986, 88651148, 58721102, 14190733, 4152969, 69466713, 25786122, 41422929, 94311020, 72522860, 50595094, 61330894, 39870878, 97104019, 95847001, 73758349, 87476624, 50987378, 18293054, 20347514, 46979770, 51216235, 47829403, 47732618, 71076033, 59338466, 79095737, 42931340, 35044416, 7531114, 89863960, 79316594, 38981905, 25781429, 30204065]
config['test_seed'] = 70247649

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/imtl_run_2"
