# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 12754692
config['train_seeds'] = [38960065, 99201600, 14956009, 65335169, 52945740, 31567517, 81517630, 49975577, 97040020, 15413550, 31933446, 63850350, 60322491, 73347752, 62434579, 52381176, 73351947, 9705354, 21719107, 99538767, 52728904, 57567681, 82464360, 94641363, 4253862, 37178273, 87344661, 10024621, 9261842, 79178090, 31114189, 36883267, 64979191, 45166889, 44254544, 9558720, 44184906, 13815963, 66393485, 42348402, 8390212, 15217168, 24845774, 22412385, 81678340, 92395434, 97589774, 12847633, 81402701, 29690974, 77513991, 78343767, 74654691, 90508193, 30263864, 89188858, 44585259, 64515238, 8745621, 68580448, 46786310, 46024681, 60947627, 76258421, 81971144, 78469493, 96723914, 81490523, 5298712, 11216031, 45184586, 1909276, 66438185, 15335886, 68647919, 72741290, 33180922, 64599854, 17451926, 8185125, 43604271, 52621637, 69704643, 76379325, 19499501, 68260615, 78388009, 58554696, 64503857, 4720122, 31006303, 32359834, 95468875, 31983278, 4438398, 34287692, 35098280, 53842575, 46682098, 90783882]
config['val_seeds'] = [43692181, 92502948, 87445580, 35619014, 15728932, 77510922, 41042126, 68934679, 62044120, 97174936, 12695067, 91548685, 38830469, 39274265, 70770293, 75294116, 26618343, 37233198, 15764864, 60383000, 58014991, 66881793, 66162080, 47911903, 9561700, 28549251, 12431670, 11151749, 10457230, 80915641, 19304319, 8659956, 9743107, 59449983, 78529793, 48536152, 99603992, 2070303, 36618908, 14431002, 3416548, 74247745, 36462300, 85087422, 49624170, 53141153, 14710196, 49420553, 86618799, 23030865, 75097907, 77728517, 52426977, 23692401, 94759468, 20630930, 26218684, 98287988, 30857241, 19501368, 17705283, 50746442, 72168994, 18081059, 55297702, 94393891, 81867991, 96636477, 86733756, 59878101, 65166183, 48277003, 92513455, 70772029, 23449557, 76855641, 55396831, 74065677, 93738490, 73757168, 7855231, 39799745, 85865561, 76684752, 15521502, 24379463, 81691183, 49344943, 37038682, 34823694, 29106030, 37355850, 40955685, 35011839, 57849377, 6030115, 13189067, 3688633, 41815451, 64193367]
config['test_seed'] = 74244177

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/mgda_run_1"
