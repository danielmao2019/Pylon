# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 84671140
config['train_seeds'] = [63787917, 82131707, 6866782, 89958787, 93919686, 58906192, 71366677, 15704411, 21229201, 21398940, 4928582, 89573539, 3596774, 80834550, 66221636, 50269539, 64810010, 20932147, 32505715, 83452130, 14628198, 6108647, 44311512, 30056375, 34093145, 91330826, 50226541, 41350015, 78721193, 42467483, 77535311, 13971197, 90051295, 98913010, 31274002, 20370002, 83352140, 72352032, 96013894, 6046431, 26892131, 46952374, 96895252, 60995598, 17742393, 86706348, 25036764, 96522300, 46992102, 34083068, 2467026, 60647660, 31427440, 73049280, 65195396, 87942302, 79416396, 16597450, 50214125, 56979583, 32744954, 33103730, 665, 4754658, 79087434, 57472782, 92302058, 92422721, 46902894, 71425404, 58737319, 28284238, 22800584, 6928298, 47017775, 38210574, 21821361, 14702195, 19253477, 9651023, 55361447, 31037662, 2002974, 35124942, 27469695, 11308997, 4585162, 79227271, 45725465, 12458708, 94964040, 13487985, 18750991, 54761246, 89448614, 25852806, 5143750, 83312303, 25750732, 61597152]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/alignedmtl_run_0"
