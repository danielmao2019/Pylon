# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['depth_estimation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['depth_estimation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['depth_estimation']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_depth_estimation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 6944270
config['train_seeds'] = [10228861, 28816106, 98294053, 88340296, 79226663, 97169902, 71900717, 6841160, 99023419, 44624715, 28577585, 65177011, 43534341, 37775331, 66590993, 90490854, 16130600, 91755501, 34343537, 94207506, 92648400, 51936430, 65078926, 72182774, 22790788, 67943590, 64352466, 98523618, 87485743, 39232573, 72228845, 222596, 82190512, 61262410, 18998081, 98973911, 93611189, 53951855, 41131260, 78670614, 96885478, 35947510, 4111490, 67460114, 42327714, 55532081, 55736052, 8218382, 96359612, 54992827, 2334132, 29486610, 49461658, 57105176, 685144, 24353918, 38942797, 72040307, 13802699, 92798175, 7389290, 43504311, 17598297, 36355695, 72852136, 12647286, 63944293, 51028425, 32616117, 8718958, 43295034, 44095122, 85368428, 70100775, 16870275, 75548233, 71710173, 13576028, 59416245, 36498332, 48957538, 84025482, 90738532, 5820510, 343332, 522426, 44149451, 35847532, 44760792, 27022608, 89288748, 44995424, 56931147, 34752104, 55652107, 13627140, 84789429, 15938085, 26178051, 94214169]
config['val_seeds'] = [89267169, 48154793, 55633771, 9551652, 35240310, 91598648, 36134545, 69884423, 88376239, 88605261, 69671139, 51539989, 20055390, 65720481, 38836123, 51897799, 74197776, 4871022, 64756195, 98838213, 82512280, 11409135, 45673353, 34310242, 49320698, 92938531, 70672342, 18514970, 30608920, 64829900, 47901043, 69819470, 77560873, 99364982, 24024269, 60430655, 23049473, 92198828, 22788061, 99027315, 47054211, 13939649, 32991332, 76426680, 81976418, 98051081, 55935079, 89949692, 65978731, 64585166, 35100242, 43243480, 58680052, 43787900, 11376714, 3395005, 41578510, 88091694, 64687662, 17437468, 75407640, 38877085, 77019931, 37377837, 63429080, 31506832, 66202540, 28128672, 62319952, 23533811, 11492208, 25208881, 36107497, 96967668, 23121839, 73302007, 37588733, 44680874, 12126322, 6900313, 6956287, 61605932, 57208664, 74898099, 74056172, 35584803, 47475419, 93769146, 5413773, 29215782, 1542406, 46445754, 68627534, 62827447, 99689134, 20962351, 74815123, 92565177, 49231980, 15502816]
config['test_seed'] = 71873196

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/single_task_depth_estimation_run_2"
