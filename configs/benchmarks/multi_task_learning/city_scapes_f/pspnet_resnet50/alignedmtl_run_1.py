# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 33650372
config['train_seeds'] = [41946735, 55626927, 23293517, 67136930, 48191309, 14204238, 60688803, 53825007, 47891354, 35319752, 83551263, 4807473, 18714200, 94728831, 72919059, 11114750, 4888763, 11746305, 26640628, 26367470, 56214117, 90642587, 99310010, 60331248, 40702959, 11979281, 19617339, 59987371, 9045342, 26250921, 26813170, 65358623, 13417454, 14663303, 26767388, 9945346, 75980282, 60597179, 44902866, 73563217, 96576941, 23261381, 43387314, 23080751, 17423221, 36887414, 99532965, 52306665, 43326409, 49545477, 51436134, 60752893, 69763790, 70644024, 5947341, 68244076, 43938204, 69706516, 1062604, 81098580, 7692954, 62334174, 48545401, 57621795, 75662451, 54729598, 34355477, 24711287, 59668318, 9653659, 58975792, 83971202, 81906173, 67175309, 649471, 81975946, 31069596, 65403838, 39978807, 62646976, 70376096, 80839403, 25570251, 31449348, 95997755, 86241414, 51011670, 99759601, 95777544, 64962376, 47087105, 82234251, 48989099, 20473519, 37390409, 69519797, 16992107, 95959646, 30898261, 92006750]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/alignedmtl_run_1"
