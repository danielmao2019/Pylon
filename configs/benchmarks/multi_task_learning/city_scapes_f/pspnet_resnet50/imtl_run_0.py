# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 84280764
config['train_seeds'] = [16289656, 34941705, 13750061, 29404201, 83643501, 66050830, 27226668, 26010248, 83632836, 3757690, 89186068, 60861823, 58423831, 19179275, 29189441, 68711995, 33324527, 74048568, 82531627, 67287685, 42620099, 69225759, 85922259, 29613689, 3589539, 75809375, 32737378, 2141115, 22744560, 54036219, 57397901, 37377183, 19376746, 87471823, 82072770, 54656015, 95268313, 97981558, 76138192, 72115933, 2658125, 31606286, 35329254, 45815822, 76011202, 12479092, 22930820, 18280514, 87762480, 51517439, 82690843, 88479489, 17763289, 77294520, 79821989, 78821801, 39817615, 67266470, 58396020, 28969390, 41293002, 74733300, 7410334, 96676525, 6894269, 21841525, 53116216, 57786686, 93162746, 84660281, 91117985, 72544484, 3256234, 1646845, 27494367, 21958411, 94371490, 81983969, 93952524, 46465864, 56887246, 99801891, 39194927, 97290049, 42062253, 11802069, 11521352, 97561679, 21855406, 11475260, 31770004, 77188308, 41373455, 19233303, 51908548, 54390638, 98848838, 18541095, 2468755, 47557683]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/imtl_run_0"
