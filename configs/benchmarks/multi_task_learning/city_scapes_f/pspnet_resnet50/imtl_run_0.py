# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 84280764
config['train_seeds'] = [16289656, 34941705, 13750061, 29404201, 83643501, 66050830, 27226668, 26010248, 83632836, 3757690, 89186068, 60861823, 58423831, 19179275, 29189441, 68711995, 33324527, 74048568, 82531627, 67287685, 42620099, 69225759, 85922259, 29613689, 3589539, 75809375, 32737378, 2141115, 22744560, 54036219, 57397901, 37377183, 19376746, 87471823, 82072770, 54656015, 95268313, 97981558, 76138192, 72115933, 2658125, 31606286, 35329254, 45815822, 76011202, 12479092, 22930820, 18280514, 87762480, 51517439, 82690843, 88479489, 17763289, 77294520, 79821989, 78821801, 39817615, 67266470, 58396020, 28969390, 41293002, 74733300, 7410334, 96676525, 6894269, 21841525, 53116216, 57786686, 93162746, 84660281, 91117985, 72544484, 3256234, 1646845, 27494367, 21958411, 94371490, 81983969, 93952524, 46465864, 56887246, 99801891, 39194927, 97290049, 42062253, 11802069, 11521352, 97561679, 21855406, 11475260, 31770004, 77188308, 41373455, 19233303, 51908548, 54390638, 98848838, 18541095, 2468755, 47557683]
config['val_seeds'] = [38772656, 91427459, 85374360, 71758896, 91740315, 44874572, 81614602, 60372612, 82517470, 15028818, 16481066, 97612569, 77185610, 79617209, 14005719, 87567828, 54834677, 22030754, 90940374, 65271373, 25607984, 74565240, 86767163, 58284791, 68336848, 84773013, 83558315, 66318649, 4262796, 89382057, 43538598, 70571195, 28268940, 51400401, 89632811, 14125155, 90937365, 55107679, 34989673, 41841474, 74096270, 87752753, 61722865, 52974277, 11017993, 93620716, 64686695, 80774282, 86497109, 96838882, 2370412, 32736157, 62345862, 69795946, 37896906, 99495047, 41428053, 38575249, 4677183, 75661641, 77506476, 27643383, 63044759, 70696569, 22162651, 16287911, 53191609, 58706236, 12063050, 54008950, 41883089, 17362321, 69130392, 84718798, 34439635, 41209706, 18344079, 86516799, 53734152, 68499276, 77142149, 48394279, 80555683, 32035485, 58785732, 12540373, 24617877, 53206648, 23050179, 10874089, 63753559, 53421436, 83269790, 33053532, 62678677, 61112130, 54028257, 72058783, 9375208, 32267477]
config['test_seed'] = 88007518

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/imtl_run_0"
