# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.pcgrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 76939834
config['train_seeds'] = [27989939, 94166407, 65325986, 79190511, 58412965, 44135329, 54624471, 25706851, 72336583, 45065121, 27078726, 48474683, 72668658, 73006737, 49565109, 66586837, 18872734, 92881138, 12865796, 8693872, 14220082, 39767573, 31793869, 95733869, 30550681, 76106862, 90593714, 82597937, 76678383, 53896437, 54162461, 74062014, 35976223, 83458599, 27787588, 40125868, 97076673, 60118644, 5528909, 44281672, 15247497, 22366291, 49342165, 98428220, 16634885, 30170785, 86370243, 58992378, 29780836, 17679979, 17436187, 50492687, 6750115, 5092066, 31129226, 98301417, 4945093, 41964259, 84578503, 7594973, 8406860, 85984210, 9653370, 10563094, 15967312, 92089277, 70058037, 86344705, 23635199, 30840942, 18759944, 8933035, 41501355, 61426702, 94816259, 50774203, 15194985, 16583511, 39413750, 22534539, 88414933, 18067780, 67229012, 7215620, 81913917, 27446228, 64562747, 64378884, 86052514, 1355115, 93461596, 62368471, 18749630, 26814324, 61803551, 57882996, 88825268, 86200168, 57747159, 55375601]
config['val_seeds'] = [10238016, 95994865, 20522231, 99059001, 21959229, 39969390, 42837110, 46539851, 15802901, 43909353, 32629948, 92148088, 98355708, 21867687, 46140914, 71844594, 72273640, 13992464, 47273554, 62500520, 31630107, 52433642, 75464002, 1974771, 6709033, 56852839, 29189610, 78935159, 52364943, 67681069, 80451622, 90110827, 12486698, 78760867, 3535707, 87838537, 63643236, 36553066, 55365096, 59207648, 24806070, 83677005, 68130047, 38573334, 1785806, 3285642, 17067380, 65334872, 79861452, 30285364, 39966177, 64266462, 88852524, 32158498, 74245192, 95257290, 67041318, 2023526, 17064704, 65803947, 37914844, 88001388, 99637810, 80516711, 43690316, 7892856, 58666758, 11970303, 15763615, 78674894, 38195908, 21501794, 19606814, 89164035, 23857613, 97563319, 95176484, 78667581, 27090821, 19456798, 77586845, 76838740, 32518061, 25455378, 5935769, 58701784, 59320097, 64501421, 6503096, 90352789, 28459933, 60466181, 39273019, 62214140, 76132456, 14853385, 24219931, 12128585, 74557284, 47582268]
config['test_seed'] = 28990216

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/pcgrad_run_2"
