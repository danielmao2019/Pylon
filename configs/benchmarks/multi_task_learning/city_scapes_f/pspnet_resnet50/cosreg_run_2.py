# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 16177065
config['train_seeds'] = [59665003, 94672008, 6206785, 65129737, 18432705, 85707491, 94999601, 58479353, 27227216, 33700248, 9165175, 12553342, 24423964, 19283577, 79559071, 85530374, 69185072, 28034590, 43111162, 30975658, 55424273, 4540420, 77986195, 52340918, 60234500, 18613348, 98685600, 41592483, 95109061, 33516020, 86115417, 70825293, 14601202, 67096359, 92496695, 64107514, 23019991, 84866894, 85810581, 37834450, 53622660, 45611355, 35543714, 21551113, 49565369, 29130814, 76411028, 42335717, 79023252, 10794774, 84561160, 38495215, 64199722, 60346770, 57122600, 21034410, 22602181, 2342259, 58112305, 7605019, 5241893, 72457384, 55027621, 33291499, 25845510, 47041574, 42717772, 86477283, 80895926, 39202802, 15569681, 98857514, 27777558, 50468249, 38365834, 21265562, 64482892, 80036086, 97864628, 25152745, 31298174, 47390970, 30864014, 92993224, 35502777, 29073837, 99332031, 3118345, 53342550, 22047388, 17529551, 70739475, 19405341, 11967474, 73122409, 30954676, 53283106, 83299875, 93058112, 74871348]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/cosreg_run_2"
