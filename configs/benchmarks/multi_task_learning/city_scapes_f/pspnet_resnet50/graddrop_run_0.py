# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 10218718
config['train_seeds'] = [90001956, 80751138, 49890198, 23013674, 24381820, 88513498, 65972013, 92525200, 57707107, 68115150, 49311510, 15799779, 3909328, 10225927, 91174264, 17840101, 29192476, 28741740, 21854157, 34440027, 29844765, 2305065, 16414495, 11225236, 84231717, 27365879, 13426419, 83746718, 83016423, 91714662, 56049879, 31463533, 59909404, 54279332, 88686908, 69903815, 41715383, 13777833, 66781641, 59709954, 52931568, 96877044, 4898802, 79641114, 58890290, 48984837, 68259237, 37838934, 79462081, 99991011, 45087614, 73998986, 54665313, 41982257, 77895576, 96751532, 31256538, 29725900, 56447586, 54250983, 2937363, 8896500, 69802896, 55405530, 20188440, 98288480, 98441502, 82458943, 68131387, 67398690, 84293140, 32822366, 82954291, 61518666, 34936991, 65886503, 18709054, 91077646, 43990914, 77220949, 18281587, 63812970, 38075927, 23603818, 90117410, 45902022, 10071632, 16767836, 11484971, 52799150, 61326875, 60743981, 44847665, 33306247, 71109796, 60331988, 70973179, 15666607, 51681651, 66510288]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/graddrop_run_0"
