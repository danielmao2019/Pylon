# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.graddrop import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 64236519
config['train_seeds'] = [56735794, 23036744, 36522110, 93108514, 70396890, 4633840, 5650175, 72141474, 90299660, 50144856, 50369853, 36043717, 47438728, 50227785, 93543036, 29938478, 68866892, 75627591, 76157052, 78839902, 91984598, 31180204, 96265106, 76689613, 72597190, 43493606, 17122094, 56603241, 63806716, 93391427, 24842162, 6743703, 32442604, 38646633, 7382099, 85292759, 56479033, 40850431, 98112444, 63740473, 28460626, 36709753, 31781793, 59169748, 56841870, 14243565, 36341709, 43055019, 41265102, 34517714, 5802776, 83708675, 30078150, 7327608, 33987394, 21387996, 2035400, 1406643, 43185563, 25281415, 16590780, 55168904, 53296512, 54439570, 24577216, 91170662, 75650768, 54767758, 72583148, 7504340, 7099704, 83313045, 59879134, 20044241, 79289143, 34604679, 36154887, 78237020, 72792550, 58609736, 51185118, 97633259, 13420939, 37291955, 71477667, 70991940, 41147941, 12241625, 11217081, 39949402, 6100443, 14569879, 52678862, 28943674, 59117106, 15559111, 37504647, 65291444, 40404100, 19261901]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/graddrop_run_0"
