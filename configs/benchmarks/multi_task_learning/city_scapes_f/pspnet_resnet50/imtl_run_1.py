# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 65490634
config['train_seeds'] = [28542038, 37515835, 95235023, 38485070, 88624249, 41890494, 34464258, 10011244, 3995198, 83593546, 8391571, 93892749, 35287090, 99347923, 65633348, 24325537, 87410811, 40407283, 68473635, 77619625, 54122473, 13512620, 88307423, 1167441, 44922080, 73712333, 4095252, 1825011, 41878481, 5134984, 48573006, 70126331, 48061126, 16975781, 13525406, 79201778, 25380098, 94550368, 27517468, 81885938, 48583661, 67205342, 87969824, 2505564, 85652611, 60402057, 85634321, 96931638, 70911631, 50384461, 87448198, 11941755, 87971340, 37194900, 68902355, 52022250, 67662344, 5360802, 1531806, 89639365, 97383378, 27112040, 50533156, 3339223, 85860530, 30938362, 36123427, 93848789, 89274494, 40195380, 74024183, 882100, 6762189, 21631279, 75127960, 70652420, 73005237, 39472397, 40435789, 53525331, 8114097, 30311262, 14455046, 66268755, 30305866, 8228050, 21591730, 53693043, 57393628, 54240925, 24587763, 92641671, 32771253, 6997083, 15788960, 98960211, 97335576, 3992812, 93425309, 99112285]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_f/pspnet_resnet50/imtl_run_1"
