# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.pcgrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 52543286
config['train_seeds'] = [63687875, 76723411, 99838262, 71046453, 73148934, 58480514, 49063292, 75081980, 51239478, 94319269, 68419409, 36877380, 58951863, 5389989, 80478663, 43129390, 9676074, 27392850, 10931025, 7338254, 31636327, 78143271, 34830435, 21810365, 89494949, 92363126, 77413328, 75063502, 67277924, 2806493, 40452670, 31855525, 70262716, 35795629, 28825413, 95730119, 50350040, 7479616, 42398495, 80757664, 83933387, 2648778, 38682307, 13491856, 22337399, 7886212, 12436584, 52208101, 1482936, 7200025, 41928563, 24539252, 53793414, 11549539, 95790653, 1468348, 47379652, 13923085, 35039771, 21000266, 35111605, 69582236, 45705227, 24496662, 71006022, 63963470, 26014375, 96665546, 71974374, 69230642, 14931966, 83596474, 31666350, 77977092, 74494938, 9113655, 97944729, 80906998, 23802020, 26931454, 53164876, 62497560, 26379597, 27237421, 65907797, 23015448, 25387304, 32571830, 40536722, 13258326, 14387798, 2983112, 31583912, 69270942, 62287089, 95988141, 60146629, 98472654, 36425666, 43897843]
config['val_seeds'] = [80116788, 30503732, 95207927, 80953480, 62032506, 87015870, 25735167, 46648589, 41631772, 54081302, 44585950, 56156892, 59832549, 36063240, 22387531, 501791, 87564491, 15887224, 47787677, 59367772, 75858731, 31059562, 34467735, 72893095, 22865152, 74443548, 23705086, 4683168, 26232254, 1508008, 1643326, 5687478, 78319630, 24374261, 9290707, 19449908, 20029324, 30629525, 62270912, 30681088, 34034436, 52317559, 98865299, 30834449, 88157469, 5011563, 73824802, 5135404, 91518085, 69947550, 75794577, 35376670, 1324413, 65395432, 49670915, 77334775, 61341318, 32560821, 26016563, 88019044, 4981556, 48942434, 1492850, 9852418, 21591730, 2372392, 50938816, 46009276, 31333146, 14058258, 65119110, 7163289, 18550108, 90387161, 79281411, 64997162, 87836434, 6844611, 54007571, 35728078, 3999085, 50474813, 58699266, 59769281, 73514857, 70093764, 61679851, 11894132, 90870722, 54277939, 13576304, 25576347, 30462593, 61849860, 77752072, 47459464, 86174285, 61624931, 88366880, 71583541]
config['test_seed'] = 32973097

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/pcgrad_run_0"
