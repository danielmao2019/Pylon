# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.city_scapes_f import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['semantic_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['semantic_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['semantic_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_f.pspnet_resnet50 import model_config_semantic_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 68219443
config['train_seeds'] = [41138641, 50946456, 61676193, 7424006, 50596449, 24839503, 5713426, 26580263, 13523441, 27788308, 16494389, 52528237, 81040372, 51637132, 70149182, 48960195, 70662709, 53480321, 99318502, 7071091, 46443167, 55585731, 60247662, 36054132, 18534904, 77424555, 55145659, 77337394, 71271926, 32881513, 79093150, 19099417, 82830860, 18928188, 9308958, 50453806, 8297634, 78462344, 48903793, 41849590, 15537204, 21812552, 79559506, 61247237, 43677487, 68616109, 46252411, 56997698, 30495991, 57859495, 26662439, 90232130, 5445765, 36510842, 58418691, 80006796, 31025739, 4602699, 30385747, 8295852, 68738347, 81324456, 24169966, 60507756, 29999240, 91067275, 41655055, 85936314, 55951998, 45197536, 30895746, 99311332, 23242869, 46953896, 69261255, 95265688, 78713494, 91823918, 11957818, 29241054, 85009525, 56515341, 21445918, 99667517, 76724973, 21391976, 88637742, 20801620, 84373846, 61760765, 38012695, 93147001, 8198799, 57710908, 97607056, 24507558, 57719878, 40335635, 15647815, 37097093]
config['val_seeds'] = [15314095, 80891331, 31384590, 52019718, 84996696, 29849950, 70723804, 673109, 35588415, 48762203, 77601189, 40203163, 41884079, 43155133, 49616364, 49687902, 62003948, 29176797, 70978483, 63945530, 96800121, 81215226, 86938213, 51796550, 13795246, 6417009, 6907233, 8200459, 17264596, 91982582, 6333674, 72045018, 18115716, 78418938, 19320280, 43246916, 81314696, 82282240, 43614037, 51622847, 86474892, 46040017, 44913746, 93443842, 89697229, 28695174, 31866218, 40616172, 66985693, 21526837, 85758972, 85866954, 2276571, 26624138, 41105155, 16460847, 90355447, 44345309, 97998646, 26711107, 72275358, 21572444, 67944264, 2799948, 88931583, 78231728, 3346069, 97098088, 77102053, 34848441, 59537486, 16966010, 52138714, 88166449, 94652148, 83764741, 95744496, 21938132, 59276874, 88097495, 49125367, 38881408, 95466804, 44153619, 93341023, 94002497, 56517438, 26065443, 76612141, 47486433, 22176171, 99274003, 71778473, 1608053, 74430632, 20905651, 43549921, 29628722, 77542793, 96948656]
config['test_seed'] = 70274876

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_f/pspnet_resnet50/single_task_semantic_segmentation_run_1"
