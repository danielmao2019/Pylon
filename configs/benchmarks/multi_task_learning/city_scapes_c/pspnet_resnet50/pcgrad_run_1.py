# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 54851127
config['train_seeds'] = [40090379, 47251477, 91962704, 33754967, 97443361, 5695972, 98163313, 97694715, 57178150, 76724014, 56545565, 72542074, 2644295, 40884221, 82330927, 36709371, 99703989, 86546534, 64620788, 85267114, 52969857, 18188123, 45561551, 71449287, 13713266, 10454064, 96142404, 9272849, 86594250, 10829128, 24297732, 99458829, 33158730, 3572432, 4757962, 66747945, 82564323, 47744328, 88924115, 77740051, 95224631, 49998080, 1501703, 41177511, 40975246, 85656923, 5166473, 96888948, 24461374, 98669606, 17604027, 93104463, 43040966, 55059707, 23738469, 83809378, 72903175, 28450390, 2516052, 52242356, 20085991, 42759784, 62329399, 21986825, 23569764, 22174493, 40556535, 38670811, 57747490, 76007926, 48684103, 8361443, 48323705, 59942258, 71474399, 97495767, 41775909, 42222782, 63325263, 64772209, 26370027, 10186090, 92771917, 49912844, 97171671, 85156623, 90872113, 82726297, 44676271, 48917895, 62344096, 34825796, 2602891, 98373747, 14291253, 96654757, 25379390, 64606210, 9167515, 14749020]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/pcgrad_run_1"
