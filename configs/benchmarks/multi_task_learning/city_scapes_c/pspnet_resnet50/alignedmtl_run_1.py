# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 13198971
config['train_seeds'] = [81531394, 39861694, 86384313, 19510447, 53104053, 92623184, 14198718, 81647514, 58069998, 71411895, 1253933, 21651408, 68422607, 18892748, 32122397, 49350763, 38913160, 66039259, 18666680, 73063363, 7711117, 41052379, 25727714, 58007696, 40148218, 19871627, 84630362, 32934738, 59386532, 84488508, 54435257, 78249441, 4394354, 15290467, 18190876, 23031508, 78833817, 33935069, 45476434, 8456492, 44158987, 59625104, 74615755, 89753793, 39128158, 24141784, 84841022, 98714753, 47696915, 33285543, 71648351, 11397531, 73158415, 47178083, 48416048, 45105953, 90651029, 16426902, 74468329, 84518891, 84086168, 87069280, 2450367, 85650454, 62615836, 54296914, 83015402, 50857026, 91884777, 76736825, 10478526, 81578606, 31222979, 85933864, 51107557, 83859943, 28243139, 74429006, 1909927, 55325131, 76607507, 39005130, 96422545, 1904495, 93548037, 54332327, 63768787, 90917694, 78358412, 92841164, 76792019, 94356599, 68224218, 68941960, 94415761, 5524675, 1553789, 11982994, 40284232, 87593889]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/alignedmtl_run_1"
