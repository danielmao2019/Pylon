# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 50177536
config['train_seeds'] = [24331162, 38493410, 99340289, 55374047, 48176479, 44909727, 83267416, 5373698, 95459020, 27688936, 40057194, 84785765, 92846017, 99614947, 24746280, 11451980, 42734063, 49698021, 75580998, 61012227, 30836600, 90731016, 90506176, 91703815, 18803928, 55617459, 43310537, 81561460, 44159750, 66482113, 17861414, 7535328, 72355323, 22737279, 77781779, 95206204, 73693835, 76773048, 94366171, 81735411, 68106269, 20625308, 71482915, 65491142, 88151763, 44427382, 46191263, 19616355, 70362066, 66858356, 64147513, 69687006, 81595804, 37961373, 53796697, 39141726, 57346084, 81647303, 7649649, 54328625, 69270025, 63429286, 52128393, 89399740, 37007810, 35826662, 23658609, 58357266, 67971939, 51105109, 73205671, 10011269, 70483442, 57782688, 3885794, 74669411, 72734360, 60144468, 89897341, 32625959, 1434834, 31022790, 6291814, 91969213, 28080053, 99801230, 23923158, 88739421, 56089976, 89663910, 64183489, 44430414, 43237502, 10538237, 17557944, 37999304, 93628336, 23658645, 89110601, 57117163]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/imtl_run_2"
