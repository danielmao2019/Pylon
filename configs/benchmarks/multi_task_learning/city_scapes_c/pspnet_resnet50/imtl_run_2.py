# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 50177536
config['train_seeds'] = [24331162, 38493410, 99340289, 55374047, 48176479, 44909727, 83267416, 5373698, 95459020, 27688936, 40057194, 84785765, 92846017, 99614947, 24746280, 11451980, 42734063, 49698021, 75580998, 61012227, 30836600, 90731016, 90506176, 91703815, 18803928, 55617459, 43310537, 81561460, 44159750, 66482113, 17861414, 7535328, 72355323, 22737279, 77781779, 95206204, 73693835, 76773048, 94366171, 81735411, 68106269, 20625308, 71482915, 65491142, 88151763, 44427382, 46191263, 19616355, 70362066, 66858356, 64147513, 69687006, 81595804, 37961373, 53796697, 39141726, 57346084, 81647303, 7649649, 54328625, 69270025, 63429286, 52128393, 89399740, 37007810, 35826662, 23658609, 58357266, 67971939, 51105109, 73205671, 10011269, 70483442, 57782688, 3885794, 74669411, 72734360, 60144468, 89897341, 32625959, 1434834, 31022790, 6291814, 91969213, 28080053, 99801230, 23923158, 88739421, 56089976, 89663910, 64183489, 44430414, 43237502, 10538237, 17557944, 37999304, 93628336, 23658645, 89110601, 57117163]
config['val_seeds'] = [83317509, 25068143, 68128936, 93184769, 40693403, 97639758, 82019886, 69246253, 67596709, 35822954, 46626365, 74516296, 43370039, 27155578, 18938275, 57832909, 1600465, 61177408, 92691728, 80840395, 54946735, 69614377, 95748770, 42795173, 60142437, 44792083, 12564541, 6063328, 75550874, 91332770, 59873043, 22992652, 21085291, 1269621, 69291205, 74043768, 4817157, 71861552, 40791553, 46549641, 69659048, 71262877, 39484290, 55773410, 965915, 7149326, 74887475, 45124067, 8047788, 36523195, 76372219, 40559378, 62171962, 65372529, 90065100, 99897944, 28402804, 58094476, 89569204, 30596405, 76241737, 9380597, 13691210, 78712072, 25346123, 53458589, 23650620, 73736374, 13520825, 6243807, 4978027, 81743763, 31327076, 14867470, 6326584, 7226767, 55311591, 26478948, 8279566, 88854413, 86802860, 4664468, 23466139, 37059583, 7972565, 44527414, 18857647, 2377553, 75245817, 41936486, 56571044, 57992672, 48502755, 45504771, 73587283, 21516376, 67732549, 2933408, 99635243, 14942856]
config['test_seed'] = 51986014

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/imtl_run_2"
