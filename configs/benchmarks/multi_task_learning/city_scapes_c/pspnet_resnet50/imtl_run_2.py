# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 39131530
config['train_seeds'] = [43345407, 74754237, 46313135, 74686664, 73927544, 85659364, 36302565, 72037134, 49086428, 92845722, 27416976, 18281114, 7531850, 1465735, 64794029, 37748519, 91288122, 13580544, 11941216, 16561983, 98437333, 84692700, 63412356, 95939421, 75206014, 54156475, 21318694, 23791672, 6933330, 63768953, 58795562, 60666041, 31476618, 41906610, 51143036, 16217887, 28646830, 96293410, 4361145, 57232786, 92895850, 50498393, 50969661, 98067242, 9526340, 8701431, 28058129, 55235134, 42922671, 46933688, 11213260, 74434947, 23746017, 37695337, 50265787, 38135650, 46317560, 54227687, 94346349, 15153348, 7151133, 18497608, 11944844, 63293277, 68468277, 36974349, 34028538, 51484154, 9154535, 76721859, 22012281, 49830825, 56132415, 13062029, 94819741, 42990799, 98097167, 1497677, 42599711, 90996357, 79968023, 80571782, 67067974, 35905778, 10627143, 56046753, 63415276, 37335754, 60709528, 15112310, 13620016, 52881883, 43928559, 20583442, 54335942, 57686994, 85334213, 34414038, 18128664, 6422556]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/imtl_run_2"
