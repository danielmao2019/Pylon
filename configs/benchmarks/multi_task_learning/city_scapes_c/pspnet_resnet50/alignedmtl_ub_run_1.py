# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 4783050
config['train_seeds'] = [51070975, 16311010, 20230366, 32887880, 3378406, 42142257, 86501105, 79926594, 71614336, 96089828, 85674000, 25424062, 77027071, 13837169, 42445431, 21212753, 37615599, 76557654, 68916827, 91199043, 77482263, 57172872, 95249128, 66425345, 90944726, 92504960, 81148198, 59676470, 4025354, 91654881, 98550792, 97367198, 9967539, 78874521, 67549456, 92730809, 80518543, 74881985, 17932266, 95026361, 12353250, 65606852, 22624424, 37031539, 90085608, 38540771, 83879052, 18402023, 43101069, 45759108, 52923331, 64332094, 85525161, 59518014, 83737092, 5422399, 67708122, 31352390, 87680944, 92440694, 74334383, 51123478, 74172595, 96587435, 63764051, 48042237, 78620918, 19491477, 73290323, 16110880, 76514100, 83794915, 115993, 31508605, 37298034, 72047232, 36404829, 28979703, 82017205, 34482946, 72378060, 20182319, 5480247, 55627804, 6846346, 41941746, 90756580, 11044147, 46998094, 80989110, 24274926, 27730262, 60812052, 34258393, 10634145, 61908865, 6981249, 86217532, 41282397, 74083301]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/alignedmtl_ub_run_1"
