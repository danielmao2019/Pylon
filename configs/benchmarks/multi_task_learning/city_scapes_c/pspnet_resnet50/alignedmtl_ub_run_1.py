# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 61951093
config['train_seeds'] = [36246932, 60575648, 23682421, 46269708, 97461803, 26392965, 87222476, 53103249, 83033134, 87668163, 34639483, 14983529, 23036996, 52677694, 89518810, 83793501, 33724522, 8027479, 3032437, 76317066, 65124998, 25002377, 22989255, 68965890, 23494925, 56475908, 13937119, 89003883, 37150619, 7018033, 88010181, 25424535, 52408091, 94280283, 57918422, 43290952, 79135927, 12392798, 18227618, 72462616, 87245167, 2105790, 64973808, 29813918, 96924708, 15495303, 8614301, 65190029, 81783435, 58722764, 23080611, 54241497, 16190606, 17950204, 16355219, 66452267, 88609995, 96585215, 75849526, 65384504, 41790348, 60022919, 26742823, 44704656, 38039300, 41757579, 12252766, 38788365, 4642143, 6224480, 41619494, 67856955, 84240138, 71977664, 35231557, 88417081, 84992302, 11420690, 48776841, 29398760, 24794095, 53559899, 34329009, 47621726, 22316681, 52927958, 34966119, 80614777, 63019372, 26891883, 83686952, 31891745, 43673843, 18856771, 59339948, 4847840, 22968255, 73625659, 54741723, 72282462]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/alignedmtl_ub_run_1"
