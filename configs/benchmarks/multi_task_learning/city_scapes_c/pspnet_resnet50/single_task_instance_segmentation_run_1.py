# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['instance_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['instance_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['instance_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_instance_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 83026044
config['train_seeds'] = [95011348, 52141872, 20613754, 46211401, 63112088, 85738420, 62532830, 61289347, 79618131, 20200612, 99637216, 43957860, 67796120, 60740205, 22924127, 99626555, 53878883, 41023927, 911505, 47908769, 51140909, 17859913, 94843943, 99288214, 93511535, 12055010, 58796303, 69731065, 77034150, 76497451, 34096006, 59678885, 80333503, 84281348, 5589266, 60105127, 63358957, 43629493, 73641760, 48210647, 69808160, 32476557, 37140729, 12050681, 80070867, 11580105, 56396220, 95695960, 21114473, 83644077, 6547444, 9628458, 41833514, 41307263, 61248013, 10423660, 35364740, 88737188, 42679716, 27072512, 44831197, 42729336, 69107037, 86041035, 81752429, 52226551, 86098523, 14504893, 58867612, 83302823, 78876726, 41683560, 40212124, 24713404, 81375287, 1073654, 9348681, 68236156, 3055749, 58734524, 37849192, 51952873, 60880241, 97457241, 50450573, 43397607, 79321681, 49359304, 41577221, 36898135, 2563936, 88487417, 89938954, 90589815, 71273390, 36456555, 42631705, 92868832, 62356281, 55821050]
config['val_seeds'] = [67647334, 28729359, 49970698, 20694323, 13068767, 23832752, 60423816, 82451755, 2355582, 57241500, 79126736, 37920273, 92223797, 84350852, 89346116, 7435297, 73366477, 86260185, 26736237, 22392769, 12173750, 33812082, 63717502, 41825414, 27941033, 1971452, 91703578, 8523526, 17128984, 7893707, 90233676, 28990014, 4772065, 10735940, 19786801, 60804017, 40491439, 42032346, 46598593, 27524507, 2429890, 16775231, 14741613, 33359117, 92642690, 29021508, 78321753, 35674397, 67170255, 28526935, 43196522, 56087976, 26932988, 6841912, 11086145, 89371356, 38224800, 29195049, 58546755, 99821684, 18595851, 46663388, 43993771, 22571565, 37846944, 1920067, 72976089, 76453607, 58326022, 94181183, 32327980, 5477542, 77426347, 84618376, 35305468, 22927597, 82445572, 14520944, 23139511, 58815599, 43514492, 57932124, 51312312, 97386399, 557644, 28583573, 65629195, 27941349, 3588381, 83495940, 43613676, 55180023, 22341310, 71493066, 78456439, 71275148, 60878864, 93763901, 58553300, 84088970]
config['test_seed'] = 73643324

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/single_task_instance_segmentation_run_1"
