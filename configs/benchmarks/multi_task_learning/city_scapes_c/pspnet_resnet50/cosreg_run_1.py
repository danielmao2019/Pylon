# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.cosreg import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 31668543
config['train_seeds'] = [73675307, 64379440, 12983317, 91344158, 59364147, 43251753, 14105864, 90381092, 2510008, 16664172, 82186993, 1337351, 72176425, 60828291, 42541811, 45631483, 45139935, 26132364, 24387633, 53911359, 20831174, 84967503, 38943924, 8324621, 33009102, 53476662, 86845484, 865239, 77444020, 23963861, 16396008, 32853279, 30734801, 45217813, 91788917, 11239935, 14808267, 94288226, 24076438, 51294044, 83270837, 38057486, 11778550, 38930416, 68338627, 4794521, 87304117, 14136520, 28719884, 8639056, 82888227, 24897912, 6100512, 81583449, 27940404, 17819355, 62829571, 46164563, 17648504, 77666874, 34072583, 68538758, 11545797, 48925686, 5363823, 82208660, 61247704, 68119529, 66797774, 66052267, 67817104, 54819399, 27779083, 11244782, 42360606, 53256013, 3821150, 29065186, 37091684, 64153013, 49737146, 10910170, 28172452, 4854415, 65666386, 28452539, 58904638, 98447127, 26971661, 98359027, 59182560, 75444371, 85453620, 10157494, 85745417, 54549355, 7693430, 11126217, 98676942, 10918373]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/cosreg_run_1"
