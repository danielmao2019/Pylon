# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 43276259
config['train_seeds'] = [3359464, 46486822, 45824721, 14631798, 45894219, 53358246, 30720922, 62621237, 78793676, 97976797, 47273740, 97689775, 93847996, 41687053, 12314598, 54953387, 4209936, 24002239, 27983352, 14146735, 14540021, 11877251, 27348028, 84081914, 30351553, 28922037, 72617563, 40560029, 49729729, 39644732, 71957079, 17329083, 73019753, 75511005, 54647090, 6364519, 52433146, 45963118, 32623552, 76306756, 75392896, 58020050, 3462056, 59487249, 72663986, 78669096, 31995128, 27880935, 44275549, 67687156, 6476178, 44002804, 2551953, 35063541, 50216817, 6235845, 15734385, 36273340, 67860660, 13443397, 25672784, 63274369, 80682663, 81690406, 49842273, 54712549, 7807188, 81842196, 67689246, 46167817, 12092667, 2481916, 78674071, 8335078, 31977217, 35782344, 65099988, 97844486, 97649623, 34111611, 2916534, 51463623, 14347239, 46161131, 43345453, 39476395, 35465778, 63387397, 61840655, 81888431, 28378013, 33669539, 63196607, 52084450, 58844985, 82585334, 68775731, 44300605, 99163772, 9774436]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/mgda_run_2"
