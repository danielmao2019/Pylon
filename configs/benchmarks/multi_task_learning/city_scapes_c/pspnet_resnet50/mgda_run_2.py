# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 43276259
config['train_seeds'] = [3359464, 46486822, 45824721, 14631798, 45894219, 53358246, 30720922, 62621237, 78793676, 97976797, 47273740, 97689775, 93847996, 41687053, 12314598, 54953387, 4209936, 24002239, 27983352, 14146735, 14540021, 11877251, 27348028, 84081914, 30351553, 28922037, 72617563, 40560029, 49729729, 39644732, 71957079, 17329083, 73019753, 75511005, 54647090, 6364519, 52433146, 45963118, 32623552, 76306756, 75392896, 58020050, 3462056, 59487249, 72663986, 78669096, 31995128, 27880935, 44275549, 67687156, 6476178, 44002804, 2551953, 35063541, 50216817, 6235845, 15734385, 36273340, 67860660, 13443397, 25672784, 63274369, 80682663, 81690406, 49842273, 54712549, 7807188, 81842196, 67689246, 46167817, 12092667, 2481916, 78674071, 8335078, 31977217, 35782344, 65099988, 97844486, 97649623, 34111611, 2916534, 51463623, 14347239, 46161131, 43345453, 39476395, 35465778, 63387397, 61840655, 81888431, 28378013, 33669539, 63196607, 52084450, 58844985, 82585334, 68775731, 44300605, 99163772, 9774436]
config['val_seeds'] = [16136814, 78441759, 71340859, 23013790, 43843300, 94621850, 66843502, 96427139, 28846718, 89447031, 27771910, 70280598, 1766642, 54424904, 43125584, 91553399, 55540073, 11649206, 39920012, 87382429, 42529897, 38650346, 35480672, 8575848, 66688003, 58588624, 39103316, 62710539, 59238586, 48231612, 83528646, 81356436, 97812891, 30086067, 12450578, 2949693, 75920389, 30981620, 75623363, 88184491, 27227468, 38624054, 8565389, 32317524, 94206149, 25783752, 62552551, 88261527, 31426145, 14514235, 42233310, 75906731, 42413708, 42623029, 95461612, 1619590, 25503163, 50289247, 2203746, 55856660, 64397920, 32207358, 47369282, 59302857, 95608969, 74161750, 52114404, 16596760, 71239235, 65956040, 50240561, 47521960, 75691090, 66768239, 87397241, 50543798, 56986109, 17042316, 15815207, 77284587, 79590490, 84992606, 69708951, 71072618, 70030086, 34830127, 15737949, 1577690, 4865520, 77234916, 66781747, 32123910, 76959093, 98874481, 24607661, 75322128, 2810639, 93500337, 52031761, 59222501]
config['test_seed'] = 44172630

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/mgda_run_2"
