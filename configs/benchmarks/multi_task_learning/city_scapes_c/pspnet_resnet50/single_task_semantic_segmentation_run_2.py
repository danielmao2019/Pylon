# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.city_scapes_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['semantic_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['semantic_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['semantic_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_semantic_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 39261647
config['train_seeds'] = [62680051, 94559999, 8258483, 47950481, 84654701, 80420839, 86516423, 55206527, 8963292, 18543540, 68423333, 22886898, 41745720, 68034945, 52696727, 45668223, 79517496, 78454433, 6906365, 75453878, 24787200, 63168458, 23227198, 11925526, 88392826, 83950505, 27597273, 67453233, 51138810, 42820, 19632651, 28228978, 32484688, 31329212, 77180539, 49243566, 69245351, 88376143, 56154984, 53446181, 911992, 47465049, 89939439, 10407994, 15279799, 27812223, 23870354, 22743285, 14679048, 49540049, 5327282, 32575549, 40934531, 11648224, 52487554, 96517057, 51427494, 69669688, 17961720, 27114259, 51035703, 5695904, 88168624, 24448927, 66966967, 42320323, 11205994, 57997952, 37225613, 11672357, 76749226, 73075190, 23236174, 64009300, 65845563, 38793830, 97804650, 20996446, 46758236, 69670336, 60726130, 87937918, 98123592, 61181264, 25995474, 11998057, 54895133, 27509316, 11161046, 66123414, 54317545, 64728572, 42021322, 51296432, 95733512, 18301091, 70382445, 79287756, 76400577, 84310658]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/single_task_semantic_segmentation_run_2"
