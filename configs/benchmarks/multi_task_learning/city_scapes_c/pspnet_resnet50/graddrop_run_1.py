# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.graddrop import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 56697742
config['train_seeds'] = [43010198, 76977193, 16427262, 84469287, 7038848, 29729606, 38346389, 17460689, 6691191, 76485125, 62801703, 85177008, 90229495, 17406188, 3686693, 41317174, 70758227, 59156309, 38391976, 33455008, 14730079, 63944202, 14776815, 13565341, 36933402, 56283670, 93082232, 67857893, 25334615, 39173479, 1669790, 19417521, 82071399, 21496563, 29989902, 27978625, 31117613, 80736301, 81814912, 30021062, 86813321, 3452484, 1782551, 6276209, 75239644, 9229048, 68146574, 73207453, 24867609, 44542270, 94736302, 73518729, 18458511, 92176209, 87849903, 2728937, 47873994, 4644031, 3008827, 25416223, 21757078, 68809285, 95290910, 93498400, 44786854, 44591929, 93633906, 35837419, 15683452, 95980459, 71466599, 22418984, 38535271, 27361897, 66515996, 45943031, 94899658, 81787407, 27446054, 99648611, 40591314, 91884906, 5033427, 12626047, 91495709, 91284805, 81526666, 87935955, 69366390, 21664985, 74530888, 6201808, 32483839, 5917203, 52820565, 91513935, 50313497, 42804564, 64193758, 68129988]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/graddrop_run_1"
