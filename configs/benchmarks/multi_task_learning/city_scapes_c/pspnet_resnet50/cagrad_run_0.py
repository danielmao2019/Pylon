# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 62355988
config['train_seeds'] = [47210049, 74914324, 35465429, 97987229, 35803799, 59297650, 64123779, 68216907, 18487613, 78568633, 57581951, 49324477, 39834898, 43922866, 37187666, 69767851, 43371987, 97292610, 69769637, 29342574, 24287793, 53729308, 62798254, 78954555, 63451450, 96292285, 4485627, 26509521, 26481519, 4194414, 49774805, 42330972, 40304644, 57279782, 91857930, 25449259, 54080971, 4330320, 30532775, 82357964, 64200963, 87877385, 13940352, 52938153, 11432887, 40761312, 87817750, 86515861, 21922594, 21317078, 22563577, 67540730, 18258768, 48578502, 28352741, 51611695, 38128994, 76984464, 42675027, 42901258, 37585828, 38490981, 89837704, 29515391, 89721363, 42385409, 1390309, 50223724, 5833076, 81345926, 34099550, 83736681, 23791280, 69302661, 33045757, 22037436, 18674862, 93695790, 62316424, 90062320, 70912636, 34880456, 98270216, 80841897, 36199557, 3211445, 58339216, 70335833, 3162692, 44218893, 35908148, 28231459, 68195208, 60447907, 3154957, 90582584, 50455885, 28301794, 49963701, 44227419]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/cagrad_run_0"
