# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.rgw import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 79157944
config['train_seeds'] = [11102388, 87750863, 92334771, 75853347, 4333242, 71916873, 18050338, 29668551, 19346562, 66680328, 54528580, 24315417, 61305962, 18349208, 88695162, 68186919, 14682549, 89516179, 66739821, 72354086, 61122351, 12966342, 613363, 45771971, 60172831, 98626704, 82313243, 57603757, 34166366, 326902, 35979263, 44637022, 43143292, 42800629, 55549419, 28775653, 86312393, 24491913, 66833871, 1084806, 25840183, 96237403, 98964031, 25394838, 39307707, 82476160, 64212906, 77322319, 68450626, 85581457, 95159922, 31955751, 8954694, 26445385, 87718231, 58617600, 45491397, 93276700, 13687480, 74889096, 59306692, 5262060, 22161742, 93055124, 81063534, 62313556, 4717654, 27404618, 70218163, 28542734, 35568393, 15883222, 34274843, 53730447, 19753727, 83761347, 55244615, 89084664, 15307038, 94701298, 66785440, 98314520, 46381154, 52251561, 69270228, 47059563, 34859829, 6319731, 97562720, 89598252, 6693193, 35178977, 72763001, 36045707, 67501963, 93365322, 36765010, 17172013, 70416808, 79656576]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/rgw_run_1"
