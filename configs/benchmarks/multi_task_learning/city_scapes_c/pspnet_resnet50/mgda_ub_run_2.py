# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 61677847
config['train_seeds'] = [14722450, 4239452, 16416921, 89225584, 17607423, 46452624, 49312274, 2514176, 50701424, 82044398, 93644387, 98569570, 24373840, 29776828, 10342727, 67918483, 20508056, 32650330, 54581677, 6560572, 68739277, 26622889, 34036400, 5067391, 81089921, 41670980, 52061930, 52331331, 60539389, 27384908, 706150, 23014358, 31801610, 70087348, 23444759, 64657089, 69207563, 28398376, 82189633, 35197484, 38931216, 5066519, 43005512, 19541721, 16043961, 34008449, 96985090, 85270946, 84839565, 70635887, 1651111, 64241237, 26841529, 85581896, 75748081, 60421582, 91420978, 47465195, 65164850, 41220456, 15222897, 511328, 40864882, 9620164, 12953425, 71312686, 52857758, 59782767, 13745327, 25397262, 20662360, 46639845, 61186407, 98631830, 89629076, 90553821, 78883242, 40215488, 6944045, 77131675, 47783495, 84605643, 70282184, 51261058, 22189150, 49747174, 76322752, 32835207, 51587044, 97918920, 75973688, 4678226, 64760848, 52305793, 15968948, 5088833, 96808310, 35819827, 16707034, 75983754]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/mgda_ub_run_2"
