# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 61677847
config['train_seeds'] = [14722450, 4239452, 16416921, 89225584, 17607423, 46452624, 49312274, 2514176, 50701424, 82044398, 93644387, 98569570, 24373840, 29776828, 10342727, 67918483, 20508056, 32650330, 54581677, 6560572, 68739277, 26622889, 34036400, 5067391, 81089921, 41670980, 52061930, 52331331, 60539389, 27384908, 706150, 23014358, 31801610, 70087348, 23444759, 64657089, 69207563, 28398376, 82189633, 35197484, 38931216, 5066519, 43005512, 19541721, 16043961, 34008449, 96985090, 85270946, 84839565, 70635887, 1651111, 64241237, 26841529, 85581896, 75748081, 60421582, 91420978, 47465195, 65164850, 41220456, 15222897, 511328, 40864882, 9620164, 12953425, 71312686, 52857758, 59782767, 13745327, 25397262, 20662360, 46639845, 61186407, 98631830, 89629076, 90553821, 78883242, 40215488, 6944045, 77131675, 47783495, 84605643, 70282184, 51261058, 22189150, 49747174, 76322752, 32835207, 51587044, 97918920, 75973688, 4678226, 64760848, 52305793, 15968948, 5088833, 96808310, 35819827, 16707034, 75983754]
config['val_seeds'] = [3057173, 57612490, 58570575, 35958816, 95079436, 10664014, 56258728, 65937785, 16924958, 26668180, 30294478, 36575194, 13494157, 17021912, 28187011, 26635132, 24821591, 93325613, 36612540, 37832478, 13145589, 97143205, 86968482, 69917315, 49747484, 9943844, 67441874, 81298556, 6881878, 9294179, 15673931, 31402328, 41120367, 8811683, 77904125, 3362553, 71294565, 92520817, 63225679, 35089736, 39897736, 15987898, 45127981, 77068096, 91413088, 87282951, 29389584, 89611001, 81201514, 82076077, 24587163, 70462315, 49637724, 50846901, 95765353, 99662962, 53264147, 35468097, 71331848, 13705320, 84840962, 58419363, 13555285, 32132837, 63709086, 81713516, 31161365, 16469444, 8762205, 11123285, 52662030, 8832626, 93579229, 71354317, 70481676, 89480268, 61619159, 67080622, 90461030, 98030243, 64694725, 54773829, 61899799, 29845, 36539435, 5616831, 86231240, 87651688, 88172189, 5236100, 78345617, 91294531, 30174184, 83589253, 36988736, 13313529, 70217970, 84227707, 94949620, 37812784]
config['test_seed'] = 20959225

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/mgda_ub_run_2"
