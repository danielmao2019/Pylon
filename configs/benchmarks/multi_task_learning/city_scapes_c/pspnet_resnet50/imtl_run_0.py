# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 13331946
config['train_seeds'] = [40574174, 33819713, 86828633, 74678890, 15884064, 57424288, 32796144, 93527624, 52679846, 25059792, 64219929, 66962898, 47029708, 63357968, 88860149, 81812940, 42656488, 44949259, 37222636, 51960929, 35795332, 37055033, 28942467, 25151931, 96229853, 71165326, 73436499, 68932534, 55030478, 70518881, 42460542, 38163777, 81539814, 43424261, 41967123, 13915966, 44184238, 70347558, 31562210, 6804295, 96591675, 38814781, 68581008, 85491467, 69629111, 46469568, 74814674, 44256184, 42798773, 12476892, 31539696, 87534296, 76524387, 87184201, 83651610, 46757036, 49505203, 98558297, 46400143, 66297512, 13881042, 46236368, 71987784, 81432163, 56833619, 1947460, 36463784, 65628325, 41955448, 75111375, 12747081, 98084134, 84797815, 91087800, 42139879, 97379887, 69260491, 8997698, 61402858, 19978060, 20796449, 40130778, 84525423, 10038773, 92452026, 5238847, 18508010, 91634357, 63865618, 65194090, 90490516, 68541658, 58739704, 55438288, 11822384, 79223470, 42965977, 80074140, 58891445, 63035520]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/imtl_run_0"
