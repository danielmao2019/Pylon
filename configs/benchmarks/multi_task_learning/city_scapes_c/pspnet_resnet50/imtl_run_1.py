# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 77483694
config['train_seeds'] = [32866616, 37820867, 56372336, 20760256, 66061838, 55828391, 36608272, 63986816, 36729430, 20947512, 79351356, 44266505, 60367672, 91998509, 1013798, 70339626, 702092, 88183761, 26838777, 26621509, 13105189, 17198555, 48298735, 23216732, 88082524, 86414429, 87453890, 70537181, 76162219, 98625873, 86241652, 58784148, 26880565, 15493075, 16458397, 34307674, 34501457, 9496326, 37632767, 59333489, 52723867, 80249066, 93753493, 97117131, 51041728, 91743238, 12548427, 63097092, 31809403, 72976409, 59617863, 9230349, 39210955, 44478172, 32013313, 94906539, 81738154, 95254249, 25084701, 2561635, 82956630, 45046426, 78225772, 82783971, 33542986, 15332406, 93138839, 34051371, 68566392, 69493309, 91489387, 45433325, 66413915, 43539834, 37219034, 5683361, 18229823, 98056543, 18504747, 66077063, 90427579, 16338448, 85743563, 27671824, 29616899, 70443086, 94195317, 22671969, 22046326, 55841054, 27676423, 95344432, 75017009, 18645495, 20814807, 96056195, 53486665, 37111778, 91279901, 93403540]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/imtl_run_1"
