# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.gradvac import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 19220046
config['train_seeds'] = [26874150, 35758348, 66929589, 79535561, 52703039, 7738031, 22510469, 89321674, 97282216, 23529502, 18164202, 15190596, 46754595, 18028979, 25174030, 65078001, 37143224, 23273451, 42879162, 33495088, 78383465, 44332071, 1083481, 8823055, 80619539, 14236295, 90195978, 28615659, 37639272, 88257976, 12612682, 19007301, 50736637, 37345948, 68819311, 34087120, 6592814, 31266124, 56337696, 57911409, 37498168, 2070915, 14311027, 8782942, 22694270, 22620877, 43627381, 43750547, 11650800, 92877749, 39581753, 99030755, 7087888, 43812820, 80806298, 44516494, 46163072, 56777094, 20729774, 7348527, 87239569, 95548649, 40064864, 47879327, 41246466, 49396966, 29964968, 12647611, 19563137, 36370250, 46878756, 88148603, 50464149, 42022413, 52562289, 39939845, 76201138, 62583560, 90941368, 85757044, 89700753, 9265846, 45039728, 76304160, 71653970, 60550930, 94464374, 83896320, 28415763, 76300003, 551228, 68332232, 33761730, 45252924, 32204886, 48234982, 28950219, 30179051, 89551313, 43402543]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/gradvac_run_1"
