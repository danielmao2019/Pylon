# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 51305682
config['train_seeds'] = [71060374, 82025305, 85999946, 22546177, 75826846, 20962500, 29770573, 6683689, 44380482, 702841, 95778678, 61192741, 89495334, 25003532, 60402952, 64190012, 70427074, 77613130, 35622357, 56323686, 27557857, 96958264, 28474972, 43474627, 5925444, 80748057, 28416097, 41165300, 88839648, 90792759, 85979263, 35686114, 58339729, 17486531, 75074933, 95422960, 30348125, 36493684, 87545174, 10459276, 39536148, 55344399, 53298736, 56798387, 72742933, 75960165, 61261328, 54573362, 30507069, 25333557, 69453048, 80887163, 42564553, 85058012, 86007303, 7616513, 64813365, 51686874, 35982709, 9687548, 4328475, 94204694, 2534116, 85414917, 54158949, 4566431, 49017198, 51438970, 21812296, 34175420, 9414696, 14146201, 82012919, 70200892, 96661129, 74590094, 54963593, 46873725, 93549100, 80207081, 93925783, 37292401, 17186941, 89957392, 31347071, 91666184, 95549039, 77338643, 82455010, 55700019, 51450835, 54790539, 42762573, 5147629, 21997335, 98054224, 7766455, 19251000, 16819159, 59485044]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/alignedmtl_ub_run_0"
