# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 94055501
config['train_seeds'] = [17996997, 85176777, 60973308, 25359639, 66261035, 32109144, 17733436, 84864209, 84048102, 41537237, 29266960, 39132483, 31205850, 40422260, 21365151, 30439743, 14636320, 58036161, 53984934, 94985024, 90090315, 75371298, 41624534, 78156342, 3737867, 47676293, 47550900, 38810852, 66589347, 42785454, 31694448, 51253047, 78035424, 6867254, 53902528, 60027156, 76994527, 95410730, 18971694, 24742837, 53070335, 50152531, 80330789, 34258734, 94081720, 76929040, 14088683, 74852641, 45449183, 16152845, 19494082, 99165038, 84102057, 75475119, 67825244, 45178110, 68294328, 52260761, 11867135, 9971293, 31333403, 46555751, 619740, 44934717, 10072111, 8319711, 96928796, 86346533, 63394822, 18316442, 69002185, 45812228, 47120743, 12628188, 38702170, 9810787, 81630295, 26666954, 36878838, 42065369, 65610155, 36633722, 17611125, 31756407, 2189259, 61922690, 41252087, 70405474, 60994270, 53180733, 30911754, 30634423, 6108314, 83559734, 3022652, 10441343, 62355256, 13685761, 46492295, 4567209]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/alignedmtl_run_0"
