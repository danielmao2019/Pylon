# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 89438300
config['train_seeds'] = [85186152, 71278694, 93438096, 54300443, 46767668, 12779810, 29860874, 76925852, 30243650, 51681639, 30747430, 38250493, 58251658, 61180102, 88962096, 49412465, 28832484, 61000082, 28936365, 42278841, 52349644, 36823962, 10672288, 39619362, 69091301, 28975760, 60661773, 89304341, 3959208, 65720661, 88339992, 44746219, 19205821, 71186548, 15615907, 98385373, 88188298, 40954060, 11401336, 88717432, 4146041, 84348665, 11850055, 61857126, 61400300, 66653029, 29008967, 3308555, 6268904, 69007252, 56912744, 22191626, 82045293, 49537431, 3187955, 40953692, 79923752, 94508095, 76349311, 13635222, 97772971, 94223804, 26264195, 52462261, 5640557, 16886516, 14369558, 85472469, 31757916, 46904904, 14595054, 73996784, 47457194, 97027027, 12589521, 463076, 78382217, 70281054, 54403633, 44910958, 63647719, 48261130, 30721487, 91936141, 28097878, 77591575, 36880839, 85315921, 80741246, 55007152, 25477881, 27501793, 51258610, 51079189, 80617430, 79347570, 94932043, 9935806, 52346213, 28683168]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/cosreg_run_0"
