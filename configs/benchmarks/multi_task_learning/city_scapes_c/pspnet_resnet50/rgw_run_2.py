# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 46579078
config['train_seeds'] = [60704653, 45620754, 20357838, 15035575, 81887844, 11271291, 31737682, 31401244, 45713060, 8169652, 66440853, 20461655, 63418578, 79600262, 32982510, 3446648, 29694209, 84346910, 4078714, 16889281, 8416419, 19706715, 84677606, 46138347, 75876937, 22763231, 28882033, 7750402, 8520318, 19941143, 32322764, 47059874, 12744550, 66411990, 72084431, 40335159, 71351407, 17001207, 26555503, 94181083, 37977616, 70178078, 14699137, 12299248, 11893378, 73827908, 47928975, 8892551, 75352916, 28745117, 47169304, 78567113, 13722080, 43614206, 77522583, 71819859, 45833818, 63987784, 3740229, 4006868, 37270253, 15991821, 40583712, 81904861, 67786322, 45536291, 68999742, 78287401, 7748936, 44079480, 79362286, 29854357, 49841329, 31384826, 60847398, 24105000, 22705703, 72470970, 86026188, 2866538, 2649658, 50882861, 11786366, 20910269, 91240548, 6162771, 87798463, 37434395, 39138642, 5766869, 39163770, 32663973, 85489474, 27633106, 74615012, 37261493, 60957190, 44973668, 79373134, 26636741]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/rgw_run_2"
