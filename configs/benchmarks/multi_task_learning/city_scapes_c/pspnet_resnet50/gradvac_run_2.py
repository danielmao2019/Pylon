# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.gradvac import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 90630587
config['train_seeds'] = [30659289, 26722621, 58269129, 84477724, 39151628, 39754519, 59350149, 83596575, 16332807, 68881392, 95857847, 98170750, 83714569, 7141865, 60447271, 77763129, 79624460, 67893421, 25560371, 10014159, 78471407, 97740793, 95104228, 52338332, 38450887, 61103116, 87563471, 4183572, 81933579, 88532296, 30437719, 27215221, 52823656, 84268212, 69963248, 12933994, 55902504, 76051257, 33460191, 1924928, 75250517, 3372978, 67483485, 70657735, 38355167, 99861204, 78086218, 98902258, 99929824, 19052017, 38646560, 32455577, 53493389, 5877617, 87019168, 19200979, 76420556, 79913356, 82106951, 60146692, 48700712, 24900869, 8340205, 94659698, 82361888, 23321588, 37952832, 48663100, 63722588, 12129765, 84965540, 78792348, 83409467, 26423641, 18096437, 22227413, 53202149, 16841042, 64923319, 14645223, 87719945, 97674118, 88476466, 3705436, 26628503, 73372876, 91164632, 40051997, 39637505, 21079403, 77167050, 1432812, 93206002, 57632826, 33633551, 76330564, 14052266, 9399258, 77173727, 21544121]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/gradvac_run_2"
