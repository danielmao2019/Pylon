# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.baseline import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 88332202
config['train_seeds'] = [61328457, 25480294, 68880343, 35260260, 61317628, 81537671, 51964548, 83106135, 61963885, 1841014, 24641484, 31357479, 23331944, 50873550, 74040448, 51777234, 47740709, 42194924, 58753823, 58045155, 27252146, 20014865, 79325113, 85330973, 33947654, 94267442, 43419587, 2347352, 84023958, 7306803, 14512423, 72472439, 90043760, 42760623, 67237048, 79382342, 40856353, 76051973, 95928934, 99042285, 17019543, 72091832, 65825594, 25506242, 71704459, 73443709, 65165092, 94521791, 5737823, 80581230, 48252517, 80699591, 25393912, 47532307, 7548508, 16676345, 97628147, 78166062, 28743859, 80543859, 51987330, 32533772, 53370163, 79102646, 5758109, 93753733, 61590136, 80107699, 45776523, 82592951, 4997798, 4637314, 83176934, 5195299, 21613644, 44301576, 25046253, 22310618, 31931169, 42983293, 67001449, 5450770, 15927327, 62947273, 99696196, 17863246, 73362467, 95893968, 62357766, 12655058, 78263008, 31542663, 46473462, 38954481, 13483325, 88439262, 35035134, 90852567, 83616774, 17574063]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/baseline_run_0"
