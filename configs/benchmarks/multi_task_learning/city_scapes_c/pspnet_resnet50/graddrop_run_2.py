# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 46415141
config['train_seeds'] = [95315916, 66166720, 57442694, 85128289, 60824493, 35030755, 82414273, 18268867, 11537429, 9379804, 34999332, 89364667, 73951525, 11583377, 68925189, 10429050, 71840692, 11739872, 70187526, 54839012, 48635559, 52383716, 94606704, 74088499, 3511552, 9822806, 1360070, 14109588, 30665940, 57910600, 22428682, 96427962, 48662892, 57453482, 69995628, 27056218, 33408221, 60306952, 96709162, 24359701, 74913715, 81565176, 34490182, 79743686, 27616730, 29983886, 12074723, 92483490, 82756613, 53387166, 57547511, 37067127, 61944555, 23651418, 43500754, 2182862, 78594592, 13960885, 32188436, 33234687, 49121103, 92693023, 24679503, 21766000, 4940785, 61035348, 99641301, 28936254, 93265675, 18477030, 37152216, 58179270, 67029927, 36672428, 77331943, 12300927, 5123246, 57911251, 89482066, 65202317, 719437, 49081434, 38605475, 26641653, 6149898, 54024016, 11368232, 23721208, 47704925, 49121260, 28842994, 76046173, 8276468, 70759759, 47456319, 65823146, 55531154, 64383361, 94817215, 34543504]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/graddrop_run_2"
