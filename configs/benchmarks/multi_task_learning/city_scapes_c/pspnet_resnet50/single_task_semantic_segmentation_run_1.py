# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['semantic_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['semantic_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['semantic_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_semantic_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 31024526
config['train_seeds'] = [78560597, 33776146, 19637250, 1899179, 76666963, 4847941, 36515994, 84045889, 7555501, 57947201, 65787125, 29922806, 4321559, 11936631, 96119602, 50093247, 58940541, 90295640, 82348240, 85320625, 97106682, 95862375, 39418059, 38753409, 96733489, 68810902, 7333482, 65309077, 42818422, 18020899, 690083, 71974779, 81981895, 27087975, 87603924, 35308161, 71696535, 99753643, 1425646, 60336728, 84648476, 45835876, 67990544, 91835037, 22063032, 5411107, 7500348, 25362555, 94262423, 49039357, 64273355, 8935949, 46092267, 94056234, 19808493, 28667300, 94870371, 74351863, 83215572, 42255554, 40156734, 9097393, 81945260, 27051529, 956631, 82598516, 49045682, 8229837, 2271576, 49833517, 63458224, 70549076, 26520127, 15762748, 25697965, 3653855, 13400310, 66184080, 23687409, 78851479, 7266644, 77054679, 17873319, 32499197, 30634223, 90985333, 33032972, 34079427, 8874279, 74268482, 91397589, 9525898, 65548214, 19283322, 29944182, 62831496, 31160104, 29289943, 82576037, 7461332]
config['val_seeds'] = [5022520, 50577291, 56961819, 72954199, 92583620, 16476796, 10199524, 78252034, 97722620, 48970822, 97114857, 27491878, 21471909, 36581690, 86359283, 32218762, 34371662, 67160444, 43984723, 44949751, 68970813, 60185490, 84602687, 914906, 80993765, 26611700, 53883164, 46069836, 8375670, 56969112, 46430621, 35556913, 22449334, 9440424, 80521661, 52025952, 5876869, 13081090, 24472571, 79043580, 3198546, 29856587, 51045470, 69986511, 80130849, 22414715, 98349992, 79605157, 56028149, 39204439, 70909848, 79211408, 48366508, 54424786, 8348145, 41300023, 8499595, 57994303, 56602747, 61245105, 65544139, 92628808, 73370771, 30751678, 55664752, 79088333, 8701780, 42926630, 57988116, 56426181, 33442729, 55166711, 28696577, 94536371, 57339762, 34289200, 21128279, 44928842, 61153378, 83788090, 25535734, 84814141, 29943354, 89627363, 92929337, 15116427, 3050597, 27917701, 65974246, 48516465, 88930650, 97699351, 20126417, 85735665, 20605614, 95017600, 23208834, 49041298, 25718905, 50150875]
config['test_seed'] = 32505302

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/single_task_semantic_segmentation_run_1"
