# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.pcgrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 30320606
config['train_seeds'] = [61681487, 54361261, 35607747, 37801560, 87756950, 52981624, 14183008, 59757374, 63857225, 63578341, 32124992, 86393208, 4797888, 33806874, 62286719, 97770429, 214695, 18978941, 29552219, 35366207, 91103326, 50362619, 14020312, 4704104, 37929685, 3323458, 49427164, 93697147, 98545811, 30215479, 93103519, 13578864, 98512670, 29243300, 70089062, 98831856, 82141757, 35868198, 7674222, 28161710, 70394268, 49864087, 49733351, 88946797, 44154246, 95518050, 29836264, 76920954, 37296456, 49703824, 39356556, 59316139, 82926758, 2175748, 53536438, 46655826, 47741312, 61268219, 53755345, 10833343, 72294625, 78194290, 21796842, 18090148, 72761235, 71634103, 80605765, 991997, 99555254, 60180024, 7918084, 43866568, 89026625, 26738834, 20403779, 66024423, 72485103, 88979157, 10961551, 35681994, 37416221, 2971803, 85447629, 4281761, 59457956, 51503987, 74847412, 29553173, 80543552, 74938279, 87479901, 36638719, 59995501, 121026, 51929237, 22619892, 54200416, 84101513, 39537174, 96673604]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/pcgrad_run_2"
