# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 24441213
config['train_seeds'] = [5968492, 69234201, 48261366, 56225879, 14120784, 47265270, 33886483, 36196326, 49370965, 10704704, 2201206, 62752027, 73381145, 37866015, 67592809, 96545511, 46636565, 27119141, 81076309, 14849633, 3147255, 39902553, 46566553, 94390456, 20157319, 11808572, 55247795, 94888436, 78742574, 17285303, 26801625, 74789123, 61609945, 38180387, 53688873, 85263754, 107433, 17191532, 84260916, 35921525, 50928853, 16567842, 3462060, 72410489, 37605390, 62773861, 85063886, 88026230, 62791555, 24937468, 76794037, 2261220, 4220095, 22982020, 37706324, 45638348, 46512858, 60529420, 58146125, 51828297, 17618133, 55567821, 10397984, 40034548, 81460739, 5038679, 67749292, 6239327, 30241832, 63362819, 52013887, 28592770, 94786250, 38246594, 1460111, 44893792, 67462691, 94557568, 91551488, 36015620, 10763926, 69993720, 39028962, 93182333, 31396658, 4593189, 98467048, 75766182, 12549677, 99091881, 37706231, 33088672, 92141978, 18769606, 34639136, 17675134, 20026011, 7161178, 41821892, 63238293]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/pcgrad_run_2"
