# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.baseline import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 995040
config['train_seeds'] = [63744165, 77103149, 2218192, 27429984, 76629862, 4693362, 83428260, 47265696, 78154821, 13924237, 693254, 84017841, 35862247, 72146593, 42794341, 98044839, 48863358, 61150320, 41957563, 60218451, 89405090, 78526067, 43534892, 69499727, 37265586, 61789035, 82549546, 52397137, 84908895, 38656810, 52036896, 33213114, 18370666, 27454143, 55062531, 4429856, 91779656, 55131692, 45335333, 54935714, 259108, 23207837, 54113425, 98085045, 7315644, 88604025, 44935644, 57965060, 59863987, 5481601, 97082710, 69346043, 31059361, 15855652, 26793720, 93327840, 37930265, 16584128, 22764834, 19609119, 97109954, 75689361, 13470693, 43922682, 62351300, 76080778, 52373927, 26893997, 82232372, 49086375, 11339696, 20100779, 15682777, 81045656, 35990208, 67478284, 77701447, 17429794, 43885411, 85950120, 40903719, 55325599, 14331050, 1550272, 53804028, 99652277, 40133878, 69518030, 56517465, 34672981, 79571007, 27997815, 62726959, 87906319, 48975569, 41807550, 17713380, 1320833, 80939347, 79882510]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/baseline_run_1"
