# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 25583021
config['train_seeds'] = [50231086, 73511473, 40726135, 96927904, 43373929, 18996604, 71529807, 84131281, 73610185, 54884820, 4844407, 67387970, 54849136, 74696922, 47994750, 73331905, 74398192, 82614955, 50112208, 84947603, 28450630, 64273316, 83633080, 37065180, 88112257, 3395492, 72554496, 42105732, 72365921, 30182347, 87217212, 14706362, 77891920, 300395, 99887758, 193499, 56097272, 60240586, 86249931, 79058823, 37400055, 92439337, 18100413, 99307917, 96666981, 2346441, 90850257, 7316852, 14231942, 48688771, 74082086, 24996137, 84855050, 2649045, 65202495, 95712178, 37817212, 66453904, 12511384, 98754122, 13243189, 66651120, 17273306, 8330985, 53669214, 22679851, 30434519, 24227927, 25030489, 96445304, 13044875, 2780445, 73383786, 73591984, 31313843, 19939724, 31713441, 95754668, 13956678, 43041770, 83406498, 38021996, 8959708, 26897102, 17463210, 99936428, 27954648, 1758911, 5804514, 40990041, 21095062, 38771339, 86818527, 45840568, 54624465, 70998834, 47118715, 44969315, 4397861, 91943325]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/alignedmtl_ub_run_2"
