# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 90415162
config['train_seeds'] = [68350338, 86067042, 93450564, 20646947, 39053994, 49123709, 22090482, 93046858, 43297858, 31086050, 7653754, 88423202, 26836190, 43267945, 77235555, 38626047, 1474569, 56749359, 26199028, 33870574, 22794778, 10148398, 69965602, 32610807, 61659861, 3012393, 30870073, 80030591, 32960246, 20877471, 89038016, 71522653, 45172011, 52610390, 76710362, 65209330, 27686453, 17454761, 38429810, 46404647, 98078491, 5505363, 6926847, 51699504, 2934219, 50939221, 33401953, 9743410, 40008615, 42711104, 32146278, 26680161, 40810104, 1317488, 99082678, 67966742, 32291514, 28607897, 36120365, 2028413, 44917807, 11169677, 80279595, 29522959, 22407659, 57373963, 67259307, 79451758, 55979962, 59168821, 7333592, 2243418, 66514366, 2662343, 46915773, 70989993, 8394205, 10321178, 87506091, 88987289, 57108220, 75752691, 64102174, 5620713, 38256434, 83291759, 77936776, 27825558, 84109713, 5420130, 50969947, 91054823, 32134969, 57482540, 3645766, 38663139, 48419187, 63008709, 59597908, 46005985]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/cagrad_run_2"
