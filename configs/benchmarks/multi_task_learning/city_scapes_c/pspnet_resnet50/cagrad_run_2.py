# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 1970671
config['train_seeds'] = [47655689, 39900194, 41442168, 16377821, 92195193, 63064105, 60619628, 1976355, 99242767, 33405749, 77094797, 93455637, 47578577, 81036865, 83037515, 38784923, 31415564, 12174665, 4345020, 96893047, 98695092, 60908231, 89344052, 77379159, 9136408, 3693180, 41594594, 63746475, 40914599, 85495849, 77729351, 59184727, 41559907, 66160025, 54492126, 63129750, 37779799, 35978920, 27815841, 28751356, 1989236, 28234337, 48519727, 23453579, 71983199, 36990034, 70396252, 17982438, 87464433, 59809719, 7238991, 27206159, 47602361, 24083755, 50510918, 4607914, 28994571, 89516088, 21774906, 43233007, 28156273, 62273192, 2282655, 43917382, 37215398, 29652880, 8406808, 38454680, 72903389, 56323951, 44722347, 98363641, 390651, 6813114, 3238029, 30717440, 40931736, 77175038, 74189882, 3294377, 27490791, 57621936, 74565814, 82610762, 45379390, 49408236, 15791305, 15307280, 32701021, 91236324, 66202975, 44649441, 32680601, 61530219, 27089780, 13556330, 54876718, 73040925, 93483179, 53624575]
config['val_seeds'] = [94544088, 66433557, 23197415, 38005363, 5609585, 84795954, 57945454, 25979331, 33008534, 41458295, 84242109, 15341577, 21089751, 97953237, 39550260, 12973504, 17735416, 43179222, 82408979, 1917475, 86906073, 36652252, 66143900, 56171198, 54178869, 48122914, 67652005, 78038262, 94593671, 59948159, 10556280, 83834662, 30040754, 55555941, 37468261, 32788072, 19935075, 58897234, 66517608, 22655026, 81476955, 30061878, 48500125, 65976848, 39490532, 19734066, 5050646, 68115848, 31861567, 86292777, 32400691, 68737695, 35778678, 64352977, 40261822, 44860070, 61252501, 64032720, 70226443, 34226764, 79688014, 8523116, 99145888, 95812750, 3714362, 16341236, 24733437, 12662000, 98981735, 11065142, 42681648, 8329495, 83214035, 42377091, 29391141, 31289842, 75309982, 14361391, 96973833, 71813877, 86062640, 29003300, 10876590, 50324313, 38498357, 78384304, 53019097, 34589954, 49025150, 6140532, 60778004, 21887723, 12041435, 44121343, 97031286, 28715802, 35923776, 75825697, 3349605, 51760147]
config['test_seed'] = 1015471

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/cagrad_run_2"
