# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 1970671
config['train_seeds'] = [47655689, 39900194, 41442168, 16377821, 92195193, 63064105, 60619628, 1976355, 99242767, 33405749, 77094797, 93455637, 47578577, 81036865, 83037515, 38784923, 31415564, 12174665, 4345020, 96893047, 98695092, 60908231, 89344052, 77379159, 9136408, 3693180, 41594594, 63746475, 40914599, 85495849, 77729351, 59184727, 41559907, 66160025, 54492126, 63129750, 37779799, 35978920, 27815841, 28751356, 1989236, 28234337, 48519727, 23453579, 71983199, 36990034, 70396252, 17982438, 87464433, 59809719, 7238991, 27206159, 47602361, 24083755, 50510918, 4607914, 28994571, 89516088, 21774906, 43233007, 28156273, 62273192, 2282655, 43917382, 37215398, 29652880, 8406808, 38454680, 72903389, 56323951, 44722347, 98363641, 390651, 6813114, 3238029, 30717440, 40931736, 77175038, 74189882, 3294377, 27490791, 57621936, 74565814, 82610762, 45379390, 49408236, 15791305, 15307280, 32701021, 91236324, 66202975, 44649441, 32680601, 61530219, 27089780, 13556330, 54876718, 73040925, 93483179, 53624575]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/cagrad_run_2"
