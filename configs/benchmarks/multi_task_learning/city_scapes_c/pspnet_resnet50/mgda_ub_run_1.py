# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 73300764
config['train_seeds'] = [49978406, 79735850, 45794042, 36365369, 88234981, 64647653, 4230579, 38320158, 71850411, 57322101, 99711055, 36180132, 97226602, 16402011, 24946661, 56096869, 72555621, 11120609, 28194940, 87409585, 86203866, 27968059, 93757028, 33079709, 76250569, 98009330, 35542827, 79067350, 3890249, 59249413, 75633207, 10318833, 79747255, 44401456, 43015768, 32862377, 48937197, 18150841, 38272972, 34203956, 42632104, 78156367, 83150280, 46834052, 90419145, 87272686, 87287350, 59783673, 10724307, 28265318, 35108313, 27834170, 22730059, 90880611, 412333, 67778719, 31683870, 42321869, 72858349, 37025158, 68646664, 47000767, 14389329, 1586306, 24188970, 56203334, 83139439, 76168351, 34872061, 94161812, 18272651, 99110900, 30265601, 76230717, 81874289, 83910610, 55240912, 91922811, 54365674, 81989793, 7821361, 44415766, 76805706, 81223877, 3580547, 63689663, 81493358, 8478236, 91147240, 4634077, 20164189, 60071104, 24139641, 53617059, 14324986, 2867188, 79534132, 19929036, 53587000, 18538343]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/mgda_ub_run_1"
