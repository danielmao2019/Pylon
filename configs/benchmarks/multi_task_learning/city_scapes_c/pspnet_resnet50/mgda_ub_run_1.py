# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 59233969
config['train_seeds'] = [98110494, 45925511, 76980004, 78105381, 35701828, 64320256, 9185411, 57721050, 31415609, 76853618, 2047419, 34230748, 73368237, 81477486, 79164218, 42391561, 6306323, 40888406, 17242395, 8733997, 4010122, 92568427, 37185497, 1798467, 3590879, 42701717, 99082180, 94738386, 82167602, 33073146, 69671300, 9764289, 33640171, 32045083, 23656153, 83338577, 65015712, 72749521, 79225609, 26505385, 47246252, 10528039, 8459816, 25523133, 65667592, 82828067, 68432078, 4871672, 61907978, 3257317, 10870268, 42253980, 80111689, 79817944, 80021610, 61400333, 1572362, 83050683, 13984081, 23666061, 58544439, 88146426, 4333688, 40504381, 62515216, 31320901, 74141645, 48454070, 8617852, 15767526, 94513398, 89180830, 18853852, 91046169, 60508692, 29266042, 21806946, 46741569, 83494040, 28729239, 68221554, 37941236, 96671376, 85086628, 49856166, 15132366, 91488439, 6303217, 56436118, 14556338, 61690388, 26132881, 72873590, 62216111, 14165008, 47291939, 18884580, 45769354, 33132749, 61502963]
config['val_seeds'] = [27505325, 53178705, 82435209, 25053174, 56983735, 34600691, 52211273, 27542649, 15456189, 90542964, 56165985, 92323390, 34386145, 87271926, 88055967, 92856287, 91329563, 3756976, 72218235, 49919727, 22521489, 38038871, 68032211, 73866155, 27501509, 83136707, 71836559, 40770204, 20688736, 87461610, 54354557, 73514957, 23117628, 6181181, 26732056, 96036097, 33893193, 65911500, 26992602, 56239683, 65720838, 48122031, 15318988, 1396391, 56996767, 36417, 33376226, 86047996, 70018858, 70901026, 76457878, 18186213, 17378383, 85577215, 4611640, 17676453, 61467088, 61892433, 85036421, 16668898, 38922185, 65070522, 23194526, 62869689, 62630893, 47410158, 63933569, 83802103, 11487530, 20647939, 93035322, 15963879, 74995966, 10620091, 73816499, 81585561, 34137819, 33791057, 73845685, 53320449, 82067600, 21762034, 15258288, 65676508, 9319262, 42120858, 3671347, 15103109, 524379, 36390691, 17198752, 67108404, 25821550, 54724332, 37188018, 20520712, 72176325, 99199901, 23710442, 85321797]
config['test_seed'] = 9590591

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/mgda_ub_run_1"
