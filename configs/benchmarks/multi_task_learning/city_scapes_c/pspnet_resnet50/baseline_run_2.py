# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.baseline import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 18960546
config['train_seeds'] = [86170477, 94268478, 52249432, 28966082, 24026286, 55237948, 72902896, 96928032, 12234120, 36110452, 50025862, 12086642, 96399335, 52680454, 53419798, 16202732, 52776145, 27465981, 903541, 20198602, 49627279, 94739611, 81409582, 72685210, 33857622, 47160064, 82698340, 65032296, 61149288, 24187415, 78567852, 76986547, 81180860, 78790565, 78872727, 99988567, 1285250, 39365875, 28637909, 67250158, 71020689, 57937353, 52081298, 86058653, 50041410, 24416464, 10027810, 85595849, 83368851, 1816266, 30335214, 67607611, 58388756, 75091573, 5805705, 60297765, 78459674, 61129691, 14420783, 85722626, 23728418, 65295317, 405990, 57606901, 29157277, 87955139, 39186658, 82083416, 54541250, 32977489, 95735339, 30901570, 95490365, 93832512, 31547554, 91757310, 60319760, 87548891, 16538024, 90237168, 30804555, 68160453, 33240234, 78875154, 72707104, 30633343, 38633099, 50012258, 90701007, 11742154, 53632290, 32258013, 67442638, 42284963, 80997937, 90818479, 15297740, 1332914, 30229026, 30009433]

# work dir
config['work_dir'] = "./logs/benchmarks/city_scapes_c/pspnet_resnet50/baseline_run_2"
