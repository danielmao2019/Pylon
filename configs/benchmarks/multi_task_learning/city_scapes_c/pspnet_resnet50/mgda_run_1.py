# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.mgda import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 50515287
config['train_seeds'] = [96816866, 5827823, 90318612, 49674690, 99371628, 23577146, 23559246, 18111787, 85250850, 64718386, 4000444, 21038021, 28867116, 59677198, 69770888, 2375609, 68332304, 84284542, 82895182, 79581518, 85154084, 40134992, 54669597, 29228661, 70684196, 99878693, 96009091, 70111289, 17693159, 99328517, 6141557, 35381179, 96113917, 60678321, 62936071, 74293063, 29953, 12930769, 81399547, 94599363, 8697485, 11587679, 45039809, 32459393, 99707451, 89617200, 68329470, 83288454, 2534421, 72783429, 19908566, 95895815, 2177353, 72728807, 92083496, 34277919, 74623876, 37005468, 14337412, 72038573, 75213087, 85311120, 92730412, 11868049, 76926371, 76785307, 56828993, 94266128, 43845800, 30382438, 37493878, 98395266, 24583952, 53708529, 43960497, 43198181, 50358727, 85278357, 19997523, 76807887, 76346854, 84885518, 48523910, 78131821, 11280548, 71514248, 99050849, 10502398, 78249251, 99015078, 32792109, 84474019, 46382186, 49333771, 33278828, 3591144, 64837278, 98314866, 35257954, 27605747]
config['val_seeds'] = [87289209, 36428457, 44063774, 50235126, 99989265, 82995700, 34799531, 33621462, 42745906, 17634501, 95442351, 49502092, 46320837, 48346824, 42541206, 15892898, 37966256, 4329658, 65185478, 91047136, 52649268, 23840148, 12948914, 51038430, 61258078, 42290332, 16964959, 13492662, 56346792, 54389154, 76457614, 44907604, 19380137, 86050061, 83973354, 40540650, 45480766, 40249311, 33629540, 62066045, 213625, 19289155, 52816384, 86432812, 99257201, 83688017, 24546979, 34257396, 82972643, 11100852, 94455242, 5596856, 76934398, 12367336, 21957732, 35101312, 23639009, 43596044, 96538202, 81335567, 2298439, 41072873, 75356791, 88113718, 33765245, 79247641, 94122414, 2656033, 95537861, 35328046, 861062, 81851280, 46566001, 68563117, 77333790, 76682033, 6014849, 35237250, 34936493, 40977943, 59270086, 17797367, 73922674, 80614895, 8643152, 20823998, 44126844, 14616716, 80571051, 66930115, 16483355, 6824024, 29477581, 25722257, 36481723, 86384067, 16459602, 61979122, 34299787, 79301834]
config['test_seed'] = 85546266

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/mgda_run_1"
