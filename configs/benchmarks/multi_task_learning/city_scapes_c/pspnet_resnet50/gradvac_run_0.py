# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.city_scapes_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.city_scapes_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.gradvac import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 54964956
config['train_seeds'] = [90030725, 90633821, 84805481, 60884449, 67996189, 2789115, 39987350, 22361843, 40661504, 13835186, 42480671, 11068274, 75432220, 61801351, 53235659, 12766118, 11420726, 67335086, 88868286, 66415597, 29538233, 20257960, 18103057, 7722374, 27106393, 91700486, 40350592, 15680179, 49839890, 10174589, 82279728, 2183064, 15835724, 14701798, 39421297, 33589510, 29695678, 24135878, 27489205, 85322987, 21129349, 68508708, 98841135, 48433657, 81211186, 79698027, 3204370, 44039542, 261303, 25534328, 93867406, 74925657, 81075947, 88794949, 48429251, 69852324, 9955050, 4436328, 16761393, 2129571, 90512195, 70713351, 9472209, 83284959, 81313479, 39375850, 31677563, 91162008, 45397606, 62892263, 98009995, 57161518, 27978342, 66672101, 25900169, 99062704, 85252385, 53235327, 67259212, 10494452, 68419518, 59093284, 23012667, 69358180, 12762879, 85997509, 26304933, 12784928, 11201142, 68288841, 74670796, 39462929, 55094526, 28524400, 48268726, 14065192, 20613232, 11091730, 99609855, 10119450]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/city_scapes_c/pspnet_resnet50/gradvac_run_0"
