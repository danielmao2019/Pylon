# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 19607556
config['train_seeds'] = [82677815, 18602518, 14502945, 29558330, 58749356, 70401556, 50981721, 88723530, 48722050, 64637985, 84392818, 23029394, 71162107, 27116319, 64448333, 40758621, 98258270, 30246982, 34249130, 44530197, 18667769, 86386419, 47058589, 8435205, 88696718, 16126192, 94017848, 14318377, 7337907, 75731200, 19817296, 95760144, 88816626, 15695566, 34771337, 89310995, 750085, 88086199, 78570922, 54000915, 83042736, 35403468, 60811865, 84237903, 97207009, 6435849, 50899017, 542985, 75949915, 99537411, 55987699, 35332416, 30500242, 31398606, 27960394, 63346886, 45850920, 54864000, 79694987, 38748569, 38743151, 83008139, 14145820, 73533267, 72587194, 4506237, 43993090, 69305754, 92173634, 90397505, 2400711, 76939934, 69386588, 69337249, 49806308, 74439721, 9843858, 53169640, 14527419, 94423217, 11542127, 48339792, 93082856, 76823392, 31298720, 31053036, 21706339, 40833580, 95670575, 70992160, 92324102, 55739253, 66172294, 81066452, 57472680, 63573415, 50172712, 13698840, 27084614, 91492030]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/graddrop_run_0"
