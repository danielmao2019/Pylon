# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 43206347
config['train_seeds'] = [35277548, 71479768, 249460, 40931586, 53801891, 56716510, 92105226, 4868390, 81344072, 31155113, 18356608, 90776682, 18858378, 49738235, 56582833, 90860221, 58463946, 74601623, 8630481, 49274873, 97860041, 80028446, 88328559, 26201000, 69737056, 17113208, 12476807, 46868165, 32985020, 98258886, 38320877, 16769766, 65688233, 76870101, 29229361, 70258542, 30457696, 90682049, 97078617, 93593425, 51270553, 79575542, 65598867, 79286667, 10779158, 71437217, 36992884, 73113204, 31078456, 69573560, 31810079, 19594210, 2881892, 16717876, 1623626, 13355356, 16077095, 25124055, 62806370, 75672184, 90661482, 84678633, 74731408, 22522581, 59281965, 19309623, 59480002, 27566757, 64833300, 4053711, 1946559, 2960298, 46910506, 19487148, 60907720, 69801126, 83290145, 28924224, 69032386, 63110980, 71165406, 51570563, 22644808, 29367925, 5009940, 25097353, 22075068, 94863078, 37284340, 47095791, 90917488, 86060623, 23997666, 90623503, 10750272, 51564749, 58958783, 19355896, 16220439, 82553933]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/multi_mnist/multi_mnist_lenet5/imtl_run_0"
