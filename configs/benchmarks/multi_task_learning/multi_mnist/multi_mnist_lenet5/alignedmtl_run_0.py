# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 60669795
config['train_seeds'] = [81529140, 95594682, 32169296, 34541425, 5660736, 93971443, 58806499, 39969755, 39011705, 73377664, 22079657, 9219155, 18617069, 13772822, 26378061, 59722995, 6096658, 44554383, 20351103, 65966446, 63324022, 95911869, 68023986, 6972766, 15483545, 43574869, 22014005, 3560964, 56034652, 98301018, 70435880, 88319215, 32447429, 18918877, 73751207, 2524103, 32830642, 19866109, 61241424, 21287978, 59595668, 95981688, 4718877, 50534480, 13928358, 48270647, 25761009, 65573195, 33285400, 68811105, 94129668, 99174871, 31391179, 94649574, 88552684, 21787272, 60136437, 15382484, 86689725, 82738358, 5219514, 72628009, 36441500, 36259928, 69166544, 51731056, 15816258, 44203671, 32804702, 70009719, 27974648, 25384363, 92170327, 82990777, 39916095, 71791643, 8473959, 70250774, 45846030, 1442771, 29886973, 39683019, 43252027, 34045466, 40167064, 3168362, 85125479, 78576269, 76260303, 80745040, 65033981, 27305900, 21199369, 66786379, 55372522, 87580158, 60759051, 79639018, 6870450, 75032361]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/alignedmtl_run_0"
