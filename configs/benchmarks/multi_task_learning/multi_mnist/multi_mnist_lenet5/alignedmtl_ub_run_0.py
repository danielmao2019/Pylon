# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 80247275
config['train_seeds'] = [1674738, 19572187, 19096797, 26747293, 65989645, 66802687, 87279390, 49795713, 22305413, 96229785, 5351094, 16512779, 42431388, 85720046, 56726643, 78204290, 79551576, 68603300, 821611, 75723545, 59495937, 80843522, 81654008, 94791532, 38265101, 70559535, 28616732, 99517374, 42524858, 46305671, 45517815, 82509067, 83340255, 48634078, 20549162, 78678829, 16457867, 32798908, 46217664, 71819172, 96845419, 17228564, 80222911, 95375897, 67751774, 47728572, 71109512, 3662922, 42645037, 16775766, 83181837, 57756809, 8153854, 73222806, 95842573, 80705248, 92337253, 30812929, 3448287, 50710548, 81786537, 34163501, 19648483, 34443576, 57962515, 17071238, 8169803, 25673600, 96087357, 33846382, 21753317, 63568398, 73861419, 18393989, 53796810, 91282956, 93125822, 83737303, 45004648, 20801822, 41322830, 85821770, 46381263, 45549111, 80055797, 61654950, 11874747, 26719179, 36535007, 80714213, 8701345, 31307756, 84755338, 74081931, 17640536, 87546044, 26854728, 97387671, 56654108, 3683198]
config['val_seeds'] = [46712886, 16700776, 72244474, 12938794, 67754405, 2380537, 69579381, 48950972, 56789580, 93586773, 40162821, 16706571, 98124695, 73385694, 45132621, 31170826, 14315867, 89089253, 9623747, 55196180, 76771018, 19502439, 77746605, 15828605, 38489988, 90002091, 66111816, 9398373, 52131302, 10625662, 44205135, 12143694, 67383747, 2035558, 33366884, 56296803, 57721039, 38048890, 60176784, 64235339, 71349660, 79825046, 80412221, 26004976, 60269035, 26916221, 74963578, 6962642, 56718058, 19280284, 54268189, 51873784, 17974312, 77203940, 28856794, 47211289, 21730765, 61099258, 44205085, 59066644, 88052759, 88586133, 89087938, 77451402, 19356626, 13758246, 34767028, 48721229, 73125884, 78940432, 5678321, 48874288, 33743806, 20535315, 57111971, 99493755, 68295657, 7072240, 23818717, 94210638, 92144789, 86719052, 15728856, 51423039, 47930164, 78712891, 39810453, 17947332, 20773823, 71259592, 50123785, 87234068, 25688839, 50202371, 89473730, 38412664, 47711268, 91343956, 87666358, 80678218]
config['test_seed'] = 34753977

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/multi_mnist/multi_mnist_lenet5/alignedmtl_ub_run_0"
