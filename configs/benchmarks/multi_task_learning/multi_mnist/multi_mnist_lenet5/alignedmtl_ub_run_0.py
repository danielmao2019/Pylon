# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 80247275
config['train_seeds'] = [1674738, 19572187, 19096797, 26747293, 65989645, 66802687, 87279390, 49795713, 22305413, 96229785, 5351094, 16512779, 42431388, 85720046, 56726643, 78204290, 79551576, 68603300, 821611, 75723545, 59495937, 80843522, 81654008, 94791532, 38265101, 70559535, 28616732, 99517374, 42524858, 46305671, 45517815, 82509067, 83340255, 48634078, 20549162, 78678829, 16457867, 32798908, 46217664, 71819172, 96845419, 17228564, 80222911, 95375897, 67751774, 47728572, 71109512, 3662922, 42645037, 16775766, 83181837, 57756809, 8153854, 73222806, 95842573, 80705248, 92337253, 30812929, 3448287, 50710548, 81786537, 34163501, 19648483, 34443576, 57962515, 17071238, 8169803, 25673600, 96087357, 33846382, 21753317, 63568398, 73861419, 18393989, 53796810, 91282956, 93125822, 83737303, 45004648, 20801822, 41322830, 85821770, 46381263, 45549111, 80055797, 61654950, 11874747, 26719179, 36535007, 80714213, 8701345, 31307756, 84755338, 74081931, 17640536, 87546044, 26854728, 97387671, 56654108, 3683198]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/multi_mnist/multi_mnist_lenet5/alignedmtl_ub_run_0"
