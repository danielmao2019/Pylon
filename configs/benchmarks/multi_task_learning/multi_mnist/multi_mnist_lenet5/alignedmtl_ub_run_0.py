# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 39217977
config['train_seeds'] = [90729952, 40030713, 1154243, 10645199, 53832175, 91503824, 44291790, 94294097, 60068682, 21463155, 36754943, 20915572, 87699779, 69626843, 81525411, 13472394, 92575941, 2486068, 76175979, 5918107, 88289505, 30344247, 66971421, 18123954, 18377904, 7730855, 27707064, 6229533, 30056719, 61106895, 24595827, 96840836, 11723205, 88424280, 37173906, 15266320, 44508645, 75231153, 6858181, 34863813, 62080864, 19948814, 13952660, 83395071, 91695982, 15086727, 43894765, 31660084, 57322965, 43948963, 80716679, 83071727, 70359543, 93657673, 67671803, 60360655, 40345701, 40593645, 35291257, 37898123, 86652027, 28159891, 68855918, 4843132, 85547807, 6708325, 10139194, 57201036, 9836421, 5812197, 67200503, 38508510, 50372300, 41068599, 75671304, 19083924, 377822, 21526407, 43531625, 52203828, 95215564, 44562100, 5720423, 84859306, 43293554, 50824066, 72356956, 52669520, 71543716, 60558415, 54475073, 48332379, 92169890, 38618960, 14815815, 74693339, 88678501, 12782864, 85844971, 31849816]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/alignedmtl_ub_run_0"
