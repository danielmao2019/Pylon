# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 97892415
config['train_seeds'] = [77798084, 99446763, 99757017, 32443048, 51492241, 96421927, 18917306, 58441579, 71477675, 88897918, 47887824, 56272001, 88773941, 72899072, 6432833, 31311649, 80589353, 24319229, 51201744, 82020030, 91176, 90371824, 99690797, 38346702, 13111221, 69268256, 87356081, 32951457, 52725609, 30707352, 86682291, 68002467, 21268450, 55973211, 73382115, 89808280, 30623533, 19954503, 42727083, 17858788, 43083286, 78899661, 7922875, 53527438, 30337491, 64044860, 5479385, 71434675, 94456949, 46677476, 15543311, 30612036, 27900078, 45095403, 44432175, 57975507, 24298904, 81226164, 55841457, 5635563, 68461448, 63648799, 44271536, 31254072, 1792251, 80216635, 77350018, 48443867, 15558697, 18760537, 19333387, 41664851, 88493568, 33083262, 25572427, 16981468, 44813935, 90280148, 65601529, 64214269, 55495873, 50334888, 23202383, 93012647, 55424037, 8285507, 18386683, 11288787, 25872066, 89008163, 64932750, 34656594, 10496743, 75131495, 43310932, 35109674, 8897988, 56873648, 5635608, 46926020]
config['val_seeds'] = [51480101, 10911123, 12413946, 44603297, 55915437, 61802614, 26038225, 17076265, 70149571, 24149266, 94811911, 40687220, 37134796, 65462417, 20890988, 10090303, 48682421, 85813228, 69348076, 87885079, 68925349, 93333492, 87412793, 4350607, 7807503, 10835104, 2318399, 45203479, 67846380, 8023172, 61903886, 59333177, 73196368, 98724844, 50824214, 95446816, 46481869, 76869953, 82980023, 10207567, 33193466, 51977304, 13534974, 88474017, 64177371, 8087968, 75476970, 66573200, 97325145, 62009677, 33048723, 73221042, 2637246, 22733768, 69871741, 49625514, 21198612, 49113052, 83287665, 55889466, 48417443, 5508780, 95305232, 20439426, 83725599, 56442005, 99415103, 59749742, 97773615, 47773255, 78385014, 67666076, 85348645, 46768613, 16783653, 36404237, 87536974, 6055531, 40390693, 46692665, 95736680, 51841557, 96114832, 50750838, 45669787, 67009070, 13536292, 21360543, 59837707, 54085717, 86126820, 21399249, 2162341, 46684487, 72667742, 50659290, 40462744, 27039584, 390292, 81713270]
config['test_seed'] = 33010547

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/multi_mnist/multi_mnist_lenet5/cagrad_run_1"
