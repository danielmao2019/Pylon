# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.rgw import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 51965354
config['train_seeds'] = [74991006, 38727545, 10450643, 97367776, 64308234, 69589582, 36532451, 14624059, 78217458, 75332175, 57198864, 48825536, 60740124, 12756246, 75858892, 37444110, 99523115, 97653807, 25868050, 65949878, 61319404, 54449796, 42685025, 31086871, 97130729, 4033088, 15697813, 19506211, 53138182, 871143, 21992694, 20041637, 59222124, 90359234, 58965575, 71621193, 34463180, 8487685, 87137254, 43347095, 43633043, 81957532, 91086839, 40342274, 74149885, 76231466, 33530721, 80618293, 31298658, 15946421, 20827893, 80895316, 99872490, 30389014, 38669968, 87073026, 56546328, 19699131, 36114887, 17088535, 13804911, 19285273, 25533398, 5862455, 83140119, 11203567, 11143670, 36535381, 81744473, 44182857, 21513957, 3591316, 78430041, 84524848, 58932684, 13911250, 15612437, 26554934, 42461625, 12391938, 62971994, 85649904, 41297996, 93880987, 41726289, 668842, 85685524, 76649574, 35252142, 7289956, 46577263, 39289473, 17079352, 44552843, 56048986, 92844493, 15834891, 13308963, 49778114, 22643046]
config['val_seeds'] = [50188911, 76597614, 25320301, 31040618, 78558459, 78748428, 7691028, 69846840, 11822533, 44945438, 75182123, 47675158, 9341344, 84471927, 29753543, 13733409, 14876083, 75100744, 33048566, 74239079, 1444001, 92534783, 90858686, 42574289, 92101282, 83146464, 34572042, 75062611, 94839303, 99374589, 1142227, 35032852, 80335547, 645723, 71545643, 39931255, 3205846, 57982985, 93329688, 75532117, 44862645, 51835283, 2518286, 63509097, 30282083, 81726944, 85104958, 10532075, 87519967, 60819141, 8474283, 58228718, 10340906, 3220506, 61451006, 97445228, 23702487, 93025796, 5010110, 49207809, 25158462, 59502523, 21947851, 36716267, 6245267, 14073300, 52689173, 71955958, 3427389, 64080853, 23354245, 84385987, 42696986, 63487655, 42050381, 88543033, 89967699, 13841873, 32887907, 26795044, 84397808, 52502504, 9479943, 96149751, 82852627, 13453987, 96158413, 35103795, 18003655, 80915001, 58365986, 73639798, 97502698, 21464170, 64276234, 9783055, 93573627, 56220663, 70755359, 996255]
config['test_seed'] = 29638838

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/multi_mnist/multi_mnist_lenet5/rgw_run_0"
