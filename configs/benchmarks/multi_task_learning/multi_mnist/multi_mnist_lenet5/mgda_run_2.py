# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 71911005
config['train_seeds'] = [83474112, 66486247, 45734350, 71986489, 68240308, 1436912, 37570385, 43183893, 6454257, 35622146, 3650660, 76946417, 58804497, 67603163, 80228243, 73305351, 8600200, 83019928, 62914075, 22071226, 73168634, 84021582, 15443549, 6306530, 50361266, 87842329, 160705, 61700275, 52395922, 62304208, 24318814, 64942770, 74237221, 51242560, 34004503, 99710048, 59088710, 60053064, 90722304, 27380241, 3526090, 78634783, 59254727, 5121445, 18929862, 52041273, 46855454, 87913720, 74741167, 63297196, 35048578, 52146823, 58466280, 33224353, 38013947, 39642820, 89639547, 53082553, 44870414, 60573475, 94723375, 73728347, 12630271, 94871407, 57346770, 39360942, 9108284, 70710924, 68163723, 33421995, 27101757, 69576890, 57306243, 17252730, 79901985, 10311984, 42548414, 95309980, 97038577, 97111659, 96643360, 44064073, 25309392, 28954185, 27519752, 46855355, 41863079, 65828451, 61199108, 25414022, 8668049, 38714968, 9341864, 87109019, 36256026, 39114949, 21045611, 62603434, 99149453, 87210816]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/mgda_run_2"
