# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 48770982
config['train_seeds'] = [47312721, 90950389, 13245337, 91405764, 64018227, 67435722, 38153310, 95196289, 22739899, 48893978, 47261650, 58680676, 58516566, 80905885, 87518669, 81822157, 55743823, 71070261, 28735057, 5182125, 28989709, 55724626, 95316720, 2096989, 21793073, 27593343, 38347454, 49510098, 3834363, 90741609, 69102458, 27222479, 85329413, 20207142, 59930080, 65761743, 86662107, 94414376, 64018841, 95396394, 19179050, 85366946, 42958812, 79620914, 90922927, 45682375, 43049708, 50644268, 32809965, 30064258, 40958352, 48555228, 15195149, 83124300, 76238850, 63725678, 21136840, 96872455, 29728135, 32183344, 13587178, 23875976, 64452287, 42621970, 29785051, 85905090, 5702208, 42618568, 32016899, 50966093, 39251864, 92693419, 92178776, 70777001, 8242982, 46785508, 10191679, 50267416, 95255185, 86210633, 72395815, 46115774, 1325767, 11406798, 69459938, 88497301, 36692874, 47311717, 26003192, 9653797, 48510520, 4984910, 41165245, 69975659, 32109463, 32232116, 25754568, 4226184, 26151887, 11249923]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/cosreg_run_2"
