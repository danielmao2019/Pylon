# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.gradvac import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 57329961
config['train_seeds'] = [36590795, 81032704, 13789118, 85917692, 31274234, 97756219, 67669268, 5889, 41721369, 9238319, 70719776, 44960258, 3810099, 5341548, 23023211, 14130685, 14497499, 69819063, 54427078, 94575902, 38793987, 7013012, 40900517, 76615755, 82236427, 81117222, 52959719, 20039051, 39622659, 77697992, 30082722, 93803545, 78700359, 24505100, 43116971, 85746092, 54116896, 9280205, 42694454, 18283014, 50872966, 81481708, 97957185, 68134575, 65357935, 11911850, 31469260, 37647016, 36924555, 66288517, 55165337, 52852145, 5786222, 7440931, 41674126, 27308180, 56866761, 4811799, 94711201, 33502081, 13249125, 6521497, 82563620, 97406610, 69059196, 66569142, 34346318, 40056147, 57487421, 19426647, 20049803, 64475274, 26051704, 50890433, 41975291, 97339767, 45062404, 42444405, 19836007, 85441208, 89425610, 64009214, 50092360, 65370571, 70615766, 75775453, 75440560, 66506369, 59293660, 99189450, 1126086, 50378169, 62550112, 67160928, 70507175, 18013522, 85652927, 5832071, 17194573, 7197887]
config['val_seeds'] = [95759362, 385783, 87093183, 26734538, 44215739, 38176216, 91251439, 67368217, 691365, 76525154, 2833157, 19293316, 11101531, 1141550, 8777978, 73629701, 17619300, 97004098, 20959679, 78792817, 72927264, 90327146, 60382715, 45501744, 98212557, 9849700, 26911627, 91638204, 7649273, 87033834, 49812494, 93081960, 44936245, 61434303, 78836528, 48401519, 75897631, 31008102, 43443772, 68757830, 26668150, 30472662, 50194613, 40466941, 80265552, 23378584, 78630357, 29393465, 82936782, 41553466, 54992909, 83300262, 85343930, 11240578, 61701305, 20402760, 13873575, 32157906, 72957937, 17663178, 85194810, 43405599, 59752560, 93063652, 64597292, 53064949, 33420604, 52353413, 65772241, 32701009, 18054611, 53264280, 23417922, 32826542, 53177602, 93915303, 63532170, 23917147, 66426296, 40438393, 19925576, 81491513, 25661437, 97659130, 13509112, 11782740, 18362236, 5760568, 84279128, 88938393, 2520990, 76461206, 38212771, 14497163, 94469190, 47292076, 43612261, 97407706, 89176216, 2665795]
config['test_seed'] = 42453397

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/multi_mnist/multi_mnist_lenet5/gradvac_run_1"
