# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.gradvac import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 57329961
config['train_seeds'] = [36590795, 81032704, 13789118, 85917692, 31274234, 97756219, 67669268, 5889, 41721369, 9238319, 70719776, 44960258, 3810099, 5341548, 23023211, 14130685, 14497499, 69819063, 54427078, 94575902, 38793987, 7013012, 40900517, 76615755, 82236427, 81117222, 52959719, 20039051, 39622659, 77697992, 30082722, 93803545, 78700359, 24505100, 43116971, 85746092, 54116896, 9280205, 42694454, 18283014, 50872966, 81481708, 97957185, 68134575, 65357935, 11911850, 31469260, 37647016, 36924555, 66288517, 55165337, 52852145, 5786222, 7440931, 41674126, 27308180, 56866761, 4811799, 94711201, 33502081, 13249125, 6521497, 82563620, 97406610, 69059196, 66569142, 34346318, 40056147, 57487421, 19426647, 20049803, 64475274, 26051704, 50890433, 41975291, 97339767, 45062404, 42444405, 19836007, 85441208, 89425610, 64009214, 50092360, 65370571, 70615766, 75775453, 75440560, 66506369, 59293660, 99189450, 1126086, 50378169, 62550112, 67160928, 70507175, 18013522, 85652927, 5832071, 17194573, 7197887]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/multi_mnist/multi_mnist_lenet5/gradvac_run_1"
