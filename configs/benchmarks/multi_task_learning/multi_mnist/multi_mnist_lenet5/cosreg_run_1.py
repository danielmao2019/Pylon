# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 47936970
config['train_seeds'] = [63597776, 54869381, 85793667, 30695541, 89530263, 77402372, 97724984, 84065162, 25979580, 93110551, 70615398, 38110374, 34232125, 95505935, 17456995, 43035360, 2023854, 43390312, 23619340, 751587, 69082713, 10083435, 85190360, 29417717, 61333128, 324962, 75881252, 90193914, 71379531, 77190157, 12501259, 63715048, 31176370, 39666779, 51093011, 12063389, 61579431, 3810737, 92509667, 74265429, 2857038, 79874772, 91588496, 8593294, 51975401, 91006402, 63244752, 50241929, 991571, 71574820, 99371492, 7825370, 94542384, 31505596, 33605867, 78047578, 95778953, 85384784, 47405982, 26482512, 26517007, 27179269, 11692009, 25813727, 780457, 13486450, 35339235, 39627970, 91207986, 21127130, 97492183, 24907463, 3537867, 19781354, 36762018, 48330563, 95518720, 87689891, 98391512, 69247694, 52973734, 90143658, 49367884, 43047254, 79591672, 72363984, 11887099, 15809599, 91457725, 84941280, 80597951, 64081457, 1171967, 23727151, 20387265, 31781310, 64515484, 30362873, 64328946, 69152330]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/cosreg_run_1"
