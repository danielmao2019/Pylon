# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 96478865
config['train_seeds'] = [18564006, 89404499, 30704968, 37891845, 76962164, 52348340, 70307208, 4339928, 58841471, 86293772, 17028963, 35343828, 85788754, 33003422, 97496214, 90487872, 55216196, 57369628, 48172122, 13555283, 2703014, 92533402, 37749002, 63482457, 80189087, 99304086, 3693300, 80399209, 2821692, 50372893, 37758132, 22529804, 65424576, 28018028, 75678160, 25048217, 7642831, 95583035, 76868209, 58973074, 63326758, 54825523, 57560111, 69725431, 12298726, 3010476, 52901443, 19167897, 94421454, 70038339, 57383293, 14399711, 80934638, 12167459, 89208349, 62467199, 41110939, 61087687, 13919118, 55337895, 65922685, 1547876, 83468594, 32190123, 39088165, 99158324, 56576265, 92562508, 16022007, 53256993, 79971996, 20064841, 74593653, 68461534, 59419910, 15444117, 21423189, 56450475, 63069360, 92122746, 42327309, 32698696, 76405343, 17504700, 66662954, 64819541, 54838511, 97053512, 69109592, 45522923, 22491510, 62212853, 10387270, 15022485, 32610706, 95279733, 22221590, 65381735, 31833395, 33893594]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/imtl_run_2"
