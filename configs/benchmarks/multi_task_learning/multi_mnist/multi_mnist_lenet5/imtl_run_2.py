# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 97088737
config['train_seeds'] = [45863849, 91679842, 50426401, 40735984, 8501961, 40758144, 83742993, 16445251, 99854108, 75838465, 73018577, 81024369, 9990343, 87819847, 63646632, 75080581, 38401027, 6533076, 43369398, 52212083, 20418486, 84700663, 31873263, 54825039, 62506965, 17426506, 45114346, 42621275, 87768143, 57031912, 66498816, 24049180, 12953408, 64557538, 50264770, 69938611, 28279721, 79971245, 2135737, 57206203, 15540932, 86700256, 86045982, 57227395, 57660600, 63451022, 52739007, 71874796, 22280087, 33030453, 6006538, 14445597, 93677369, 62251763, 21138666, 3268989, 5027655, 14331781, 66909489, 46858054, 55003531, 68833530, 67550895, 99935139, 24200540, 79288207, 18833690, 39252013, 16662731, 25635778, 38617362, 56983529, 78798714, 88659847, 74089893, 96200620, 68647963, 16415762, 9269767, 57541132, 2761447, 53675800, 79945558, 30378993, 36670387, 75521322, 67905251, 27616462, 84154310, 84805746, 81342549, 98962779, 16258383, 30884397, 77465297, 11724909, 99852381, 28651715, 13796449, 53561902]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/multi_mnist/multi_mnist_lenet5/imtl_run_2"
