# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.cagrad import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 57471062
config['train_seeds'] = [55096050, 1761482, 16603418, 82714456, 96355913, 32156136, 87570907, 90918755, 81109193, 12635991, 71196023, 82640015, 54667649, 49182225, 39906362, 8400597, 15345034, 18717867, 10436426, 17029414, 1726025, 50632608, 81192324, 77832562, 87482428, 77691549, 50106041, 23664371, 86648089, 10555365, 82866598, 59333474, 61357142, 3900027, 2136207, 11381494, 64208917, 26340093, 56858222, 82840953, 98602402, 32872166, 87916750, 81168305, 91681423, 40428664, 62900758, 82064315, 80119044, 28630605, 27232406, 12726732, 69824999, 80365970, 37135793, 12161238, 69969008, 52369106, 90163946, 56605360, 53469092, 76247133, 45077093, 15433887, 4616813, 87605439, 99671799, 92872572, 177006, 84515778, 77505997, 51230800, 92302767, 17491021, 30153818, 44312081, 6109371, 11807577, 52244628, 58325352, 25477614, 69451084, 23718614, 30097553, 39779294, 23699245, 6513605, 10764858, 21023464, 40053490, 23828351, 43788927, 13548388, 78422911, 23678872, 53915872, 61273713, 27425997, 15312603, 11349768]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/multi_mnist/multi_mnist_lenet5/cagrad_run_2"
