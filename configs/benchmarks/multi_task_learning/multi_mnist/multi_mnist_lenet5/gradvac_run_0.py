# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.gradvac import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 45800557
config['train_seeds'] = [25269084, 65477930, 81375232, 59389533, 63427746, 85449242, 33795718, 69581672, 85236359, 64558742, 23032140, 41194752, 40373724, 54724849, 16465890, 68290044, 37943003, 19616660, 80923458, 40724094, 96766036, 85086930, 2797904, 51396082, 84334483, 63745102, 98666979, 5918103, 11661987, 66223974, 93908282, 99512065, 29780381, 68419604, 56952557, 4134651, 23828498, 66442643, 4566044, 61882827, 30305870, 25291456, 39864670, 81107704, 43793581, 3769883, 7917627, 76224484, 2948954, 96681454, 11412576, 45972615, 90279978, 32643100, 65881640, 88146530, 81511368, 95903299, 20714017, 45215929, 86759858, 53774395, 24891629, 14272870, 36274188, 47027918, 209686, 17921244, 11689966, 84853591, 77392790, 68519881, 42468564, 98493403, 5008162, 6472158, 40212724, 57607341, 34750931, 23441339, 60068662, 33668553, 18190918, 71821496, 41936395, 61298354, 15091095, 86825404, 72464881, 86358633, 46364912, 47963569, 93646551, 93359264, 86053952, 25115024, 25400257, 2897128, 77479589, 38722775]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/gradvac_run_0"
