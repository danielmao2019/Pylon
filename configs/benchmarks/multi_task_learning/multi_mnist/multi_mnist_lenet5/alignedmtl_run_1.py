# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.alignedmtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 5306257
config['train_seeds'] = [32759715, 81121924, 44741918, 61404464, 61268063, 15464166, 46882106, 45819525, 70868020, 36458279, 22369003, 88758823, 40692166, 42527240, 40632929, 68397382, 77170792, 15905847, 2111014, 47040573, 18618311, 81710664, 87788704, 57337753, 17320960, 38722153, 86046076, 32969151, 92935620, 26033378, 45514867, 76170891, 2909869, 4297067, 41662701, 55942697, 47013664, 56327789, 32915613, 55315972, 20065560, 81334382, 56449816, 98545309, 98658016, 33588500, 39585133, 71488993, 73846709, 95533636, 18545893, 41758442, 91596601, 87388552, 69425015, 88269690, 87407553, 68368177, 57679088, 58875748, 28522338, 77893579, 89408919, 77796044, 93196157, 17611037, 66529145, 10940639, 28612734, 99322614, 92943118, 724221, 88516193, 23670024, 16831552, 46515078, 78490425, 3382682, 99479429, 36641631, 72987458, 24489528, 73802624, 92521215, 11306535, 37314829, 87728170, 48958006, 91027711, 97616817, 56000898, 14706263, 74941763, 91936386, 24870535, 23884891, 26908882, 32989170, 99116640, 20782428]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/multi_mnist/multi_mnist_lenet5/alignedmtl_run_1"
