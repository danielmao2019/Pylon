# This file is automatically generated by `./configs/benchmarks/multi_task_learning/gen_multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_task_learning.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_task_learning.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.multi_task_learning.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 28231950
config['train_seeds'] = [44057139, 3717058, 12803111, 6319014, 13490525, 46948030, 97945114, 21092413, 19546680, 20265305, 56486685, 78915593, 41867367, 89506950, 21038998, 15616730, 59990631, 82237102, 78026450, 50266839, 78055176, 79339667, 82077516, 68944551, 91652879, 63634961, 55175319, 55858074, 29119468, 80262792, 99526689, 71784829, 56121011, 91444958, 28075352, 32218580, 1946532, 17182105, 78883191, 57009466, 11008383, 81308087, 98925112, 27524660, 76989328, 69984544, 44183373, 6596426, 54789310, 31410346, 22173995, 96064911, 61021878, 79095960, 82469252, 74257027, 57884613, 53936717, 6982554, 1734550, 47295574, 83786192, 43182963, 32251691, 68811623, 88007818, 68064569, 19047854, 14638484, 57806123, 32454110, 12803790, 8413478, 88444533, 3465207, 25331592, 90070830, 62543766, 15311692, 55505212, 14423632, 40467418, 26692497, 28420432, 77280250, 59086343, 94591772, 52118375, 79853683, 42913806, 65146815, 93372800, 13246610, 5959181, 21765445, 67967081, 91233207, 55338222, 74408450, 91680967]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_task_learning/multi_mnist/multi_mnist_lenet5/imtl_run_1"
