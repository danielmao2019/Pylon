# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 23322029
config['train_seeds'] = [84968919, 59945774, 77106268, 94719228, 15872098, 93760851, 41468313, 89523193, 77743910, 69021026, 47192570, 75163463, 71298147, 25872646, 74192387, 12094760, 38204074, 69531163, 13339234, 8667458, 77046070, 27720530, 43545912, 61892417, 71796301, 34179875, 31505607, 53094477, 38274919, 42242103, 15497822, 374739, 65895359, 49154251, 6243404, 76269122, 18183647, 29747815, 47760175, 50449838, 88391804, 42534360, 36505623, 35320859, 16203778, 21080442, 75207976, 56314227, 99048940, 97187075, 24334578, 70789297, 61179211, 28761525, 71009123, 1991756, 71811842, 25894258, 91168200, 36471115, 62760848, 67845117, 89071165, 16644466, 63052649, 10838414, 94199399, 86339734, 16819711, 78775576, 77906883, 35522379, 16991741, 56134124, 66324574, 1725599, 18718127, 81263721, 75725346, 53284873, 61273771, 62781882, 76860995, 92473719, 4927572, 23399276, 25604183, 96325293, 83315328, 29053445, 45848107, 58143267, 7830371, 57805130, 36957321, 54909939, 35194933, 73284744, 13987782, 38884104]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/imtl_run_1"
