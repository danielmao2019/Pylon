# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.gradvac import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 15949194
config['train_seeds'] = [38042475, 59746503, 80231581, 66863536, 81613144, 55303905, 12352234, 2683749, 14050051, 42483376, 25545387, 74111727, 18352408, 57929382, 84933994, 70355155, 86255125, 50407487, 87908399, 27624584, 99495834, 53989387, 81718388, 85808203, 10995787, 39304245, 62388513, 74696658, 64991540, 42747479, 8591629, 7781996, 58888950, 54951417, 43278801, 55316617, 14607933, 97812164, 9133523, 86529384, 25436608, 85580605, 39445627, 55064900, 32824942, 80828707, 45456243, 70395631, 76555801, 45941690, 72456366, 43450732, 8056107, 11282146, 59552615, 58493799, 80667022, 63730344, 71908232, 55973743, 97182290, 82241376, 54466110, 51117044, 90909610, 50411238, 87857467, 10835603, 56170140, 17939848, 98329566, 80399840, 78878502, 54487516, 48143298, 95514754, 45469367, 80593574, 13342311, 80324686, 47013358, 45638196, 25915396, 80873350, 4175074, 44527795, 72094836, 5375122, 32688718, 79238462, 29200642, 18355900, 74910383, 36779490, 92468441, 15938073, 75346947, 90689036, 12924250, 79001321]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/gradvac_run_0"
