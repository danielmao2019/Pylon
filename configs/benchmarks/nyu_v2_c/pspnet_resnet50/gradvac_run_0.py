# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.gradvac import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 42936552
config['train_seeds'] = [35021606, 30077174, 44555991, 9282849, 91802685, 87308577, 77672955, 6421752, 40691571, 61832943, 49950724, 86803645, 75858319, 63963164, 96131676, 18316695, 26314817, 26888023, 80732930, 64841905, 97685653, 59840366, 35695335, 56679828, 21978013, 38704846, 34468667, 5553895, 85265026, 44786669, 17120116, 45375711, 11816545, 33035277, 88858723, 73621523, 66444761, 2415421, 90254140, 24221376, 82680345, 93788533, 31495255, 61598301, 26001394, 86573329, 82006900, 34064497, 61709626, 60300958, 44998762, 73184742, 12617770, 83657307, 15728080, 38887716, 32001462, 55420327, 23399504, 85402007, 86730193, 61002012, 52060016, 60633236, 70045920, 20398380, 24171734, 61023193, 46715331, 50955206, 575954, 83497518, 25179962, 30355260, 1671193, 4995493, 33972546, 60561753, 78260162, 68715047, 11503144, 47275406, 10402456, 97987878, 80568669, 60837245, 3715564, 96595736, 19490260, 52618447, 26015609, 43469632, 47928131, 109120, 64401824, 36072852, 66930099, 79324376, 47023013, 85308397]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/gradvac_run_0"
