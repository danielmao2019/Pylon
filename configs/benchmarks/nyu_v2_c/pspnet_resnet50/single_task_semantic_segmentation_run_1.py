# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.nyu_v2_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['semantic_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['semantic_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['semantic_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_semantic_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 60437210
config['train_seeds'] = [98608237, 48598709, 745218, 5557114, 3500554, 59618343, 45188477, 32302070, 40853587, 91561379, 73690932, 38853363, 48627612, 66584428, 93048113, 64786773, 32302649, 93257236, 13684995, 22136654, 16220986, 6129312, 93111760, 53030361, 65590355, 8873277, 27204456, 36928010, 30425230, 96175412, 71452134, 46057441, 72408940, 75411470, 99042209, 30740578, 90410102, 44894467, 11766797, 18948870, 42539180, 66525263, 96609380, 24303923, 55170304, 94638564, 83712591, 6900961, 24919353, 24855901, 70211126, 78690340, 78058740, 69470440, 67248213, 53854117, 80650128, 12954266, 25301822, 74548502, 68375862, 13934014, 6736242, 32062029, 29510447, 30977342, 78894624, 54571197, 27162428, 3720169, 41366743, 18038416, 90537822, 5319301, 62319090, 1266646, 77977705, 371524, 44762771, 85257091, 51398926, 5634671, 87084663, 97345822, 8660283, 94229755, 91481378, 57239061, 45196619, 55392324, 72948146, 7480048, 13161752, 63392175, 40997511, 13104662, 49715102, 56682937, 87980304, 81544611]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/single_task_semantic_segmentation_run_1"
