# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 62825436
config['train_seeds'] = [14985437, 89836020, 83238675, 93238771, 89177802, 34414623, 41246698, 99933581, 98095582, 48676301, 96407559, 76374386, 93334735, 67572949, 82940868, 13757090, 75665652, 48217411, 31313080, 48557077, 23839779, 68319453, 91426876, 76698385, 37359918, 37307505, 28739903, 3066123, 79335945, 28621851, 25309182, 87776111, 20890483, 78415557, 79476166, 8950542, 63884181, 32653662, 31430785, 3557615, 92143677, 40167520, 40943028, 24519445, 96253194, 79877405, 34159941, 65785178, 39007183, 39498263, 4978386, 94349460, 55315779, 58999928, 27788785, 63937525, 4690217, 53815041, 72961347, 54691478, 12114254, 27984651, 88287966, 48256835, 94002069, 27837495, 93303120, 14882688, 34290788, 7420127, 14455160, 58071031, 99129998, 26221829, 56789946, 94779951, 16096439, 41564670, 50730325, 29069317, 75567616, 18619826, 62229332, 93456516, 30831852, 23560027, 98175068, 11602101, 22434696, 69446454, 93043790, 3716087, 32685966, 95683719, 71141524, 25431351, 95733755, 96555429, 46110980, 58705230]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/mgda_run_1"
