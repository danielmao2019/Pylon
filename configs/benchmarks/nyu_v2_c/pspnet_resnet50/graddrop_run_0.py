# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 5660961
config['train_seeds'] = [70250385, 36254950, 17370630, 43712271, 54998030, 76120572, 23120353, 48989866, 69692950, 78975630, 18270639, 45252587, 19854521, 26331623, 52681724, 65276340, 21799321, 52684128, 37219089, 98085850, 59824258, 51234756, 44999763, 57452484, 63577689, 5384231, 89660588, 14306589, 34493922, 21400828, 7318693, 89596132, 77125229, 21508733, 44928095, 22348938, 23301726, 36244267, 21649154, 2694337, 91110448, 79972377, 2838832, 21400323, 33722897, 59720738, 8995871, 42188140, 40121527, 98691628, 81951051, 17359411, 83505247, 33549891, 81854069, 63460390, 78841975, 48898129, 66081762, 79588451, 24610712, 2868143, 93495786, 86089400, 36414022, 45683349, 1128124, 87047013, 13581970, 8500757, 86290593, 11031812, 47366499, 16157956, 29874353, 44647970, 14653512, 68616572, 19718369, 79219933, 39520696, 19779185, 21310953, 44008576, 96746720, 83505477, 51036061, 28310333, 40830867, 54747603, 97683938, 11007174, 15000028, 64058098, 63007853, 34792188, 79073000, 3765680, 81020243, 5366735]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/graddrop_run_0"
