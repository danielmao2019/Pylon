# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 94256429
config['train_seeds'] = [37676529, 28169855, 22236808, 89718692, 38791734, 99732473, 87593852, 50000638, 37799508, 10125201, 60262446, 71426234, 456825, 61621141, 98694142, 73118513, 99531051, 77115853, 48754562, 56677508, 95715177, 75933530, 64094189, 38613687, 20127927, 45028058, 49560079, 51631387, 54283503, 95405121, 83742783, 22629269, 2799967, 46711113, 3630433, 91034924, 29555022, 40578630, 10161654, 5644734, 53814989, 14183672, 32363124, 92672263, 88889461, 69450521, 24607421, 86556056, 38762208, 94632548, 22897615, 87428011, 80139786, 90921136, 76073398, 98235360, 59663232, 96912799, 95978279, 19566624, 55339326, 66964115, 8254251, 34420102, 64263036, 87749835, 65719869, 50497897, 34791090, 63570451, 28025241, 86755947, 71845825, 64934043, 45781836, 51673128, 4415324, 15357935, 47333626, 83917343, 91042085, 18536349, 85345344, 95043246, 52713421, 43192791, 16646675, 29178978, 85735877, 68903498, 98301217, 92372004, 80026132, 39904088, 6927649, 44956356, 41999322, 47337405, 43825590, 75242996]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/graddrop_run_0"
