# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 3431140
config['train_seeds'] = [32914780, 44004496, 74834084, 27985788, 92359054, 40132830, 68572517, 36225005, 68483622, 27307953, 69009931, 4742444, 42417413, 69877002, 97734863, 94762417, 29319397, 24522877, 67873100, 58731529, 89552132, 88001810, 39900507, 84132491, 75070812, 86710813, 26596485, 37830909, 98038715, 68015183, 58319206, 32499896, 62722155, 35966217, 14016751, 35530006, 28711020, 80331164, 94985683, 28718251, 88508859, 12636457, 70684221, 71858306, 74064493, 33291913, 67216433, 83956044, 32385667, 22486832, 22823770, 59199324, 28279158, 58446879, 55049520, 94444973, 74470621, 65984011, 55191937, 54932677, 17708764, 40295345, 56656678, 14492418, 11031290, 94769565, 97802537, 894005, 64292449, 14646029, 17644159, 83438992, 98379666, 36941182, 57223772, 65025914, 25147058, 71446864, 7242396, 63735848, 46697939, 59038431, 15464522, 93021020, 66549579, 43607357, 22761483, 91801799, 8042742, 82262912, 41601440, 80292725, 8788195, 49901019, 99647454, 46600253, 93075918, 13673759, 55159446, 85508408]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/mgda_run_0"
