# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 60757305
config['train_seeds'] = [72732609, 48939748, 1165014, 44371235, 23452764, 74196972, 1594608, 34697559, 8313315, 22289316, 84545169, 81467334, 33504450, 78749169, 9838623, 3739932, 27176316, 13826228, 90819609, 24295896, 99455173, 38007976, 10161595, 7599658, 38716721, 70826097, 98843612, 73369984, 69818329, 15157398, 52392436, 58733388, 1047350, 14845913, 4931344, 67759992, 69786525, 75821568, 3696206, 59767971, 28858658, 28053864, 60529916, 87596815, 89889113, 80338225, 59814134, 19342545, 67336919, 91426106, 37938331, 64683941, 16005302, 27365290, 83873128, 16813448, 12396920, 71746883, 30655380, 40846905, 20319298, 61198527, 91726290, 20441172, 56752717, 90486958, 39314134, 98851518, 86200822, 61386019, 34931217, 78841442, 90666257, 41931437, 35758289, 40737184, 59294607, 518111, 16817822, 22033389, 24035832, 45956469, 84297473, 16965576, 49440548, 99313422, 82230430, 47666574, 11320845, 50730804, 4362353, 68296676, 17619957, 58615769, 92892367, 98567972, 34104192, 2341237, 98139343, 95551973]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/alignedmtl_run_2"
