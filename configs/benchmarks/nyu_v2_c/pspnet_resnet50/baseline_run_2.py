# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.baseline import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 71587745
config['train_seeds'] = [28305873, 34706748, 80217456, 40214825, 68438258, 78950133, 31438985, 63361820, 63236009, 65388488, 97533024, 83546734, 50209149, 21739721, 60015954, 36560735, 22250785, 27451366, 66055505, 76896860, 41517823, 47056620, 30747890, 35929207, 16247549, 34846316, 64287931, 34404349, 34584243, 88471083, 77101138, 578897, 79953685, 37086379, 66569383, 20728571, 10273444, 82961979, 56393818, 50033356, 85714852, 67742650, 29342752, 52100841, 12159013, 96314363, 34289779, 58372000, 59703946, 20390022, 72490568, 25832442, 89352515, 58262556, 55242074, 900574, 44888964, 38762618, 93617396, 70300177, 10589678, 33746941, 5767114, 28118408, 37623805, 68851351, 4614238, 76991512, 89135906, 21399826, 62949372, 68387134, 94053366, 94513889, 53099271, 31789914, 7310347, 90527174, 3751201, 55124435, 80378253, 55174297, 73856277, 76535079, 91215021, 72011583, 46341146, 17604944, 13331229, 12836465, 63077563, 49238510, 9363463, 97806316, 57709357, 55302012, 34840233, 66554002, 16908792, 77954172]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/baseline_run_2"
