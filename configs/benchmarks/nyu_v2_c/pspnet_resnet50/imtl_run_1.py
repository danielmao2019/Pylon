# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.imtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 79748934
config['train_seeds'] = [83996205, 25016502, 85723707, 68676129, 5329763, 56762616, 28189932, 73255468, 29687610, 72563141, 4038036, 91888565, 7133618, 99935404, 3229664, 57542009, 70052518, 8936455, 45855925, 79309265, 74696751, 5351063, 6445816, 10108734, 33713078, 29382185, 94932198, 381113, 69969364, 44238425, 83005400, 73084169, 77882331, 9621666, 45843205, 18025653, 43756252, 76929804, 73037142, 78130918, 52303037, 80297491, 91452175, 88809116, 65027466, 76617212, 69168976, 31379055, 7430578, 45434992, 87845445, 79918790, 44480292, 72931467, 4460534, 35534190, 76324488, 91006249, 58421379, 33780638, 56069863, 30841199, 38983349, 9585258, 62597663, 78047954, 99112197, 98248994, 24244481, 33047285, 37680142, 27322019, 46610696, 5941489, 85570812, 6782514, 68352949, 36299400, 39026955, 39522218, 5947273, 55416443, 65709125, 3070102, 73345815, 94155004, 74095851, 40358939, 64065070, 24999150, 37393249, 83092520, 76825269, 27281231, 27440275, 22074510, 48402190, 74825301, 37182623, 50069058]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/imtl_run_1"
