# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 88335430
config['train_seeds'] = [92850539, 18359624, 8784584, 43675900, 39354084, 70186065, 70763820, 33951406, 52100767, 81931438, 13536299, 32849787, 81941888, 15267804, 24390962, 53551556, 11085097, 48875225, 47815787, 71355100, 90148505, 39670596, 85492888, 9796574, 28295348, 86778684, 80983910, 11664298, 5776134, 69039916, 35354402, 81043626, 30214255, 45790575, 26604132, 95973242, 81026299, 16853839, 45284531, 8317567, 86809818, 54742881, 16325142, 4041517, 64751892, 35331357, 8694307, 79012006, 58278756, 28203599, 31587758, 20751649, 92131302, 64876544, 63347124, 54821142, 30665215, 75155849, 16190744, 29602234, 98074914, 77890388, 4648000, 63134923, 51772389, 29538781, 20949483, 26918713, 80367307, 65415027, 74937929, 3858805, 44525957, 34040206, 10635104, 21615770, 52476485, 12479993, 4493091, 18440174, 53210415, 9199653, 39347488, 40393106, 52818565, 85626071, 34007717, 70887214, 96211818, 84982769, 79310956, 57170601, 33124454, 21406249, 93300279, 94018295, 28763953, 55909688, 83127914, 43092480]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/rgw_run_0"
