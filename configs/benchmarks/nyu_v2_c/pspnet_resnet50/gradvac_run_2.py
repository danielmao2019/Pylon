# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.gradvac import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 42595950
config['train_seeds'] = [75907038, 30898630, 5368794, 39657635, 67038929, 19469376, 56103443, 32955953, 27693143, 64779324, 12997430, 15524712, 12906005, 68927432, 3244746, 74702159, 52041785, 77371864, 90428081, 31975073, 56224328, 60225141, 17435406, 20572210, 69265649, 77580768, 81781377, 4290928, 64843224, 36222229, 70162378, 66538173, 92170583, 82352758, 11102566, 73831775, 75672503, 98944357, 1404703, 26169960, 98108737, 65148107, 4221979, 52568092, 42276819, 33028270, 27985608, 81792654, 95537691, 81327758, 11980778, 82494594, 86182395, 34755053, 15446127, 28984684, 31887502, 45055636, 40585629, 4584010, 52379620, 97340308, 88630297, 61239348, 17176195, 25360688, 33078802, 8122523, 30239316, 42885277, 70339327, 37039371, 36217433, 12321676, 85763955, 28008634, 23718990, 87177115, 14541710, 34292932, 12200753, 93107682, 76628127, 29063841, 61610611, 24300627, 61236084, 26710840, 35065989, 79716271, 31105550, 40642979, 54843846, 44121084, 69242589, 66501724, 13606112, 95650903, 13721227, 31217601]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/gradvac_run_2"
