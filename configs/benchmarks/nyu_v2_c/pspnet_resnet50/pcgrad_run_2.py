# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 35552013
config['train_seeds'] = [61040182, 89884326, 34962501, 11811452, 93187329, 71529199, 16286106, 11099877, 19245006, 36528471, 75543935, 22232347, 69219194, 56793147, 60510201, 29983539, 22139058, 92092992, 32361325, 25405654, 716328, 76488745, 87760188, 85479390, 44187400, 71426802, 6338811, 71606211, 50405032, 92035969, 46882461, 49629794, 55559980, 27322822, 34898366, 19178054, 91461242, 24469604, 63702135, 97493713, 5987356, 99357582, 43834835, 2088928, 64339898, 73497808, 67688070, 25732755, 8595116, 20977734, 84477688, 56379388, 44503200, 53452119, 45947510, 60999396, 68660596, 37183923, 94227470, 29384198, 58402920, 8685949, 49875899, 87614659, 87839413, 54590958, 61535110, 36169373, 19789358, 75608661, 2898123, 87567868, 76412096, 79832172, 83103988, 62240304, 34360991, 46178690, 65394774, 20984801, 49426944, 17440486, 46561205, 3143900, 58988557, 69043837, 38547740, 9145238, 34145335, 29743545, 19298535, 38841543, 3665763, 77691024, 25846279, 47374006, 75709810, 74266565, 98010148, 75588140]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/pcgrad_run_2"
