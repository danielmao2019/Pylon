# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 3205998
config['train_seeds'] = [70159631, 8463322, 95313260, 79080680, 79540441, 17149743, 64082642, 47466634, 9734612, 58443214, 96714673, 79132970, 99456584, 32134553, 12982876, 45444982, 20771318, 73789775, 45677170, 90251625, 19142679, 96046661, 73406344, 65201165, 81019765, 65563168, 83002258, 28339633, 19480053, 50296467, 97921242, 85107781, 2490112, 473300, 27249608, 55943713, 18163823, 96882265, 4831288, 27128810, 79854292, 66723269, 5494565, 43570456, 14110667, 66058873, 18869096, 83604666, 40646823, 5063433, 87705117, 48867967, 66481973, 2990530, 41369651, 90609547, 19426121, 23420614, 48068767, 80569062, 13034454, 7171426, 71126572, 12574059, 18073203, 87222545, 88072601, 13348294, 17153525, 60203511, 68719768, 75579990, 73702333, 84271496, 94666416, 26046950, 44533778, 86843630, 17896817, 31818613, 83054261, 49513021, 69494233, 95845364, 28293740, 54928602, 17500607, 46079474, 33472190, 43468657, 91394052, 18637088, 57187298, 23269606, 21992443, 32289300, 84340723, 32987258, 68755674, 59036468]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/cagrad_run_2"
