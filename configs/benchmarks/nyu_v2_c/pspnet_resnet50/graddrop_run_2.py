# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 70806464
config['train_seeds'] = [776637, 40572990, 45631370, 69349772, 3239915, 62179484, 43695068, 81490934, 11362749, 84881505, 39546235, 16783104, 80530975, 83806339, 92874823, 2798741, 83027793, 74754333, 1389608, 86575432, 73868340, 63136686, 45164087, 99949801, 92102457, 57694222, 77734356, 68960001, 40127004, 64682256, 4630741, 16908825, 52993755, 98913415, 40442875, 59222300, 61900599, 41127757, 19041343, 12296625, 80689240, 20868208, 66985756, 9533164, 4272069, 70105036, 62583558, 44278909, 11345139, 58282262, 70281413, 90003921, 52921302, 19621587, 66340315, 25207006, 42042970, 10605199, 68201761, 43618269, 1177516, 38937526, 41734873, 10599744, 16205660, 38357497, 34273175, 90893742, 27843709, 63071253, 73742732, 5510029, 88337030, 18581058, 10570495, 124820, 63313135, 96337272, 30220748, 24180740, 89851154, 2320889, 48107834, 20325388, 38483592, 33160006, 13258735, 57988744, 58025052, 54882307, 4779636, 40838543, 22633822, 37585221, 48427629, 6910110, 4097068, 5246407, 37587793, 56241982]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/graddrop_run_2"
