# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.graddrop import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 48226484
config['train_seeds'] = [91296834, 89606489, 90309241, 27706664, 36781511, 26920823, 71574620, 61023190, 58363795, 47270822, 99325035, 93133691, 12691502, 61566779, 71896659, 67080589, 3960515, 82261318, 16266990, 66052544, 14443719, 12631640, 2347985, 71809837, 44897257, 14916728, 42327530, 75566050, 99069377, 43668787, 17727048, 6968000, 86515432, 43209952, 56410803, 51548442, 36527367, 23097794, 35034702, 33107969, 36246544, 97934746, 87511766, 87199405, 91983120, 65582286, 50531670, 63981833, 64087377, 2950856, 71565597, 43490135, 87928905, 33343992, 6521554, 66123519, 71570978, 49124385, 16999583, 57649443, 5405239, 97181123, 8645544, 77218347, 96009968, 8096379, 13124335, 93540288, 65669571, 34327289, 80462601, 37976590, 99954342, 33080276, 60457405, 74476150, 11052487, 47552315, 65232018, 34145788, 3583743, 69410015, 43028659, 69450421, 38351364, 349261, 23766089, 39468241, 70211359, 37927995, 55851582, 8283997, 19540219, 16736788, 49067196, 59929385, 95882009, 84150114, 36525018, 88376837]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/graddrop_run_2"
