# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 49399853
config['train_seeds'] = [88609442, 40014813, 75722634, 19747238, 99967816, 87475702, 41482635, 47411730, 93012831, 79152684, 86847507, 68285196, 95083333, 34556299, 2299015, 74593573, 51298026, 36526764, 1904592, 21808070, 32338433, 37808018, 96446827, 26365131, 83204253, 20331438, 76579830, 77896791, 92560557, 99188815, 1946442, 70857535, 83550141, 16532459, 3829173, 98542742, 15757601, 62035628, 17326256, 87376797, 52943431, 21565784, 95218662, 14338834, 22446734, 68057960, 6701945, 62421808, 25327651, 35363955, 46546380, 71232172, 70698449, 82722405, 8961327, 43128, 19811280, 31581627, 38433658, 31855017, 89182565, 18770758, 44821307, 79260721, 85980130, 42839986, 47413075, 43850810, 15253816, 73292796, 42114381, 35666419, 71446985, 41123261, 36071844, 18925890, 98759585, 16679811, 6309266, 27438368, 96228254, 48799010, 45998765, 46836275, 99671333, 61077245, 83287919, 6680066, 59253632, 54742508, 8606278, 81887920, 88794299, 95508370, 6009745, 20074658, 53609149, 5837410, 74994241, 36762307]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/pcgrad_run_0"
