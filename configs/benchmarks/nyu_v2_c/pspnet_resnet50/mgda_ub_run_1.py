# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 40912387
config['train_seeds'] = [73375281, 69075264, 90839760, 35632127, 37099897, 4721146, 15546862, 79871632, 98663780, 54438243, 26076420, 75674041, 5135656, 81847283, 98214335, 27415547, 26433502, 39445371, 39691917, 97146, 85323269, 61646683, 99838008, 29800870, 19316463, 98706603, 18560138, 20217941, 1757312, 92719904, 76762924, 90372552, 53205716, 10789311, 15252177, 27024871, 88599709, 86480397, 5184479, 7170120, 56249216, 69385652, 63997503, 35889063, 21975831, 61021781, 59759082, 48806236, 4828847, 50318596, 88959487, 13270028, 69494790, 38016351, 1523238, 19727724, 56365691, 89802364, 93822887, 43777979, 83780031, 26639639, 26442694, 78858822, 7369778, 36238441, 24760056, 65038016, 76603698, 62209876, 96197597, 7785835, 16180320, 67548131, 79351242, 91288666, 39112708, 70528302, 77560438, 86698505, 35415695, 8467436, 16341706, 9973745, 92830740, 74266100, 91378263, 71030327, 2281574, 82860501, 723012, 27991395, 97274762, 8255981, 29612780, 51662397, 86886759, 1664630, 13768329, 21014640]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/mgda_ub_run_1"
