# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
import data
from configs.common.datasets.nyu_v2_c import config as dataset_config
for key in ['train_dataset', 'val_dataset', 'test_dataset']:
    dataset_config[key] = {
        'class': data.datasets.ProjectionDatasetWrapper,
        'args': {
            'dataset_config': dataset_config[key],
            'mapping': {
                'inputs': ['image'],
                'labels': ['semantic_segmentation'],
                'meta_info': ['image_filepath', 'image_resolution'],
            },
        },
    }
dataset_config['criterion'] = dataset_config['criterion']['args']['criterion_configs']['semantic_segmentation']
dataset_config['metric'] = dataset_config['metric']['args']['metric_configs']['semantic_segmentation']
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_semantic_segmentation as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers._core_ import adam_optimizer_config
config['optimizer'] = adam_optimizer_config

# seeds
config['init_seed'] = 27780469
config['train_seeds'] = [3441757, 9709690, 70004382, 30285898, 2297706, 33837787, 50152355, 95847180, 55270311, 27126983, 28549579, 12461254, 33078487, 18903264, 23284408, 74235100, 52481584, 85996198, 30546038, 93262227, 91124285, 5024630, 53427594, 81563634, 98528132, 60451961, 98419834, 63474746, 5889889, 22966928, 2280203, 73259227, 37379245, 62540188, 75874030, 51026042, 54264079, 30489569, 31831793, 78956717, 58042661, 197943, 24333373, 98312218, 90068955, 77800537, 98617485, 6911518, 47159966, 26164448, 143401, 70467716, 42935380, 92717842, 6462237, 95120807, 6994045, 31257355, 79919777, 86175039, 67193297, 83938818, 87168939, 81126803, 93030366, 81044655, 78945999, 51551511, 96181623, 99827322, 53330790, 66528150, 12113498, 99529327, 71027394, 46756394, 41536942, 38298783, 48729143, 96402900, 74850147, 54160421, 97247953, 52729083, 43356021, 59788424, 82630374, 15359546, 36240287, 65665050, 52700940, 99955840, 46784282, 49425127, 36765985, 46245873, 88034041, 94927843, 78611573, 34626922]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/single_task_semantic_segmentation_run_2"
