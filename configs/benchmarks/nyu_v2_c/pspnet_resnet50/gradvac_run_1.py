# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.gradvac import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 38141946
config['train_seeds'] = [23155001, 23499792, 26207488, 54415765, 86000148, 76285161, 48678284, 15915855, 6159173, 62332433, 85722673, 3798771, 66074047, 15276407, 34818536, 55316047, 13006204, 32205931, 32845618, 74226948, 45027645, 23519549, 66933252, 65511592, 54087077, 77245058, 2482459, 19023284, 42628360, 94102123, 20502315, 69705459, 96492221, 37125881, 23467488, 19349404, 93772697, 79397554, 4226151, 48410392, 21728336, 50809042, 10280479, 74367579, 33335826, 12193957, 24689692, 49242996, 38099456, 41518888, 95722597, 68588205, 91296399, 26410874, 97349447, 20129100, 35790068, 66580146, 62614490, 20272108, 40544314, 74360224, 27305222, 46716890, 97541231, 52384473, 68016669, 24679411, 59423477, 61015223, 20316884, 71289200, 30978906, 95378037, 11381567, 63925505, 68653332, 69046218, 21565502, 30869961, 5512850, 81482125, 41253878, 37720833, 87286642, 68072156, 61005659, 2320528, 52017996, 87374979, 45479222, 26109118, 98263954, 1883893, 80135751, 91347642, 53693616, 3128675, 1533644, 97405575]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/gradvac_run_1"
