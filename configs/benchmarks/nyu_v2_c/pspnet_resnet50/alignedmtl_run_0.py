# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 75544018
config['train_seeds'] = [983965, 22643839, 54561651, 38285147, 87721320, 43308611, 77892652, 9951573, 8201203, 13002452, 70643509, 64188538, 47714727, 19325715, 14619652, 57674501, 65224693, 49130947, 4206260, 69940550, 28863031, 36872815, 22909017, 48058902, 56416970, 78698327, 31849151, 99791882, 76056955, 75322711, 49968464, 38465753, 51328989, 64292393, 26053476, 18912314, 52796292, 88337049, 24442592, 27956140, 88760434, 75496657, 8779407, 96243163, 67807985, 61889922, 32954390, 34284523, 25122802, 73771356, 3385512, 28903026, 87520836, 52056139, 22092421, 67599958, 44380518, 11299780, 78864927, 44220124, 29125659, 82169809, 6784167, 73582742, 54845365, 64633888, 64465204, 68735615, 7799663, 79768616, 61192681, 9635317, 5036783, 53298010, 75414283, 44506415, 78569158, 61303269, 89555332, 51010265, 68785472, 64656998, 36788705, 79932798, 96473167, 56181918, 89504782, 73522160, 47930388, 6110530, 35653835, 57881696, 81528699, 19354564, 91811972, 5743645, 17454825, 78581200, 34487445, 53221597]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/alignedmtl_run_0"
