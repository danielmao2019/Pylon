# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 98914004
config['train_seeds'] = [9600580, 81867435, 48774620, 68930173, 64880800, 129508, 84851634, 79562332, 41331488, 71251584, 70821851, 19991247, 98992209, 18236337, 43377350, 59678754, 20301417, 28944974, 41362718, 86349256, 51535703, 97204969, 47352769, 7750171, 54793099, 62499658, 77855944, 86031081, 95067884, 41172297, 39575347, 36348666, 95932420, 12608594, 93101015, 32993829, 12370001, 41653280, 2489916, 76116890, 13816069, 51314638, 361742, 7328500, 48212404, 1830277, 82558590, 7680616, 92591504, 30463390, 9889184, 168980, 68858426, 23046711, 39983738, 22252327, 84587497, 76885689, 20848799, 92749745, 6722453, 8058369, 64191198, 40467082, 76558150, 99289195, 64636642, 14444676, 23024063, 11911863, 25574599, 67693837, 3814169, 35647058, 48808916, 70385109, 91759948, 41171137, 26994713, 420348, 45841615, 6473336, 85871148, 55346, 1472637, 80051775, 73230582, 36249161, 791662, 60744764, 63115391, 98912808, 81082358, 31025745, 69242480, 21953851, 43058022, 70444746, 88624948, 26465159]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/rgw_run_1"
