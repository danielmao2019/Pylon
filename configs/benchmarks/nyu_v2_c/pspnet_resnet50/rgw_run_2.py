# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.rgw import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 57689481
config['train_seeds'] = [89676620, 89853905, 57631024, 14637616, 37660322, 35357270, 1532502, 83955309, 761614, 15971826, 8004132, 2152400, 70959703, 61561532, 42583434, 97121893, 40034289, 28286182, 39700971, 96646311, 51456043, 8534461, 71536703, 38648180, 90458489, 70449829, 85888810, 37257328, 60217410, 96341316, 99635502, 75101242, 7414429, 70827565, 17473876, 15767273, 75012674, 7121770, 96305101, 77980773, 13512854, 97228761, 57812429, 38263661, 49541139, 71444902, 79170941, 40270889, 1432077, 81897045, 47337863, 42409017, 84439612, 42524661, 69055579, 32268432, 17391695, 3323460, 7914269, 67455499, 55642134, 46803292, 7291026, 88467916, 53270800, 31482592, 13086268, 57913144, 4502368, 94556686, 86108105, 62322190, 48330543, 63965094, 97135496, 53315331, 37198306, 50094091, 48505871, 43228981, 163701, 7299332, 90032572, 11556664, 37085198, 21189450, 2800472, 96558982, 61935367, 61553514, 52540190, 71587514, 30349624, 39071337, 58875681, 30329698, 95940843, 42063795, 80939182, 61229447]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/rgw_run_2"
