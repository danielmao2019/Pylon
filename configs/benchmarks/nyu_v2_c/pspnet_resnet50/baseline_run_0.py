# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.baseline import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 50885618
config['train_seeds'] = [38977510, 64385321, 67997267, 46871842, 14317825, 3719138, 39486898, 18069039, 52021966, 17597514, 91396755, 978506, 43272278, 97552696, 53358739, 3944060, 69867163, 24561012, 41153216, 65008590, 11566952, 85307860, 65283991, 35819952, 20197330, 90804855, 53937803, 91468312, 44715548, 76193385, 92735680, 15522770, 46291658, 12292559, 8817251, 24378172, 3844920, 23837688, 11051021, 30675242, 14981512, 12877425, 9289071, 1139023, 85956556, 90261097, 1469242, 7937969, 45321141, 72847238, 7077318, 82999738, 90206486, 28547588, 58183533, 82656046, 21369212, 74466309, 21446411, 65583090, 40499537, 93803896, 12842893, 76043906, 34768367, 35965173, 10002441, 97007200, 48187318, 36850722, 17014435, 92948642, 66756229, 61295043, 31738079, 53048140, 6034942, 84274740, 7070776, 80350366, 51222269, 6419179, 78698608, 29761122, 54596050, 78433045, 46519404, 13370723, 83550203, 65571627, 47621671, 59522754, 63560384, 5686129, 1954813, 60103664, 63381100, 6588309, 91438790, 25639503]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/baseline_run_0"
