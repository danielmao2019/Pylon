# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 8969430
config['train_seeds'] = [93774394, 84817370, 15832085, 80767985, 40654740, 35902459, 29466199, 68427251, 79345022, 63083753, 85986413, 54310273, 72922889, 87152136, 92022688, 11424534, 11365135, 21977394, 49168789, 25567777, 36643705, 87945066, 21093527, 45796710, 12288637, 97209191, 62969384, 14076883, 50766404, 69777156, 97602564, 48253857, 89148646, 90416992, 43651452, 72221366, 84133385, 23615348, 95591476, 3097700, 40779173, 6714810, 81150261, 68407981, 53981277, 35821845, 85761953, 16439655, 92374963, 68512917, 1870345, 687744, 22123856, 31338570, 83864130, 47624611, 67401295, 54781624, 56827531, 29618088, 53478246, 67667194, 68568326, 15415268, 53036206, 8200249, 62169277, 10606066, 94662147, 98833004, 73181961, 52215536, 35227867, 79257027, 41324088, 19015536, 92479388, 69163261, 72159145, 15472029, 49146086, 33515625, 41856820, 71560063, 42265519, 84108408, 53416448, 86696910, 48692606, 39670514, 80172276, 89399629, 87277168, 64680173, 71613795, 26486304, 38230125, 54250637, 82460573, 48456811]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/alignedmtl_ub_run_2"
