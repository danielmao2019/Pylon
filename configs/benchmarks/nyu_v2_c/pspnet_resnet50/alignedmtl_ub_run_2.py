# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 83602854
config['train_seeds'] = [69346296, 73740903, 26092609, 14287462, 2153100, 15724710, 76075807, 28581522, 28805365, 81111290, 70807170, 60059424, 25334684, 69643127, 3280458, 25782189, 10051081, 67827994, 16885638, 12726044, 41595002, 74844239, 49938436, 22082326, 87635647, 8564810, 16306631, 91035219, 68431944, 32253, 52847164, 85524609, 333969, 46272794, 30889790, 46335927, 40836870, 87855350, 51244286, 22068909, 94857731, 18395145, 5521071, 11903597, 47274354, 23255990, 89988830, 38879891, 34703622, 10313655, 59873479, 98473465, 89142907, 49875440, 74319476, 24728519, 36759685, 22552532, 18410558, 32288335, 13483800, 88252987, 9202113, 28458278, 87121865, 67895197, 86284643, 71021886, 64906906, 72340746, 13486042, 42111232, 56759407, 98019900, 78124049, 24539428, 67649155, 42213412, 17057299, 63850974, 75145529, 61254483, 14558460, 48826355, 47958898, 50602729, 64009486, 34373816, 70315465, 70570915, 80148157, 63993392, 8667201, 67769712, 11687900, 22280401, 49788251, 452568, 60877023, 13658387]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/alignedmtl_ub_run_2"
