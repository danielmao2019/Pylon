# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 74259528
config['train_seeds'] = [53186162, 15078394, 82097524, 54633899, 47900851, 2663730, 85632375, 20372140, 84722802, 71844432, 19046210, 68771510, 87948198, 26294778, 10215215, 52511772, 4044148, 92059966, 96762133, 90198092, 60664640, 5031168, 4787022, 67755562, 52037865, 92505566, 54866290, 80526928, 62403719, 33635400, 62333909, 60636232, 357737, 49032628, 97497254, 71516341, 32044999, 24366598, 60482763, 54319047, 2415771, 88091353, 91665480, 69858800, 15310221, 26356155, 80196853, 33142322, 5694442, 98486482, 41726986, 96611594, 62816979, 13694759, 54862925, 96400850, 33948681, 3805650, 66098751, 65028678, 56012886, 94457759, 35156289, 32865592, 95878283, 73580730, 49795163, 24389112, 3574270, 11644126, 8533014, 22303797, 31976784, 17157595, 45872783, 50289849, 79153395, 70814414, 10664286, 92908579, 8891661, 15728214, 13414541, 12072298, 27303221, 40129261, 61591013, 72167058, 8376734, 59740044, 98397057, 53912637, 24248772, 95828160, 1468111, 35860099, 30363352, 19865972, 8449145, 42782341]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/mgda_ub_run_0"
