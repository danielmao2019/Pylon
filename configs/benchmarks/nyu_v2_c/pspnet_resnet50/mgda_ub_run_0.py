# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.nyu_v2_c import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.nyu_v2_c.pspnet_resnet50 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.mgda_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 67786263
config['train_seeds'] = [95655643, 5051676, 1675270, 54485663, 34941595, 16743169, 65280382, 64485314, 59391057, 29196148, 50361105, 1966740, 98544553, 59203901, 99108603, 90507028, 58057767, 59564358, 44907381, 94795300, 75600758, 29390707, 45023316, 26096688, 89710015, 74560161, 62912264, 89509730, 81646659, 7127290, 90291242, 63513121, 14765290, 43995495, 86007683, 16746440, 72195562, 440210, 99283710, 93775175, 5796603, 43488218, 76747821, 6001552, 56912818, 34105081, 34550670, 73269518, 12415336, 72931593, 15554167, 51332068, 4362196, 79665579, 20795879, 39919442, 59913867, 45271422, 13800849, 41831662, 4634820, 32107007, 75655052, 91785260, 47654700, 46663055, 32976596, 81097019, 91655193, 42267186, 53402399, 42007351, 7480618, 7800459, 90346410, 92110636, 6365798, 93070018, 36478828, 35611641, 38797070, 40744297, 56901507, 35205832, 73822755, 56771762, 80503410, 26667153, 34086302, 82155197, 63395495, 65042694, 65002944, 51469871, 74760973, 46017000, 15777477, 59822028, 48073277, 27490470]

# work dir
config['work_dir'] = "./logs/benchmarks/nyu_v2_c/pspnet_resnet50/mgda_ub_run_0"
