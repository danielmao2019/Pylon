# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.pcgrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 72735796
config['train_seeds'] = [72480527, 23548060, 43179660, 90888452, 60669673, 53597384, 53517258, 92047694, 23432995, 88604107, 4564482, 23201032, 67338224, 25464595, 57305439, 74986440, 72506894, 31727884, 55795959, 87412039, 12867371, 79816341, 85978427, 92753497, 47089896, 63931553, 82772677, 28663296, 30178608, 14073793, 64234065, 63282595, 61531124, 89408251, 46867342, 86203969, 65484711, 21222116, 55081231, 49860418, 88575074, 41168546, 68727867, 61728414, 52820271, 12559573, 74500626, 29049824, 93360491, 74197851, 3784828, 33004802, 34747636, 53878842, 46285732, 30607673, 16960614, 61016299, 17544867, 37057179, 39816349, 72380900, 32168116, 31717473, 44149303, 34735507, 71115293, 52148644, 25313102, 66136764, 11102812, 10372609, 20808304, 88380597, 24219768, 73380189, 46548546, 52579679, 14622185, 43127318, 99594056, 14909761, 99849916, 70042608, 5412684, 57577928, 55828917, 2311775, 4727789, 37978674, 92596297, 16184127, 26032336, 42063326, 94568172, 927309, 55231860, 63347340, 23720991, 10719228]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/pcgrad_run_2"
