# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cagrad import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 21664753
config['train_seeds'] = [48564727, 72941527, 29788940, 15282279, 47962356, 38051794, 196220, 5574108, 6454079, 70868313, 76566832, 43617908, 31605078, 372144, 58180435, 37109044, 79492056, 98174719, 79581451, 27662533, 87354975, 89933303, 81430248, 56272600, 72109571, 3749937, 49077291, 61949244, 34340475, 33467379, 44836376, 96753218, 33180472, 30002169, 29618885, 4523403, 28245547, 68367987, 24017138, 41355328, 77478881, 96598696, 83630489, 89134848, 25122697, 38106122, 39950371, 75150256, 15608692, 25393129, 76960091, 22408589, 60490822, 72035598, 6857394, 90218800, 82103336, 80851244, 41765244, 86013726, 39843910, 53780156, 33653475, 89573264, 30655437, 98373899, 21750571, 40343640, 79051860, 10634057, 42788046, 73576157, 63785108, 79694097, 37788847, 66159405, 69761920, 40638863, 5012313, 95976787, 16399833, 86350036, 23503, 40681535, 75240897, 2360171, 90119021, 46040025, 54879532, 83687706, 46338728, 26248405, 77859341, 90139117, 554959, 43191153, 66837428, 55763581, 58464434, 56967786]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/cagrad_run_2"
