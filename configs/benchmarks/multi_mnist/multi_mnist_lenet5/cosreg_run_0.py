# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.cosreg import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 76767692
config['train_seeds'] = [75114553, 58235552, 4170287, 69428441, 70303454, 25552680, 32345987, 17727673, 35457210, 46490485, 53283022, 38699587, 97790961, 9434883, 26705099, 41263043, 85926399, 25287214, 57245856, 62932120, 8052296, 21985988, 94202645, 33828021, 92645211, 52887399, 63744892, 48558757, 9598239, 4219570, 53391938, 16518762, 4833135, 70943850, 60257883, 97817098, 63420946, 40292288, 13848940, 45236323, 65775865, 62546515, 19089208, 89097834, 69137668, 28045205, 9858330, 32444413, 53625246, 40813540, 47464778, 7131874, 61520246, 82579269, 60337093, 87538143, 43470788, 14836479, 98407429, 42445277, 18825585, 32912817, 92500052, 30683551, 86572994, 10061664, 76500599, 62753821, 8154709, 92516260, 68300254, 23445965, 89714122, 53004078, 62676194, 73285677, 11287782, 67153533, 31210524, 46760302, 48467523, 57820911, 93415716, 65510335, 94754580, 17253354, 99513517, 95400761, 43495980, 21855119, 16522666, 63648483, 47758376, 66345331, 82514649, 55934049, 4914720, 30492095, 28268574, 89678268]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/cosreg_run_0"
