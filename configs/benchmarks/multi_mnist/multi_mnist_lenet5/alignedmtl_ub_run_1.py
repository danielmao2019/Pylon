# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 17701372
config['train_seeds'] = [57805261, 34489521, 76717621, 73433479, 12181304, 4373010, 72329464, 29220243, 75277037, 87367877, 72692074, 24534968, 39753401, 76496979, 4518588, 63344262, 17212137, 43300525, 38709015, 6154756, 64947192, 59243204, 12953114, 8098263, 77720197, 83060275, 10048056, 29822903, 34799123, 6595535, 79641817, 46938573, 74815827, 61735002, 83531312, 65747212, 12432953, 44365724, 82917282, 50380242, 34355022, 22898717, 34588203, 24383985, 72080138, 85549850, 63976894, 67904515, 92322986, 90325410, 30368984, 74331830, 15709803, 37120366, 99594036, 81607014, 98610948, 23471294, 7670162, 16887134, 55021014, 92281982, 40982194, 24113549, 82300007, 68823805, 25814143, 13520885, 75712373, 61017077, 39069920, 37851287, 56049193, 54224673, 27716807, 26320367, 33919706, 116848, 36762606, 68976196, 47456625, 32277174, 39290122, 48854617, 83456919, 75460190, 67294743, 90340303, 83083594, 60061626, 12045836, 44107000, 18882579, 60510621, 89382168, 89995250, 85380871, 73109369, 51421393, 40587207]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/alignedmtl_ub_run_1"
