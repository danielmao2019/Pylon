# This file is automatically generated by `./configs/benchmarks/multi_task_learning.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedMultiTaskTrainer
config['runner'] = SupervisedMultiTaskTrainer

# dataset config
from configs.common.datasets.multi_mnist import config as dataset_config
config.update(dataset_config)

# model config
from configs.common.models.multi_mnist.multi_mnist_lenet5 import model_config_all_tasks as model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.alignedmtl_ub import optimizer_config
from configs.common.optimizers._core_ import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
optimizer_config['args']['per_layer'] = False
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 47533184
config['train_seeds'] = [3909590, 73919617, 2873371, 39238488, 57896576, 17429624, 61878079, 12100576, 5462956, 16554384, 74512250, 95772292, 40344363, 93030406, 29991131, 58525743, 23973580, 8541706, 49569569, 24985932, 41142556, 37860526, 10981101, 7701376, 34050963, 27660547, 16066316, 37041249, 74018648, 26325540, 12445482, 98331436, 92403874, 53758345, 5160133, 8746403, 63237680, 75992345, 17032063, 57838980, 77393584, 52806142, 26927780, 63695360, 58481433, 90451858, 95562020, 44156703, 29265896, 95375826, 32103661, 71250755, 62770382, 35746113, 64391556, 80362097, 8483423, 38057138, 54498269, 88192701, 70974167, 53487294, 82659462, 62588136, 60140377, 3901955, 54559647, 93178872, 30735478, 6689868, 60163904, 13033889, 79557074, 84107274, 17560858, 46860406, 78812791, 47937982, 74711215, 87338910, 35009222, 97639440, 5595627, 60718598, 47429729, 27364025, 62580510, 20633327, 19139890, 66243700, 70910548, 88845598, 50117828, 47365991, 40671102, 99410481, 75325354, 76035359, 37068707, 60084682]

# work dir
config['work_dir'] = "./logs/benchmarks/multi_mnist/multi_mnist_lenet5/alignedmtl_ub_run_2"
