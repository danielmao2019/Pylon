# This file is automatically generated by `./configs/benchmarks/change_detection/gen_bi_temporal.py`.
# Please do not attempt to modify manually.
from configs.common.datasets.change_detection.val._transforms_cfg import transforms_cfg
from torch.optim.lr_scheduler import PolynomialLR
from torch.optim.sgd import SGD
from torch.utils.data.dataloader import DataLoader
from torchvision.transforms.transforms import ColorJitter
from criteria.vision_2d.dense_prediction.dense_classification.focal_dice_loss import FocalDiceLoss
from criteria.wrappers.auxiliary_outputs_criterion import AuxiliaryOutputsCriterion
from data.collators.base_collator import BaseCollator
from data.datasets.change_detection_datasets.bi_temporal.sysu_cd_dataset import SYSU_CD_Dataset
from data.transforms.compose import Compose
from data.transforms.randomize import Randomize
from data.transforms.vision_2d.crop.random_crop import RandomCrop
from data.transforms.vision_2d.flip import Flip
from data.transforms.vision_2d.random_rotation import RandomRotation
from metrics.vision_2d.semantic_segmentation_metric import SemanticSegmentationMetric
from models.change_detection.change_next.models.change_next_v1 import ChangeNextV1
from optimizers.single_task_optimizer import SingleTaskOptimizer
from runners.supervised_single_task_trainer import SupervisedSingleTaskTrainer


config = {
    'runner': SupervisedSingleTaskTrainer,
    'work_dir': './logs/benchmarks/change_detection/sysu_cd/ChangeNextV1_run_0',
    'epochs': 100,
    'init_seed': 57272912,
    'train_seeds': [76498368, 77505994, 73630834, 12802908, 48227167, 82888916, 78851137, 87653369, 25360146, 14215337, 73507610, 61729145, 73259191, 31649919, 20592225, 57530484, 30871878, 38619005, 49519696, 49393162, 66800767, 88298105, 62494741, 43496034, 51969256, 58939476, 82508568, 91441552, 4553880, 30655717, 38136306, 14173133, 59262453, 27990437, 98038214, 70159092, 91175697, 85413732, 28309682, 16953411, 92361256, 57736476, 65376094, 62159984, 19169418, 18733378, 5594040, 17139208, 42857672, 12228500, 74529678, 26249899, 76948853, 96165431, 11935736, 98309603, 14723822, 63195719, 90971514, 25604532, 16846312, 71733922, 86417144, 70700762, 78488454, 35727120, 86070105, 19927450, 58306732, 81604734, 91817880, 89164157, 21374037, 56578855, 23998037, 77479083, 75595411, 11187473, 1359834, 44872288, 38214313, 43311868, 77088330, 29838167, 58717072, 41689363, 34227799, 45061362, 5644779, 41194819, 82890616, 5509007, 45830986, 55339087, 72082046, 76046841, 50498559, 67314644, 7054856, 63979652],
    'val_seeds': [86396692, 26248658, 52137248, 51202429, 38901134, 55991049, 75924616, 76715679, 56973136, 65509862, 89266948, 56300715, 4750487, 66890111, 67229644, 72989632, 67216503, 67481227, 21393425, 57113207, 4674189, 26184427, 16323979, 11841943, 59468633, 92427920, 20512642, 37545414, 50617672, 16998825, 61841721, 11423614, 20702347, 28560904, 93153538, 62513182, 26585958, 31651151, 75451540, 90865210, 42322775, 19463714, 50132493, 38473469, 63971914, 12115301, 5472652, 57373343, 1358338, 35206056, 40451149, 9975283, 62265136, 2716146, 55398573, 90722977, 54080315, 35458762, 29406576, 4795668, 73319018, 91223348, 3155245, 2847547, 54718084, 48957062, 32900490, 14085842, 33593092, 80445225, 76115928, 15932405, 50997169, 29613794, 42145018, 16283169, 23052802, 64727600, 49184152, 7421614, 95241500, 13910056, 78010321, 65933418, 46595121, 93643167, 42701148, 441694, 34736659, 69886260, 45726923, 54095311, 82209855, 89302814, 71623155, 65857551, 23623270, 48270853, 34273929, 34922181],
    'test_seed': 80698914,
    'train_dataset': {
        'class': SYSU_CD_Dataset,
        'args': {
            'data_root': './data/datasets/soft_links/SYSU-CD',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [(
    {
            'class': RandomCrop,
            'args': {
                'size': (256, 256),
                'resize': None,
                'interpolation': None,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': RandomRotation,
            'args': {
                'choices': [0, 90, 180, 270],
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -1,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -2,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': ColorJitter,
                    'args': {
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_1')
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': ColorJitter,
                    'args': {
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_2')
)],
                },
            },
        },
    },
    'train_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 4,
            'num_workers': 4,
            'collate_fn': {
                'class': BaseCollator,
                'args': {
                    'collators': {},
                },
            },
        },
    },
    'criterion': {
        'class': AuxiliaryOutputsCriterion,
        'args': {
            'criterion_cfg': {
                'class': FocalDiceLoss,
                'args': {
                    'class_weights': (0.4268217980861664, 1.5731782913208008),
                    'use_buffer': False,
                },
            },
            'reduction': 'mean',
        },
    },
    'val_dataset': {
        'class': SYSU_CD_Dataset,
        'args': {
            'data_root': './data/datasets/soft_links/SYSU-CD',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [(
    {
            'class': RandomCrop,
            'args': {
                'size': (256, 256),
                'resize': None,
                'interpolation': None,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': RandomRotation,
            'args': {
                'choices': [0, 90, 180, 270],
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -1,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -2,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': ColorJitter,
                    'args': {
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_1')
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': ColorJitter,
                    'args': {
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_2')
)],
                },
            },
        },
    },
    'val_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 1,
            'num_workers': 4,
            'collate_fn': {
                'class': BaseCollator,
                'args': {
                    'collators': {},
                },
            },
        },
    },
    'test_dataset': {
        'class': SYSU_CD_Dataset,
        'args': {
            'data_root': './data/datasets/soft_links/SYSU-CD',
            'split': 'test',
            'transforms_cfg': transforms_cfg,
        },
    },
    'test_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 1,
            'num_workers': 4,
            'collate_fn': {
                'class': BaseCollator,
                'args': {
                    'collators': {},
                },
            },
        },
    },
    'metric': {
        'class': SemanticSegmentationMetric,
        'args': {
            'num_classes': 2,
        },
    },
    'model': {
        'class': ChangeNextV1,
        'args': {},
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': SGD,
                'args': {
                    'lr': 0.001,
                    'momentum': 0.9,
                    'weight_decay': 0.0001,
                },
            },
        },
    },
    'scheduler': {
        'class': PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}
