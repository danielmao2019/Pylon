# This file is automatically generated by `./configs/benchmarks/change_detection/gen_bi_temporal.py`.
# Please do not attempt to modify manually.
from builtins import list
from torch.optim.lr_scheduler import PolynomialLR
from torch.optim.sgd import SGD
from torch.utils.data.dataloader import DataLoader
from torchvision.transforms.transforms import ColorJitter
from criteria.vision_2d.change_detection.dsfernet_criterion import DsferNetCriterion
from data.collators.base_collator import BaseCollator
from data.datasets.change_detection_datasets.bi_temporal.oscd_dataset import OSCDDataset
from data.transforms.compose import Compose
from data.transforms.randomize import Randomize
from data.transforms.torchvision_wrapper import TorchvisionWrapper
from data.transforms.vision_2d.crop.random_crop import RandomCrop
from data.transforms.vision_2d.flip import Flip
from data.transforms.vision_2d.random_rotation import RandomRotation
from metrics.vision_2d.semantic_segmentation_metric import SemanticSegmentationMetric
from models.change_detection.dsfernet.dsfernet import DsferNet
from optimizers.single_task_optimizer import SingleTaskOptimizer
from runners.supervised_single_task_trainer import SupervisedSingleTaskTrainer


config = {
    'runner': SupervisedSingleTaskTrainer,
    'work_dir': './logs/benchmarks/change_detection/oscd/DsferNet_run_2',
    'epochs': 100,
    'init_seed': 26933399,
    'train_seeds': [53031702, 98499737, 22987814, 83083422, 43553997, 51739784, 3032926, 74450077, 26507404, 98027725, 21843346, 90757896, 36979679, 33320458, 53888240, 32899800, 42908090, 73506728, 66520780, 10016219, 50075728, 38113460, 57850607, 28928815, 85339471, 98677440, 11395149, 19820629, 41789405, 70922101, 72973246, 16338455, 24143908, 10743515, 90753908, 42396403, 52536858, 34732966, 10828628, 14802540, 20478963, 8440584, 31623247, 32275388, 16659214, 14178150, 54669771, 73430701, 60134909, 65674125, 33778036, 89824353, 84578701, 45179651, 99758489, 46112348, 44288144, 93480980, 18757003, 84505603, 52646620, 89557741, 25295479, 83658832, 67834729, 26786204, 41077364, 69007773, 95606686, 80513170, 85156543, 73086040, 66035512, 19583853, 98859758, 68944548, 35437106, 44756600, 21936906, 11131710, 38639317, 32261925, 23280331, 56635938, 29511073, 51892666, 40183297, 85994955, 33547213, 89285354, 15700945, 72997838, 40809028, 76110107, 58188305, 8873924, 82494571, 4229814, 49265076, 62858322],
    'val_seeds': [68424111, 17319770, 12582490, 97262284, 73244355, 13575689, 46992834, 26583498, 85816433, 99994139, 73959841, 36286471, 45894577, 71192824, 92169014, 75671675, 70801337, 12750784, 79474286, 17764141, 94779283, 64303691, 53604830, 62888390, 59030512, 61795183, 32281535, 6485111, 36189304, 54818360, 66693028, 18503352, 30817686, 4424291, 87918669, 85469959, 21691088, 24428854, 22031490, 77123591, 62107037, 79652638, 1524529, 93475729, 1600477, 5588565, 6167993, 57790530, 57734399, 234903, 12770451, 82324568, 80071445, 60685936, 61073240, 14317043, 21665514, 6738253, 38084219, 81162483, 10878890, 68736923, 32893724, 83967124, 97375546, 96556375, 14734951, 9095962, 28957762, 42325956, 42828032, 41065718, 34172729, 30369699, 31177560, 96510997, 31622303, 96341035, 56757819, 75978144, 71672224, 63056811, 63343575, 62346492, 73096235, 36527820, 56584070, 46909220, 18830506, 32798929, 35583611, 89088958, 60959360, 12835247, 51201035, 57600311, 47649016, 35983804, 41608778, 67993800],
    'test_seed': 88431568,
    'train_dataset': {
        'class': OSCDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/OSCD',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [(
    {
            'class': RandomCrop,
            'args': {
                'size': (224, 224),
                'resize': (256, 256),
                'interpolation': None,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': RandomRotation,
            'args': {
                'choices': [0, 90, 180, 270],
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -1,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -2,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': TorchvisionWrapper,
                    'args': {
                        'transform_class': ColorJitter,
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_1')
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': TorchvisionWrapper,
                    'args': {
                        'transform_class': ColorJitter,
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_2')
)],
                },
            },
            'bands': None,
        },
    },
    'train_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 4,
            'num_workers': 4,
            'collate_fn': {
                'class': BaseCollator,
                'args': {
                    'collators': {
                        'meta_info': {
                            'date_1': list,
                            'date_2': list,
                        },
                    },
                },
            },
        },
    },
    'criterion': {
        'class': DsferNetCriterion,
        'args': {},
    },
    'val_dataset': {
        'class': OSCDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/OSCD',
            'split': 'test',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [(
    {
            'class': RandomCrop,
            'args': {
                'size': (224, 224),
                'resize': (256, 256),
                'interpolation': None,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': RandomRotation,
            'args': {
                'choices': [0, 90, 180, 270],
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -1,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -2,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': TorchvisionWrapper,
                    'args': {
                        'transform_class': ColorJitter,
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_1')
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': TorchvisionWrapper,
                    'args': {
                        'transform_class': ColorJitter,
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_2')
)],
                },
            },
            'bands': None,
        },
    },
    'val_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 1,
            'num_workers': 4,
            'collate_fn': {
                'class': BaseCollator,
                'args': {
                    'collators': {
                        'meta_info': {
                            'date_1': list,
                            'date_2': list,
                        },
                    },
                },
            },
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': SemanticSegmentationMetric,
        'args': {
            'num_classes': 2,
        },
    },
    'model': {
        'class': DsferNet,
        'args': {},
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': SGD,
                'args': {
                    'lr': 0.001,
                    'momentum': 0.9,
                    'weight_decay': 0.0001,
                },
            },
        },
    },
    'scheduler': {
        'class': PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}
