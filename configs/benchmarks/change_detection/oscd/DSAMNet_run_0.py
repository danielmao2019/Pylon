# This file is automatically generated by `./configs/benchmarks/change_detection/gen_bi_temporal.py`.
# Please do not attempt to modify manually.
from builtins import list
from torch.optim.lr_scheduler import PolynomialLR
from torch.optim.sgd import SGD
from torch.utils.data.dataloader import DataLoader
from torchvision.transforms.transforms import ColorJitter
from criteria.vision_2d.change_detection.dsamnet_criterion import DSAMNetCriterion
from data.collators.base_collator import BaseCollator
from data.datasets.change_detection_datasets.bi_temporal.oscd_dataset import OSCDDataset
from data.transforms.compose import Compose
from data.transforms.randomize import Randomize
from data.transforms.vision_2d.crop.random_crop import RandomCrop
from data.transforms.vision_2d.flip import Flip
from data.transforms.vision_2d.random_rotation import RandomRotation
from metrics.vision_2d.semantic_segmentation_metric import SemanticSegmentationMetric
from models.change_detection.dsamnet.dsamnet import DSAMNet
from optimizers.single_task_optimizer import SingleTaskOptimizer
from runners.supervised_single_task_trainer import SupervisedSingleTaskTrainer


config = {
    'runner': SupervisedSingleTaskTrainer,
    'work_dir': './logs/benchmarks/change_detection/oscd/DSAMNet_run_0',
    'epochs': 100,
    'init_seed': 46583111,
    'train_seeds': [13240630, 55940119, 19898165, 52995332, 70211650, 62356254, 75588731, 3238732, 96770085, 51546632, 24377998, 24077540, 86234555, 25053237, 68029004, 60357603, 36535775, 24809560, 65132583, 8414319, 89329011, 92127267, 15696482, 17804372, 92159622, 31220972, 14252672, 65527448, 583333, 38758437, 22797933, 25481187, 44293993, 47706071, 2388481, 77501601, 9869192, 5017114, 70559022, 72091612, 70123545, 26684764, 53320471, 36976550, 85944214, 57997141, 22923146, 22837549, 24212711, 58882402, 14934189, 65242199, 754398, 98063741, 33917695, 10739201, 34340190, 37889658, 78727581, 63553381, 20429390, 21964465, 4067414, 98716689, 88476325, 56300018, 55589355, 21269937, 70414157, 94489669, 30428295, 42290564, 50413563, 12817786, 81384564, 71196336, 71339227, 27726879, 3684809, 79324744, 61286335, 25850620, 89477863, 94525974, 19140030, 50501212, 60042569, 42771028, 63215093, 88124423, 37531686, 23596357, 18155014, 75527238, 42231792, 12003148, 56559347, 23891346, 25676661, 74068771],
    'val_seeds': [83106487, 23158818, 47646870, 3948863, 61331430, 5503575, 24337444, 18100691, 88749238, 77341771, 75791312, 75932359, 89636933, 85556519, 80139934, 87531551, 15112072, 69766421, 58988118, 23279613, 71872746, 85217204, 22806972, 56919385, 76865679, 35340863, 43012123, 21883883, 75046028, 67042134, 93323702, 4330988, 41241364, 28551265, 59279383, 62266752, 37450964, 1917226, 8270445, 8518016, 87350100, 3749016, 82554429, 67209032, 9806794, 8353839, 37532832, 32794225, 8621303, 76078252, 70557603, 19381913, 18176255, 3500728, 2706178, 12235664, 59005516, 60761309, 46242542, 70757355, 42432851, 87054333, 97944833, 22370257, 64555268, 74103591, 45760906, 34288548, 35908727, 60578887, 74240523, 27333272, 86214126, 59159753, 11602176, 68337383, 19973338, 86831111, 16635252, 8397322, 46084267, 69667539, 68976042, 56286470, 7188152, 71003817, 13672908, 15702056, 63083886, 13034675, 29874083, 46601555, 77159243, 6928030, 19855896, 24846769, 47108877, 88071984, 2114901, 94207986],
    'test_seed': 90139485,
    'train_dataset': {
        'class': OSCDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/OSCD',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [(
    {
            'class': RandomCrop,
            'args': {
                'size': (224, 224),
                'resize': (256, 256),
                'interpolation': None,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': RandomRotation,
            'args': {
                'choices': [0, 90, 180, 270],
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -1,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -2,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': ColorJitter,
                    'args': {
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_1')
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': ColorJitter,
                    'args': {
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_2')
)],
                },
            },
            'bands': None,
        },
    },
    'train_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 4,
            'num_workers': 4,
            'collate_fn': {
                'class': BaseCollator,
                'args': {
                    'collators': {
                        'meta_info': {
                            'date_1': list,
                            'date_2': list,
                        },
                    },
                },
            },
        },
    },
    'criterion': {
        'class': DSAMNetCriterion,
        'args': {
            'dice_weight': 0.1,
        },
    },
    'val_dataset': {
        'class': OSCDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/OSCD',
            'split': 'test',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [(
    {
            'class': RandomCrop,
            'args': {
                'size': (224, 224),
                'resize': (256, 256),
                'interpolation': None,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': RandomRotation,
            'args': {
                'choices': [0, 90, 180, 270],
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -1,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -2,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': ColorJitter,
                    'args': {
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_1')
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': ColorJitter,
                    'args': {
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_2')
)],
                },
            },
            'bands': None,
        },
    },
    'val_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 1,
            'num_workers': 4,
            'collate_fn': {
                'class': BaseCollator,
                'args': {
                    'collators': {
                        'meta_info': {
                            'date_1': list,
                            'date_2': list,
                        },
                    },
                },
            },
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': SemanticSegmentationMetric,
        'args': {
            'num_classes': 2,
        },
    },
    'model': {
        'class': DSAMNet,
        'args': {},
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': SGD,
                'args': {
                    'lr': 0.001,
                    'momentum': 0.9,
                    'weight_decay': 0.0001,
                },
            },
        },
    },
    'scheduler': {
        'class': PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}
