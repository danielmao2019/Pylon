# This file is automatically generated by `./configs/benchmarks/change_detection/gen_bi_temporal.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.SGD,
                'args': {
                    'lr': 1.0e-03,
                    'momentum': 0.9,
                    'weight_decay': 1.0e-04,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
from configs.common.datasets.change_detection.train.oscd_data_cfg import data_cfg as train_dataset_config
config.update(train_dataset_config)
from configs.common.datasets.change_detection.val.oscd_data_cfg import data_cfg as val_dataset_config
config.update(val_dataset_config)

# model config
import models
config['model'] = {'class': models.change_detection.CDXFormer, 'args': {}}

import criteria
config['criterion'] = {'class': criteria.vision_2d.CEDiceLoss, 'args': {}}

# seeds
config['init_seed'] = 88646444
config['train_seeds'] = [2890645, 44973035, 39062169, 15415284, 53783486, 79018078, 17028550, 26234898, 51340955, 25221020, 97328543, 99655111, 70094698, 38929997, 95020421, 59260395, 56172943, 14920441, 77741169, 79329110, 36357611, 57576068, 40359852, 2498582, 66264750, 46552952, 29239796, 95505694, 89172794, 53582771, 23716142, 53964425, 34794513, 27027531, 63362534, 66020823, 71526587, 49477887, 69558377, 788428, 53810777, 55121292, 18899028, 85192642, 11967559, 40266442, 10142500, 47815406, 44599409, 44422491, 3322748, 47743301, 70362738, 95132495, 4545035, 96421720, 24953064, 52640226, 43679169, 78020891, 13629625, 25570592, 50412630, 99045171, 40871245, 87996871, 64396875, 89901865, 45774442, 22649156, 73014767, 10697956, 92497161, 56383242, 60367643, 9119022, 4818139, 98483474, 13239871, 36722232, 51371534, 25787650, 49697988, 36168125, 53991137, 27414962, 25619605, 22326976, 82504362, 44544040, 81429776, 77093936, 90897336, 88544230, 75531791, 76321035, 66387459, 40079457, 30247028, 44936036]
config['val_seeds'] = [83910389, 21648475, 62754152, 51230408, 18751178, 23429618, 23388299, 62813358, 7451028, 83417534, 4067419, 66854263, 81220229, 77181656, 52740876, 33872490, 10898525, 40234848, 7922111, 89030027, 51383354, 78702756, 56160113, 72087251, 49084383, 62271313, 89907240, 65186898, 30285858, 42987531, 53373946, 30563808, 13600084, 74053700, 15035191, 28461297, 4109185, 99019323, 33897478, 28119435, 57703854, 90859188, 57320495, 87807938, 55341874, 32508797, 79823403, 98599177, 52510439, 11742686, 42466004, 36916981, 9125613, 98322190, 84985348, 92393387, 55029169, 73406347, 77588659, 40042745, 85888601, 79813141, 86557206, 12859986, 6941996, 99160419, 69850941, 43290000, 23888393, 93587647, 62940563, 99839264, 8373962, 99756034, 19290675, 92377658, 53895241, 46902859, 15738379, 15214428, 12478059, 53164508, 88717354, 96911832, 34503716, 36305271, 11876396, 39983200, 18714208, 14327251, 85472096, 85725188, 97573654, 71528469, 8728888, 26893314, 58799555, 87266004, 56590552, 1179979]
config['test_seed'] = 64656776

# work dir
config['work_dir'] = "./logs/benchmarks/change_detection/oscd/CDXFormer_run_1"
