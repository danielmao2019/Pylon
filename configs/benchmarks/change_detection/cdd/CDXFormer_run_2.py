# This file is automatically generated by `./configs/benchmarks/change_detection/gen_bi_temporal.py`.
# Please do not attempt to modify manually.
from torch import Tensor
from torch.optim.lr_scheduler import PolynomialLR
from torch.optim.sgd import SGD
from torch.utils.data.dataloader import DataLoader
from torchvision.transforms.transforms import ColorJitter
from criteria.vision_2d.dense_prediction.dense_classification.ce_dice_loss import CEDiceLoss
from data.collators.base_collator import BaseCollator
from data.datasets.change_detection_datasets.bi_temporal.cdd_dataset import CDDDataset
from data.transforms.compose import Compose
from data.transforms.randomize import Randomize
from data.transforms.torchvision_wrapper import TorchvisionWrapper
from data.transforms.vision_2d.crop.random_crop import RandomCrop
from data.transforms.vision_2d.flip import Flip
from data.transforms.vision_2d.random_rotation import RandomRotation
from metrics.vision_2d.semantic_segmentation_metric import SemanticSegmentationMetric
from models.change_detection.cdx_former.cdx_former_model import CDXFormer
from optimizers.single_task_optimizer import SingleTaskOptimizer
from runners.trainers.supervised_single_task_trainer import SupervisedSingleTaskTrainer


config = {
    'runner': SupervisedSingleTaskTrainer,
    'work_dir': './logs/benchmarks/change_detection/cdd/CDXFormer_run_2',
    'epochs': 100,
    'init_seed': 57352194,
    'train_seeds': [62909950, 22456470, 81035963, 85943751, 26836583, 92370980, 65752654, 84732206, 44782179, 77966811, 51191342, 7658158, 84713606, 30522896, 56420895, 59994884, 22214649, 1843227, 75936634, 12279199, 13248326, 28505332, 96037423, 99853997, 98892150, 70779296, 20799065, 54337309, 61309045, 9121130, 82412739, 93753323, 132372, 30592701, 57537625, 16821193, 57252252, 43982426, 43993077, 97842458, 38267997, 5006184, 31462365, 10241176, 45554286, 55318267, 46013485, 90367950, 85801814, 65706970, 96911927, 20731831, 40393245, 1269024, 59221195, 41108040, 8743005, 25691116, 1936899, 13253801, 26776067, 20005380, 79498932, 72165064, 63553977, 81374961, 42913239, 59627387, 87006959, 63690357, 35333274, 94544065, 24738378, 84865243, 16749041, 93153042, 39471074, 79334501, 36971152, 63528055, 46515260, 27783358, 86989205, 68910366, 8787812, 94763006, 48690346, 47193065, 66511414, 17014839, 39919285, 16895825, 21819237, 42685001, 90815326, 80925130, 28062436, 78703650, 97058552, 98688388],
    'val_seeds': [31292600, 22514539, 73189522, 97227187, 74680992, 83558596, 71891517, 53154101, 75047193, 25008368, 98226553, 94586392, 41450649, 36093252, 19869806, 68924686, 66206721, 76385123, 47639511, 37810852, 3275226, 90007115, 9434861, 49535084, 20292592, 54417305, 39766934, 10347943, 17048994, 56418887, 36233532, 20776346, 51244480, 28774290, 38379581, 98294015, 31507394, 64268970, 50570343, 81811746, 51709403, 60707714, 80649055, 40906830, 96509589, 33002114, 85591374, 1729513, 10899989, 34532031, 1256358, 427738, 20428932, 78727675, 72658833, 43895784, 11088767, 10739287, 38146476, 46293876, 135564, 75882565, 55452546, 72116000, 78118075, 91261663, 31900123, 14136453, 70151926, 39068894, 65508286, 97566780, 43935567, 6542032, 68496443, 24931323, 58806360, 31867035, 72930278, 8612657, 49287405, 38977007, 31832678, 97676143, 24942451, 17255415, 33137364, 86414140, 73086480, 67027756, 96631821, 20758543, 47714189, 22317595, 4912925, 65122116, 7577560, 13808959, 64610313, 56127321],
    'test_seed': 31803936,
    'train_dataset': {
        'class': CDDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/CDD',
            'split': 'train',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [(
    {
            'class': RandomCrop,
            'args': {
                'size': (224, 224),
                'resize': None,
                'interpolation': None,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': RandomRotation,
            'args': {
                'choices': [0, 90, 180, 270],
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -1,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': Flip,
                    'args': {
                        'axis': -2,
                    },
                },
                'p': 0.5,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': TorchvisionWrapper,
                    'args': {
                        'transform_class': ColorJitter,
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_1')
), (
    {
            'class': Randomize,
            'args': {
                'transform': {
                    'class': TorchvisionWrapper,
                    'args': {
                        'transform_class': ColorJitter,
                        'brightness': 0.5,
                        'contrast': 0.5,
                        'saturation': 0.5,
                    },
                },
                'p': 0.5,
            },
        },
    ('inputs', 'img_2')
)],
                },
            },
        },
    },
    'train_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 4,
            'num_workers': 4,
            'collate_fn': {
                'class': BaseCollator,
                'args': {
                    'collators': {
                        'meta_info': {
                            'image_resolution': Tensor,
                        },
                    },
                },
            },
        },
    },
    'criterion': {
        'class': CEDiceLoss,
        'args': {},
    },
    'val_dataset': {
        'class': CDDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/CDD',
            'split': 'val',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [(
    {
            'class': RandomCrop,
            'args': {
                'size': (224, 224),
                'resize': None,
                'interpolation': None,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
)],
                },
            },
        },
    },
    'val_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 1,
            'num_workers': 4,
            'collate_fn': {
                'class': BaseCollator,
                'args': {
                    'collators': {
                        'meta_info': {
                            'image_resolution': Tensor,
                        },
                    },
                },
            },
        },
    },
    'test_dataset': {
        'class': CDDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/CDD',
            'split': 'test',
            'transforms_cfg': {
                'class': Compose,
                'args': {
                    'transforms': [(
    {
            'class': RandomCrop,
            'args': {
                'size': (224, 224),
                'resize': None,
                'interpolation': None,
            },
        },
    [('inputs', 'img_1'), ('inputs', 'img_2'), ('labels', 'change_map')]
)],
                },
            },
        },
    },
    'test_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 1,
            'num_workers': 4,
            'collate_fn': {
                'class': BaseCollator,
                'args': {
                    'collators': {
                        'meta_info': {
                            'image_resolution': Tensor,
                        },
                    },
                },
            },
        },
    },
    'metric': {
        'class': SemanticSegmentationMetric,
        'args': {
            'num_classes': 2,
        },
    },
    'model': {
        'class': CDXFormer,
        'args': {},
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': SGD,
                'args': {
                    'lr': 0.001,
                    'momentum': 0.9,
                    'weight_decay': 0.0001,
                },
            },
        },
    },
    'scheduler': {
        'class': PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}
