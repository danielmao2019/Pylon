# This file is automatically generated by `./configs/benchmarks/change_detection/gen_bi_temporal.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.SGD,
                'args': {
                    'lr': 1.0e-03,
                    'momentum': 0.9,
                    'weight_decay': 1.0e-04,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
from configs.common.datasets.change_detection.train.cdd_data_cfg import data_cfg as train_dataset_config
config.update(train_dataset_config)
from configs.common.datasets.change_detection.val.cdd_data_cfg import data_cfg as val_dataset_config
config.update(val_dataset_config)

# model config
import models
config['model'] = {'class': models.change_detection.DsferNet, 'args': {}}

# criterion config
import criteria
config['criterion'] = {'class': criteria.vision_2d.change_detection.DsferNetCriterion, 'args': {}}

# transforms config
from configs.common.datasets.change_detection.train._transforms_cfg import transforms_cfg
config['train_dataset']['args']['transforms_cfg'] = transforms_cfg(size=(256, 256))
config['val_dataset']['args']['transforms_cfg'] = transforms_cfg(size=(256, 256))

# seeds
config['init_seed'] = 58471565
config['train_seeds'] = [55669956, 66069247, 79521129, 13143639, 54450693, 5448984, 98492430, 83376984, 97731698, 39831326, 23178355, 80456121, 22336659, 60757269, 35063505, 34221815, 123972, 14835219, 66693876, 78594479, 53823331, 72017286, 1502371, 78650494, 29583850, 84289919, 13315634, 89210071, 82591812, 32200814, 60066982, 19144367, 81998636, 42999931, 70999004, 77910404, 49921937, 69242023, 82995060, 37919883, 75554233, 94583976, 55923338, 84675329, 83760357, 16767403, 8924593, 97039894, 18196781, 56461203, 80061658, 38043149, 67137959, 75485253, 12332270, 66796491, 30845956, 98692744, 43194319, 47951666, 47975485, 44799842, 75153366, 58135037, 17258537, 35600796, 67048001, 11828567, 39679698, 92186897, 952855, 23544470, 73495380, 7491351, 13211093, 13064431, 70762088, 64383885, 61575081, 14350937, 61530136, 94050530, 36884290, 60899466, 97404018, 19231075, 33385330, 61326331, 50440745, 94097491, 9517583, 15528440, 3859684, 20959605, 9747600, 49846225, 71806847, 86634, 727284, 78441107]
config['val_seeds'] = [66164978, 93241742, 31498048, 56427087, 77364455, 79640830, 65640875, 29222259, 46434428, 6032484, 28279893, 46388266, 24554052, 46052173, 65124987, 75601352, 1391676, 83179004, 29825770, 76206391, 763967, 48054996, 28260394, 98984506, 66572059, 44006353, 45354256, 1267637, 59527957, 2370431, 27308480, 83543563, 42648190, 85708999, 31870293, 10200000, 87808425, 85209802, 47720764, 68364619, 82168996, 75083233, 11834078, 39737191, 7290594, 60830674, 5982871, 95250997, 34426330, 58515374, 33003961, 90724360, 44200387, 88742292, 49063822, 91167302, 34341619, 71945958, 56959007, 24039114, 82952207, 60008146, 11878297, 61139693, 74327872, 33301883, 22059835, 87551461, 71468364, 44029482, 89050899, 65894795, 66140219, 83650367, 57656743, 2801373, 59300357, 93487220, 87040575, 25893025, 64962257, 76544305, 36304863, 1628145, 3949201, 28153748, 34518953, 71091918, 66971729, 44972615, 29851992, 53672809, 8306934, 35981288, 71815236, 19166436, 41718054, 52101834, 32048673, 70308643]
config['test_seed'] = 98537480

# work dir
config['work_dir'] = "./logs/benchmarks/change_detection/cdd/DsferNet_run_0"
