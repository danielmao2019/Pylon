# This file is automatically generated by `./configs/benchmarks/change_detection/gen_bi_temporal.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.SGD,
                'args': {
                    'lr': 1.0e-03,
                    'momentum': 0.9,
                    'weight_decay': 1.0e-04,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
from configs.common.datasets.change_detection.train.levir_cd_data_cfg import data_cfg as train_dataset_config
config.update(train_dataset_config)
from configs.common.datasets.change_detection.val.levir_cd_data_cfg import data_cfg as val_dataset_config
config.update(val_dataset_config)

# model config
from configs.common.models.change_detection.change_mamba import model_tiny_cfg as model_cfg
config['model'] = model_cfg

# criterion config
import criteria
config['criterion'] = {'class': criteria.vision_2d.change_detection.STMambaBCDCriterion, 'args': {}}

# seeds
config['init_seed'] = 53780356
config['train_seeds'] = [5569849, 82328099, 5597916, 70030952, 99497390, 99098744, 74885352, 20683546, 13591608, 72191662, 3272833, 80916139, 74905206, 53928306, 79788757, 53995598, 26237029, 65838202, 99025918, 22716499, 69271253, 18269124, 26768779, 12515838, 81728971, 24750982, 83833226, 65566742, 76881702, 47732446, 64856856, 41539180, 24407878, 53097334, 24291176, 33802476, 82922494, 89971439, 60046185, 74811023, 54862724, 2466609, 18195327, 80657505, 76143272, 31970912, 75846732, 62243162, 20189395, 67282438, 63828836, 58761168, 51965258, 32266951, 564656, 98773742, 83318734, 66730480, 82727911, 84841810, 50233208, 23883315, 5986891, 94123242, 35771968, 74857225, 72198316, 76190939, 9751039, 39456232, 77809181, 46792351, 40504242, 11976976, 7297219, 55887124, 98794916, 56161024, 10241285, 5345360, 67595801, 66593584, 79132876, 7787730, 47993453, 87764662, 70888281, 44122758, 10470779, 11556410, 14974429, 40359499, 32400243, 39286558, 85160016, 69615203, 34092117, 46165755, 18549935, 27125313]
config['val_seeds'] = [87390513, 5360308, 58171540, 22685190, 12490088, 50498753, 58945795, 39501055, 41554454, 43550271, 3725922, 15715374, 35519627, 37319353, 32871109, 36093155, 17556405, 36997018, 89285150, 73791742, 94933483, 45623127, 5808616, 51211592, 93805174, 6532, 57202281, 143374, 51537858, 37277083, 81760394, 22469213, 25352735, 78300153, 25268434, 72261779, 14055576, 95169969, 21584152, 88802947, 98807137, 21678802, 72497019, 42171264, 34119865, 74245961, 93648438, 4830659, 79645623, 26226222, 82030860, 36169427, 20125682, 17146765, 82663760, 19821070, 46301071, 41535374, 30211610, 95882802, 93739017, 21330205, 288134, 10156032, 49235799, 67579579, 93398780, 85865045, 90072668, 79703837, 94705235, 91754881, 24399127, 42278773, 85105914, 10817358, 35148065, 65439546, 18213538, 95068989, 46048811, 32507166, 87682572, 26695967, 31406608, 63372656, 11182464, 8891416, 23888880, 355518, 88079149, 16707095, 7562916, 81026282, 48366620, 70152463, 46530313, 92697451, 81211723, 6388069]
config['test_seed'] = 63374035

# work dir
config['work_dir'] = "./logs/benchmarks/change_detection/levir_cd/ChangeMamba-Tiny_run_1"
