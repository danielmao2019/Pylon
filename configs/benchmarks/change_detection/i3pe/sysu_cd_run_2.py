# This file is automatically generated by `./configs/benchmarks/change_detection/gen_i3pe.py`.
# Please do not attempt to modify manually.
import torch
import schedulers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'criterion': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': None,
    'scheduler': {
        'class': torch.optim.lr_scheduler.LambdaLR,
        'args': {
            'lr_lambda': {
                'class': schedulers.lr_lambdas.WarmupLambda,
                'args': {},
            },
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
from configs.common.datasets.change_detection.train.i3pe_sysu_cd import config as train_dataset_config
config.update(train_dataset_config)
from configs.common.datasets.change_detection.val.all_bi_temporal import config as val_dataset_config
config.update(val_dataset_config)

# model config
from configs.common.models.change_detection.i3pe_model import model_config
config['model'] = model_config

# optimizer config
from configs.common.optimizers.single_task_optimizer import single_task_optimizer_config as optimizer_config
from configs.common.optimizers.standard import adam_optimizer_config
optimizer_config['args']['optimizer_config'] = adam_optimizer_config
config['optimizer'] = optimizer_config

# seeds
config['init_seed'] = 69055869
config['train_seeds'] = [36921033, 5903639, 43436836, 85660065, 3195613, 62889732, 9523687, 72958942, 63979574, 96441638, 16128993, 40136901, 40519446, 87519407, 27634932, 2583214, 15611092, 96609128, 3670999, 82872799, 27585874, 64886919, 62031272, 32223145, 90059801, 19624549, 27925506, 97591065, 99631508, 98941342, 90300549, 16073420, 34067251, 46659230, 69800129, 63648429, 63032544, 49159134, 72483703, 60006973, 32344933, 21703564, 62246889, 31028826, 21372323, 26725850, 37943485, 10848932, 75200792, 9905857, 87133291, 94167069, 51895667, 96315042, 39974872, 40696424, 79097679, 42841803, 37602340, 21424925, 24721137, 77343700, 80187293, 59119133, 60043918, 24937834, 51026201, 83008656, 44128898, 51400392, 62189522, 43076570, 42932057, 87049778, 78566810, 93521811, 6884048, 58234968, 85063139, 7925181, 23216155, 22814951, 27220493, 85945763, 21726574, 11500350, 24863745, 3727642, 50584110, 26217466, 64756812, 69540561, 46832636, 44287967, 12332713, 48585387, 75375609, 73956883, 95607140, 76480350]

# work dir
config['work_dir'] = "./logs/benchmarks/change_detection/i3pe/sysu_cd_run_2"
