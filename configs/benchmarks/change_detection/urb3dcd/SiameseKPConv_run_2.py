# This file is automatically generated by `./configs/benchmarks/change_detection/gen_3d_change_detection.py`.
# Please do not attempt to modify manually.
from torch.optim.lr_scheduler import PolynomialLR
from torch.optim.sgd import SGD
from torch.utils.data.dataloader import DataLoader
from criteria.vision_3d.point_cloud_segmentation_criterion import PointCloudSegmentationCriterion
from data.collators.siamese_kpconv_collator import SiameseKPConvCollator
from data.datasets.change_detection_datasets.bi_temporal.urb3dcd_dataset import Urb3DCDDataset
from metrics.common.confusion_matrix import ConfusionMatrix
from models.change_detection.siamese_kpconv.siamese_kpconv_model import SiameseKPConv
from optimizers.single_task_optimizer import SingleTaskOptimizer
from runners.supervised_single_task_trainer import SupervisedSingleTaskTrainer


config = {
    'runner': SupervisedSingleTaskTrainer,
    'work_dir': './logs/benchmarks/change_detection/urb3dcd/SiameseKPConv_run_2',
    'epochs': 100,
    'init_seed': 70084642,
    'train_seeds': [31842340, 95611172, 83226465, 86401550, 82199393, 25047129, 15653008, 46754620, 47456942, 18303622, 40988960, 40474176, 29882364, 7909885, 94151975, 76504428, 14240581, 47195693, 10147149, 11008154, 15556855, 188870, 80140139, 92984467, 20703909, 55691507, 6257823, 19222485, 5456989, 4823324, 94487725, 74919532, 69365512, 10464057, 49544632, 60592645, 71903094, 42508326, 89221573, 32220594, 60265799, 8746659, 1315060, 6950165, 94291826, 47191934, 73950476, 72839493, 65588425, 66898682, 13329639, 53454977, 69736908, 11665336, 87607455, 18347935, 35451792, 42458718, 7956530, 8157741, 98401201, 70556505, 71650694, 47498660, 74531692, 17821427, 23068880, 97586837, 63931107, 83350203, 8342858, 75366650, 54177325, 71085577, 11815327, 98375524, 184467, 76849952, 60046429, 38858987, 79900185, 42017094, 52309773, 73319712, 78508556, 50756979, 64786181, 42535595, 55936654, 83012509, 24059702, 17269667, 18127044, 29905250, 90886568, 65818704, 50390411, 68918622, 89522986, 67892983],
    'val_seeds': [49983235, 98988670, 86738099, 75210456, 73336371, 8070239, 26573324, 50364109, 87252616, 16139524, 24332414, 14643704, 39988980, 93978436, 39150485, 97370246, 44648723, 82747970, 23322112, 98288244, 44615502, 3521249, 8417954, 30660836, 98925581, 84678785, 93893202, 61374166, 52672313, 51468307, 1036308, 94785724, 90920759, 67709968, 95306469, 13872203, 29147983, 27178997, 92919332, 2032422, 56970789, 75688605, 23094760, 8872478, 77443647, 84649364, 99338237, 44079802, 51938791, 44930002, 48740654, 4135655, 48391046, 80061643, 35208383, 66507212, 30102525, 84678496, 94229374, 22970563, 53026907, 2752318, 44618081, 26471217, 40964619, 63435048, 64763722, 57330936, 30778760, 56985157, 59160409, 75261806, 52717910, 8095575, 19889901, 15735545, 64150958, 33353484, 80809292, 18552738, 8346042, 65471368, 29465000, 51718379, 62788964, 49992287, 1491484, 46744244, 41530445, 40469834, 35628252, 99397488, 48380291, 27117313, 29292956, 95361012, 223575, 14590076, 12264755, 90552254],
    'test_seed': 88408977,
    'train_dataset': {
        'class': Urb3DCDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/Urb3DCD',
            'split': 'train',
        },
    },
    'train_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 1,
            'collate_fn': {
                'class': SiameseKPConvCollator,
                'args': {},
            },
        },
    },
    'criterion': {
        'class': PointCloudSegmentationCriterion,
        'args': {
            'ignore_value': -1,
            'class_weights': None,
        },
    },
    'val_dataset': {
        'class': Urb3DCDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/Urb3DCD',
            'split': 'val',
        },
    },
    'val_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 1,
            'collate_fn': {
                'class': SiameseKPConvCollator,
                'args': {},
            },
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': ConfusionMatrix,
        'args': {
            'num_classes': 7,
        },
    },
    'model': {
        'class': SiameseKPConv,
        'args': {
            'in_channels': 4,
            'out_channels': 7,
            'point_influence': 0.05,
            'down_channels': [64, 128, 256, 512, 1024],
            'up_channels': [1024, 512, 256, 128, 64],
            'bn_momentum': 0.02,
            'dropout': 0.5,
            'conv_type': 'simple',
            'block_params': {
                'n_kernel_points': 25,
                'max_num_neighbors': 25,
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': SGD,
                'args': {
                    'lr': 0.001,
                    'momentum': 0.9,
                    'weight_decay': 0.0001,
                },
            },
        },
    },
    'scheduler': {
        'class': PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}
