# This file is automatically generated by `./configs/benchmarks/change_detection/gen_3d_change_detection.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.SGD,
                'args': {
                    'lr': 1.0e-03,
                    'momentum': 0.9,
                    'weight_decay': 1.0e-04,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
from configs.common.datasets.change_detection.train.urb3dcd_data_cfg import data_cfg as train_dataset_config
config.update(train_dataset_config)
from configs.common.datasets.change_detection.val.urb3dcd_data_cfg import data_cfg as val_dataset_config
config.update(val_dataset_config)

# model config
from configs.common.models.change_detection.siamese_kpconv import model_config
config['model'] = model_config

# Use specialized point cloud collator
import data
config['train_dataloader']['args']['collate_fn'] = data.collators.SiameseKPConvCollator()
config['val_dataloader']['args']['collate_fn'] = data.collators.SiameseKPConvCollator()

# seeds
config['init_seed'] = 86820758
config['train_seeds'] = [11691954, 57552398, 77322223, 95156366, 13503884, 42865742, 60894786, 60154919, 7978254, 19706388, 29830813, 39851851, 17483907, 47271670, 76557675, 60729593, 1451480, 51685131, 42938670, 44286948, 63549733, 19595219, 22543037, 16926034, 45284887, 14344977, 34785280, 95443436, 76626905, 40887618, 10975850, 48743236, 4036288, 41255037, 80220347, 78146924, 49854840, 53626090, 15832119, 64979489, 88586632, 48336818, 20294882, 38795943, 85425087, 98299009, 57488896, 26778848, 70096956, 19083880, 6368892, 5351724, 94862140, 3242226, 17062145, 79802525, 51189887, 4484892, 34676309, 80676624, 12207870, 86098477, 90320365, 64143796, 49259265, 85002845, 6078975, 65148229, 81908768, 29894796, 85866918, 2374101, 70377076, 62227396, 38009053, 96757105, 11253492, 88474397, 71617181, 17372657, 15257066, 18415472, 10050074, 47244474, 32624773, 45390470, 41297845, 65136087, 81028769, 48712904, 897882, 85009545, 29994200, 70796549, 79363275, 4055315, 86620924, 6280898, 91269536, 42245054]
config['val_seeds'] = [80232832, 94004132, 23706153, 42690797, 82306026, 97390446, 70780061, 90055978, 17326012, 40575496, 66897625, 84935068, 72712555, 87518907, 30960938, 64324154, 21345471, 5088795, 15935199, 54563733, 58698929, 19776140, 59792805, 14872794, 14007884, 29584555, 81309885, 64665195, 816583, 18523008, 39025009, 91942635, 36491742, 62747001, 82488995, 75889672, 21432029, 25850762, 20605192, 43340708, 44363580, 37011806, 62341394, 16739313, 99746725, 5119826, 7127843, 20657204, 92005756, 24591019, 41346587, 9981886, 80314099, 63408614, 97463231, 18671599, 94867346, 70497602, 90078056, 78330195, 17515790, 72028755, 7109721, 5126561, 10419579, 98390155, 76007237, 45891408, 50582020, 86082286, 77516011, 56661830, 88042687, 5933679, 67112474, 18708136, 90535366, 81468189, 38369431, 74889176, 30331016, 46549676, 92176446, 50076283, 75442509, 80777188, 58530765, 53138125, 6737162, 78215991, 21631032, 3436291, 11332380, 12787668, 84140025, 22782888, 17002146, 69750629, 88509039, 71193112]
config['test_seed'] = 48138583

# work dir
config['work_dir'] = "./logs/benchmarks/change_detection/urb3dcd/SiameseKPConv_run_1"
