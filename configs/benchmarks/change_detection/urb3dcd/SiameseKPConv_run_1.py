# This file is automatically generated by `./configs/benchmarks/change_detection/gen_3d_change_detection.py`.
# Please do not attempt to modify manually.
from torch.optim.lr_scheduler import PolynomialLR
from torch.optim.sgd import SGD
from torch.utils.data.dataloader import DataLoader
from criteria.vision_3d.point_cloud_segmentation_criterion import PointCloudSegmentationCriterion
from data.collators.siamese_kpconv_collator import SiameseKPConvCollator
from data.datasets.change_detection_datasets.bi_temporal.urb3dcd_dataset import Urb3DCDDataset
from metrics.common.confusion_matrix import ConfusionMatrix
from models.change_detection.siamese_kpconv.siamese_kpconv_model import SiameseKPConv
from optimizers.single_task_optimizer import SingleTaskOptimizer
from runners.supervised_single_task_trainer import SupervisedSingleTaskTrainer


config = {
    'runner': SupervisedSingleTaskTrainer,
    'work_dir': './logs/benchmarks/change_detection/urb3dcd/SiameseKPConv_run_1',
    'epochs': 100,
    'init_seed': 86820758,
    'train_seeds': [11691954, 57552398, 77322223, 95156366, 13503884, 42865742, 60894786, 60154919, 7978254, 19706388, 29830813, 39851851, 17483907, 47271670, 76557675, 60729593, 1451480, 51685131, 42938670, 44286948, 63549733, 19595219, 22543037, 16926034, 45284887, 14344977, 34785280, 95443436, 76626905, 40887618, 10975850, 48743236, 4036288, 41255037, 80220347, 78146924, 49854840, 53626090, 15832119, 64979489, 88586632, 48336818, 20294882, 38795943, 85425087, 98299009, 57488896, 26778848, 70096956, 19083880, 6368892, 5351724, 94862140, 3242226, 17062145, 79802525, 51189887, 4484892, 34676309, 80676624, 12207870, 86098477, 90320365, 64143796, 49259265, 85002845, 6078975, 65148229, 81908768, 29894796, 85866918, 2374101, 70377076, 62227396, 38009053, 96757105, 11253492, 88474397, 71617181, 17372657, 15257066, 18415472, 10050074, 47244474, 32624773, 45390470, 41297845, 65136087, 81028769, 48712904, 897882, 85009545, 29994200, 70796549, 79363275, 4055315, 86620924, 6280898, 91269536, 42245054],
    'val_seeds': [80232832, 94004132, 23706153, 42690797, 82306026, 97390446, 70780061, 90055978, 17326012, 40575496, 66897625, 84935068, 72712555, 87518907, 30960938, 64324154, 21345471, 5088795, 15935199, 54563733, 58698929, 19776140, 59792805, 14872794, 14007884, 29584555, 81309885, 64665195, 816583, 18523008, 39025009, 91942635, 36491742, 62747001, 82488995, 75889672, 21432029, 25850762, 20605192, 43340708, 44363580, 37011806, 62341394, 16739313, 99746725, 5119826, 7127843, 20657204, 92005756, 24591019, 41346587, 9981886, 80314099, 63408614, 97463231, 18671599, 94867346, 70497602, 90078056, 78330195, 17515790, 72028755, 7109721, 5126561, 10419579, 98390155, 76007237, 45891408, 50582020, 86082286, 77516011, 56661830, 88042687, 5933679, 67112474, 18708136, 90535366, 81468189, 38369431, 74889176, 30331016, 46549676, 92176446, 50076283, 75442509, 80777188, 58530765, 53138125, 6737162, 78215991, 21631032, 3436291, 11332380, 12787668, 84140025, 22782888, 17002146, 69750629, 88509039, 71193112],
    'test_seed': 48138583,
    'train_dataset': {
        'class': Urb3DCDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/Urb3DCD',
            'split': 'train',
        },
    },
    'train_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 1,
            'collate_fn': {
                'class': SiameseKPConvCollator,
                'args': {},
            },
        },
    },
    'criterion': {
        'class': PointCloudSegmentationCriterion,
        'args': {
            'ignore_value': -1,
            'class_weights': None,
        },
    },
    'val_dataset': {
        'class': Urb3DCDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/Urb3DCD',
            'split': 'val',
        },
    },
    'val_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 1,
            'collate_fn': {
                'class': SiameseKPConvCollator,
                'args': {},
            },
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': ConfusionMatrix,
        'args': {
            'num_classes': 7,
        },
    },
    'model': {
        'class': SiameseKPConv,
        'args': {
            'in_channels': 4,
            'out_channels': 7,
            'point_influence': 0.05,
            'down_channels': [64, 128, 256, 512, 1024],
            'up_channels': [1024, 512, 256, 128, 64],
            'bn_momentum': 0.02,
            'dropout': 0.5,
            'conv_type': 'simple',
            'block_params': {
                'n_kernel_points': 25,
                'max_num_neighbors': 25,
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': SGD,
                'args': {
                    'lr': 0.001,
                    'momentum': 0.9,
                    'weight_decay': 0.0001,
                },
            },
        },
    },
    'scheduler': {
        'class': PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}
