# This file is automatically generated by `./configs/benchmarks/change_detection/gen_3d_change_detection.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.SGD,
                'args': {
                    'lr': 1.0e-03,
                    'momentum': 0.9,
                    'weight_decay': 1.0e-04,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
from configs.common.datasets.change_detection.train.urb3dcd_data_cfg import config as train_dataset_config
config.update(train_dataset_config)
from configs.common.datasets.change_detection.val.urb3dcd import config as val_dataset_config
config.update(val_dataset_config)

# model config
from configs.common.models.change_detection.siamese_kpconv import model_config
config['model'] = model_config

# Use specialized point cloud collator
import data
config['train_dataloader']['args']['collate_fn'] = data.collators.SiameseKPConvCollator()
config['val_dataloader']['args']['collate_fn'] = data.collators.SiameseKPConvCollator()

# seeds
config['init_seed'] = 86820758
config['train_seeds'] = [11691954, 57552398, 77322223, 95156366, 13503884, 42865742, 60894786, 60154919, 7978254, 19706388, 29830813, 39851851, 17483907, 47271670, 76557675, 60729593, 1451480, 51685131, 42938670, 44286948, 63549733, 19595219, 22543037, 16926034, 45284887, 14344977, 34785280, 95443436, 76626905, 40887618, 10975850, 48743236, 4036288, 41255037, 80220347, 78146924, 49854840, 53626090, 15832119, 64979489, 88586632, 48336818, 20294882, 38795943, 85425087, 98299009, 57488896, 26778848, 70096956, 19083880, 6368892, 5351724, 94862140, 3242226, 17062145, 79802525, 51189887, 4484892, 34676309, 80676624, 12207870, 86098477, 90320365, 64143796, 49259265, 85002845, 6078975, 65148229, 81908768, 29894796, 85866918, 2374101, 70377076, 62227396, 38009053, 96757105, 11253492, 88474397, 71617181, 17372657, 15257066, 18415472, 10050074, 47244474, 32624773, 45390470, 41297845, 65136087, 81028769, 48712904, 897882, 85009545, 29994200, 70796549, 79363275, 4055315, 86620924, 6280898, 91269536, 42245054]

# work dir
config['work_dir'] = "./logs/benchmarks/change_detection/urb3dcd/SiameseKPConv_run_1"
