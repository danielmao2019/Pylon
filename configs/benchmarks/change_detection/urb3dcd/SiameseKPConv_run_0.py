# This file is automatically generated by `./configs/benchmarks/change_detection/gen_3d_change_detection.py`.
# Please do not attempt to modify manually.
from torch.optim.lr_scheduler import PolynomialLR
from torch.optim.sgd import SGD
from torch.utils.data.dataloader import DataLoader
from criteria.vision_3d.point_cloud_segmentation_criterion import PointCloudSegmentationCriterion
from data.collators.siamese_kpconv_collator import SiameseKPConvCollator
from data.datasets.change_detection_datasets.bi_temporal.urb3dcd_dataset import Urb3DCDDataset
from metrics.common.confusion_matrix import ConfusionMatrix
from models.change_detection.siamese_kpconv.siamese_kpconv_model import SiameseKPConv
from optimizers.single_task_optimizer import SingleTaskOptimizer
from runners.trainers.supervised_single_task_trainer import SupervisedSingleTaskTrainer


config = {
    'runner': SupervisedSingleTaskTrainer,
    'work_dir': './logs/benchmarks/change_detection/urb3dcd/SiameseKPConv_run_0',
    'epochs': 100,
    'init_seed': 59874168,
    'train_seeds': [62290649, 20174431, 24391354, 52042786, 23224246, 43933073, 39926367, 99119579, 63706582, 29449840, 14178606, 26505726, 40640731, 20732256, 14977512, 32856924, 57669012, 56807285, 15015612, 58650856, 61301560, 1830814, 68068713, 99840223, 61834893, 51001777, 96675916, 29340180, 45742197, 11816878, 44243348, 11919054, 63044863, 46701114, 36767326, 72179133, 78459024, 58620228, 74441337, 48219429, 91840029, 37891562, 89784702, 48084908, 57224674, 32404127, 4207885, 1934766, 41890442, 5384128, 67063576, 23277609, 54753755, 37246243, 18163759, 48464825, 39851268, 62414834, 33124242, 37848253, 54707143, 16899358, 40735590, 4926374, 30508651, 37946065, 73465768, 44908541, 55287148, 15319952, 83687953, 41386248, 81774104, 75281660, 76929575, 43457067, 8098971, 78222156, 62682446, 12007283, 78513391, 97387883, 79264735, 19161796, 82406242, 85634018, 23030980, 88154523, 21593079, 19113536, 44609333, 75548384, 68661186, 49253903, 16516442, 71187161, 83508107, 18032103, 96996461, 18413149],
    'val_seeds': [78184587, 89675787, 90957536, 14412352, 7954609, 32198148, 52828039, 54792237, 34259528, 46252217, 86448301, 56913194, 25941428, 21543717, 36427305, 3937507, 46916668, 65776558, 68886739, 2285178, 42966271, 39101096, 11892364, 85203482, 24272832, 94006136, 16825405, 32910873, 16008163, 90945570, 76293661, 2382151, 97586108, 1161295, 88168993, 38345877, 47383908, 40528494, 70904184, 95233507, 91456061, 25902619, 22988290, 5138079, 27885435, 48474040, 51597133, 12758367, 88369569, 95181557, 86434870, 90555478, 94409802, 81240369, 90076493, 64218385, 12370597, 75395560, 51519003, 34295390, 46849029, 79319182, 80088073, 91279025, 25626476, 2195395, 40360091, 6957072, 67311628, 99234449, 73990095, 73886915, 43153697, 7694116, 84388416, 93991438, 41173310, 60867451, 6737078, 89342100, 73705953, 60551668, 11753915, 5214779, 42570912, 32892599, 91750232, 45499285, 10361949, 22023624, 67205039, 83640448, 76283704, 13202064, 52998505, 39287758, 83207563, 91705199, 31783572, 29092408],
    'test_seed': 48796045,
    'train_dataset': {
        'class': Urb3DCDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/Urb3DCD',
            'split': 'train',
        },
    },
    'train_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 1,
            'collate_fn': {
                'class': SiameseKPConvCollator,
                'args': {},
            },
        },
    },
    'criterion': {
        'class': PointCloudSegmentationCriterion,
        'args': {
            'ignore_value': -1,
            'class_weights': None,
        },
    },
    'val_dataset': {
        'class': Urb3DCDDataset,
        'args': {
            'data_root': './data/datasets/soft_links/Urb3DCD',
            'split': 'val',
        },
    },
    'val_dataloader': {
        'class': DataLoader,
        'args': {
            'batch_size': 1,
            'collate_fn': {
                'class': SiameseKPConvCollator,
                'args': {},
            },
        },
    },
    'test_dataset': None,
    'test_dataloader': None,
    'metric': {
        'class': ConfusionMatrix,
        'args': {
            'num_classes': 7,
        },
    },
    'model': {
        'class': SiameseKPConv,
        'args': {
            'in_channels': 4,
            'out_channels': 7,
            'point_influence': 0.05,
            'down_channels': [64, 128, 256, 512, 1024],
            'up_channels': [1024, 512, 256, 128, 64],
            'bn_momentum': 0.02,
            'dropout': 0.5,
            'conv_type': 'simple',
            'block_params': {
                'n_kernel_points': 25,
                'max_num_neighbors': 25,
            },
        },
    },
    'optimizer': {
        'class': SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': SGD,
                'args': {
                    'lr': 0.001,
                    'momentum': 0.9,
                    'weight_decay': 0.0001,
                },
            },
        },
    },
    'scheduler': {
        'class': PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}
