# This file is automatically generated by `./configs/benchmarks/change_detection/gen_3d_change_detection.py`.
# Please do not attempt to modify manually.
import torch
import optimizers


config = {
    'runner': None,
    'work_dir': None,
    'epochs': 100,
    # seeds
    'init_seed': None,
    'train_seeds': None,
    'val_seeds': None,
    'test_seed': None,
    # dataset config
    'train_dataset': None,
    'train_dataloader': None,
    'criterion': None,
    'val_dataset': None,
    'val_dataloader': None,
    'test_dataset': None,
    'test_dataloader': None,
    'metric': None,
    # model config
    'model': None,
    # optimizer config
    'optimizer': {
        'class': optimizers.SingleTaskOptimizer,
        'args': {
            'optimizer_config': {
                'class': torch.optim.SGD,
                'args': {
                    'lr': 1.0e-03,
                    'momentum': 0.9,
                    'weight_decay': 1.0e-04,
                },
            },
        },
    },
    # scheduler config
    'scheduler': {
        'class': torch.optim.lr_scheduler.PolynomialLR,
        'args': {
            'optimizer': None,
            'total_iters': None,
            'power': 0.9,
        },
    },
}

from runners import SupervisedSingleTaskTrainer
config['runner'] = SupervisedSingleTaskTrainer

# dataset config
from configs.common.datasets.change_detection.train.urb3dcd_data_cfg import data_cfg as train_dataset_config
config.update(train_dataset_config)
from configs.common.datasets.change_detection.val.urb3dcd_data_cfg import data_cfg as val_dataset_config
config.update(val_dataset_config)

# model config
from configs.common.models.change_detection.siamese_kpconv import model_config
config['model'] = model_config

# Use specialized point cloud collator
import data
config['train_dataloader']['args']['collate_fn'] = data.collators.SiameseKPConvCollator()
config['val_dataloader']['args']['collate_fn'] = data.collators.SiameseKPConvCollator()

# seeds
config['init_seed'] = 59874168
config['train_seeds'] = [62290649, 20174431, 24391354, 52042786, 23224246, 43933073, 39926367, 99119579, 63706582, 29449840, 14178606, 26505726, 40640731, 20732256, 14977512, 32856924, 57669012, 56807285, 15015612, 58650856, 61301560, 1830814, 68068713, 99840223, 61834893, 51001777, 96675916, 29340180, 45742197, 11816878, 44243348, 11919054, 63044863, 46701114, 36767326, 72179133, 78459024, 58620228, 74441337, 48219429, 91840029, 37891562, 89784702, 48084908, 57224674, 32404127, 4207885, 1934766, 41890442, 5384128, 67063576, 23277609, 54753755, 37246243, 18163759, 48464825, 39851268, 62414834, 33124242, 37848253, 54707143, 16899358, 40735590, 4926374, 30508651, 37946065, 73465768, 44908541, 55287148, 15319952, 83687953, 41386248, 81774104, 75281660, 76929575, 43457067, 8098971, 78222156, 62682446, 12007283, 78513391, 97387883, 79264735, 19161796, 82406242, 85634018, 23030980, 88154523, 21593079, 19113536, 44609333, 75548384, 68661186, 49253903, 16516442, 71187161, 83508107, 18032103, 96996461, 18413149]
config['val_seeds'] = [78184587, 89675787, 90957536, 14412352, 7954609, 32198148, 52828039, 54792237, 34259528, 46252217, 86448301, 56913194, 25941428, 21543717, 36427305, 3937507, 46916668, 65776558, 68886739, 2285178, 42966271, 39101096, 11892364, 85203482, 24272832, 94006136, 16825405, 32910873, 16008163, 90945570, 76293661, 2382151, 97586108, 1161295, 88168993, 38345877, 47383908, 40528494, 70904184, 95233507, 91456061, 25902619, 22988290, 5138079, 27885435, 48474040, 51597133, 12758367, 88369569, 95181557, 86434870, 90555478, 94409802, 81240369, 90076493, 64218385, 12370597, 75395560, 51519003, 34295390, 46849029, 79319182, 80088073, 91279025, 25626476, 2195395, 40360091, 6957072, 67311628, 99234449, 73990095, 73886915, 43153697, 7694116, 84388416, 93991438, 41173310, 60867451, 6737078, 89342100, 73705953, 60551668, 11753915, 5214779, 42570912, 32892599, 91750232, 45499285, 10361949, 22023624, 67205039, 83640448, 76283704, 13202064, 52998505, 39287758, 83207563, 91705199, 31783572, 29092408]
config['test_seed'] = 48796045

# work dir
config['work_dir'] = "./logs/benchmarks/change_detection/urb3dcd/SiameseKPConv_run_0"
